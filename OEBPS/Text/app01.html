<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <script type="text/x-mathjax-config">
    MathJax.Hub.Register.StartupHook("TeX AMSmath Ready",function () {
      MathJax.InputJax.TeX.Definitions.environment["myarray1"] =
        ['Array',null,true,true,'r',".5em",".1em"];
      MathJax.InputJax.TeX.Definitions.environment["myarray2"] = 
        ['Array',null,true,true,'c',".4em",".1em"];
    });
    MathJax.Hub.Config({
      extensions: ["tex2jax.js"],
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        inlineMath: [["$","$"]],
        displayMath: [["$$","$$"]],
        processEscapes: true
      },
      "HTML-CSS": { availableFonts: ["TeX"] }
    });
  </script>
  <script src="MathJax-2.4-latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
  <title></title>
  <link href="../Styles/answers.css" rel="stylesheet" type="text/css">
  <style type="text/css">.st {font-weight: 800}</style><!--required in a formula-->
</head>

<body>
  <div style="display:none">
    $\newcommand{\md}[2][\!\!]{#1\;({\rm modulo}\;#2)}$<!-- #1 optional arg, #2 mandatory arg, [\!\!] optional arg. If not second arg is given, optional arg will be used (canceling the space produced by the first "\;")-->
    $\newcommand{\phihat}{\skew{3}\widehat{\smash{\phi}\vphantom{a}}}$
    $\newcommand{\mybinom}[2]{{\scriptstyle{\big(}\begin{myarray1}#1\\#2\end{myarray1}{\big)}}}$
    $\newcommand{\mybinomf}[2]{{\scriptstyle{\big(}\begin{myarray2}#1\\#2\end{myarray2}{\big)}}}$
  </div>

  <h2 id="app01"><a id="page_466"></a>Answers to Exercises</h2>

  <p class="blockquote"><span class="roman_italic">I am not bound to please thee with my answers</span>.</p>

  <p class="attribution">— SHYLOCK, in <span class="roman_italic">The Merchant of Venice</span> (Act IV, Scene 1, Line 65)</p>

  <h3 id="app01lev1sec1">Notes on the Exercises</h3>

  <p><a href="../Text/pref03.html#pref03ex_3_1" id="pref03ex_3_1a">1</a>. An average problem for a mathematically inclined reader.</p>

  <p><a href="../Text/pref03.html#pref03ex_3_4" id="pref03ex_3_4a">4</a>. See W. J. LeVeque, <em>Topics in Number Theory</em> <strong>2</strong> (Reading, Mass.: Addison–Wesley, 1956), Chapter 3; P. Ribenboim, <em>13 Lectures on Fermat’s Last Theorem</em> (New York: Springer-Verlag, 1979); A. Wiles, <em>Annals of Mathematics</em> (2) <strong>141</strong> (1995), 443–551.</p>

  <h3 id="app01lev1sec2">Section 1.1</h3>

  <p><a href="../Text/ch01.html#ch01ex_1_1_1" id="ch01ex_1_1_1a">1</a>. $t←a$, $a←b$, $b←c$, $c←d$, $d←t$.</p>

  <p><a href="../Text/ch01.html#ch01ex_1_1_2" id="ch01ex_1_1_2a">2</a>. After the first time, the values of the variables <em>m</em> and <em>n</em> are the previous values of <em>n</em> and <em>r</em>, respectively; and $n\gt r$.</p>

  <p><strong><a href="../Text/ch01.html#ch01ex_1_1_3" id="ch01ex_1_1_3a">3</a>. Algorithm F</strong> (<em>Euclid’s algorithm</em>). Given two positive integers <em>m</em> and <em>n</em>, find their greatest common divisor.</p>

  <p class="uln-indentCC"><strong>F1.</strong> [Remainder $m/n$.] Divide <em>m</em> by <em>n</em> and let <em>m</em> be the remainder.</p>

  <p class="uln-indentCC"><strong>F2.</strong> [Is it zero?] If $m=0$, the algorithm terminates with answer <em>n</em>.</p>

  <p class="uln-indentCC"><strong>F3.</strong> [Remainder $n/m$.] Divide <em>n</em> by <em>m</em> and let <em>n</em> be the remainder.</p>

  <p class="uln-indentCC"><strong>F4.</strong> [Is it zero?] If $n=0$, the algorithm terminates with answer <em>m</em>; otherwise go back to step F1. <span class="middle"><img src="../Images/box.png"></span></p>

  <p><a href="../Text/ch01.html#ch01ex_1_1_4" id="ch01ex_1_1_4a">4</a>. By <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a>, <em>n</em> = 6099, 2166, 1767, 399, 171, 57. Answer: 57.</p>

  <p><a href="../Text/ch01.html#ch01ex_1_1_5" id="ch01ex_1_1_5a">5</a>. Not finite nor definite nor effective, perhaps no output; in format, no letter is given before step numbers, no summary phrase appears, and there is no “&nbsp;<span class="middle"><img src="../Images/box.png"></span>&nbsp;”.</p>

  <p><a href="../Text/ch01.html#ch01ex_1_1_6" id="ch01ex_1_1_6a">6</a>. Trying <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a> with <em>n</em> = 5 and <em>m</em> = 1, 2, 3, 4, 5, we find that step E1 is executed 2, 3, 4, 3, 1 times, respectively. So the average is $2.6=T_{5}$.</p>

  <p><a href="../Text/ch01.html#ch01ex_1_1_7" id="ch01ex_1_1_7a">7</a>. In all but a finite number of cases, $n\gt m$. And when $n\gt m$, the first iteration of <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a> merely exchanges these numbers; so $U_{m}=T_{m}+1$.</p>

  <p><a id="page_467"></a><a href="../Text/ch01.html#ch01ex_1_1_8" id="ch01ex_1_1_8a">8</a>. Let $A=\{a,b,c\}$, $N=5$. The algorithm will terminate with the string $a^{\gcd(m,n)}$.</p>

  <div class="image"><img src="../Images/e467_01.png"></div>

  <p>Each iteration either decreases <em>m</em> or keeps <em>m</em> unchanged and decreases <em>n</em>.</p>

  <p><a href="../Text/ch01.html#ch01ex_1_1_9" id="ch01ex_1_1_9a">9</a>. For example we can say $C_{2}$ represents $C_{1}$ if there is a function <em>g</em> from $I_{1}$ into $I_{2}$, a function <em>h</em> from $Q_{2}$ into $Q_{1}$, and a function <em>j</em> from $Q_{2}$ into the positive integers, satisfying the following conditions:</p>

  <p class="uln-indentCC">a) If <em>x</em> is in $I_{1}$ then $h(g(x))=x$.</p>

  <p class="uln-indentCC">b) If <em>q</em> is in $Q_{2}$ then $f_{1}(h(q))=h(f_{2}^{[j(q)]}(q))$, where $f_{2}^{[j(q)]}$ means that the function $f_{2}$ is to be iterated $j(q)$ times.</p>

  <p class="uln-indentCC">c) If <em>q</em> is in $Q_{2}$ then $h(q)$ is in $Ω_{1}$ if and only if <em>q</em> is in $Ω_{2}$.</p>

  <p class="indent">For example, let $C_{1}$ be as in (<a href="../Text/ch01.html#ch01eq-lev1sec1-2">2</a>) and let $C_{2}$ have $I_{2}=\{(m,n)\}$, $Ω_{2}=\{(m,n,d)\}$, $Q_{2}=I_{2}∪Ω_{2}∪\{(m,n,a,b,1)\}∪$ $\{(m,n,a,b,r,2)\}∪\{(m,n,a,b,r,3)\}∪$ $\{(m,n,a,b,r,4)\}∪\{(m,n,a,b,5)\}$. Let $f_{2}((m,n))=(m,n,m,n,1)$; $f_{2}((m,n,d))=(m,n,d)$; $f_{2}((m,n,a,b,1))=(m,n,a,b,a\bmod b,2)$; $f_{2}((m,n,a,b,r,2))=(m,n,b)$ if <em>r</em> = 0, otherwise $(m,n,a,b,r,3)$; $f_{2}((m,n,a,b,r,3))=(m,n,b,b,r,4)$; $f_{2}((m,n,a,b,r,4))=(m,n,a,r,5)$; $f_{2}((m,n,a,b,5))=f_{2}((m,n,a,b,1))$.</p>

  <p class="indent">Now let $h((m,n))=g((m,n))=(m,n)$; $h((m,n,d))=(d)$; $h((m,n,a,b,1))=(a,b,0,1)$; $h((m,n,a,b,r,2))=(a,b,r,2)$; $h((m,n,a,b,r,3))=(a,b,r,3)$; $h((m,n,a,b,r,4))=h(f_{2}((m,n,a,b,r,4)))$; $h((m,n,a,b,5))=(a,b,b,1)$; $j((m,n,a,b,r,3))=j((m,n,a,b,r,4))=2$, otherwise $j(q)=1$. Then $C_{2}$ represents $C_{1}$.</p>

  <p class="indent"><em>Notes</em>: It is tempting to try to define things in a more simple way—for example, to let <em>g</em> map $Q_{1}$ into $Q_{2}$ and to insist only that when $x_{0},x_{1},\ldots$ is a computational sequence in $C_{1}$ then $g(x_{0}),g(x_{1}),\ldots$ is a subsequence of the computational sequence in $C_{2}$ that begins with $g(x_{0})$. But this is inadequate; in the example above, $C_{1}$ forgets the original value of <em>m</em> and <em>n</em> but $C_{2}$ does not.</p>

  <p class="indent">If $C_{2}$ represents $C_{1}$ by means of functions <em>g</em>, <em>h</em>, <em>j</em>, and if $C_{3}$ represents $C_{2}$ by means of functions <em>g</em>′, <em>h</em>′, <em>j</em>′, then $C_{3}$ represents $C_{1}$ by means of functions $g''$, $h''$, $j''$, where</p>

  <div class="image"><img src="../Images/e467_04.png"></div>

  <p>if $q_{0}=q$ and $q_{k+1}=f_{3}^{\large[j'(q_{k})]}(q_k)$. Hence the relation defined above is transitive. We can say $C_{2}$ <em>directly represents</em> $C_{1}$ if the function <em>j</em> is bounded; this relation is also transitive. The relation “$C_{2}$ represents $C_{1}$” generates an equivalence relation in which two computational methods apparently are equivalent if and only if they compute isomorphic functions of their inputs; the relation “$C_{2}$ directly represents $C_{1}$” generates a more interesting equivalence relation that perhaps matches the intuitive idea of being “essentially the same algorithm.”</p>

  <p class="indent">For an alternative approach to simulation, see R. W. Floyd and R. Beigel, <em>The Language of Machines</em> (Computer Science Press, 1994), Section 3.3.</p>

  <h4 id="app01lev2sec1"><a id="page_468"></a>Section 1.2.1</h4>

  <p><a href="../Text/ch01.html#ch01ex_2_1_1" id="ch01ex_2_1_1a">1</a>. (a) Prove $P(0)$. (b) Prove that $P (0),\ldots,P(n)$ implies $P(n+1)$, for all <em>n</em> ≥ 0.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_1_2" id="ch01ex_2_1_2a">2</a>. The theorem has not been proved for <em>n</em> = 2. In the second part of the proof, take <em>n</em> = 1; we assume there that $a^{(n-1)-1}=a^{-1}=1$. If this condition is true (so that <em>a</em> = 1), the theorem is indeed valid.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_1_3" id="ch01ex_2_1_3a">3</a>. The correct answer is $1-1/n$. The mistake occurs in the proof for <em>n</em> = 1, when the formula on the left either may be assumed to be meaningless, or it may be assumed to be zero (since there are <em>n</em> − 1 terms).</p>

  <p><a href="../Text/ch01.html#ch01ex_2_1_5" id="ch01ex_2_1_5a">5</a>. If <em>n</em> is prime, it is trivially a product of one or more primes. Otherwise <em>n</em> has factors, so $n=km$ for some <em>k</em> and <em>m</em> with 1 &lt; <em>k</em>,<em>m</em> &lt; <em>n</em>. Since both <em>k</em> and <em>m</em> are less than <em>n</em>, by induction they can be written as products of primes; hence <em>n</em> is the product of the primes appearing in the representations of <em>k</em> and <em>m</em>.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_1_6" id="ch01ex_2_1_6a">6</a>. In the notation of <a href="../Text/ch01.html#ch01fig04">Fig. 4</a>, we prove <em>A5</em> implies <em>A6</em>. This is clear since <em>A5</em> implies $(a'-qa)m+(b'-qb)n=(a'm+b'n)-q(am+bn)=c-qd=r$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_1_7" id="ch01ex_2_1_7a">7</a>. $n^{2}-(n-1)^{2}+\cdots-(-1)^{n}1^{2}=1+2+\cdots+n=n(n+1)/2$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_1_8" id="ch01ex_2_1_8a">8</a>.&nbsp;&nbsp;&nbsp;(a) We must show that $(n^{2}-n+1)+(n^{2}-n+3)+\cdots+(n^{2}+n-1)$ equals $n^{3}$: And indeed, the sum is $n(n^{2}-n)+(1+3+\cdots+(2n-1))=n^{3}-n^{2}+n^{2}$, by Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec1-2">2</a>). But an inductive proof was requested, so another approach should be taken! For $n=1$, the result is obvious. Let $n≥1$; we have $(n+1)^{2}-(n+1)=n^{2}-n+2n$, so the first terms for $n+1$ are $2n$ larger; thus the sum for $n+1$ is the sum for <em>n</em> plus</p>

  <div class="image"><img src="../Images/e468_01.png"></div>

  <p>this equals $n^{3}+2n^{2}+n^{2}+3n+1=(n+1)^{3}$.</p>

  <p class="indent">(b) We have shown that the first term for $(n+1)^{3}$ is two greater than the last term for $n^{3}$. Therefore by Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec1-2">2</a>), $1^{3}+2^{3}+\cdots+n^{3}=$ sum of consecutive odd numbers starting with unity $=(\text{number of terms})^{2}=(1+2+\cdots+n)^{2}$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_1_10" id="ch01ex_2_1_10a">10</a>. Obvious for $n=10$. If $n≥10$, we have $2^{n+1}=2·2^{n}\gt (1+1/n)^{3}2^{n}$ and by induction this is greater than $(1+1/n)^{3}n^{3}=(n+1)^{3}$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_1_11" id="ch01ex_2_1_11a">11</a>. $(-1)^{n}(n+1)/(4(n+1)^{2}+1)$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_1_12" id="ch01ex_2_1_12a">12</a>. The only nontrivial part of the extension is the calculation of the integer <em>q</em> in E2. This can be done by repeated subtraction, reducing to the problem of determining whether $u+v\sqrt{2}$ is positive, negative, or zero, and the latter problem is readily solved.</p>

  <p class="indent">It is easy to show that whenever $u+v\sqrt{2}=u'+v'\sqrt{2}$, we must have $u=u'$ and $v=v'$, since $\sqrt{2}$ is irrational. Now it is clear that 1 and $\sqrt{2}$ have no common divisor, if we define divisor in the sense that $u+v\sqrt{2}$ divides $a(u+v\sqrt{2})$ if and only if <em>a</em> is an integer. The algorithm extended in this way computes the regular continued fraction of the ratio of its inputs; see Section 4.5.3.</p>

  <p class="indent">[<em>Note:</em> If we extend the concept of divisor so that $u+v\sqrt{2}$ divides $a(u+v\sqrt{2})$ if and only if <em>a</em> has the form $u'+v'\sqrt{2}$ for integers $u'$ and $v'$, there <em>is</em> a way to extend <a href="../Text/ch01.html#ch01alg-lev2sec1-E">Algorithm E</a> so that it always will terminate: If in step E2 we have $c=u+v\sqrt{2}$ and $d=u'+v'\sqrt{2}$, compute $c/d=c(u'-v'\sqrt{2})/(u'^{2}-2v'^{2})=x+y\sqrt{2}$ where <em>x</em> and <em>y</em> are rational. Now let $q=u''+v''\sqrt{2}$, where $u''$ and $v''$ are the nearest integers to <em>x</em> and <em>y</em>; and let $r=c-qd$. If $r=u'''+v'''\sqrt{2}$, it follows that $|u'''^{2}-2v'''^{2}|\lt|u'^{2}-2v'^{2}|$, hence the computation will terminate. See “quadratic Euclidean domains” in number theory texts.]</p>

  <p><a href="../Text/ch01.html#ch01ex_2_1_13" id="ch01ex_2_1_13a">13</a>. Add “$T≤3(n-d)+k$” to assertions <em>A3</em>, <em>A4</em>, <em>A5</em>, <em>A6</em>, where <em>k</em> takes the respective values 2, 3, 3, 1. Also add “$d\gt 0$” to <em>A4</em>.</p>

  <p><a id="page_469"></a><a href="../Text/ch01.html#ch01ex_2_1_15" id="ch01ex_2_1_15a">15</a>. (a) Let $A=S$ in (iii); every nonempty well-ordered set has a least element.</p>

  <p class="indent">(b) Let $x≺y$ if $|x|\lt|y|$ or if $|x|=|y|$ and $x\lt 0 \lt y$.</p>

  <p class="indent">(c) No, the subset of all positive reals fails to satisfy (iii). [<em>Note:</em> Using the so-called axiom of choice, a rather complicated argument can be given to show that every set can be well-ordered somehow; but nobody has yet been able to define an explicit relation that well-orders the real numbers.]</p>

  <p class="indent">(d) To prove (iii) for $T_{n}$, use induction on <em>n</em>: Let <em>A</em> be a nonempty subset of $T_{n}$ and consider $A_{1}$, the set of first components of <em>A</em>. Since $A_{1}$ is a nonempty subset of <em>S</em>, and <em>S</em> is well-ordered, $A_{1}$ contains a smallest element <em>x</em>. Now consider $A_{x}$, the subset of <em>A</em> in which the first component equals <em>x</em>; $A_{x}$ may be considered a subset of $T_{n-1}$ if its first component is suppressed, so by induction $A_{x}$ contains a smallest element $(x,x_{2},\ldots,x_{n})$ that in fact is the smallest element of <em>A</em>.</p>

  <p class="indent">(e) No, although properties (i) and (ii) are valid. If <em>S</em> contains at least two distinct elements, $a≺b$, the set $(b),(a,b),(a,a,b),(a,a,a,b),(a,a,a,a,b),\ldots$ has no least element. On the other hand <em>T</em> can be well-ordered if we define $(x_{1},\ldots,x_{m})≺(y_{1},\ldots,y_{n})$ whenever $m\lt n$, or $m=n$ and $(x_{1},\ldots,x_{n})≺(y_{1},\ldots,y_{n})$ in $T_{n}$.</p>

  <p class="indent">(f) Let <em>S</em> be well-ordered by $≺$. If such an infinite sequence exists, the set <em>A</em> consisting of the members of the sequence fails to satisfy property (iii), for no element of the sequence can be smallest. Conversely if $≺$ is a relation satisfying (i) and (ii) but not (iii), let <em>A</em> be a nonempty subset of <em>S</em> that has no smallest element. Since <em>A</em> is not empty, we can find $x_{1}$ in <em>A</em>; since $x_{1}$ is not the smallest element of <em>A</em>, there is $x_{2}$ in <em>A</em> for which $x_{2}≺x_{1}$; since $x_{2}$ is not the smallest element either, we can find $x_{3}≺x_{2}$; etc.</p>

  <p class="indent">(g) Let <em>A</em> be the set of all <em>x</em> for which $P(x)$ is false. If <em>A</em> is not empty, it contains a smallest element $x_{0}$. Hence $P(y)$ is true for all $y≺x_{0}$. But this implies $P(x_{0})$ is true, so $x_{0}$ is not in <em>A</em> (a contradiction). Therefore <em>A</em> must be empty: $P(x)$ is always true.</p>

  <h4 id="app01lev2sec2">Section 1.2.2</h4>

  <p><a href="../Text/ch01.html#ch01ex_2_2_1" id="ch01ex_2_2_1a">1</a>. There is none; if <em>r</em> is a positive rational, $r/2$ is smaller.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_2" id="ch01ex_2_2_2a">2</a>. Not if infinitely many nines appear in a row; in that case the decimal expansion of the number is $1+.24000000\ldots$, according to Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec2-2">2</a>).</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_3" id="ch01ex_2_2_3a">3</a>. $-1/27$, but the text hasn’t defined it.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_4" id="ch01ex_2_2_4a">4</a>. 4.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_6" id="ch01ex_2_2_6a">6</a>. The decimal expansion of a number is unique, so $x=y$ if and only if $m=n$ and $d_{i}=e_{i}$ for all $i≥1$. If $x≠y$, one may compare <em>m</em> vs. <em>n</em>, $d_{1}$ vs. $e_{1}$, $d_{2}$ vs. $e_{2}$, etc.; when the first inequality occurs, the larger quantity belongs to the larger of $\{x,y\}$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_7" id="ch01ex_2_2_7a">7</a>. One may use induction on <em>x</em>, first proving the laws for <em>x</em> positive, and then for <em>x</em> negative. Details are omitted here.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_8" id="ch01ex_2_2_8a">8</a>. By trying $n=0,1,2,\ldots$ we find the value of <em>n</em> for which $n^{m}≤u\lt(n+1)^{m}$. Assuming inductively that $n,d_{1},\ldots,d_{k-1}$ have been determined, $d_{k}$ is the digit such that</p>

  <div class="image"><img src="../Images/e469_06.png"></div>

  <p>This construction can’t make $d_{k}=9$ for all $k\gt l$, because that could happen only if $(n+d_{1}/10+\cdots+d_{l}/10^{l}+1/10^{l})^{m}≤u$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_9" id="ch01ex_2_2_9a">9</a>. $((b^{p/q})^{u/v})^{qv}=(((b^{p/q})^{u/v})^{v})^{q}=((b^{p/q})^{u})^{q}=((b^{p/q})^{q})^{u}=b^{pu}$, hence $(b^{p/q})^{u/v}=b^{pu/qv}$. This proves the second law. We prove the first law using the second: $b^{p/q}b^{u/v}=(b^{1/qv})^{pv}(b^{1/qv})^{qu}=(b^{1/qv})^{pv+qu}=b^{p/q+u/v}$.</p>

  <p><a id="page_470"></a><a href="../Text/ch01.html#ch01ex_2_2_10" id="ch01ex_2_2_10a">10</a>. If $\log_{10}2=p/q$, with <em>p</em> and <em>q</em> positive, then $2^{q}=10^{p}$, which is absurd since the right-hand side is divisible by 5 but the left-hand side isn’t.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_11" id="ch01ex_2_2_11a">11</a>. Infinitely many! No matter how many digits of <em>x</em> are given, we will not know whether $10^{x}=1.99999\ldots$ or $2.00000\ldots$, if <em>x</em>’s digits agree with the digits of $\log_{10}2$. There is nothing mysterious or paradoxical in this; a similar situation occurs in addition, if we are adding $.444444\ldots$ to $.55555\ldots$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_12" id="ch01ex_2_2_12a">12</a>. They are the only values of $d_{1},\ldots,d_{8}$ that satisfy Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec2-7">7</a>).</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_13" id="ch01ex_2_2_13a">13</a>. (a) First prove by induction that if $y\gt 0$, $1+ny≤(1+y)^{n}$. Then set $y=x/n$, and take <em>n</em>th roots.</p>

  <p class="indent">(b) $x=b-1$, $n=10^{k}$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_14" id="ch01ex_2_2_14a">14</a>. Set $x=\log_{b}c$ in the second equation of (<a href="../Text/ch01.html#ch01eq-lev2sec2-5">5</a>), then take logarithms of both sides.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_15" id="ch01ex_2_2_15a">15</a>. Prove it, by transposing “$\log_{b}y$” to the other side of the equation and using (<a href="../Text/ch01.html#ch01eq-lev2sec2-11">11</a>).</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_16" id="ch01ex_2_2_16a">16</a>. $\ln x/\ln 10$, by (<a href="../Text/ch01.html#ch01eq-lev2sec2-14">14</a>).</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_17" id="ch01ex_2_2_17a">17</a>. 5; 1; 1; 0; undefined.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_18" id="ch01ex_2_2_18a">18</a>. No, $\log_{8}x=\lg{x}/\lg{8}=\frac13\lg{x}$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_19" id="ch01ex_2_2_19a">19</a>. Yes, since $\lg n\lt(\log_{10}n)/.301\lt 14/.301\lt 47$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_20" id="ch01ex_2_2_20a">20</a>. They are reciprocals.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_21" id="ch01ex_2_2_21a">21</a>. $(\ln\ln x-\ln\ln b)/\ln b$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_22" id="ch01ex_2_2_22a">22</a>. From the tables in <a href="../Text/app02.html#app02">Appendix A</a>, $\lg x≈1.442695\ln x$; $\log_{10}x≈.4342945\ln x$. The relative error is $≈(1.442695-1.4342945)/1.442695≈0.582\%$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_23" id="ch01ex_2_2_23a">23</a>. Take the figure of area $\ln y$, and divide its height by <em>x</em> while multiplying its length by <em>x</em>. This deformation preserves its area and makes it congruent to the piece left when $\ln x$ is removed from $\ln xy$, since the height at point $x+xt$ in the diagram for $\ln xy$ is $1/(x+xt)=(1/(1+t))/x$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_24" id="ch01ex_2_2_24a">24</a>. Substitute 2 everywhere 10 appears.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_25" id="ch01ex_2_2_25a">25</a>. Note that $z=2^{-p}\lfloor{2^{p-k}x}\rfloor\gt 0$, when <em>p</em> is the precision (the number of binary digits after the radix point). The quantity $y+\log_{b}x$ stays approximately constant.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_27" id="ch01ex_2_2_27a">27</a>. Prove by induction on <em>k</em> that</p>

  <div class="image"><img src="../Images/e470_02.png"></div>

  <p>and take logarithms.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_28" id="ch01ex_2_2_28a">28</a>. The following solution uses the same auxiliary table as before.</p>

  <p class="uln-indentC"><strong>E1.</strong> [Initialize.] Set $x←1-\epsilon-x$, $y←y_{0}$, and $k←1$, where $1-\epsilon$ is the largest possible value of <em>x</em>, and $y_{0}$ is the nearest approximation to $b^{1-\epsilon}$. (The quantity $yb^{-x}$ will remain approximately constant in the following steps.)</p>

  <p class="uln-indentC"><strong>E2.</strong> [Test for end.] If $x=0$, stop.</p>

  <p class="uln-indentC"><strong>E3.</strong> [Compare.] If $x\lt\log_{b}(2^{k}/(2^{k}-1))$, increase <em>k</em> by 1 and repeat this step.</p>

  <p class="uln-indentC"><strong>E4.</strong> [Reduce values.] Set $x←x-\log_{b}(2^{k}/(2^{k}-1))$, $y←y-(y\text{ shifted right }k)$, and go to E2. <span class="middle"><img src="../Images/box.png"></span></p>

  <p class="indent">If <em>y</em> is set to $b^{1-\epsilon}(1+\epsilon_{0})$ in step E1, the subsequent computational error arises when $x←x+\log_{b}(1-2^{-k})+δ_{j}$ and $y←y(1-2^{-k})(1+\epsilon_{j})$ during the <em>j</em>th execution of step E4, for certain small errors $δ_{j}$ and $\epsilon_{j}$. When the algorithm terminates we have computed $y=b^{x-Σδ_{j}}∏_{j}(1+\epsilon_{j})$. Further analysis depends on <em>b</em> and the computer word size. Notice that both in this case and in <a href="../Text/ch01.html#ch01ex_2_2_26">exercise 26</a>, it is possible to refine the error estimates somewhat if the base is <em>e</em>, since for most values of <em>k</em> the table entry $\ln(2^{k}/(2^{k}-1))$ can be given with high accuracy: It equals $2^{-k}+\frac{1}{2}2^{-2k}+\frac{1}{3}2^{-3k}+\cdots$.</p>

  <p class="indent"><a id="page_471"></a><em>Note:</em> Similar algorithms can be given for trigonometric functions; see J. E. Meggitt, <em>IBM J. Res. and Dev.</em> <strong>6</strong> (1962), 210–226; <strong>7</strong> (1963), 237–245. See also T. C. Chen, <em>IBM J. Res. and Dev.</em> <strong>16</strong> (1972), 380–388; V. S. Linsky, <em>Vychisl. Mat.</em> <strong>2</strong> (1957), 90–119; D. E. Knuth, <em>METAFONT: The Program</em> (Reading, Mass.: Addison–Wesley, 1986), §120–§147.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_29" id="ch01ex_2_2_29a">29</a>. <em>e</em>; 3; 4.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_2_30" id="ch01ex_2_2_30a">30</a>. <em>x</em>.</p>

  <h4 id="app01lev2sec3">Section 1.2.3</h4>

  <p><a href="../Text/ch01.html#ch01ex_2_3_1" id="ch01ex_2_3_1a">1</a>. $-a_{1}$; and $a_{2}+\cdots+a_{1}=0$. In general, sums with ‘$\cdots$’ are defined so that $(a_{p}+\cdots+a_{q})+(a_{q+1}+\cdots+a_{r})=a_{p}+\cdots+a_{r}$ for arbitrary integers <em>p</em>, <em>q</em>, and <em>r</em>.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_2" id="ch01ex_2_3_2a">2</a>. $a_{1}+a_{2}+a_{3}$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_3" id="ch01ex_2_3_3a">3</a>. $\frac11+\frac13+\frac15+\frac17+\frac19+\frac{1}{11}$; $\frac19+\frac13+\frac11+\frac13+\frac19$. The rule for $p(j)$ is violated: In the first case $n^{2}=3$ occurs for no <em>n</em>, and in the second case $n^{2}=4$ occurs for <em>two</em> <em>n</em>. [See Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-18">18</a>).]</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_4" id="ch01ex_2_3_4a">4</a>. $(a_{11})+(a_{21}+a_{22})+(a_{31}+a_{32}+a_{33})=(a_{11}+a_{21}+a_{31})+(a_{22}+a_{32})+(a_{33})$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_5" id="ch01ex_2_3_5a">5</a>. It is only necessary to use the rule $a∑_{R(i)}x_{i}=∑_{R(i)}(ax_{i})$:</p>

  <div class="image"><img src="../Images/e471_02.png"></div>

  <p><a href="../Text/ch01.html#ch01ex_2_3_7" id="ch01ex_2_3_7a">7</a>. Use Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-3">3</a>); the two limits are interchanged and the terms between $a_{0}$ and $a_{c}$ must be transferred from one limit to the other.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_8" id="ch01ex_2_3_8a">8</a>. Let $a_{(i+1)i}=+1$, and $a_{i(i+1)}=-1$, for all <em>i</em> ≥ 0, and all other $a_{ij}$ zero; let $R(i)=S(i)=“i≥0”$. The left-hand side is −1, the right-hand side is +1.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_9" id="ch01ex_2_3_9a">9</a>, <a href="../Text/ch01.html#ch01ex_2_3_10" id="ch01ex_2_3_10a">10</a>. No; the applications of rule (d) assume that <em>n</em> ≥ 0. (The result is correct for <em>n</em> = −1 but the derivation isn’t.)</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_11" id="ch01ex_2_3_11a">11</a>. $(n+1)a$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_12" id="ch01ex_2_3_12a">12</a>. $\frac76(1-1/7^{n+1})$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_13" id="ch01ex_2_3_13a">13</a>. $m(n-m+1)+\frac12(n-m)(n-m+1)$; or, $\frac12(n(n+1)-m(m-1))$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_14" id="ch01ex_2_3_14a">14</a>. $\frac14(n(n+1)-m(m-1))(s(s+1)-r(r-1))$, if <em>m</em> ≤ <em>n</em> and <em>r</em> ≤ <em>s</em>.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_15" id="ch01ex_2_3_15a">15</a>, <a href="../Text/ch01.html#ch01ex_2_3_16" id="ch01ex_2_3_16a">16</a>. Key steps:</p>

  <div class="image"><img src="../Images/e471_07.png"></div>

  <p><a href="../Text/ch01.html#ch01ex_2_3_17" id="ch01ex_2_3_17a">17</a>. The number of elements in <em>S</em>.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_18" id="ch01ex_2_3_18a">18</a>. $S'(j)=“1≤j\lt n”$. $R'(i,j)=$ “<em>n</em> is a multiple of <em>i</em> and $i\gt j$”.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_19" id="ch01ex_2_3_19a">19</a>. $(a_{n}-a_{m-1}) [m≤n]$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_20" id="ch01ex_2_3_20a">20</a>. $(b-1)\sum_{k=0}^{n}(n-k)b^{k}+n+1=\sum_{k=0}^{n}b^{k}$; this formula follows from (<a href="../Text/ch01.html#ch01eq-lev2sec3-14">14</a>) and the result of <a href="../Text/ch01.html#ch01ex_2_3_16">exercise 16</a>.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_21" id="ch01ex_2_3_21a">21</a>. $∑_{R(j)}a_{j}+∑_{S(j)}a_{j}=∑_{j}a_{j}[R(j)]+∑_{j}a_{j}[S(j)]=∑_{j}a_{j}([R(j)]+[S(j)])$; now use the fact that $[R(j)]+[S(j)]=[R(j)\text{ or }S(j)]+[R(j)\text{ and }S(j)]$. In general, bracket notation gives us the ability to manipulate “on the line” instead of “below the line.”</p>

  <p><a id="page_472"></a><a href="../Text/ch01.html#ch01ex_2_3_22" id="ch01ex_2_3_22a">22</a>. For (<a href="../Text/ch01.html#ch01eq-lev2sec3-5">5</a>) and (<a href="../Text/ch01.html#ch01eq-lev2sec3-7">7</a>), just change ∑ to ∏. We also have $∏_{R(i)}b_{i}c_{i}=(∏_{R(i)}b_{i})(∏_{R(i)}c_{i})$ and</p>

  <div class="image"><img src="../Images/e472_01.png"></div>

  <p><a href="../Text/ch01.html#ch01ex_2_3_23" id="ch01ex_2_3_23a">23</a>. 0 + <em>x</em> = <em>x</em> and $1·x=x$. This makes many operations and equations simpler, such as rule (d) and its analog in the previous exercise.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_25" id="ch01ex_2_3_25a">25</a>. The first step and last step are OK. The second step uses <em>i</em> for two different purposes at once. The third step should probably be $∑_{i=1}^{n}n$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_26" id="ch01ex_2_3_26a">26</a>. Key steps, after transforming the problem as in <a href="../Text/ch01.html#ch01exam-1-2">Example 2</a>:</p>

  <div class="image"><img src="../Images/e472_03.png"></div>

  <p>The answer is $\left(∏_{i=0}^{n}a_{i}\right)^{n+2}$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_28" id="ch01ex_2_3_28a">28</a>. $(n+1)/2n$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_29" id="ch01ex_2_3_29a">29</a>. (a) $∑_{0≤k≤j≤i≤n}a_{i}a_{j}a_{k}$. (b) Let $S_r=∑_{i=0}^{n}a_{i}^{r}$. <em>Solutions</em>: $\frac{1}{3}S_3+\frac{1}{2}S_1S_2+\frac{1}{6}S_{1}^{3}$. The general solution to this problem, as the number of indices gets larger, may be found in <a href="../Text/ch01a.html#ch01lev2sec9">Section 1.2.9</a>, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-38">38</a>).</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_30" id="ch01ex_2_3_30a">30</a>. Write the left side as $∑_{1≤j,k≤n}a_{j}b_{k}x_{j}y_{k}$, and do a similar thing on the right. (This identity is the special case <em>m</em> = 2 of <a href="../Text/app01.html#ch01ex_2_3_46a">exercise 46</a>.)</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_31" id="ch01ex_2_3_31a">31</a>. Set $a_{j}=u_{j}$, $b_{j}=1$, $x_{j}=v_{j}$, and $y_{j}=1$, to obtain the answer $n∑_{j=1}^{n}u_{j}v_{j}-(∑_{j=1}^{n}u_j)(∑_{j=1}^{n}v_j)$. Consequently we have $(∑_{j=1}^{n}u_{j})(∑_{j=1}^{n}v_{j})≤n∑_{j=1}^{n}u_{j}v_{j}$ when $u_{1}≤u_{2}≤\cdots≤u_{n}$ and $v_{1}≤v_{2}≤\cdots≤v_{n}$, a result known as <em>Chebyshev’s monotonic inequality</em>. [See <em>Soobshch. mat. obshch. Khar, kovskom Univ.</em> <strong>4</strong>, 2 (1882), 93–98.]</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_33" id="ch01ex_2_3_33a">33</a>. This can be proved by induction on <em>n</em>, if we rewrite the formula as</p>

  <div class="image"><img src="../Images/e472_09.png"></div>

  <p>Each of these sums now has the form of the original sum, except on $n-1$ elements, and the values turn out nicely by induction when $0≤r≤n-1$. When <em>r</em> = <em>n</em>, consider the identity</p>

  <div class="image"><img src="../Images/e472_10.png"></div>

  <p>where $P(x_{j})$ is a polynomial of degree $n-2$ in $x_{j}$ whose coefficients are symmetric functions of $\{x_{1},\ldots,x_{n}\}$ that don’t depend on <em>j</em>. (See <a href="../Text/ch01a.html#ch01ex_2_9_10">exercise 1.2.9–10</a>.) We obtain the desired answer from the solutions for $r=0,1,\ldots,n-1$.</p>

  <p class="indent"><em>Notes:</em> Dr. Matrix was anticipated in this discovery by L. Euler, who wrote to Christian Goldbach about it on 9 November 1762. See Euler’s <em>Institutionum Calculi Integralis</em> <strong>2</strong> (1769),§1169; and E. Waring, <em>Phil. Trans.</em> <strong>69</strong> (1779), 64–67. The following alternative method of proof, using complex variable theory, is less elementary but more elegant: By the residue theorem, the value of the given sum is</p>

  <div class="image"><img src="../Images/e472_11.png"></div>

  <p><a id="page_473"></a>where $R\gt|x_{1}|,\ldots,|x_{n}|$. The Laurent expansion of the integrand converges uniformly on $|z|=R$; it is</p>

  <div class="image"><img src="../Images/e473_01.png"></div>

  <p>Integrating term by term, everything vanishes except the coefficient of $z^{-1}$. This method gives us the <em>general formula</em> for an arbitrary integer <em>r</em> ≥ 0:</p>

  <div class="image"><img src="../Images/e473_02.png"></div>

  <p>see Eq. <a href="../Text/ch01a.html#ch01lev2sec9">1.2.9</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec9-33">33</a>). [J. J. Sylvester, <em>Quart. J. Math.</em> <strong>1</strong> (1857), 141–152.]</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_34" id="ch01ex_2_3_34a">34</a>. If the reader has tried earnestly to solve this problem, <em>without</em> getting the answer, perhaps its purpose has been achieved. The temptation to regard the numerators as polynomials in <em>x</em> rather than as polynomials in <em>k</em> is almost overwhelming. It would undoubtedly be easier to prove the considerably more general result</p>

  <div class="image"><img src="../Images/e473_03.png"></div>

  <p>which is an identity in $2n-1$ variables!</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_35" id="ch01ex_2_3_35a">35</a>. If $R(j)$ never holds, the value should be $-∞$. The stated analog of rule (a) is based on the identity $a+\max(b,c)=\max(a+b,a+c)$. Similarly if all $a_{i}$, $b_{j}$ are <em>nonnegative</em>, we have</p>

  <p class="center">$\sup_{R(i)}a_{i}\sup_{S(j)}b_{j}=\sup_{R(i)}\sup_{S(j)}a_{i}b_{j}$.</p>

  <p>Rules (b), (c) do not change; for rule (d) we get the simpler form</p>

  <p class="center">$\sup(\sup_{R(j)}a_{j},\sup_{S(j)}a_{j})=\sup_{R(j)\text{ or }S(j)}a_{j}$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_36" id="ch01ex_2_3_36a">36</a>. Subtract column one from columns $2,\ldots,n$. Add rows $2,\ldots,n$ to row one. The result is a triangular determinant.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_37" id="ch01ex_2_3_37a">37</a>. Subtract column one from columns $2,\ldots,n$. Then subtract $x_{1}$ times row <em>k</em> − 1 from row <em>k</em>, for $k=n,n-1,\ldots,2$ (in that order). Now factor $x_{1}$ out of the first column and factor $x_{k}-x_{1}$ out of columns $k=2,\ldots,n$, obtaining $x_{1}(x_{2}-x_{1})\ldots(x_{n}-x_{1})$ times a Vandermonde determinant of order <em>n</em> − 1. The process continues by induction.</p>

  <p class="indent">Alternative proof, using “higher” mathematics: The determinant is a polynomial in the variables $x_{1},\ldots,x_{n}$ of total degree $1+2+\cdots+n$. It vanishes if $x_{j}=0$ or if $x_{i}=x_{j}$ $(i\lt j)$, and the coefficient of $x_{1}^{1}x_{2}^{2}\ldots x_{n}^{n}$ is +1. These facts characterize its value. In general, if two rows of a matrix become equal for $x_{i}=x_{j}$, their difference is usually divisible by $x_{i}-x_{j}$, and this observation often speeds the evaluation of determinants.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_38" id="ch01ex_2_3_38a">38</a>. Subtract column one from columns $2,\ldots,n$, and factor out</p>

  <p class="center">$(x_{1}+y_{1})^{-1}\ldots(x_{n}+y_{1})^{-1}(y_{1}-y_{2})\ldots(y_{1}-y_{n})$</p>

  <p>from rows and columns. Now subtract row one from rows $2,\ldots,n$ and factor out $(x_{1}-x_{2})\ldots(x_{1}-x_{n})(x_{1}+y_{2})^{-1}\ldots(x_{1}+y_{n})^{-1}$; we are left with the Cauchy determinant of order <em>n</em> − 1.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_39" id="ch01ex_2_3_39a">39</a>. Let <em>I</em> be the identity matrix $(δ_{ij})$, and <em>J</em> the matrix of all ones. Since $J^{2}=nJ$, we have $(xI+yJ)((x+ny)I-yJ)=x(x+ny)I$.</p>

  <p><a id="page_474"></a><a href="../Text/ch01.html#ch01ex_2_3_40" id="ch01ex_2_3_40a">40</a>. [A. de Moivre, <em>The Doctrine of Chances</em>, 2nd edition (London: 1738), 197–199.] We have</p>

  <div class="image"><img src="../Images/e474_01.png"></div>

  <p><a href="../Text/ch01.html#ch01ex_2_3_41" id="ch01ex_2_3_41a">41</a>. This follows immediately from the relation of an inverse matrix to its cofactors. It may also be interesting to give a direct proof here: We have</p>

  <div class="image"><img src="../Images/e474_02.png"></div>

  <p>when <em>x</em> = 0. This is a polynomial of degree at most <em>n</em> − 1 in <em>x</em>. If we set $x=x_{j}+y_{s}$, 1≤ <em>s</em> ≤ <em>n</em>, the terms are zero except when <em>s</em> = <em>t</em>, so the value of this polynomial is</p>

  <div class="image"><img src="../Images/e474_03.png"></div>

  <p class="indent">These polynomials of degree at most <em>n</em> − 1 agree at <em>n</em> distinct points <em>x</em>, so they agree also for <em>x</em> = 0; hence</p>

  <div class="image"><img src="../Images/e474_04.png"></div>

  <p><a href="../Text/ch01.html#ch01ex_2_3_42" id="ch01ex_2_3_42a">42</a>. $n/(x+ny)$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_43" id="ch01ex_2_3_43a">43</a>. $1-∏_{k=1}^{n}(1-1/x_{k})$. This is easily verified if any $x_{i}=1$, since the inverse of any matrix having a row or column all of ones must have elements whose sum is 1. If none of the $x_{i}$ equals one, sum the elements of row <em>i</em> by setting <em>x</em> = 1 in <a href="../Text/ch01.html#ch01ex_2_3_40">exercise 40</a> and obtaining $∏_{k≠i}(x_{k}-1)/x_{i}∏_{k≠i}(x_{k}-x_{i})$. After multiplying numerator and denominator by $x_{i}-1$, we can sum on <em>i</em> by applying <a href="../Text/ch01.html#ch01ex_2_3_33">exercise 33</a> with <em>r</em> = 0 to the <em>n</em> + 2 numbers $\{0,1,x_{1},\ldots,x_{n}\}$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_44" id="ch01ex_2_3_44a">44</a>. We find</p>

  <div class="image"><img src="../Images/e474_06.png"></div>

  <p>after applying <a href="../Text/ch01.html#ch01ex_2_3_33">exercise 33</a>. And</p>

  <div class="image"><img src="../Images/e474_07.png"></div>

  <p><a href="../Text/ch01.html#ch01ex_2_3_45" id="ch01ex_2_3_45a">45</a>. Let $x_{i}=i$, $y_{j}=j-1$. From <a href="../Text/ch01.html#ch01ex_2_3_44">exercise 44</a>, the sum of the elements of the inverse is $(1+2+\cdots+n)+((n-1)+(n-2)+\cdots+0)=n^{2}$. From <a href="../Text/ch01.html#ch01ex_2_3_38">exercise 38</a>, the elements of the inverse are</p>

  <div class="image"><img src="../Images/e474_08.png"></div>

  <p>This quantity can be put into several forms involving binomial coefficients, for example</p>

  <div class="image"><img src="../Images/e474_09.png"></div>

  <p><a id="page_475"></a>From the latter formula we see that $b_{ij}$ is not only an integer, it is divisible by $i$, $j$, $n$, $i+j-1$, $i+n-1$, $j+n-1$, $n-i+1$, and $n-j+1$. Perhaps the prettiest formula for $b_{ij}$ is</p>

  <div class="image"><img src="../Images/e475_01.png"></div>

  <p class="indent">The solution to this problem would be extremely difficult if we had not realized that a Hilbert matrix is a special case of a Cauchy matrix; the more general problem is much easier to solve than its special case! It is frequently wise to generalize a problem to its “inductive closure,” i.e., to the smallest generalization such that all subproblems that arise in an attempted proof by mathematical induction belong to the same class. In this case, we see that cofactors of a Cauchy matrix are determinants of Cauchy matrices, but cofactors of Hilbert matrices are not determinants of Hilbert matrices. [For further information, see J. Todd, <em>J. Research Nat. Bur. Stand.</em> <strong>65</strong> (1961), 19–22; A. Cauchy, <em>Exercices d’analyse et de physique mathématique</em> <strong>2</strong> (1841), 151–159.]</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_46" id="ch01ex_2_3_46a">46</a>. For any integers $k_{1},k_{2},\ldots,k_{m}$, let $\epsilon(k_{1},\ldots,k_{m})={\rm sign}{(∏_{1≤i\lt j≤m}(k_{j}-k_{i}))}$, where sign $x=[x\gt 0]-[x\lt 0]$. If $(l_{1},\ldots,l_{m})$ is equal to $(k_{1},\ldots,k_{m})$ except for the fact that $k_{i}$ and $k_{j}$ have been interchanged, we have $\epsilon(l_{1},\ldots,l_{m})=-\epsilon(k_{1},\ldots,k_{m})$. Therefore we have the equation $\det(B_{k_{1}\ldots k_{m}})=\epsilon(k_{1},\ldots,k_{m})\det(B_{j_{1}\ldots j_{m}})$, if $j_{1}≤\cdots≤j_{m}$ are the numbers $k_{1},\ldots,k_{m}$ rearranged into nondecreasing order. Now by definition of the determinant,</p>

  <div class="image"><img src="../Images/e475_02.png"></div>

  <p>Finally, if $j_{i}=j_{i+1}$, $\det(A_{j_{1}\ldots j_{m}})=0$. [<em>J. de l’École Polytechnique</em> <strong>9</strong> (1813), 280–354; <strong>10</strong> (1815), 29–112. Binet and Cauchy presented their papers on the same day in 1812.]</p>

  <p><a href="../Text/ch01.html#ch01ex_2_3_47" id="ch01ex_2_3_47a">47</a>. Let $a_{ij}=(∏_{k=1}^{j-1}(x_{i}+p_{k}))(∏_{k=j+1}^{n}(x_{i}+q_{k}))$. Subtract column <em>k</em> − 1 from column <em>k</em> and factor out $p_{k-j}-q_{k}$, for $k=n,n-1,\ldots,j+1$ (in that order), for $j=1,2,\ldots,n-1$ (in that order). This leaves $∏_{1≤i\lt j≤n}(p_{i}-q_{j})$ times $\det(b_{ij})$ where $b_{ij}=∏_{k=j+1}^{n}(x_{i}+q_{k})$. Now subtract $q_{k+j}$ times column <em>k</em> + 1 from column <em>k</em> for $k=1,\ldots,n-j$, and for $j=1,\ldots,n-1$; this leaves $\det(c_{ij})$, where $c_{ij}=x_{i}^{n-j}$ essentially defines a Vandermonde matrix. We can now proceed as in <a href="../Text/ch01.html#ch01ex_2_3_37">exercise 37</a>, operating on rows instead of columns, obtaining</p>

  <div class="image"><img src="../Images/e475_06.png"></div>

  <p>When $p_{j}=q_{j}=y_{j}$ for $1≤j≤n$, the matrix in this exercise is a Cauchy matrix with row <em>i</em> multiplied by $∏_{j=1}^{n}(x_{i}+y_{j})$. Therefore this result generalizes <a href="../Text/ch01.html#ch01ex_2_3_38">exercise 38</a> by adding $n-2$ independent parameters. [<em>Manuscripta Math.</em> <strong>69</strong> (1990), 177–178.]</p>

  <h4 id="app01lev2sec4"><a id="page_476"></a>Section 1.2.4</h4>

  <p><a href="../Text/ch01.html#ch01ex_2_4_1" id="ch01ex_2_4_1a">1</a>. 1,−2, −1, 0, 5.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_2" id="ch01ex_2_4_2a">2</a>. $\lfloor{x}\rfloor$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_3" id="ch01ex_2_4_3a">3</a>. By definition, $\lfloor{x}\rfloor$ is the greatest integer less than or equal to <em>x</em>; therefore $\lfloor{x}\rfloor$ is an integer, $\lfloor{x}\rfloor≤x$, and $\lfloor{x}\rfloor+1\gt x$. The latter properties, plus the fact that when <em>m</em> and <em>n</em> are integers we have <em>m</em> &lt; <em>n</em> if and only if <em>m</em> ≤ <em>n</em> − 1, lead to an easy proof of propositions (a) and (b). Similar arguments prove (c) and (d). Finally, (e) and (f) are just combinations of previous parts of this exercise.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_4" id="ch01ex_2_4_4a">4</a>. By part (f), $x\le\lceil{x}\rceil\lt x+1$; hence $-x-1\lt\lceil{x}\rceil\le-x$; use part (e).</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_5" id="ch01ex_2_4_5a">5</a>. $\lfloor{x+\frac12}\rfloor$. The value of $(-x\text{ rounded})$ will be the same as $-(x\text{ rounded})$, <em>except</em> when $x\bmod1=\frac12$. In the latter case, the negative value is rounded towards zero and the positive value is rounded away from zero.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_6" id="ch01ex_2_4_6a">6</a>. (a) is true: $\lfloor{\sqrt{x}}\rfloor=n⇔n^{2}≤x\lt(n+1)^{2}⇔$ $n^{2}≤\lfloor{x}\rfloor\lt(n+1)^{2}⇔$ $\lfloor{\sqrt{\lfloor{x}\rfloor}}\rfloor=n$. Similarly, (b) is true. But (c) fails when <em>x</em> is, say, 1.1.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_7" id="ch01ex_2_4_7a">7</a>. $\lfloor{x+y}\rfloor=\lfloor{\lfloor{x}\rfloor+x\bmod 1+\lfloor{y}\rfloor+y\bmod 1}\rfloor=$ $\lfloor{x}\rfloor+\lfloor{y}\rfloor+\lfloor{x\bmod 1+y\bmod 1}\rfloor$. The inequality should be ≥ for ceilings, and then equality holds if and only if either <em>x</em> or <em>y</em> is an integer or $x\bmod 1+y\bmod 1\gt 1$; that is, if and only if $(-x)\bmod1+(-y)\bmod1\lt 1$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_8" id="ch01ex_2_4_8a">8</a>. 1, 2, 5, −100.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_9" id="ch01ex_2_4_9a">9</a>. −1, 0, −2.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_10" id="ch01ex_2_4_10a">10</a>. 0.1, 0.01, −0.09.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_11" id="ch01ex_2_4_11a">11</a>. <em>x</em> = <em>y</em>.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_12" id="ch01ex_2_4_12a">12</a>. All.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_13" id="ch01ex_2_4_13a">13</a>. +1, −1.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_14" id="ch01ex_2_4_14a">14</a>. 8.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_15" id="ch01ex_2_4_15a">15</a>. Multiply both sides of Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec4-1">1</a>) by <em>z</em>; the result is also easily verified if <em>y</em> = 0.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_17" id="ch01ex_2_4_17a">17</a>. As an example, consider the multiplication portion of Law A: We have $a=b+qm$ and $x=y+rm$, for some integers <em>q</em> and <em>r</em>; so $ax=by+(br+yq+qrm)m$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_18" id="ch01ex_2_4_18a">18</a>. We have $a-b=kr$ for some integer <em>k</em>, and also $kr≡\md[0]{s}$. Hence by Law B, $k≡\md[0]{s}$, so $a-b=qsr$ for some integer <em>q</em>.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_20" id="ch01ex_2_4_20a">20</a>. Multiply both sides of the congruence by <em>a</em>′.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_21" id="ch01ex_2_4_21a">21</a>. There is at least one such representation, by the previously proved exercise. If there are two representations, $n=p_{1}\ldots p_{k}=q_{1}\ldots q_{m}$, we have $q_{1}\ldots q_{m}≡\md[0]{p_{1}}$; so if none of the <em>q</em>’s equals $p_{1}$ we could cancel them all by Law B and obtain $1≡\md[0]{p_{1}}$. The latter is impossible since $p_{1}$ is not equal to 1. So some $q_{j}$ equals $p_{1}$, and $n/p_{1}=p_{2}\ldots p_{k}=q_{1}\ldots q_{j-1}q_{j+1}\ldots q_{m}$. Either <em>n</em> is prime, when the result is clearly true, or by induction the two factorizations of $n/p_{1}$ are the same.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_22" id="ch01ex_2_4_22a">22</a>. Let <em>m</em> = <em>ax</em>, where <em>a</em> &gt; 1 and <em>x</em> &gt; 0. Then $ax≡0$ but $x\not\equiv\md[0]{m}$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_24" id="ch01ex_2_4_24a">24</a>. Law A is always valid for addition and subtraction; Law C is always valid.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_26" id="ch01ex_2_4_26a">26</a>. If <em>b</em> is not a multiple of <em>p</em>, then $b^{2}-1$ is, so one of the factors must be.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_27" id="ch01ex_2_4_27a">27</a>. A number is relatively prime to $p^{e}$ if and only if it is not a multiple of <em>p</em>. So we count those that are not multiples of <em>p</em> and get $\varphi(p^{e})=p^{e}-p^{e-1}$.</p>

  <p><a id="page_477"></a><a href="../Text/ch01.html#ch01ex_2_4_28" id="ch01ex_2_4_28a">28</a>. If <em>a</em> and <em>b</em> are relatively prime to <em>m</em>, so is <em>ab</em> mod <em>m</em>, since any prime dividing the latter and <em>m</em> must divide <em>a</em> or <em>b</em> also. Now simply let $x_{1},\ldots,x_{\varphi(m)}$ be the numbers relatively prime to <em>m</em>, and observe that $ax_{1}\bmod m,\ldots,ax_{\varphi(m)}\bmod m$ are the same numbers in some order, etc.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_29" id="ch01ex_2_4_29a">29</a>. We prove (b): If $r⊥ s$ and if $k^{2}$ divides <em>rs</em>, then $p^{2}$ divides <em>rs</em> for some prime <em>p</em>, so <em>p</em> divides <em>r</em> (say) and cannot divide <em>s</em>; so $p^{2}$ divides <em>r</em>. We see that $f(rs)=0$ if and only if $f(r)=0$ or $f(s)=0$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_30" id="ch01ex_2_4_30a">30</a>. Suppose $r⊥s$. One idea is to prove that the $\varphi(rs)$ numbers relatively prime to <em>rs</em> are precisely the $\varphi(r)\varphi(s)$ distinct numbers $(sx_{i}+ry_{j})\bmod(rs)$ where $x_{1},\ldots,x_{\varphi(r)}$ and $y_{1},\ldots,y_{\varphi(s)}$ are the corresponding values for <em>r</em> and <em>s</em>.</p>

  <p class="indent">Since $\varphi$ is multiplicative, $\varphi(10^{6})=\varphi(2^{6})\varphi(5^{6})=(2^{6}-2^{5})(5^{6}-5^{5})=400000$. And in general when $n=p_{1}^{\large e_{1}}\ldots p_{r}^{\large e_{r}}$, we have $\varphi(n)=(p_{1}^{\large e_{1}}-p_{1}^{{\large e_{1}}-1})\ldots(p_{r}^{\large e_{r}}-p_{r}^{{\large e_{r}}-1})=n∏_{p\backslash n,\,p\text{ prime}}(1-1/p)$. (Another proof appears in <a href="../Text/ch01c.html#ch01ex_2_14_27">exercise 1.3.3–27</a>.)</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_31" id="ch01ex_2_4_31a">31</a>. Use the fact that the divisors of <em>rs</em> may be uniquely written in the form <em>cd</em> where <em>c</em> divides <em>r</em> and <em>d</em> divides <em>s</em>. Similarly, if $f(n)≥0$, one can show that the function $\max_{d\backslash n}f(d)$ is multiplicative (see <a href="../Text/ch01.html#ch01ex_2_3_35">exercise 1.2.3–35</a>).</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_33" id="ch01ex_2_4_33a">33</a>. Either $n+m$ or $n-m+1$ is even, so one of the quantities inside the brackets is an integer; so equality holds in <a href="../Text/ch01.html#ch01ex_2_4_7">exercise 7</a>, and we obtain (a) <em>n</em>; (b) <em>n</em> + 1.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_34" id="ch01ex_2_4_34a">34</a>. <em>b</em> must be an integer ≥ 2. (Set $x=b$.) The sufficiency is proved as in <a href="../Text/ch01.html#ch01ex_2_4_6">exercise 6</a>. The same condition is necessary and sufficient for $\lceil{\log_{b}x}\rceil=\lceil{\log_{b}\lceil{x}\rceil}\rceil$.</p>

  <p class="indent"><em>Note:</em> R. J. McEliece has pointed out the following generalization: Let $f$ be a continuous, strictly increasing function defined on an interval <em>A</em>, and assume that both $\lfloor{x}\rfloor$ and $\lceil{x}\rceil$ are in <em>A</em> whenever <em>x</em> is in <em>A</em>. Then the relation $\lfloor{f(x)}\rfloor=\lfloor{f(\lfloor{x}\rfloor)}\rfloor$ holds for all <em>x</em> in <em>A</em> if and only if the relation $\lceil{f(x)}\rceil=\lceil{f(\lceil{x}\rceil)}\rceil$ holds for all <em>x</em> in <em>A</em>, if and only if the following condition is satisfied for all <em>x</em> in <em>A</em>: “$f(x)$ is an integer implies <em>x</em> is an integer.” The condition is obviously necessary, for if $f(x)$ is an integer and it equals $\lfloor{f(\lfloor{x}\rfloor)}\rfloor$ or $\lceil{f(\lceil{x}\rceil)}\rceil$ then <em>x</em> must equal $\lfloor{x}\rfloor$ or $\lceil{x}\rceil$. Conversely if, say, $\lfloor{f(\lfloor{x}\rfloor)}\rfloor\lt\lfloor{f(x)}\rfloor$ then by continuity there is some <em>y</em> with $\lfloor{x}\rfloor\lt y≤x$ for which $f(y)$ is an integer; but <em>y</em> cannot be an integer.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_35" id="ch01ex_2_4_35a">35</a>. $\large\frac{x+m}{n}-1=\frac{x+m}{n}-\frac{1}{n}-\frac{n-1}{n}\lt$ $\frac{\lfloor{x}\rfloor+m}{n}-\frac{n-1}{n}≤\left\lfloor{\frac{\lfloor{x}\rfloor+m}{n}}\right\rfloor≤\frac{x+m}{n}$; apply <a href="../Text/ch01.html#ch01ex_2_4_3">exercise 3</a>. Use of <a href="../Text/ch01.html#ch01ex_2_4_4">exercise 4</a> gives a similar result for the ceiling function. Both identities follow as a special case of McEliece’s theorem in <a href="../Text/ch01.html#ch01ex_2_4_34">exercise 34</a>.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_36" id="ch01ex_2_4_36a">36</a>. Assume first that $n=2t$. Then</p>

  <div class="image"><img src="../Images/e477_04.png"></div>

  <p>hence</p>

  <div class="image"><img src="../Images/e477_05.png"></div>

  <p>by <a href="../Text/ch01.html#ch01ex_2_4_33">exercise 33</a>. And if $n=2t+1$, we have $t^{2}+\lfloor{n/2}\rfloor=t^{2}+t=n^{2}/4-1/4$. For the second sum we get, similarly, $\lceil{n(n+2)/4}\rceil$.</p>

  <p><a id="page_478"></a><a href="../Text/ch01.html#ch01ex_2_4_37" id="ch01ex_2_4_37a">37</a>. $\large\sum\limits_{0≤k\lt n}\frac{mk+x}{n}=\frac{m(n-1)}{2}+x$. Let $\{y\}$ denote $y\bmod1$; we must subtract</p>

  <div class="image"><img src="../Images/e478_02.png"></div>

  <p>This quantity <em>S</em> consists of <em>d</em> copies of the same sum, since if $t=n/d$ we have</p>

  <div class="image"><img src="../Images/e478_03.png"></div>

  <p>Let $u=m/d$; then</p>

  <div class="image"><img src="../Images/e478_04.png"></div>

  <p>and since $t⊥u$ this sum may be rearranged to equal</p>

  <div class="image"><img src="../Images/e478_05.png"></div>

  <p>Finally, since $(x\bmod d)/n\lt 1/t$, the braces in this sum may be removed and we have</p>

  <div class="image"><img src="../Images/e478_06.png"></div>

  <p class="indent">An application of <a href="../Text/ch01.html#ch01ex_2_4_4">exercise 4</a> yields the similar identity</p>

  <div class="image"><img src="../Images/e478_07.png"></div>

  <p>This formula would become symmetric in <em>m</em> and <em>n</em> if it were extended over the range $0\lt k≤n$. (The symmetry can be explained by drawing the graph of the summand as a function of <em>k</em>, then reflecting about the line $y=x$.)</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_38" id="ch01ex_2_4_38a">38</a>. Both sides increase by $\lceil{y}\rceil$  when <em>x</em> increases by 1, so we can assume that $0≤x\lt 1$. Then both sides are zero when $x=0$, and both sides increase by 1 when <em>x</em> increases past the values $1-k/y$ for $y\gt k≥0$. [<em>Crelle</em> <strong>136</strong> (1909), 42; the case $y=n$ is due to C. Hermite, <em>Acta Math.</em> <strong>5</strong> (1884), 315.]</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_39" id="ch01ex_2_4_39a">39</a>. Proof of part (f): Consider the more general identity $∏_{0≤k\lt n}2\sin π(x+k/n)=2\sin πnx$, which can be demonstrated as follows: Since $2\sinθ=(e^{iθ}-e^{-iθ})/i=(1-e^{-2iθ})e^{iθ-iπ/2}$, the identity is a consequence of the two formulas</p>

  <div class="image"><img src="../Images/e478_08.png"></div>

  <p>The latter is true since the function $x-\frac12$ is replicative; and the former is true because we may set $z=1$ in the factorization of the polynomial $z^{n}-α^{n}=(z-α)(z-ωα)\ldots(z-ω^{n-1}α)$, where $ω=e^{-2πi/n}$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_40" id="ch01ex_2_4_40a">40</a>. (Note by N. G. de Bruijn.) If $f$ is replicative, $f(nx+1)-f(nx)=f(x+1)-f(x)$ for all $n\gt 0$. Hence if $f$ is continuous, $f(x+1)-f(x)=c$ for all <em>x</em>, and $g(x)=f(x)-c\lfloor{x}\rfloor$  is replicative and periodic. Now</p>

  <div class="image"><img src="../Images/e478_10.png"></div>

  <p><a id="page_479"></a>expanding in Fourier series shows that $g(x)=(x-\frac12)a$ for $0\lt x\lt 1$. It follows that $f(x)=(x-\frac12)a$. In general, this argument shows that any replicative locally Riemann-integrable function has the form $(x-\frac12)a+b\max(\lfloor{x}\rfloor,0)+c\min(\lfloor{x}\rfloor,0)$ almost everywhere. For further results see L. J. Mordell, <em>J. London Math. Soc.</em> <strong>33</strong> (1958), 371–375; M. F. Yoder, <em>Æquationes Mathematic</em>æ <strong>13</strong> (1975), 251–261.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_41" id="ch01ex_2_4_41a">41</a>. We want $a_{n}=k$ when $\frac{1}{2}k(k-1)\lt n≤\frac{1}{2}k(k+1)$. Since <em>n</em> is an integer, this is equivalent to</p>

  <div class="image"><img src="../Images/e479_05.png"></div>

  <p>i.e., $k-\frac12\lt\sqrt{2n}\lt k+\frac12$. Hence $a_n=\lfloor{\sqrt{2n}+\frac12}\rfloor$, the nearest integer to $\sqrt{2n}$. Other correct answers are $\lceil{\sqrt{2n}-\frac12}\rceil$, $\lceil{(\sqrt{8n+1}-1)/2}\rceil$, $\lfloor{(\sqrt{8n-7}+1)/2}\rfloor$, etc.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_42" id="ch01ex_2_4_42a">42</a>. (a) See <a href="../Text/ch01a.html#ch01ex_2_7_10">exercise 1.2.7–10</a>. (b) The given sum is $n\lfloor{\log_{b}n}\rfloor-S$, where</p>

  <div class="image"><img src="../Images/e479_12.png"></div>

  <p><a href="../Text/ch01.html#ch01ex_2_4_43" id="ch01ex_2_4_43a">43</a>. $\lfloor{\sqrt{n}}\rfloor(n-\frac{1}{6}(2\lfloor{\sqrt{n}}\rfloor+5)(\lfloor{\sqrt{n}}\rfloor-1))$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_44" id="ch01ex_2_4_44a">44</a>. The sum is $n+1$ when <em>n</em> is negative.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_45" id="ch01ex_2_4_45a">45</a>. $\lfloor{mj/n}\rfloor=r$ if and only if $\displaystyle\left\lceil\frac{rn}{m}\right\rceil≤j\lt{\left\lceil{\smash{\frac{(r+1)n}{m}}\vphantom{\frac12}}\right\rceil}$, and we find that the given sum is therefore</p>

  <div class="image"><img src="../Images/e479_15.png"></div>

  <p>The stated result follows by rearranging the latter sum, grouping the terms with a particular value of $\lceil{rn/m}\rceil$. The second formula is immediate by the substitution</p>

  <div class="image"><img src="../Images/e479_16.png"></div>

  <p><a href="../Text/ch01.html#ch01ex_2_4_46" id="ch01ex_2_4_46a">46</a>. $∑_{0≤j\lt αn}f(\lfloor{mj/n}\rfloor)=$ $∑_{0≤r\lt αm}\lceil{rn/m}\rceil(f(r-1)-f(r))+\lceil{αn}\rceil f(\lceil{αm}\rceil-1)$.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_47" id="ch01ex_2_4_47a">47</a>. (a) The numbers $2,4,\ldots,p-1$ are the even residues (modulo <em>p</em>); since $2kq=p\lfloor{2kq/p}\rfloor+(2kq)\bmod p$, the number $(-1)^{\lfloor{2kq/p}\rfloor}((2kq)\bmod p)$ will be an even residue or an even residue minus <em>p</em>, and each even residue clearly occurs just once. Hence $(-1)^{σ}q^{(p-1)/2}2·4\ldots(p-1)≡2·4\ldots(p-1)$.</p>

  <p class="indent">(b) Let $q=2$. If $p=4n+1$, $σ=n$; if $p=4n+3,σ=n+1$. Hence $\left(\frac{2}{p}\right)=(1,-1,-1,1)$ according as $p\bmod 8=(1,3,5,7)$, respectively.</p>

  <p class="indent">(c) For $k\lt p/4$, we have</p>

  <p class="center">$\lfloor{(p-1-2k)q/p}\rfloor=q-\lceil{(2k+1)q/p}\rceil=q-1-\lfloor{(2k+1)q/p}\rfloor≡\md[\lfloor{(2k+1)q/p}\rfloor]{2}$.</p>

  <p>Hence we may replace the last terms $\lfloor{(p-1)q/p}\rfloor,\lfloor{(p-3)q/p}\rfloor,\ldots$ by $\lfloor{q/p}\rfloor,\lfloor{3q/p}\rfloor$, etc. (d) $∑_{0≤k\lt p/2}\lfloor{kq/p}\rfloor+∑_{0≤r\lt q/2}\lceil{rp/q}\rceil=\lceil{p/2}\rceil(\lceil{q/2}\rceil-1)=(p+1)(q-1)/4$. Also $∑_{0≤r\lt q/2}\lceil{rp/q}\rceil=∑_{0≤r\lt q/2}\lfloor{rp/q}\rfloor+(q-1)/2$. The idea of this proof goes back to G. Eisenstein, <em>Crelle</em> <strong>28</strong> (1844), 246–248; Eisenstein also gave several other proofs of this and other reciprocity laws in the same volume.</p>

  <p><a href="../Text/ch01.html#ch01ex_2_4_48" id="ch01ex_2_4_48a">48</a>. (a) This is clearly not always true when $n\lt 0$; when $n\gt 0$ it is easy to verify.</p>

  <p class="indent">(b) $\lfloor{(n+2-\lfloor{n/25}\rfloor)/3}\rfloor=\lceil{(n-\lfloor{n/25}\rfloor)/3}\rceil=$ $\lceil{(n+\lceil{-n/25}\rceil)/3}\rceil=\lceil{\lceil{24n/25}\rceil/3}\rceil=$ $\lceil{8n/25}\rceil=\lfloor{(8n+24)/25}\rfloor$. The penultimate equality is justified by <a href="../Text/ch01.html#ch01ex_2_4_35">exercise 35</a>.</p>

  <p><a id="page_480"></a><a href="../Text/ch01.html#ch01ex_2_4_49" id="ch01ex_2_4_49a">49</a>. Since $f(0)=f(f(0))=f(f(0)+0)=f(0)+f(0)$, we have $f(n)=n$ for all integers <em>n</em>. If ${\large f}{\left(\frac12\right)}=k≤0$, we have $k={\large f}{\left(\frac{1}{1-2k}{\large f}{\left(\frac{1}{2}-k\right)}\right)}={\large f}{\left(\frac{1}{1-2k}\left({\large f}{\left(\frac{1}{2}\right)}-k\right)\right)}=f(0)=0$. And if ${\large f}{\left(\frac{1}{n-1}\right)}=0$ we have ${\large f}{\left(\frac{1}{n}\right)}={\large f}{\left(\frac{1}{n}{\large f}{\left(1+\frac{1}{n-1}\right)}\right)}={\large f}{\left(\frac{1}{n-1}\right)}=0$; furthermore $1≤m\lt n$ implies ${\large f}{\left(\frac{m}{n}\right)}={\large f}{\left(\frac{1}{a}{\large f}{\left(\frac{am}{n}\right)}\right)}={\large f}{\left(\frac{1}{a}\right)}=0$, for $a=\lceil{n/m}\rceil$, by induction on <em>m</em>. Thus ${\large f}{\left(\frac12\right)}≤0$ implies $f(x)=\lfloor{x}\rfloor$ for all rational <em>x</em>. On the other hand, if ${\large f}{\left(\frac12\right)}\gt0$ the function $g(x)=-f(-x)$ satisfies (i) and (ii) and has ${\large g}{\left(\frac12\right)}=1-{\large f}{\left(\frac12\right)}≤0$; hence $f(x)=-g(-x)=-\lfloor{-x}\rfloor=\lceil{x}\rceil$  for all rational <em>x</em>. [P. Eisele and K. P. Hadeler, <em>AMM</em> <strong>97</strong> (1990), 475–477.]</p>

  <p class="indent">It does not follow, however, that $f(x)=\lfloor{x}\rfloor$ or $\lceil{x}\rceil$ for all <em>real</em> values of <em>x</em>. If, for example, $h(x)$ is any function with $h(1)=1$ and $h(x+y)=h(x)+h(y)$ for all real <em>x</em> and <em>y</em>, then the function $f(x)=\lfloor{h(x)}\rfloor$ satisfies (i) and (ii); but $h(x)$ may be unbounded and highly erratic when $0\lt x\lt 1$ [G. Hamel, <em>Math. Annalen</em> <strong>60</strong> (1905), 459–462].</p>

  <h4 id="app01lev2sec5">Section 1.2.5</h4>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_1" id="ch01ex_2_5_1a">1</a>. 52!. For the curious, this number is 806 58175 17094 38785 71660 63685 64037 66975 28950 54408 83277 82400 00000 00000. (!)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_2" id="ch01ex_2_5_2a">2</a>. $p_{nk}=p_{n(k-1)}(n-k+1)$. After the first $n-1$ objects have been placed, there is only one possibility for the last object.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_3" id="ch01ex_2_5_3a">3</a>. 5 3 1 2 4, 3 5 1 2 4, 3 1 5 2 4, 3 1 2 5 4, 3 1 2 4 5; 4 2 3 5 1, 4 1 3 5 2, 4 1 2 5 3, 3 1 2 5 4, 3 1 2 4 5.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_4" id="ch01ex_2_5_4a">4</a>. There are 2568 digits. The leading digit is 4 (since $\log_{10}4=2\log_{10}2 ≈ .602$). The least significant digit is zero, and in fact by Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-8">8</a>) the low order 249 digits are all zero. The exact value of 1000! was calculated by H. S. Uhler using a desk calculator and much patience over a period of several years, and appears in <em>Scripta Mathematica</em> <strong>21</strong> (1955), 266–267. It begins with 402 38726 00770 … . (The last step in the calculation, to multiply the two numbers 750! and $\prod_{k=751}^{1000}k$, was performed on UNIVAC I by John W. Wrench, Jr., “in the extraordinary time of 2½ minutes.” Nowadays, of course, a desktop machine easily produces 1000! in a fraction of a second, and we can confirm that Uhler’s value was 100% correct.)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_5" id="ch01ex_2_5_5a">5</a>. $(39902)(97/96)≈416+39902=40318$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_6" id="ch01ex_2_5_6a">6</a>. $2^{18}·3^{8}·5^{4}·7^{2}·11·13·17·19$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_8" id="ch01ex_2_5_8a">8</a>. It is $\lim_{m→∞}m^{n}m!/((n+m)!/n!)=n!\lim_{m→∞}m^{n}/((m+1)\ldots(m+n))=n!$, since $m/(m+k)→1$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_9" id="ch01ex_2_5_9a">9</a>. $\sqrt{\pi}$ and $-2\sqrt{\pi}$. (<a href="../Text/ch01a.html#ch01ex_2_5_10">Exercise 10</a> used.)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_10" id="ch01ex_2_5_10a">10</a>. Yes, except when <em>x</em> is zero or a negative integer. For we have</p>

  <div class="image"><img src="../Images/e480_11.png"></div>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_11" id="ch01ex_2_5_11a">11</a>, <a href="../Text/ch01a.html#ch01ex_2_5_12" id="ch01ex_2_5_12a">12</a>. <span class="top"><img src="../Images/e480_12.png"></span></p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_13" id="ch01ex_2_5_13a">13</a>. For each <em>n</em>, $1≤n\lt p$, determine $n'$ as in <a href="../Text/ch01.html#ch01ex_2_4_19">exercise 1.2.4–19</a>. There is exactly one such $n'$, by Law 1.2.4B; and $(n')'=n$. Therefore we can pair off the numbers in groups of two, provided that $n'≠n$. If $n'=n$, we have $n^{2}≡\md[1]{p}$; hence, as in <a href="../Text/ch01.html#ch01ex_2_4_26">exercise 1.2.4–26</a>, $n=1$ or $n=p-1$. So $(p-1)!≡ 1·1\ldots1·(-1)$, since 1 and $p-1$ are the only unpaired elements.</p>

  <p><a id="page_481"></a><a href="../Text/ch01a.html#ch01ex_2_5_14" id="ch01ex_2_5_14a">14</a>. Among the numbers $\{1,2,\ldots,n\}$ that are <em>not</em> multiples of <em>p</em>, there are $\lfloor{n/p}\rfloor$ complete sets of $p-1$ consecutive elements, each with a product congruent to $\md[-1]{p}$ by Wilson’s theorem. There are also $a_{0}$ left over, which are congruent to $\md[a_{0}!]{p}$; so the contribution from the factors that are not multiples of <em>p</em> is $(-1)^{\lfloor{n/p}\rfloor}a_{0}!$. The contribution from the factors that <em>are</em> multiples of <em>p</em> is the same as the contribution in $\lfloor{n/p}\rfloor !$; this argument can therefore be repeated to get the desired formula.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_15" id="ch01ex_2_5_15a">15</a>. $(n!)^{3}$. There are $n!$ terms. Each term has one entry from each row and each column, so it has the value $(n!)^{2}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_16" id="ch01ex_2_5_16a">16</a>. The terms do not approach zero, since the coefficients approach $1/e$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_17" id="ch01ex_2_5_17a">17</a>. Express the gamma functions as limits by Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-15">15</a>).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_18" id="ch01ex_2_5_18a">18</a>. $\displaystyle\prod_{n≥1}\frac{n}{n-\frac12}\frac{n}{n+\frac12}=\frac{\varGamma(\frac12)\varGamma(\frac32)}{\varGamma(1)\varGamma(1)}=2\varGamma(\frac32)^{2}$.</p>

  <p>[Wallis’s own heuristic “proof” can be found in D. J. Struik’s <em>Source Book in Mathematics</em> (Harvard University Press, 1969), 244–253.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_19" id="ch01ex_2_5_19a">19</a>. Change of variable $t=mt$, integration by parts, and induction.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_20" id="ch01ex_2_5_20a">20</a>. [For completeness, we prove the stated inequality. Start with the easily verified inequality $1+x≤e^{x}$; set $x=±t/n$ and raise to the <em>n</em>th power to get $(1±t/n)^{n}≤e^{±t}$. Hence $e^{-t}≥(1-t/n)^{n}=e^{-t}(1-t/n)^{n}e^{t}≥$ $e^{-t}(1-t/n)^{n}(1+t/n)^{n}=$ $e^{-t}(1-t^{2}/n^{2})^{n}≥e^{-t}(1-t^{2}/n)$ by <a href="../Text/ch01.html#ch01ex_2_1_09">exercise 1.2.1–9</a>.]</p>

  <p class="indent">Now the given integral minus $\varGamma_{m}(x)$ is</p>

  <div class="image"><img src="../Images/e481_02.png"></div>

  <p>As $m→∞$, the first of these integrals approaches zero, since $t^{x-1}\lt e^{t/2}$ for large <em>t</em>; and the second is less than</p>

  <div class="image"><img src="../Images/e481_03.png"></div>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_21" id="ch01ex_2_5_21a">21</a>. If $c(n,j,k_{1},k_{2},\ldots)$ denotes the appropriate coefficient, we find</p>

  <p class="center">$c(n+1,j,k_{1},\ldots)=c(n,j-1,k_{1}-1,k_{2},\ldots)+$ $(k_{1}+1)c(n,j,k_{1}+1,k_{2}-1,k_{3},\ldots)+$ $(k_{2}+1)c(n,j,k_{1},k_{2}+1,k_{3}-1,k_{4},\ldots)+\cdots$,</p>

  <p>by differentiation. The equations $k_{1}+k_{2}+\cdots= j$ and $k_{1}+2k_{2}+\cdots= n$ are preserved in this induction relationship. We can easily factor $n!/(k_{1}!(1!)^{k_{1}}k_{2}!(2!)^{k_{2}}\ldots)$ out of each term appearing on the right-hand side of the equation for $c(n+1,j,k_{1},\ldots)$, and we are left with $k_{1}+2k_{2}+3k_{3}+\cdots= n+1$. (In the proof it is convenient to assume that there are infinitely many <em>k</em>’s, although clearly $k_{n+1}=k_{n+2}=\cdots=0$.)</p>

  <p class="indent">The solution just given makes use of standard techniques, but it doesn’t give a satisfactory explanation of <em>why</em> the formula has this form, nor how it could have been discovered in the first place. Let us examine this question using a combinatorial argument suggested by H. S. Wall [<em>Bull. Amer. Math. Soc.</em> <strong>44</strong> (1938), 395–398]. Write for convenience $w_j=D_{u}^{j}w$, $u_k=D_{x}^{k}u$. Then $D_{x}(w_{j})=w_{j+1}u_{1}$ and $D_{x}(u_{k})=u_{k+1}$.</p>

  <p><a id="page_482"></a>By these two rules and the rule for derivative of a product we find</p>

  <div class="image"><img src="../Images/e482_01.png"></div>

  <p>Analogously we may set up a corresponding tableau of set partitions thus:</p>

  <div class="image"><img src="../Images/e482_02.png"></div>

  <p>Formally, if $a_{1}a_{2}\ldots a_{j}$ is a partition of the set $\{1,2,\ldots,n-1\}$, define</p>

  <p class="center">${\cal D}a_{1}a_{2}\ldots a_{j}=\{n\}a_{1}a_{2}\ldots a_{j}+(a_{1}∪\{n\})a_{2}\ldots a_{j}+$ $a_{1}(a_{2}∪\{n\})\ldots a_{j}+\cdots+a_{1}a_{2}\ldots(a_{j}∪\{n\})$.</p>

  <p>This rule is an exact parallel of the rule</p>

  <p class="center">$D_{x}(w_{j}u_{r_{1}}u_{r_{2}}\ldots u_{r_{j}})=w_{j+1}u_{1}u_{r_{1}}u_{r_{2}}\ldots u_{r_{j}}+$ $w_{j}u_{r_{1}+1}u_{r_{2}}\ldots u_{r_{j}}+$ $w_{j}u_{r_{1}}u_{r_{2}+1}\ldots u_{r_{j}}+\cdots+w_{j}u_{r_{1}}u_{r_{2}}\ldots u_{r_{j}+1}$,</p>

  <p>if we let the term $w_{j}u_{r_{1}}u_{r_{2}}\ldots u_{r_{j}}$ correspond to a partition $a_{1}a_{2}\ldots a_{j}$ with $r_{t}$ elements in $a_{t}$, $1≤t≤j$. So there is a natural mapping from ${\cal D}^{n}$ onto $D_{x}^{n}w$, and furthermore it is easy to see that ${\cal D}^{n}$ includes each partition of the set $\{1,2,\ldots,n\}$ exactly once. (See <a href="../Text/ch01a.html#ch01ex_2_6_64">exercise 1.2.6–64</a>.)</p>

  <p class="indent">From these observations we find that if we collect like terms in $D_{x}^{n}w$, we obtain a sum of terms $c(k_{1},k_{2},\ldots)w_{j}u_{1}^{k_1}u_{2}^{k_2}\ldots$, where $j=k_{1}+k_{2}+\cdots$ and $n=k_{1}+2k_{2}+\cdots$, and where $c(k_{1},k_{2},\ldots)$ is <em>the number of partitions of $\{1,2,\ldots,n\}$ into j subsets such that there are $k_{t}$ subsets having t elements</em>.</p>

  <p class="indent">It remains to count these partitions. Consider an array of $k_{t}$ boxes of capacity <em>t</em>:</p>

  <div class="image"><img src="../Images/e482_06.png"></div>

  <p>The number of ways to put <em>n</em> different elements into these boxes is the multinomial coefficient</p>

  <div class="image"><img src="../Images/e482_07.png"></div>

  <p>To get $c(k_{1},k_{2},k_{3},\ldots)$ we should divide this by $k_{1}!\,k_{2}!\,k_{3}!\ldots$, since the boxes in each group of $k_{t}$ are indistinguishable from each other; they may be permuted in $k_{t}!$ ways without affecting the set partition.</p>

  <p class="indent">Arbogast’s original proof [<em>Du Calcul des Dérivations</em> (Strasbourg: 1800), §52] was based on the fact that $D_{x}^{k}u/k!$ is the coefficient of $z^{k}$ in $u(x+z)$ and $D_{u}^{j}w/j!$ is the <a id="page_483"></a>coefficient of $y^{j}$ in $w(u+y)$, hence the coefficient of $z^{n}$ in $w(u(x+z))$ is</p>

  <div class="image"><img src="../Images/e483_01.png"></div>

  <p>His formula was forgotten for many years, then rediscovered independently by F. Faà di Bruno [<em>Quarterly J. Math.</em> <strong>1</strong> (1857), 359–360], who observed that it can also be expressed as a determinant</p>

  <div class="image"><img src="../Images/e483_02.png"></div>

  <p>where $u_j=(D_{x}^{j}u)D_{u}$; both sides of this equation are differential operators to be applied to <em>w</em>. For a generalization of Arbogast’s formula to functions of several variables, and a list of references to other related work, see the paper by I. J. Good, <em>Annals of Mathematical Statistics</em> <strong>32</strong> (1961), 540–541.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_22" id="ch01ex_2_5_22a">22</a>. The hypothesis that $\lim_{n→∞}(n+x)!/(n!\,n^{x})=1$ is valid for integers <em>x</em>; for example, if <em>x</em> is positive, the quantity is $(1+1/n)(1+2/n)\ldots(1+x/n)$, which certainly approaches unity. If we also assume that $x!=x(x-1)!$, the hypothesis leads us to conclude immediately that</p>

  <div class="image"><img src="../Images/e483_04.png"></div>

  <p>which is equivalent to the definition given in the text.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_23" id="ch01ex_2_5_23a">23</a>. $z(-z)!\,\varGamma(z)=\lim_{m→∞}\prod_{n=1}^{m}(1-z/n)^{-1}(1+z/n)^{-1}$ by (<a href="../Text/ch01.html#ch01eq-lev2sec5-13">13</a>) and (<a href="../Text/ch01.html#ch01eq-lev2sec5-15">15</a>).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_24" id="ch01ex_2_5_24a">24</a>. $n^{n}/n!=\prod_{k=1}^{n-1}(k+1)^{k}/k^{k}\le\prod_{k=1}^{n-1}e$; $n!/n^{n+1}=\prod_{k=1}^{n-1}k^{k+1}/(k+1)^{k+1}\le\prod_{k=1}^{n-1}e^{-1}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_5_25" id="ch01ex_2_5_25a">25</a>. $x^{\underline{m+n}}=x^{\underline m}(x-m)^{\underline n}$; $x^{\overline{m+n}}=x^{\overline m}(x+m)^{\overline n}$. These laws hold also when <em>m</em> and <em>n</em> are nonintegers, by (<a href="../Text/ch01.html#ch01eq-lev2sec5-21">21</a>).</p>

  <h4 id="app01lev2sec6">Section 1.2.6</h4>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_1" id="ch01ex_2_6_1a">1</a>. <em>n</em>, since each combination leaves out one item.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_2" id="ch01ex_2_6_2a">2</a>. 1. There’s exactly one way to choose nothing from the empty set.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_3" id="ch01ex_2_6_3a">3</a>. $\mybinomf{52}{13}$. The actual number is 635013559600.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_4" id="ch01ex_2_6_4a">4</a>. $2^{4}·5^{2}·7^{2}·17·23·41·43·47$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_5" id="ch01ex_2_6_5a">5</a>. $(10+1)^{4}=10000+4(1000)+6(100)+4(10)+1$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_6" id="ch01ex_2_6_6a">6</a>. <span class="top"><img src="../Images/e483_09.png"></span></p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_7" id="ch01ex_2_6_7a">7</a>. $\lfloor{n/2}\rfloor$; or, alternatively, $\lceil{n/2}\rceil$. It is clear from (<a href="../Text/ch02a.html#ch02eq-lev2sec6-3">3</a>) that for smaller values the binomial coefficient is strictly increasing, and afterwards it decreases to zero.</p>

  <p><a id="page_484"></a><a href="../Text/ch01a.html#ch01ex_2_6_8" id="ch01ex_2_6_8a">8</a>. The nonzero entries in each row are the same from left to right as from right to left.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_9" id="ch01ex_2_6_9a">9</a>. One if <em>n</em> is positive or zero; zero if <em>n</em> is negative.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_10" id="ch01ex_2_6_10a">10</a>. (a), (b) and (f) follow immediately from (e); (c) and (d) follow from (a), (b), and Eq. (<a href="../Text/ch02a.html#ch02eq-lev2sec6-9">9</a>). Thus it suffices to prove (e). Consider $\mybinomf{n}{k}$ as a fraction, given by Eq. (<a href="../Text/ch02a.html#ch02eq-lev2sec6-3">3</a>) with factors in numerator and denominator. The first $k\bmod p$ factors have no <em>p</em>’s in the denominator, and in the numerator and denominator these terms are clearly congruent to the corresponding terms of</p>

  <div class="image"><img src="../Images/e484_01.png"></div>

  <p>which differ by multiples of <em>p</em>. (When dealing with non-multiples of <em>p</em> we may work modulo <em>p</em> in both numerator and denominator, since if $a≡c$ and $b≡d$ and $a/b$, $c/d$ are integers, then $a/b≡c/d$.) There remain $k-k\bmod p$ factors, which fall into $\lfloor{k/p}\rfloor$ groups of <em>p</em> consecutive values each. Each group contains exactly one multiple of <em>p</em>; the other $p-1$ factors in a group are congruent $(\text{modulo }p)$ to $(p-1)!$ so they cancel in numerator and denominator. It remains to investigate the $\lfloor{k/p}\rfloor$ multiples of <em>p</em> in numerator and denominator; we divide each of them by <em>p</em> and are left with the binomial coefficient</p>

  <div class="image"><img src="../Images/e484_02.png"></div>

  <p>If $k\bmod p≤n\bmod p$, this equals</p>

  <div class="image"><img src="../Images/e484_03.png"></div>

  <p>as desired; and if $k\bmod p\gt n\bmod p$, the other factor $\mybinomf{n\bmod p}{k\bmod p}$ is zero, so the formula holds in general. [<em>American J. Math.</em> <strong>1</strong> (1878), 229–230; see also L. E. Dickson, <em>Quart. J. Math.</em> <strong>33</strong> (1902), 383–384; N. J. Fine, <em>AMM</em> <strong>54</strong> (1947), 589–592.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_11" id="ch01ex_2_6_11a">11</a>. If $a=a_{r}p^{r}+\cdots+a_{0}$, $b=b_{r}p^{r}+\cdots+b_{0}$, and $a+b=c_{r}p^{r}+\cdots+c_{0}$, the value of <em>n</em> (according to <a href="../Text/ch01a.html#ch01ex_2_5_12">exercise 1.2.5–12</a> and Eq. (<a href="../Text/ch02a.html#ch02eq-lev2sec6-5">5</a>)) is</p>

  <p class="center">$(a_{0}+\cdots+a_{r}+b_{0}+\cdots+b_{r}-c_{0}-\cdots-c_{r})/(p-1)$.</p>

  <p>A carry decreases $c_{j}$ by <em>p</em> and increases $c_{j+1}$ by 1, giving a net change of +1 in this formula. [Similar results hold for <em>q</em>-nomial and Fibonomial coefficients; see Knuth and Wilf, <em>Crelle</em> <strong>396</strong> (1989), 212–219.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_12" id="ch01ex_2_6_12a">12</a>. By either of the two previous exercises, <em>n</em> must be one less than a power of 2. More generally, $\mybinomf{n}{k}$ is never divisible by the prime <em>p</em>, $0≤k≤n$, if and only if $n=ap^{m}-1$, $1≤a\lt p$, $m≥0$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_14" id="ch01ex_2_6_14a">14</a>. $24\mybinomf{n+1}{5}+36\mybinomf{n+1}{4}+14\mybinomf{n+1}{3}+\mybinomf{n+1}{2}=$ $\frac{n^{5}}{5}+\frac{n^{4}}{2}+\frac{n^{3}}{3}-\frac{n}{30}=$ $\frac{n(n+1)(n+\frac12)(3n^{2}+3n-1)}{15}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_15" id="ch01ex_2_6_15a">15</a>. Induction and (<a href="../Text/ch02a.html#ch02eq-lev2sec6-9">9</a>).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_17" id="ch01ex_2_6_17a">17</a>. We may assume that <em>r</em> and <em>s</em> are positive integers. Also</p>

  <div class="image"><img src="../Images/e484_06.png"></div>

  <p>for all <em>x</em>, so the coefficients of $x^{n}$ must be identical.</p>

  <p><a id="page_485"></a><a href="../Text/ch01a.html#ch01ex_2_6_21" id="ch01ex_2_6_21a">21</a>. The left-hand side is a polynomial of degree ≤ <em>n</em>; the right-hand side is a polynomial of degree $m+n+1$. The polynomials agree at $n+1$ points, but that isn’t enough to prove them equal. [In fact, the correct formula in general is</p>

  <div class="image"><img src="../Images/e485_01.png"></div>

  <p>when <em>m</em>, <em>n</em>, and <em>r</em> are nonnegative integers.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_22" id="ch01ex_2_6_22a">22</a>. Assume that $n\gt 0$. The <em>k</em>th term is $r/(r-tk)$ times</p>

  <div class="image"><img src="../Images/e485_02.png"></div>

  <p>and the two products give a polynomial of degree $n-1$ in <em>k</em> after division by $r-tk$. So the sum over <em>k</em> is zero by Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-34">34</a>).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_24" id="ch01ex_2_6_24a">24</a>. The proof is by induction on <em>n</em>. If <em>n</em> ≤ 0 the identity is obvious. If <em>n</em> &gt; 0, we prove it holds for $(r,n-r+nt+m,t,n)$, by induction on the integer <em>m</em> ≥ 0, using the previous two exercises and the validity for <em>n</em> − 1. This establishes the identity $(r,s,t,n)$ for infinitely many <em>s</em>, and it holds for all <em>s</em> since both sides are polynomials in <em>s</em>.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_25" id="ch01ex_2_6_25a">25</a>. Using the ratio test and straightforward estimates for large values of <em>k</em> we can prove convergence. When <em>w</em> is sufficiently small, we have</p>

  <div class="image"><img src="../Images/e485_03.png"></div>

  <p>Now let $x=1/(1+w)$, $z=-w/(1+w)^{1+t}$. This proof is due to H. W. Gould [<em>AMM</em> <strong>63</strong> (1956), 84–91]. See also the more general formulas in <a href="../Text/ch02b.html#ch02ex_3_4_33">exercises 2.3.4.4–33</a> and 4.7–22.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_26" id="ch01ex_2_6_26a">26</a>. We could start with identity (<a href="../Text/ch01a.html#ch01eq-lev2sec6-35">35</a>) in the form</p>

  <div class="image"><img src="../Images/e485_04.png"></div>

  <p>and proceed as in <a href="../Text/ch01a.html#ch01ex_2_6_25">exercise 25</a>. Another way is to differentiate the formula of that exercise with respect to <em>z</em>; we get</p>

  <div class="image"><img src="../Images/e485_05.png"></div>

  <p>hence we can obtain the value of</p>

  <div class="image"><img src="../Images/e485_06.png"></div>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_27" id="ch01ex_2_6_27a">27</a>. For Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>), multiply the series for $x^{r+1}/((t+1)x-t)$ by the series for $x^{s}$, and get a series for $x^{r+s+1}/((t+1)x-t)$ in which coefficients of <em>z</em> may be equated to the coefficients arising from the series for $x^{(r+s)+1}/((t+1)x-t)$.</p>

  <p><a id="page_486"></a><a href="../Text/ch01a.html#ch01ex_2_6_28" id="ch01ex_2_6_28a">28</a>. Denoting the left-hand side by $f(r,s,t,n)$, we find</p>

  <div class="image"><img src="../Images/e486_01.png"></div>

  <p>by considering the identity</p>

  <div class="image"><img src="../Images/e486_02.png"></div>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_29" id="ch01ex_2_6_29a">29</a>. $\displaystyle\left.{(-1)^{k}\binom{n}{k}}\middle/{n!}=(-1)^{k}/(k!\,(n-k)!)={(-1)^{n}}\middle/\right.{\prod_{\begin{myarray2}{0\le j\le n\\j\ne k}\end{myarray2}}}(k-j)$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_30" id="ch01ex_2_6_30a">30</a>. Apply (<a href="../Text/ch02a.html#ch02eq-lev2sec6-7">7</a>), (<a href="../Text/ch02a.html#ch02eq-lev2sec6-6">6</a>), and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-19">19</a>) to get</p>

  <div class="image"><img src="../Images/e486_04.png"></div>

  <p>Now we can apply Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>) with $(r,s,t,n)=(1,m-2n-1,-2,n-m)$, obtaining</p>

  <div class="image"><img src="../Images/e486_05.png"></div>

  <p>This result is the same as our previous formula, when <em>n</em> is positive, but when <em>n</em> = 0 the answer we have obtained is correct while $\mybinomf{n-1}{m-1}$ is not. Our derivation has a further bonus, since the answer $\mybinomf{n-1}{n-m}$ is valid for <em>n</em> ≥ 0 and <em>all</em> integers <em>m</em>.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_31" id="ch01ex_2_6_31a">31</a>. [This sum was first obtained in closed form by J. F. Pfaff, <em>Nova Acta Acad. Scient. Petr.</em> <strong>11</strong> (1797), 38–57.] We have</p>

  <div class="image"><img src="../Images/e486_08.png"></div>

  <p>Changing $\mybinomf{m+n-j}{n-j}$ to $\mybinomf{m+n-j}{m}$ and applying (<a href="../Text/ch01a.html#ch01eq-lev2sec6-20">20</a>) again, we get</p>

  <div class="image"><img src="../Images/e486_11.png"></div>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_32" id="ch01ex_2_6_32a">32</a>. Replace <em>x</em> by <em>−x</em> in (<a href="../Text/ch01a.html#ch01eq-lev2sec6-44">44</a>).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_33" id="ch01ex_2_6_33a">33</a>, <a href="../Text/ch01a.html#ch01ex_2_6_34" id="ch01ex_2_6_34a">34</a>. [<em>Mém. Acad. Roy. Sci.</em> (Paris, 1772), part 1, 492; C. Kramp, <em>Élémens d’Arithmétique Universelle</em> (Cologne: 1808), 359; <em>Giornale di Mat. Battaglini</em> <strong>33</strong> (1895), 179–182.] Since $x^{\overline n}=n!\,\mybinomf{x+n-1}{n}$, the equation may be transformed into</p>

  <div class="image"><img src="../Images/e486_13.png"></div>

  <p>which is a case of (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>). Similarly, $(x+y)^{\underline n}=\sum_{k}\mybinomf{n}{k}x(x-kz-1)^{\underline{k-1}}(y+kz)^{\underline{n-k}}$, an equivalent formula of Rothe [<em>Formulæ de Serierum Reversione</em> (Leipzig: 1793), 18].</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_35" id="ch01ex_2_6_35a">35</a>. For example, we prove the first formula:</p>

  <div class="image"><img src="../Images/e486_15.png"></div>

  <p><a id="page_487"></a><a href="../Text/ch01a.html#ch01ex_2_6_36" id="ch01ex_2_6_36a">36</a>. By (<a href="../Text/ch01a.html#ch01eq-lev2sec6-13">13</a>), assuming that <em>n</em> is a nonnegative integer, we get $2^{n}$ and $δ_{n0}$, respectively.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_37" id="ch01ex_2_6_37a">37</a>. When $n\gt 0$, $2^{n-1}$. (The odd and even terms cancel, so each equals half the total sum.)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_38" id="ch01ex_2_6_38a">38</a>. Let $ω=e^{2πi/m}$. Then</p>

  <div class="image"><img src="../Images/e487_01.png"></div>

  <p>Now</p>

  <div class="image"><img src="../Images/e487_02.png"></div>

  <p>(it is the sum of a geometric progression), so the right-hand sum is $\displaystyle m\sum_{t\bmod m=k}\binom{n}{t}$.</p>

  <p>The original sum on the left is</p>

  <div class="image"><img src="../Images/e487_04.png"></div>

  <p>Since the quantity is known to be real, we may take the real part and obtain the stated formula. [See <em>Crelle</em> <strong>11</strong> (1834), 353–355.]</p>

  <p class="indent">The cases <em>m</em> = 3 and <em>m</em> = 5 have special properties discussed in <em>CMath</em>, exercises 5.75 and 6.57.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_39" id="ch01ex_2_6_39a">39</a>. $n!$; $δ_{n0}-δ_{n1}$. (The row sums in the second triangle are not so simple; we will find (<a href="../Text/ch01a.html#ch01ex_2_6_64">exercise 64</a>) that $\sum_{k}{n\brace k}$ is the number of ways to partition a set of <em>n</em> elements into disjoint sets, which is the number of equivalence relations on $\{1,2,\ldots,n\}$.)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_40" id="ch01ex_2_6_40a">40</a>. Proof of (c): By parts,</p>

  <div class="image"><img src="../Images/e487_06.png"></div>

  <p>Now use (b).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_41" id="ch01ex_2_6_41a">41</a>. $m^{x}{\rm B}(x,m+1)→\varGamma(x)$ as $m→∞$, regardless of whether <em>m</em> runs through integer values or not (by monotonicity). Hence, $(m+y)^{x}{\rm B}(x,m+y+1)→\varGamma(x)$, and $(m/(m+y))^{x}→1$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_42" id="ch01ex_2_6_42a">42</a>. $1/((r+1){\rm B}(k+1,r-k+1))$, if this is defined according to <a href="../Text/ch01a.html#ch01ex_2_6_41">exercise 41</a>(b). In general when <em>z</em> and <em>w</em> are arbitrary complex numbers we define</p>

  <div class="image"><img src="../Images/e487_07.png"></div>

  <p>the value is infinite when <em>z</em> is a negative integer and <em>w</em> is not an integer.</p>

  <p class="indent">With this definition, the symmetry condition (<a href="../Text/ch01a.html#ch01eq-lev2sec6-6">6</a>) holds for all complex <em>n</em> and <em>k</em>, except when <em>n</em> is a negative integer and <em>k</em> is an integer; Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-7">7</a>), (<a href="../Text/ch01a.html#ch01eq-lev2sec6-9">9</a>), and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-20">20</a>) are never false, although they may occasionally take indeterminate forms such as $0·∞$ or $∞+∞$. Equation (<a href="../Text/ch01a.html#ch01eq-lev2sec6-17">17</a>) becomes</p>

  <div class="image"><img src="../Images/e487_08.png"></div>

  <p>We can even extend the binomial theorem (<a href="../Text/ch01a.html#ch01eq-lev2sec6-13">13</a>) and Vandermonde’s convolution (<a href="../Text/ch01a.html#ch01eq-lev2sec6-21">21</a>), obtaining $\sum_{k}\mybinomf{r}{\alpha+k}z^{\alpha+k}=(1+z)^{r}$ and $\sum_{k}\mybinomf{r}{\alpha+k}\mybinomf{s}{\beta-k}=\mybinomf{r+s}{\alpha+\beta}$; these formulas hold for all complex <em>r</em>, <em>s</em>, <em>z</em>, <em>α</em>, and <em>β</em> whenever the series converge, provided that complex powers are suitably defined. [See L. Ramshaw, <em>Inf. Proc. Letters</em> <strong>6</strong> (1977), 223–226.]</p>

  <p><a id="page_488"></a><a href="../Text/ch01a.html#ch01ex_2_6_43" id="ch01ex_2_6_43a">43</a>. $\int_{0}^{1}dt/(t^{1/2}(1-t)^{1/2})=2\int_{0}^{1}du/(1-u^{2})^{1/2}=$ $2\arcsin u{\atopwithdelims.|}_0^1=\pi$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_45" id="ch01ex_2_6_45a">45</a>. For large <em>r</em>, $\displaystyle\frac{1}{k\varGamma(k)}\sqrt{\frac{r}{r-k}}\frac{1}{e^k}\frac{(1-k/r)^k}{(1-k/r)^r}\to\frac{1}{\varGamma(k+1)}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_46" id="ch01ex_2_6_46a">46</a>. $\displaystyle\sqrt{\frac{1}{2\pi}\left(\frac{1}{x}+\frac{1}{y}\right)}\left(1+\frac{y}{x}\right)^{x}\left(1+\frac{x}{y}\right)^{y}$, and $\displaystyle\binom{2n}{n}\approx4^{n}/\sqrt{\pi n}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_47" id="ch01ex_2_6_47a">47</a>. Each quantity is $δ_{k0}$ when $k≤0$, and is multiplied by $(r-k)(r-\frac12-k)/(k+1)^2$ when <em>k</em> is replaced by $k+1$. When $r=-\frac12$ this implies $\mybinomf{-1/2}{k}=(-1/4)^{k}\mybinomf{2k}{k}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_48" id="ch01ex_2_6_48a">48</a>. This can be proved by induction, using the fact that</p>

  <div class="image"><img src="../Images/e488_08.png"></div>

  <p>when $n\gt 0$. Alternatively, we have</p>

  <div class="image"><img src="../Images/e488_09.png"></div>

  <p>(In fact, the stated sum equals ${\rm B}(x,n+1)$ for noninteger <em>n</em> also, when the series converges.)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_49" id="ch01ex_2_6_49a">49</a>. $\displaystyle\binom{r}{m}=\sum_{k}{\binom{r}{k}}{\binom{-r}{m-2k}}(-1)^{m+k}$, integer <em>m</em>. (See <a href="../Text/ch01a.html#ch01ex_2_6_17">exercise 17</a>.)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_50" id="ch01ex_2_6_50a">50</a>. The <em>k</em>th summand is $\mybinomf{n}{k}(-1)^{n-k}(x-kz)^{n-1}x$. Apply Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-34">34</a>).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_51" id="ch01ex_2_6_51a">51</a>. The right-hand side is</p>

  <div class="image"><img src="../Images/e488_12.png"></div>

  <p>The same device may be used to prove Torelli’s sum (<a href="../Text/ch01a.html#ch01ex_2_6_34">exercise 34</a>).</p>

  <p class="indent">Another neat proof of Abel’s formula comes from the fact that it is readily transformed into the more symmetric identity derived in <a href="../Text/ch02b.html#ch02ex_3_4_29">exercise 2.3.4.4–29</a>:</p>

  <div class="image"><img src="../Images/e488_13.png"></div>

  <p class="indent">Abel’s theorem has been generalized even further by A. Hurwitz [<em>Acta Mathematica</em> <strong>26</strong> (1902), 199–203] as follows:</p>

  <div class="image"><img src="../Images/e488_14.png"></div>

  <p>where the sum is over all $2^{n}$ choices of $\epsilon_{1},\ldots,\epsilon_{n}=\rm0\;or\;1$ independently. This is an identity in $x,y,z_{1},\ldots,z_{n}$, and Abel’s formula is the special case $z_{1}=z_{2}=\cdots=z_{n}$. Hurwitz’s formula follows from the result in <a href="../Text/ch02b.html#ch02ex_3_4_30">exercise 2.3.4.4–30</a>.</p>

  <p><a id="page_489"></a><a href="../Text/ch01a.html#ch01ex_2_6_52" id="ch01ex_2_6_52a">52</a>. $∑_{k≥0}(k+1)^{-2}=π^{2}/6$. [M. L. J. Hautus observes that the sum is absolutely convergent for all complex <em>x</em>, <em>y</em>, <em>z</em>, <em>n</em> whenever $z≠0$, since the terms for large <em>k</em> are always of order $1/k^{2}$. This convergence is uniform in bounded regions, so we may differentiate the series term by term. If $f(x,y,n)$ is the value of the sum when $z=1$, we find $(∂/∂y)f(x,y,n)=nf(x,y,n-1)$ and $(∂/∂x)f(x,y,n)=nf(x-1,y+1,n-1)$. These formulas are consistent with $f(x,y,n)=(x+y)^{n}$; but actually the latter equality seems to hold rarely, if ever, unless the sum is finite. Furthermore the derivative with respect to <em>z</em> is almost always nonzero.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_53" id="ch01ex_2_6_53a">53</a>. For (b), set $r=\frac12$ and $s=-\frac12$ in the result of (a).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_54" id="ch01ex_2_6_54a">54</a>. Insert minus signs in a checkerboard pattern as shown.</p>

  <div class="image"><img src="../Images/e489_03.png"></div>

  <p>This is equivalent to multiplying $a_{ij}$ by $(-1)^{i+j}$. The result is the desired inverse, by Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-33">33</a>).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_55" id="ch01ex_2_6_55a">55</a>. Insert minus signs in one triangle, as in the previous exercise, to get the inverse of the other. (Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-47">47</a>).)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_56" id="ch01ex_2_6_56a">56</a>. 210 310 320 321 410 420 421 430 431 432 510 520 521 530 531 532 540 541 542 543 610. With <em>a</em> fixed, <em>b</em> and <em>c</em> run through the combinations of <em>a</em> things two at a time; with <em>a</em> and <em>b</em> fixed, <em>c</em> runs through the combinations of <em>b</em> things one at a time.</p>

  <p class="indent">Similarly, we could express all numbers in the form $n=\mybinomf{a}{4}+\mybinomf{b}{3}+\mybinomf{c}{2}+\mybinomf{d}{1}$ with $a\gt b\gt c\gt d ≥ 0$; the sequence begins 3210 4210 4310 4320 4321 5210 5310 5320 … . We can find the combinatorial representation by a “greedy” method, first choosing the largest possible <em>a</em>, then the largest possible <em>b</em> for $n-\mybinomf{a}{4}$, etc. [Section 7.2.1.3 discusses further properties of this representation.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_58" id="ch01ex_2_6_58a">58</a>. [<em>Systematisches Lehrbuch der Arithmetik</em> (Leipzig: 1811), xxix.] Use induction and</p>

  <div class="image"><img src="../Images/e489_06.png"></div>

  <p>Therefore [F. Schweins, <em>Analysis</em> (Heidelberg: 1820),§151] the <em>q</em>-generalization of (<a href="../Text/ch01a.html#ch01eq-lev2sec6-21">21</a>) is</p>

  <div class="image"><img src="../Images/e489_07.png"></div>

  <p>And the identity $1-q^{t}=-q^{t}(1-q^{-t})$ makes it easy to generalize (<a href="../Text/ch01a.html#ch01eq-lev2sec6-17">17</a>) to</p>

  <div class="image"><img src="../Images/e489_08.png"></div>

  <p>The <em>q</em>-nomial coefficients arise in many diverse applications; see, for example, Section 5.1.2, and the author’s note in <em>J. Combinatorial Theory</em> <strong>A10</strong> (1971), 178–180.</p>

  <p class="indent"><em>Useful facts:</em> When <em>n</em> is a nonnegative integer, $\mybinomf{n}{k}_q$ is a polynomial of degree $k(n-k)$ in <em>q</em> with nonnegative integer coefficients, and it satisfies the reflective laws</p>

  <div class="image"><img src="../Images/e489_09.png"></div>

  <p>If $|q|\lt 1$ and $|x|\lt 1$, the <em>q</em>-nomial theorem holds when <em>n</em> is an arbitrary real number, if we replace the left-hand side by $∏_{k≥0}((1+q^{k}x)/(1+q^{n+k}x))$. Properties of power <a id="page_490"></a>series make it necessary to verify this only when <em>n</em> is a positive integer, because we can set $q^{n}=y$; the identity has then been verified for infinitely many values of <em>y</em>. Now we can negate the upper index in the <em>q</em>-nomial theorem, obtaining</p>

  <div class="image"><img src="../Images/e490_01.png"></div>

  <p>For further information, see G. Gasper and M. Rahman, <em>Basic Hypergeometric Series</em> (Cambridge Univ. Press, 1990). The <em>q</em>-nomial coefficients were introduced by Gauss in <em>Commentationes societatis regiæ scientiarum Gottingensis recentiores</em> <strong>1</strong> (1808), 147– 186; see also Cauchy [<em>Comptes Rendus Acad. Sci.</em> <strong>17</strong> (Paris, 1843), 523–531], Jacobi [<em>Crelle</em> <strong>32</strong> (1846), 197–204], Heine [<em>Crelle</em> <strong>34</strong> (1847), 285–328], and Section 7.2.1.4.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_59" id="ch01ex_2_6_59a">59</a>. $(n+1)\mybinomf{n}{k}-\mybinomf{n}{k+1}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_60" id="ch01ex_2_6_60a">60</a>. $\displaystyle\binom{n+k-1}{k}$. This formula can be remembered easily, since it is</p>

  <div class="image"><img src="../Images/e490_04.png"></div>

  <p>like Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-2">2</a>) except that the numbers in the numerator go up instead of down. A slick way to prove it is to note that we want to count the number of integer solutions $(a_{1},\ldots,a_{k})$ to the relations $1≤a_{1}≤a_{2}≤\cdots≤a_{k}≤n$. This is the same as $0\lt a_{1}\lt a_{2}+1\lt\cdots\lt a_{k}+k-1\lt n+k$; and the number of solutions to</p>

  <p class="center">$0\lt b_{1}\lt b_{2}\lt\cdots\lt b_{k}\lt n+k$</p>

  <p>is the number of choices of <em>k</em> distinct things from the set $\{1,2,\ldots,n+k-1\}$. (This trick is due to H. F. Scherk, <em>Crelle</em> <strong>3</strong> (1828), 97; curiously it was also given by W. A. Förstemann in the same journal, <strong>13</strong> (1835), 237, who said “One would almost believe this must have been known long ago, but I have found it nowhere, even though I have consulted many works in this regard.”)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_61" id="ch01ex_2_6_61a">61</a>. If $a_{mn}$ is the desired quantity, we have $a_{mn}=na_{m(n-1)}+δ_{mn}$ by (<a href="../Text/ch01a.html#ch01eq-lev2sec6-46">46</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-47">47</a>). Hence the answer is $[n≥m]\,n!/m!$. The same formula is also easily obtained by inversion of (<a href="../Text/ch01a.html#ch01eq-lev2sec6-56">56</a>).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_62" id="ch01ex_2_6_62a">62</a>. Use the identity of <a href="../Text/ch01a.html#ch01ex_2_6_31">exercise 31</a>, with $(m,n,r,s,k)←(m+k,l-k,m+n,n+l,j)$:</p>

  <div class="image"><img src="../Images/e490_05.png"></div>

  <p>by rearranging the factorial signs. The sum on <em>k</em> now vanishes unless $j=l$.</p>

  <p class="indent">The case $l=m=n$ of this identity was published by A. C. Dixon [<em>Messenger of Math.</em> <strong>20</strong> (1891), 79–80], who established the general case twelve years later [<em>Proc. London Math. Soc.</em> <strong>35</strong> (1903), 285–289]. However, L. J. Rogers had already published a much more general formula in the meantime [<em>Proc. London Math. Soc.</em> <strong>26</strong> (1895), 15–32,§8]. See also papers by P. A. MacMahon, <em>Quarterly Journal of Pure and Applied Math.</em> <strong>33</strong> (1902), 274–288, and John Dougall, <em>Proc. Edinburgh Math. Society</em> <strong>25</strong> <a id="page_491"></a>(1907), 114–132. The corresponding <em>q</em>-nomial identities are</p>

  <div class="image"><img src="../Images/e491_01.png"></div>

  <p>where $n!_q=\prod_{k=1}^{n}(1+q+\cdots+q^{k-1})$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_63" id="ch01ex_2_6_63a">63</a>. See <em>CMath</em>, exercises 5.83 and 5.106.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_64" id="ch01ex_2_6_64a">64</a>. Let $f(n,m)$ be the number of partitions of $\{1,2,\ldots,n\}$ into <em>m</em> parts. Clearly $f(1,m)=δ_{1m}$. If $n\gt 1$, the partitionings are of two varieties: (a) The element <em>n</em> alone forms a set of the partition; there are $f(n-1,m-1)$ ways to construct partitions like this. (b) The element <em>n</em> appears together with another element; there are <em>m</em> ways to insert <em>n</em> into any <em>m</em>-partition of $\{1,2,\ldots,n-1\}$, hence there are $mf(n-1,m)$ ways to construct partitions like this. We conclude that $f(n,m)=f(n-1,m-1)+mf(n-1,m)$, and $f(n,m)={n\brace m}$ by induction.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_65" id="ch01ex_2_6_65a">65</a>. See <em>AMM</em> <strong>99</strong> (1992), 410–422.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_66" id="ch01ex_2_6_66a">66</a>. Let $X=\mybinomf{x}{n}$, $\underline{X}=\mybinomf{x}{n-1}=\frac{n}{x-n+1}X$, $\overline{X}=\mybinomf{x}{n+1}=\frac{x-n}{n+1}X$, with similar notations for <em>Y</em> and <em>Z</em>. We may assume that $y\gt n-1$ is fixed, so that <em>x</em> is a function of <em>z</em>.</p>

  <p class="indent">Let $F(z)=\overline{X}-\overline{Y}-\overline{Z}$, and suppose that $F(z)=0$ for some $z\gt n-2$. We will prove that $F'(z)\lt0$; therefore $z=y$ must be the only root $\gt n-2$, proving the second inequality. Since $F(z)=\frac{x-n}{n+1}(Y+Z)-\frac{y-n}{n+1}Y-\frac{z-n+1}{n}Z=0$ and $x\gt y$ and $Y,Z\gt 0$, we must have $\frac{x-n}{n+1}\lt\frac{z-n+1}{n}$. Setting $X'=dX/dx$ and $Z'=dZ/dz=dX/dz$, we have</p>

  <div class="image"><img src="../Images/e491_10.png"></div>

  <p>since $\frac{x-n+1}{n+1}\lt\frac{z-n+2}{n},\cdots,\frac{x-1}{n+1}\lt\frac{z}{n}$. Thus $dx/dz=Z'/X'\lt\frac{n+1}{n}(Z/X)$, and</p>

  <div class="image"><img src="../Images/e491_13.png"></div>

  <p class="indent">To prove the first inequality, we may assume that $n\gt 2$. Then if $\underline{X}=\underline{Y}+\underline{Z}$ for some $z\gt n-2$, the second inequality tells us that $z=y$.</p>

  <p class="indent"><em>References:</em> L. Lovász, <em>Combinatorial Problems and Exercises</em> (1993), Problem 13.31(a); R. M. Redheffer, <em>AMM</em> <strong>103</strong> (1996), 62–64.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_67" id="ch01ex_2_6_67a">67</a>. If <em>k</em> &gt; 0, <a href="../Text/ch01a.html#ch01ex_2_5_24">exercise 1.2.5–24</a> gives the slightly sharper (but less memorable) upper bounds $\mybinomf{n}{k}=n^{\underline{k}}/k!\le n^{k}/k!\le\frac{1}{e}(\frac{ne}{k})^{k}\le(\frac{ne}{k+1})^{k}$. The corresponding lower bound is $\mybinomf{n}{k}\ge{\big(}\frac{(n-k+1)e}{k}{\big)}^{k}\frac{1}{ek}$, which is less memorable (but often sharper) than $\mybinomf{n}{k}\ge(\frac{n}{k})^{k}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_6_68" id="ch01ex_2_6_68a">68</a>. Let $t_k=k\mybinomf{n}{k}p^{k}(1-p)^{n+1-k}$; then $t_{k}-t_{k+1}=\mybinomf{n}{k}p^{k}(1-p)^{n-k}(k-np)$. So the stated sum is</p>

  <div class="image"><img src="../Images/e491_19.png"></div>

  <p>[De Moivre stated this identity in <em>Miscellanea Analytica</em> (1730), 101, in the case that <em>np</em> is an integer; H. Poincaré proved the general case in his <em>Calcul des Probabilités</em> (1896), 56–60. See P. Diaconis and S. Zabell, <em>Statistical Science</em> <strong>6</strong> (1991), 284–302, for the interesting history of this identity and for a variety of similar formulas.]</p>

  <h4 id="app01lev2sec7"><a id="page_492"></a>Section 1.2.7</h4>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_1" id="ch01ex_2_7_1a">1</a>. 0, 1, and $3/2$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_2" id="ch01ex_2_7_2a">2</a>. Replace each term $1/(2^{m}+k)$ by the upper bound $1/2^{m}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_3" id="ch01ex_2_7_3a">3</a>. $H_{2^{m}-1}^{(r)}\le\sum_{0\le k\lt m}2^{k}/2^{kr}$; $2^{r-1}/(2^{r-1}-1)$ is an upper bound.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_4" id="ch01ex_2_7_4a">4</a>. (b) and (c).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_5" id="ch01ex_2_7_5a">5</a>. 9.78760 60360 44382 …</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_6" id="ch01ex_2_7_6a">6</a>. Induction and Eq. <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec6-46">46</a>).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_7" id="ch01ex_2_7_7a">7</a>. $T(m+1,n)-T(m,n)=$ $1/(m+1)-1/(mn+1)-\cdots-1/(mn+n)≤$ $1/(m+1)-(1/(mn+n)+\cdots+1/(mn+n))=$ $1/(m+1)-n/(mn+n)=0$. The maximum value occurs at $m=n=1$, and the minimum is approached when <em>m</em> and <em>n</em> get very large. By Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec7-3">3</a>) the greatest lower bound is γ, which is never actually attained. A generalization of this result appears in <em>AMM</em> <strong>70</strong> (1963), 575–577.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_8" id="ch01ex_2_7_8a">8</a>. By Stirling’s approximation, $\ln n!$ is approximately $(n+\frac12)\ln n-n+\ln\sqrt{2\pi}$; also $\sum_{k=1}^{n}H_{k}$ is approximately $(n+1)\ln n-n(1-\gamma)+(\gamma+\frac12)$; the difference is approximately $\gamma n+\frac{1}{2}\ln n+.158$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_9" id="ch01ex_2_7_9a">9</a>. $-1/n$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_10" id="ch01ex_2_7_10a">10</a>. Break the left side into two sums; change <em>k</em> to <em>k</em> + 1 in the second sum.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_11" id="ch01ex_2_7_11a">11</a>. $2-H_{n}/n-1/n$, for $n\gt 0$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_12" id="ch01ex_2_7_12a">12</a>. 1.000… is correct to more than three hundred decimal places.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_13" id="ch01ex_2_7_13a">13</a>. Use induction as in the proof of <a href="../Text/ch02b.html#ch02b_the_a">Theorem A</a>. Or use calculus: Differentiate with respect to <em>x</em>, also evaluate at $x=1$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_14" id="ch01ex_2_7_14a">14</a>. See <a href="../Text/ch01.html#ch01lev2sec3">Section 1.2.3</a>, <a href="../Text/ch01.html#ch01exam-1-2">Example 2</a>. The second sum is ${\frac12}{(H_{n+1}^{2}-H_{n+1}^{(2)})}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_15" id="ch01ex_2_7_15a">15</a>. $\sum_{j=1}^{n}(1/j)\sum_{k=j}^{n}H_{k}$ can be summed by formulas in the text; the answer comes to $(n+1)H_{n}^{2}-(2n+1)H_{n}+2n$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_16" id="ch01ex_2_7_16a">16</a>. $H_{2n-1}-\frac{1}{2}H_{n-1}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_17" id="ch01ex_2_7_17a">17</a>. <em>First solution</em> (elementary): Taking the denominator to be $(p-1)!$, which is a multiple of the true denominator but not a multiple of <em>p</em>, we must show only that the corresponding numerator, $(p-1)!/1+(p-1)!/2+$ $\cdots+(p-1)!/(p-1)$, <em>is</em> a multiple of <em>p</em>. Modulo <em>p</em>, $(p-1)!/k≡(p-1)!\,k'$, where $k'$ can be determined by the relation $kk'\bmod p=1$. The set $\{1',2',\ldots,(p-1)'\}$ is just the set $\{1,2,\ldots,p-1\}$; so the numerator is congruent to $(p-1)!\,(1+2+\cdots+p-1)≡0$.</p>

  <p class="indent"><em>Second solution</em> (advanced): By exercise 4.6.2–6, we have $x^{\overline p}≡x^{p}-\md[x]{p}$; hence ${p\brack k}\equiv\delta_{kp}-\delta_{k1}$, by <a href="../Text/ch01a.html#ch01ex_2_6_32">exercise 1.2.6–32</a>. Now apply <a href="../Text/ch01a.html#ch01ex_2_7_6">exercise 6</a>.</p>

  <p class="indent">The numerator of $H_{p-1}$ is in fact known to be a multiple of $p^{2}$ when $p\gt 3$; see Hardy and Wright, <em>An Introduction to the Theory of Numbers</em>, Section 7.8.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_18" id="ch01ex_2_7_18a">18</a>. If $n=2^{k}m$ where <em>m</em> is odd, the sum equals $2^{2k}m_{1}/m_{2}$ where $m_{1}$ and $m_{2}$ are both odd. [<em>AMM</em> <strong>67</strong> (1960), 924–925.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_19" id="ch01ex_2_7_19a">19</a>. Only $n=0$, $n=1$. For $n≥2$, let $k=\lfloor{\lg n}\rfloor$. There is precisely one term whose denominator is $2^{k}$, so $2^{k-1}H_{n}-\frac12$ is a sum of terms involving only odd primes in the denominator. If $H_{n}$ were an integer, $2^{k-1}H_{n}-\frac12$ would have a denominator equal to 2.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_20" id="ch01ex_2_7_20a">20</a>. Expand the integrand term by term. See also <em>AMM</em> <strong>69</strong> (1962), 239, and an article by H. W. Gould, <em>Mathematics Magazine</em> <strong>34</strong> (1961), 317–321.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_21" id="ch01ex_2_7_21a">21</a>. $H_{n+1}^{2}-H_{n+1}^{(2)}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_22" id="ch01ex_2_7_22a">22</a>. $(n+1)(H_n^{2}-H_n^{(2)})-2n(H_{n}-1)$.</p>

  <p><a id="page_493"></a><a href="../Text/ch01a.html#ch01ex_2_7_23" id="ch01ex_2_7_23a">23</a>. $\varGamma'(n+1)/\varGamma(n+1)=1/n+\varGamma'(n)/\varGamma(n)$, since $\varGamma(x+1)=x\varGamma(x)$. Hence $H_{n}=γ+\varGamma'(n+1)/\varGamma(n+1)$. The function $\psi(x)=\varGamma'(x)/\varGamma(x)=H_{x-1}-γ$ is called the <em>psi function</em> or the <em>digamma function</em>. Some values for rational <em>x</em> appear in <a href="../Text/app02.html#app02">Appendix A</a>.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_24" id="ch01ex_2_7_24a">24</a>. It is</p>

  <div class="image"><img src="../Images/e493_01.png"></div>

  <p><em>Note:</em> The generalization of $H_{n}$ considered in the previous exercise is therefore equal to $H_{x}^{(r)}=\sum_{k\ge0}(1/(k+1)^{r}-1/(k+1+x)^{r})$, when $r=1$; the same idea can be used for larger values of <em>r</em>. The infinite product converges for all complex <em>x</em>.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_7_25" id="ch01ex_2_7_25a">25</a>. $H_{n}^{(0,v)}=\sum_{k=1}^{n}H_{n}^{(v)}$ and $H_{n}^{(u,0)}=H_{n}^{(u-1)}$; so the identity generalizes (<a href="../Text/ch01a.html#ch01eq-lev2sec7-8">8</a>). [See L. Euler, <em>Novi Comment. Acad. Sci. Pet.</em> <strong>20</strong> (1775), 140–186,§2.]</p>

  <h4 id="app01lev2sec8">Section 1.2.8</h4>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_1" id="ch01ex_2_8_1a">1</a>. After <em>k</em> months there are $F_{k+2}$ pairs, so the answer is $F_{14}=377$ pairs.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_2" id="ch01ex_2_8_2a">2</a>. $\ln(\phi^{1000}/\sqrt{5})=1000\ln\phi-\frac{1}{2}\ln 5=480.40711$; $\log_{10}F_{1000}$ is $1/(\ln 10)$ times this, or 208.64; $F_{1000}$ is therefore a 209-digit number whose leading digit is 4.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_4" id="ch01ex_2_8_4a">4</a>. 0, 1, 5; afterwards $F_{n}$ increases too fast.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_5" id="ch01ex_2_8_5a">5</a>. 0, 1, 12.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_6" id="ch01ex_2_8_6a">6</a>. Induction. (The equation holds for <em>negative</em> <em>n</em> also; see <a href="../Text/ch01a.html#ch01ex_2_8_8">exercise 8</a>.)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_7" id="ch01ex_2_8_7a">7</a>. If <em>d</em> is a proper divisor of <em>n</em>, $F_{d}$ divides $F_{n}$. Now $F_{d}$ is greater than one and less than $F_{n}$ provided <em>d</em> is greater than 2. The only nonprime number that has no proper factor greater than 2 is $n=4$; $F_{4}=3$ is the only exception.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_8" id="ch01ex_2_8_8a">8</a>. $F_{-1}=1$; $F_{-2}=-1$; $F_{-n}=(-1)^{n+1}F_{n}$ by induction on <em>n</em>.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_9" id="ch01ex_2_8_9a">9</a>. Not (<a href="../Text/ch01a.html#ch01eq-lev2sec8-15">15</a>). The others are valid, by an inductive argument that proves something true for $n-1$ assuming it true for <em>n</em> and greater.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_10" id="ch01ex_2_8_10a">10</a>. When <em>n</em> is even, it is greater; when <em>n</em> is odd, it is less. (See Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec8-14">14</a>).)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_11" id="ch01ex_2_8_11a">11</a>. Induction; see <a href="../Text/ch01a.html#ch01ex_2_8_9">exercise 9</a>. This is a special case of <a href="../Text/ch01a.html#ch01ex_2_8_13">exercise 13</a>(a).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_12" id="ch01ex_2_8_12a">12</a>. If ${\cal G}(z)=\sum{\cal F}_{n}z^{n}$, $(1-z-z^{2}){\cal G}(z)=z+F_{0}z^{2}+F_{1}z^{3}+\cdots=z+z^{2}G(z)$. Hence ${\cal G}(z)=G(z)+zG(z)^{2}$; from Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec8-17">17</a>) we find ${\cal F}_n=((3n+3)/5)F_{n}-(n/5)F_{n+1}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_13" id="ch01ex_2_8_13a">13</a>. (a) $a_{n}=rF_{n-1}+sF_{n}$.</p>

  <p class="indent">(b) Since $(b_{n+2}+c)=(b_{n+1}+c)+(b_{n}+c)$, we may consider the new sequence $b'_{n}=b_{n}+c$. Applying part (a) to $b'_{n}$, we obtain the answer $cF_{n-1}+(c+1)F_{n}-c$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_14" id="ch01ex_2_8_14a">14</a>. $a_n=F_{m+n+1}+F_{n}-\mybinomf{n}{m}$ $-\mybinomf{n+1}{m-1}-\cdots-\mybinomf{n+m}{0}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_15" id="ch01ex_2_8_15a">15</a>. $c_{n}=xa_{n}+yb_{n}+(1-x-y)F_{n}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_16" id="ch01ex_2_8_16a">16</a>. $F_{n+1}$. Induction, and $\mybinomf{n+1-k}{k}=\mybinomf{n-k}{k}+\mybinomf{(n-1)-(k-1)}{k-1}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_17" id="ch01ex_2_8_17a">17</a>. In general, the quantity $(x^{n+k}-y^{n+k})(x^{m-k}-y^{m-k})-$ $(x^{n}-y^{n})(x^{m}-y^{m})$ is equal to $(xy)^{n}(x^{m-n-k}-y^{m-n-k})(x^{k}-y^{k})$. Set $x=\phi$, $y=\phihat$, and divide by $(\sqrt{5})^{2}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_18" id="ch01ex_2_8_18a">18</a>. It is $F_{2n+1}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_19" id="ch01ex_2_8_19a">19</a>. Let $u=\cos 72^{°}$, $v=\cos 36^{°}$. We have $u=2v^{2}-1$; $v=1-2\sin^{2}18^{°}=1-2u^{2}$. Hence $u+v=2(v^{2}-u^{2})$, i.e., $1=2(v-u)=2v-4v^{2}+2$. We conclude that $v=\frac{1}{2}\phi$. (Also $u=\frac{1}{2}\phi^{-1}$, $\sin 36^{°}=\frac12 5^{1/4}\phi^{-1/2}$, $\sin 72^{°}=\frac12 5^{1/4}\phi^{1/2}$. Another interesting angle is $α=\arctan\phi=\frac{\pi}{4}+\frac12\arctan\frac12$, for which we have $\sin α=5^{-1/4}\phi^{1/2}$, $\cos α=5^{-1/4}\phi^{-1/2}$.)</p>

  <p><a id="page_494"></a><a href="../Text/ch01a.html#ch01ex_2_8_20" id="ch01ex_2_8_20a">20</a>. $F_{n+2}-1$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_21" id="ch01ex_2_8_21a">21</a>. Multiply by $x^{2}+x-1$; the solution is $(x^{n+1}F_{n+1}+x^{n+2}F_{n}-x)/(x^{2}+x-1)$. If the denominator is zero, <em>x</em> is $1/\phi$ or $1/\phihat$; then the solution is $(n+1-x^{n}F_{n+1})/(2x+1)$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_22" id="ch01ex_2_8_22a">22</a>. $F_{m+2n}$; set $t=2$ in the next exercise.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_23" id="ch01ex_2_8_23a">23</a>. $\displaystyle\frac{1}{\sqrt{5}}\sum_{k}\binom{n}{k}(\phi^{k}F_{t}^{k}F_{t-1}^{n-k}\phi^{m}-\phihat^{\,k}F_{t}^{k}F_{t-1}^{n-k}\phihat^{\,m})=$ $\displaystyle\frac{1}{\sqrt{5}}(\phi^{m}(\phi F_{t}+F_{t-1})^{n}-\phihat^{\,m}(\phihat F_{t}+F_{t-1})^{n})=$ $\displaystyle F_{m+tn}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_24" id="ch01ex_2_8_24a">24</a>. $F_{n+1}$ (expand by cofactors in the first row).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_25" id="ch01ex_2_8_25a">25</a>. $2^{n}\sqrt{5}F_{n}=(1+\sqrt{5})^{n}-(1-\sqrt{5})^{n}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_26" id="ch01ex_2_8_26a">26</a>. By Fermat’s theorem, $2^{p-1}≡1$; now apply the previous exercise and <a href="../Text/ch01a.html#ch01ex_2_6_10">exercise 1.2.6–10</a>(b).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_27" id="ch01ex_2_8_27a">27</a>. The statement is true if $p=2$. Otherwise $F_{p-1}F_{p+1}-F_{p}^{2}=-1$; hence, from the previous exercise and Fermat’s theorem, $F_{p-1}F_{p+1}≡\md[0]{p}$. Only one of these factors can be a multiple of <em>p</em>, since $F_{p+1}=F_{p}+F_{p-1}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_28" id="ch01ex_2_8_28a">28</a>. $\phihat^{\,n}$. <em>Note:</em> The solution to the recurrence $a_{n+1}=Aa_{n}+B^{n}$, $a_{0}=0$, is</p>

  <p class="center">$a_{n}=(A^{n}-B^{n})/(A-B){\rm\;if}\;A≠B,$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$a_{n}=nA^{n-1}{\rm\;if}\;A=B$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_29" id="ch01ex_2_8_29a">29</a>. (a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="top"><img src="../Images/e494_06.png"></span></p>

  <p class="indent">(b) follows from (<a href="../Text/ch01a.html#ch01eq-lev2sec8-6">6</a>). [É. Lucas, <em>Amer. J. Math.</em> <strong>1</strong> (1878), 201–204.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_30" id="ch01ex_2_8_30a">30</a>. We argue by induction on <em>m</em>, the statement being obvious when $m=1$:</p>

  <p class="indent">(a) $\displaystyle\sum_{k}\binom{m}{k}_{\!\!\cal F}(-1)^{\lceil{(m-k)/2}\rceil}F_{n+k}^{m-2}F_{k}=$ $\displaystyle F_{m}\sum_{k}\binom{m-1}{k-1}_{\!\!\cal F}(-1)^{\lceil{(m-k)/2}\rceil}F_{n+k}^{m-2}=0$.</p>

  <p class="indent">(b) $\displaystyle\sum_{k}\binom{m}{k}_{\!\!\cal F}(-1)^{\lceil{(m-k)/2}\rceil}F_{n+k}^{m-2}(-1)^{k}F_{m-k}=$ $\displaystyle(-1)^{m}F_{m}\sum_{k}\binom{m-1}{k}_{\!\!\cal F}(-1)^{\lceil{(m-1-k)/2}\rceil}F_{n+k}^{m-2}=0$.</p>

  <p class="indent">(c) Since $(-1)^{k}F_{m-k}=F_{k-1}F_{m}-F_{k}F_{m-1}$ and $F_{m}≠0$, we conclude from (a) and (b) that $\sum_{k}\mybinomf{m}{k}_{\!\cal F}(-1)^{\lceil{(m-k)/2}\rceil}F_{n+k}^{m-2}F_{k-1}=0$.</p>

  <p class="indent">(d) Since $F_{n+k}=F_{k-1}F_{n}+F_{k}F_{n+1}$ the result follows from (a) and (c). This result may also be proved in slightly more general form by using the <em>q</em>-nomial theorem of <a href="../Text/ch01a.html#ch01ex_2_6_58">exercise 1.2.6–58</a>. <em>References:</em> Dov Jarden, <em>Recurring Sequences</em>, 2nd ed. (Jerusalem, 1966), 30–33; J. Riordan, <em>Duke Math. J.</em> <strong>29</strong> (1962), 5–12.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_31" id="ch01ex_2_8_31a">31</a>. Use <a href="../Text/ch01a.html#ch01ex_2_8_8">exercises 8</a> and <a href="../Text/ch01a.html#ch01ex_2_8_11">11</a>.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_32" id="ch01ex_2_8_32a">32</a>. Modulo $F_{n}$ the Fibonacci sequence is $0,1,\ldots,F_{n-1},0,F_{n-1},-F_{n-2},\ldots$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_33" id="ch01ex_2_8_33a">33</a>. Note that $\cos z=\frac12 (e^{iz}+e^{-iz})=-i/2$, for this particular <em>z</em>; then use the fact that $\sin(n+1)z+\sin(n-1)z=2\sin nz\cos z$, for all <em>z</em>.</p>

  <p><a id="page_495"></a><a href="../Text/ch01a.html#ch01ex_2_8_34" id="ch01ex_2_8_34a">34</a>. Prove that the only possible value for $F_{k_{1}}$ is the largest Fibonacci number less than or equal to <em>n</em>; hence $n-F_{k_{1}}$ is less than $F_{k_{1}-1}$, and by induction there is a unique representation of $n-F_{k_{1}}$. The outline of this proof is quite similar to the proof of the unique factorization theorem. The Fibonacci number system is due to E. Zeckendorf [see <em>Simon Stevin</em> <strong>29</strong> (1952), 190–195; <em>Bull. Soc. Royale des Sciences de Liège</em> <strong>41</strong> (1972), 179–182]; but Section 7.2.1.7 points out that it was implicitly known in 14th-century India. Generalizations are discussed in exercise 5.4.2–10 and in Section 7.1.3.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_35" id="ch01ex_2_8_35a">35</a>. See G. M. Bergman, <em>Mathematics Magazine</em> <strong>31</strong> (1957), 98–110. To represent $x\gt 0$, find the largest <em>k</em> with $\phi^{k}≤x$ and represent <em>x</em> as $\phi^{k}$ plus the representation of $x-\phi^{k}$.</p>

  <p class="indent">The representation of nonnegative integers can also be obtained from the following all-integer recursive rules, starting with the trivial representations of 0 and 1: Let $L_{n}=\phi^{n}+\phihat^{\,n}=F_{n+1}+F_{n-1}$. The representation of $L_{2n}+m$ for $0≤m≤L_{2n-1}$ and $n≥1$ is $\phi^{2n}+\phi^{-2n}$ plus the representation of <em>m</em>. The representation of $L_{2n+1}+m$ for $0\lt m\lt L_{2n}$ and $n≥0$ is $\phi^{2n+1}+\phi^{-2n-2}$ plus the representation of $m-\phi^{-2n}$, where the latter is obtained by applying the rule $\phi^{k}-\phi^{k-2j}=$ $\phi^{k-1}+\phi^{k-3}+\cdots+\phi^{k-2j+1}$. It turns out that all strings <em>α</em> of 0s and 1s, such that <em>α</em> begins with 1 and has no adjacent 1s, occur to the left of the radix point in the representation of exactly one positive integer, except for the strings that end with $10^{2k}1$; the latter strings never occur in such representations.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_36" id="ch01ex_2_8_36a">36</a>. We may consider the infinite string $S_{∞}$, since $S_{n}$ for $n\gt 1$ consists of the first $F_{n}$ letters of $S_{∞}$. There are no double <em>a</em>’s, no triple <em>b</em>’s. The string $S_{n}$ contains $F_{n-2}$ <em>a</em>’s and $F_{n−1}$ <em>b</em>’s. If we express $m-1$ in the Fibonacci number system as in <a href="../Text/ch01a.html#ch01ex_2_8_34">exercise 34</a>, the <em>m</em>th letter of $S_{∞}$ is <em>a</em> if and only if $k_{r}=2$. The <em>k</em>th letter of $S_{∞}$ is <em>b</em> if and only if $\lfloor{(k+1)\phi^{-1}}\rfloor-\lfloor{k\phi^{-1}}\rfloor=1$; the number of <em>b</em>’s in the first <em>k</em> letters is therefore $\lfloor{(k+1)\phi^{-1}}\rfloor$. Also, the <em>k</em>th letter is <em>b</em> if and only if $k=\lfloor{m\phi}\rfloor$ for some positive integer <em>m</em>. This sequence was studied by John Bernoulli III in the 18th century, by A. A. Markov in the 19th, and by many other mathematicians since then; see K. B. Stolarsky, <em>Canadian Math. Bull.</em> <strong>19</strong> (1976), 473–482.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_37" id="ch01ex_2_8_37a">37</a>. [<em>Fibonacci Quarterly</em> <strong>1</strong> (December 1963), 9–12.] Consider the Fibonacci number system of <a href="../Text/ch01a.html#ch01ex_2_8_34">exercise 34</a>; if $n=F_{k_{1}}+\cdots+F_{k_{r}}\gt 0$ in that system, let $μ(n)=F_{k_{r}}$. Also let $μ(0)=∞$. We find that: (A) If $n\gt 0$, $μ(n-μ(n))\gt 2μ(n)$. <em>Proof:</em> $μ(n-μ(n))=F_{k_{r-1}}≥F_{k_{r}+2}\gt 2F_{k_{r}}$ since $k_{r}≥2$. (B) If $0\lt m\lt F_{k}$, $μ(m)≤2(F_{k}-m)$. <em>Proof:</em> Let $μ(m)=F_j$; $m\le F_{k-1}+F_{k-3}+\cdots+$ $F_{j+(k-1-j)\bmod 2}=-F_{j-1+(k-1-j)\bmod 2}+$ $F_{k}\le-\frac{1}{2}F_{j}+F_{k}$. (C) If $0\lt m\lt μ(n)$, $μ(n-μ(n)+m)≤2(μ(n)-m)$. <em>Proof:</em> This follows from (B). (D) If $0\lt m\lt μ(n)$, $μ(n-m)≤2m$. <em>Proof:</em> Set $m=μ(n)-m$ in (C).</p>

  <p class="indent">Now we will prove that if there are <em>n</em> chips, and if at most <em>q</em> may be taken in the next turn, there is a winning move if and only if $μ(n)≤q$. <em>Proof:</em> (a) If $μ(n)\gt q$ all moves leave a position <em>n</em>′, <em>q</em>′ with $μ(n')≤q'$. [This follows from (D), above.] (b) If $μ(n)≤q$, we can either win on this move (if $q≥n$) or we can make a move that leaves a position <em>n</em>′, <em>q</em>′ with $μ(n')\gt q'$. [This follows from (A) above: Our move is to take $μ(n)$ chips.] It can be seen that the set of all winning moves, if $n=F_{k_{1}}+\cdots+F_{k_{r}}$, is to remove $F_{k_{j}}+\cdots+F_{k_{r}}$, for some <em>j</em> with $1≤j≤r$, provided that $j=1$ or $F_{k_{j-1}}\gt 2(F_{k_{j}}+\cdots+F_{k_{r}})$.</p>

  <p class="indent">The Fibonacci representation of 1000 is 987+13; the <em>only</em> lucky move to force a victory is to take 13 chips. The first player can always win unless <em>n</em> is a Fibonacci number.</p>

  <p class="indent">The solution to considerably more general games of this type has been obtained by A. Schwenk [<em>Fibonacci Quarterly</em> <strong>8</strong> (1970), 225–234].</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_39" id="ch01ex_2_8_39a">39</a>. $(3^{n}-(-2)^{n}) /5$.</p>

  <p><a id="page_496"></a><a href="../Text/ch01a.html#ch01ex_2_8_40" id="ch01ex_2_8_40a">40</a>. We prove, by induction on <em>m</em>, that $f(n)=m$ for $F_{m}\lt n≤F_{m+1}$: First, $f(n)≤\max(1+f(F_{m})$, $2+f(n-F_{m}))=m$. Second, if $f(n)\lt m$ there is some $k\lt n$ with $1+f(k)\lt m$ (hence $k≤F_{m-1}$) and $2+f(n-k)\lt m$ (hence $n-k≤F_{m-2}$); but then $n≤F_{m-1}+F_{m-2}$. [Thus the Fibonacci trees defined in Section 6.2.1 minimize the maximum root-to-leaf cost when a right branch costs twice as much as a left branch.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_41" id="ch01ex_2_8_41a">41</a>. $F_{k_{1}+1}+\cdots+F_{k_{r}+1}=\phi n+(\phihat^{\,k_{1}}+\cdots+\phihat^{\,k_{r}})$ is an integer, and the parenthesized quantity lies between $\phihat^{\,3}+\phihat^{\,5}+\cdots=\phihat^{\,-1}-1$ and $\phihat^{\,2}+\phihat^{\,4}+\cdots=\phihat^{\,-1}$. Similarly, $F_{k_{1}-1}+\cdots+F_{k_{r}-1}=\phi^{-1}n+$ $(\phihat^{\,k_{1}}+\cdots+\phihat^{\,k_{r}})=f(\phihat^{\,-1}n)$. [Such Fibonacci shifting is a convenient way to convert mentally between miles and kilometers; see <em>CMath</em>,§6.6.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_8_42" id="ch01ex_2_8_42a">42</a>. [<em>Fibonacci Quarterly</em> <strong>6</strong> (1968), 235–244.] If such a representation exists, we have</p>

  <div class="equation"><img src="../Images/496equ01.png"></div>

  <p>for all integers <em>N</em>; hence two different representations would contradict <a href="../Text/ch01a.html#ch01ex_2_8_34">exercise 34</a>.</p>

  <p class="indent">Conversely, we can prove the existence of such joint representations for all nonnegative <em>m</em> and <em>n</em> by induction. But it is more interesting to use the previous exercise, and to prove that such joint representations exist for possibly negative integers <em>m</em> and <em>n</em> if and only if $m+\phi n≥0$: Let <em>N</em> be large enough so that $|m\phihat^{\,N-1}+n\phihat^{\,N}|\lt\phi^{-2}$, and represent $mF_{N-1}+nF_{N}$ as in $(*)$. Then $mF_{N}+nF_{N+1}=\phi(mF_{N-1}+nF_{N})+(m\phihat^{\,N-1}+n\phihat^{\,N})=$ $f(\phi(mF_{N-1}+nF_{N}))=F_{k_{1}+N+1}+\cdots+F_{k_{r}+N+1}$, and it follows that $(*)$ holds for all <em>N</em>. Now set $N=0$ and $N=1$.</p>

  <h4 id="app01lev2sec9">Section 1.2.9</h4>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_1" id="ch01ex_2_9_1a">1</a>. $1/(1-2z)+1/(1-3z)$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_2" id="ch01ex_2_9_2a">2</a>. It follows from (<a href="../Text/ch01a.html#ch01eq-lev2sec9-6">6</a>), since $\mybinomf{n}{k}=n!/k!\,(n-k)!$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_3" id="ch01ex_2_9_3a">3</a>. $G'(z)=\ln(1/(1-z))/(1-z)^{2}+1/(1-z)^{2}$. From this and the significance of $G(z)/(1-z)$, we have $\sum_{k=1}^{n-1}H_{k}=nH_{n}-n$; this agrees with Eq. <a href="../Text/ch01a.html#ch01lev2sec7">1.2.7</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec7-8">8</a>).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_4" id="ch01ex_2_9_4a">4</a>. Put $t=0$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_5" id="ch01ex_2_9_5a">5</a>. The coefficient of $z^{k}$ is, by (<a href="../Text/ch01a.html#ch01eq-lev2sec9-11">11</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec9-22">22</a>),</p>

  <div class="image"><img src="../Images/e496_08.png"></div>

  <p>Now apply Eqs. <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec6-46">46</a>) and <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec6-52">52</a>). (Or, differentiate and use <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec6-46">46</a>).)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_6" id="ch01ex_2_9_6a">6</a>. $(\ln(1/(1-z)))^{2}$; the derivative is twice the generating function for the harmonic numbers; the sum is therefore $2H_{n−1}/n$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_8" id="ch01ex_2_9_8a">8</a>. $1/((1-z)(1-z^{2})(1-z^{3})\ldots)$. [This is historically one of the first applications of generating functions. For an interesting account of L. Euler’s eighteenth-century researches concerning this generating function, see G. Pólya, <em>Induction and Analogy in Mathematics</em> (Princeton: Princeton University Press, 1954), Chapter 6.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_9" id="ch01ex_2_9_9a">9</a>. $\frac{1}{24}S_{1}^{4}+\frac{1}{4}S_{1}^{2}S_{2}+\frac{1}{8}S_{2}^{2}+\frac{1}{3}S_{1}S_{3}+\frac{1}{4}S_{4}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_10" id="ch01ex_2_9_10a">10</a>. $G(z)=(1+x_{1}z)\ldots(1+x_{n}z)$. Taking logarithms as in the derivation of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-38">38</a>), we have the same formulas except that (<a href="../Text/ch01a.html#ch01eq-lev2sec9-24">24</a>) replaces (<a href="../Text/ch01a.html#ch01eq-lev2sec9-17">17</a>), and the answer is exactly the same except that $S_{2},S_{4},S_{6},\ldots$ are replaced by $-S_{2},-S_{4},-S_{6},\ldots$. We have $e_{1}=S_{1}$, $e_{2}=\frac{1}{2}S_{1}^{2}-\frac{1}{2}S_{2}$, $e_{3}=\frac{1}{6}S_{1}^{3}-\frac{1}{2}S_{1}S_{2}+\frac{1}{3}S_{3}$, $e_{4}=\frac{1}{24}S_{1}^{4}-\frac{1}{4}S_{1}^{2}S_{2}+\frac{1}{8}S_{2}^{2}+\frac{1}{3}S_{1}S_{3}-\frac{1}{4}S_{4}$. (See <a href="../Text/ch01a.html#ch01ex_2_9_9">exercise 9</a>.) The recurrence analogous to (<a href="../Text/ch01a.html#ch01eq-lev2sec9-39">39</a>) is $ne_{n}=S_{1}e_{n-1}-S_{2}e_{n-2}+\cdots$.</p>

  <p><a id="page_497"></a><em>Note:</em> The equations in this recurrence are called <em>Newton’s identities</em>, since they were first published in Isaac Newton’s <em>Arithmetica Universalis</em> (1707); see D. J. Struik’s <em>Source Book in Mathematics</em> (Harvard University Press, 1969), 94–95.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_11" id="ch01ex_2_9_11a">11</a>. Since $∑_{m≥1}S_{m}z^{m}/m=\ln G(z)=∑_{k≥1}(-1)^{k-1}(h_{1}z+h_{2}z^{2}+\cdots)^{k}/k$, the desired coefficient is $(-1)^{k_{1}+k_{2}+\cdots+k_{m}-1}m(k_{1}+k_{2}+\cdots+k_{m}-1)!/k_{1}!\,k_{2}!\ldots k_{m}!$. [Multiply by $(-1)^{m-1}$ to get the coefficient of $e_{1}^{k_{1}}e_{2}^{k_{2}}\ldots e_{m}^{k_{m}}$ when $S_{m}$ is expressed in terms of the <em>e</em>’s of <a href="../Text/ch01a.html#ch01ex_2_9_10">exercise 10</a>. Albert Girard stated the formulas for $S_{1}$, $S_{2}$, $S_{3}$, and $S_{4}$ in terms of $e_{1}$, $e_{2}$, $e_{3}$, and $e_{4}$ near the end of his <em>Invention Nouvelle en Algébre</em> (Amsterdam: 1629); this was the birth of the theory of symmetric functions.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_12" id="ch01ex_2_9_12a">12</a>. $\displaystyle\sum_{m,n\ge 0}a_{mn}w^{m}z^{n}=\sum_{m,n\ge 0}\binom{n}{m}w^{m}z^{n}=\sum_{n\ge 0}(1+w)^{n}z^{n}=1/(1-z-wz)$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_13" id="ch01ex_2_9_13a">13</a>. $\int_{n}^{n+1}e^{-st}f(t)\,dt=(a_{0}+\cdots+a_{n})(e^{-sn}-e^{-s(n+1)})/s$. Adding these expressions together for all <em>n</em>, we find $\class{st}{\rm L}f(s)=G(e^{-s})/s$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_14" id="ch01ex_2_9_14a">14</a>. See <a href="../Text/ch01a.html#ch01ex_2_6_2">exercise 1.2.6–38</a>.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_15" id="ch01ex_2_9_15a">15</a>. $G_{n}(z)=G_{n-1}(z)+zG_{n-2}(z)+δ_{n0}$, so we find $H(w)=1/(1-w-zw^{2})$. Hence, ultimately, we find</p>

  <div class="image"><img src="../Images/e497_04.png"></div>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_16" id="ch01ex_2_9_16a">16</a>. $G_{nr}(z)=(1+z+\cdots+z^{r})=\left(\frac{1-z^{r+1}}{1-z}\right)^{n}$.[Note the case $r=∞$.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_17" id="ch01ex_2_9_17a">17</a>. $\displaystyle\sum_{k}\binom{-w}{k}(-z)^{k}=\sum_{k}\frac{w(w+1)\ldots(w+k-1)}{k(k-1)\ldots 1}z^{k}=\sum_{n,k}{k\brack n}z^{k}w^{n}/k!$.</p>

  <p>(Alternatively, write it as $e^{w\ln(1/(1-z))}$ and expand first by powers of <em>w</em>.)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_18" id="ch01ex_2_9_18a">18</a>. (a) For fixed <em>n</em> and varying <em>r</em>, the generating function is</p>

  <div class="image"><img src="../Images/e497_07.png"></div>

  <p>by Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-27">27</a>). Hence the answer is ${n+1}\brack{n+1-r}$.</p>

  <p class="indent">(b) Similarly, the generating function is</p>

  <div class="image"><img src="../Images/e497_09.png"></div>

  <p>by Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-28">28</a>), so the answer is ${n+r}\brace{n}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_19" id="ch01ex_2_9_19a">19</a>. $\sum_{n\ge1}(1/n-1/(n+p/q))x^{p+nq}=$ $\sum_{k=0}^{q-1}\omega^{-kp}\ln(1-\omega^{k}x)-x^{p}\ln(1-x^{q})+\frac{q}{p}x^{p}=$ $f(x)+g(x)$, where $\omega=e^{2πi/q}$ and</p>

  <div class="image"><img src="../Images/e497_12.png"></div>

  <p><a id="page_498"></a>Now $\lim_{x→1-}g(x)=q/p-\ln q$. From the identity</p>

  <div class="image"><img src="../Images/e498_01.png"></div>

  <p>we may write $\lim_{x→1-}f(x)=f(1)=A+B$ where</p>

  <div class="image"><img src="../Images/e498_02.png"></div>

  <p>Finally,</p>

  <div class="image"><img src="../Images/e498_03.png"></div>

  <p>[Gauss derived these results in §33 of his monograph on hypergeometric series, Eq. [75], but with insufficient proof; Abel provided a justification in <em>Crelle</em> <strong>1</strong> (1826), 314–315.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_20" id="ch01ex_2_9_20a">20</a>. $c_{mk}=k!{m\brace k}$, by Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-45">1.2.6–(45)</a>.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_21" id="ch01ex_2_9_21a">21</a>. We find $z^{2}G'(z)+zG(z)=G(z)-1$. The solution to this differential equation is $G(z)=(-1/z) e^{-1/z}(E_{1}(-1/z)+C)$, where $E_{1}(z)=\int_{z}^{\infty}e^{-t}\,dt/t$ and C is a constant. This function is very ill-behaved in the neighborhood of $z=0$, and $G(z)$ has no power series expansion. Indeed, since $\sqrt[n]{n!}\approx n/e$ is not bounded, the generating function does not converge in this case; it is, however, an asymptotic expansion for the stated function, when $z\lt 0$. [See K. Knopp, <em>Infinite Sequences and Series</em> (Dover, 1956), Section 66.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_22" id="ch01ex_2_9_22a">22</a>. $G(z)=(1+z)^{r}(1+z^{2})^{r}(1+z^{4})^{r}(1+z^{8})^{r}\ldots=(1-z)^{-r}$. It follows that the stated sum is $\mybinomf{r+n-1}{n}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_23" id="ch01ex_2_9_23a">23</a>. (a) When $m=1$ this is the binomial theorem, with $f_{1}(z)=z$ and $g_{1}(z)=1+z$. When $m≥1$ we can increase <em>m</em> by 1 if we replace $z_{m}$ by $z_{m}(1+z_{m+1}^{-1})$ and let $f_{m+1}(z_{1},\ldots,z_{m+1})=$ $z_{m+1}f_{m}(z_{1},\ldots,z_{m-1},z_{m}(1+z_{m+1}^{-1}))$, $g_{m+1}(z_{1},\ldots,z_{m+1})=$ $z_{m+1}g_{m}(z_{1},\ldots,z_{m-1},z_{m}(1+z_{m+1}^{-1}))$. Thus $g_{2}(z_{1},z_{2})=z_{1}+z_{2}+z_{1}z_{2}$ and</p>

  <div class="image"><img src="../Images/e498_11.png"></div>

  <p>Both polynomials $f_{m}$ and $g_{m}$ satisfy the same recurrence $f_{m}=z_{m}f_{m-1}+z_{m-1}f_{m-2}$, $g_{m}=z_{m}g_{m-1}+z_{m-1}g_{m-2}$, with the initial conditions $f_{-1}=0,f_{0}=g_{-1}=$ $g_{0}=z_{0}=1$. It follows that $g_{m}$ is the sum of all terms obtainable by starting with $z_{1}\ldots z_{m}$ and striking out zero or more nonadjacent factors; there are $F_{m+2}$ ways to do this. A similar interpretation applies to $f_{m}$, except that $z_{1}$ must remain. In part (b) we will encounter the polynomial $h_{m}=z_{m}g_{m-1}+z_{m-1}f_{m-2}$; this is the sum of all terms <a id="page_499"></a>obtained from $z_{1}\ldots z_{m}$ by striking out factors that are not <em>cyclically</em> adjacent. For example, $h_{3}=z_{1}z_{2}z_{3}+z_{1}z_{2}+z_{1}z_{3}+z_{2}z_{3}$.</p>

  <p class="indent">(b) By part (a), $S_{n}(z_{1},\ldots,z_{m-1},z)=[z_{m}^{n}]\sum_{r=0}^{n}z^{r}z_{m}^{n-r}f_{m}^{n-r}g_{m}^{r}$; hence</p>

  <div class="image"><img src="../Images/e499_02.png"></div>

  <p>where $a=z_{m}g_{m-1}$, $b=z_{m-1}g_{m-2}$, $c=z_{m}f_{m-1}$, $d=z_{m-1}f_{m-2}$. Multiplying this equation by $z^{n}$ and summing first on <em>n</em>, then on <em>r</em>, then on <em>s</em>, yields the closed form</p>

  <div class="image"><img src="../Images/e499_03.png"></div>

  <p>where $1-(a+d)z+(ad-bc)z^{2}=(1-ρz)(1-σz)$. Here $a+d=h_{m}$, and $ad-bc$ simplifies to $(-1)^{m}z_{1}\ldots z_{m}$. [We have, incidentally, established the recurrence $S_{n}=h_{m}S_{n-1}-(-1)^{m}z_{1}\ldots z_{m}S_{n-2}$, a relation that is not easy to derive without the help of generating functions.]</p>

  <p>(c) Let $ρ_{1}=(z+\sqrt{z^{2}+4z})/2$ and $σ_{1}=(z-\sqrt{z^{2}+4z})/2$ be the roots when $m=1$; then $ρ_{m}=ρ_{1}^{m}$ and $σ_{m}=σ_{1}^{m}$.</p>

  <p class="indent">Carlitz used this result to deduce a surprising fact: The characteristic polynomial $\det(xI-A)$ of the $n×n$ matrix</p>

  <div class="image"><img src="../Images/e499_08.png"></div>

  <p>of “right justified binomial coefficients” is $\sum_{k}\mybinomf{n}{k}_{\!\cal F}(-1)^{\lceil{(n-k)/2}\rceil}x^{k}$, with Fibonomial coefficients (see <a href="../Text/ch01a.html#ch01ex_2_8_30">exercise 1.2.8–30</a>). He also showed, using similar methods, that</p>

  <div class="image"><img src="../Images/e499_10.png"></div>

  <p>[<em>Collectanea Math.</em> <strong>27</strong> (1965), 281–296.]</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_24" id="ch01ex_2_9_24a">24</a>. Both sides are equal to $\sum_{k}\mybinomf{m}{k}[z^{n}](zG(z))^{k}$. When $G(z)=1/(1-z)$, the identity becomes $\sum_{k}\mybinomf{m}{k}\mybinomf{n-1}{n-k}=\mybinomf{m+n-1}{n}$, a case of 1.2.6–(<a href="../Text/ch01a.html#ch01eq-lev2sec6-21">21</a>). When $G(z)=(e^{z}-1)/z$, it becomes $\sum_{k}m^{\underline k}{n\brace k}=m^{n}$, Eq. <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec6-45">45</a>).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_25" id="ch01ex_2_9_25a">25</a>. $Σ_{k}[w^{k}](1-2w)^{n}[z^{n}]z^{k}(1+z)^{2n-2k}=$ $[z^{n}](1+z)^{2n}Σ_{k}[w^{k}](1-2w)^{n}(z/(1+z)^{2})^{k}$, which equals $[z^{n}](1+z)^{2n}(1-2z/(1+z)^{2})^{n}=$ $[z^{n}](1+z^{2})^{n}=\mybinomf{n}{n/2}[n\rm\;even]$. Similarly, we find $\sum_{k}\mybinomf{n}{k}\mybinomf{2n-2k}{n-k}(-4)^{k}=(-1)^{n}\mybinomf{2n}{n}$. Many examples of this summation technique can be found in G. P. Egorychev’s book <em>Integral Representation and the Computation of Combinatorial Sums</em> (Amer. Math. Soc., 1984), translated from the Russian edition of 1977.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_9_26" id="ch01ex_2_9_26a">26</a>. $[F(z)]G(z)$ denotes the constant term of $F(z^{-1})G(z)$. See the discussion by D. E. Knuth in <em>A Classical Mind</em> (Prentice–Hall, 1994), 247–258.</p>

  <h4 id="app01lev2sec10"><a id="page_500"></a>Section 1.2.10</h4>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_1" id="ch01ex_2_10_1a">1</a>. $G_{n}(0)=1/n$; this is the probability that $X[n]$ is the largest.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_2" id="ch01ex_2_10_2a">2</a>. $G''(1)=Σ_{k}k(k-1)p_{k}$, $G'(1)=Σ_{k}kp_{k}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_3" id="ch01ex_2_10_3a">3</a>. (min 0, ave 6.49, max 999, dev 2.42). Note that $H_{n}^{(2)}$ is approximately $π^{2}/6$; see Eq. <a href="../Text/ch01a.html#ch01lev2sec7">1.2.7</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec7-7">7</a>).</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_4" id="ch01ex_2_10_4a">4</a>. $\mybinomf{n}{k}p^{k}q^{n-k}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_5" id="ch01ex_2_10_5a">5</a>. The mean is $36/5=7.2$; the standard deviation is $6\sqrt{2}/5\approx1.697$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_6" id="ch01ex_2_10_6a">6</a>. For (<a href="../Text/ch01a.html#ch01eq-lev2sec10-18">18</a>), the formula</p>

  <p class="center">$\ln(q+pe^{t})=\ln\left(1+pt+\frac{pt^{2}}{2}+\frac{pt^{3}}{6}+\cdots\right)=pt+p(1-p)\frac{t^{2}}{2}+p(1-p)(1-2p)\frac{t^{3}}{6}+\cdots$</p>

  <p>tells us that $κ_{3}/n=p(1-p)(1-2p)=pq(q-p)$. (This nice pattern does not continue to the coefficient of $t^{4}$.) Setting $p=k^{-1}$ gives us $κ_3=\sum_{k=2}^{n}k^{-1}(1-k^{-1})(1-2k^{-1})=H_{n}-3H_{n}^{(2)}+2H_{n}^{(3)}$ in the case of distribution (<a href="../Text/ch01a.html#ch01eq-lev2sec10-8">8</a>). And for (<a href="../Text/ch01a.html#ch01eq-lev2sec10-20">20</a>), we have $\ln G(e^{t})=t+H(nt)-H(t)$ where $H(t)=\ln((e^{t}-1)/t)$. Since $H'(t)=e^{t}/(e^{t}-1)-1/t$, we have $κ_{r}=(n^{r}-1) B_{r}/r$ for all <em>r</em> ≥ 2 in this case; in particular, $κ_{3}=0$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_7" id="ch01ex_2_10_7a">7</a>. The probability that <em>A</em> = <em>k</em> is $p_{mk}$. For we may consider the values to be $1,2,\ldots,m$. Given any partitioning of the <em>n</em> positions into <em>m</em> disjoint sets, there are $m!$ ways to assign the numbers $1,\ldots,m$ to these sets. <a href="../Text/ch01a.html#ch01alg-lev2sec10-M">Algorithm M</a> treats these values as if only the rightmost element of each set were present; so $p_{mk}$ is the average for any fixed partitioning. For example, if <em>n</em> = 5, <em>m</em> = 3, one partition is</p>

  <p class="center">$\{X[1],X[4]\}$&nbsp;&nbsp;&nbsp;&nbsp;$\{X[2],X[5]\}$&nbsp;&nbsp;&nbsp;&nbsp;$\{X[3]\}$;</p>

  <p>the arrangements possible are 12312, 13213, 21321, 23123, 31231, 32132. In every partition we get the same percentage of arrangements with <em>A</em> = <em>k</em>.</p>

  <p class="indent">On the other hand, the probability distribution does change if more information is given. If <em>n</em> = 3 and <em>m</em> = 2, for example, our argument in the previous paragraph considers the six possibilities 122, 212, 221, 211, 121, 112; if we know that there are two 2s and one 1, then only the first three of these possibilities should be considered. But this interpretation is not consistent with the statement of the exercise.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_8" id="ch01ex_2_10_8a">8</a>. $M^{\underline n}/M^{n}$. The larger <em>M</em> is, the closer this probability gets to one.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_9" id="ch01ex_2_10_9a">9</a>. Let $q_{nm}$ be the probability that exactly <em>m</em> distinct values occur; then from the recurrence</p>

  <div class="image"><img src="../Images/e500_07.png"></div>

  <p>we deduce that</p>

  <div class="image"><img src="../Images/e500_08.png"></div>

  <p>See also <a href="../Text/ch01a.html#ch01ex_2_6_64">exercise 1.2.6–64</a>.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_10" id="ch01ex_3_10_10a">10</a>. This is $q_{nm}p_{mk}$ summed over all <em>m</em>, namely $M^{-n}\sum_{m}\mybinomf{M}{m}{n\brace m}{m\brack k+1}$. There does not appear to be a simple formula for the average, which is one less than</p>

  <div class="image"><img src="../Images/e500_10.png"></div>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_11" id="ch01ex_2_10_11a">11</a>. Since this is a product, we add the semi-invariants of each term. If $H (z)=z^{n}$, $H (e^{t})=e^{nt}$, so we find $κ_{1}=n$ and all others are zero. Therefore, mean(<em>F</em>) = <em>n</em> + <a id="page_501"></a>mean(<em>G</em>), and all other semi-invariants are unchanged. (This accounts for the name “semi-invariant.”)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_12" id="ch01ex_2_10_12a">12</a>. The first identity is obvious by writing out the power series for $e^{kt}$. For the second, let $u=1+M_{1}t+M_{2}t^{2}/2!+\cdots$; when <em>t</em> = 0 we have <em>u</em> = 1 and $D_{t}^{k}u=M_{k}$. Also, $D_{u}^{j}(\ln u)=(-1)^{j-1}(j-1)!/u^{j}$. By <a href="../Text/ch01a.html#ch01ex_2_10_11">exercise 11</a>, the same formula applies for central moments except that we leave out all terms with $k_{1}\gt 0$; thus $κ_{2}=m_{2}$, $κ_{3}=m_{3}$, $κ_{4}=m_{4}-3m_{2}^{2}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_13" id="ch01ex_2_10_13a">13</a>. $\displaystyle G_{n}(z)=\frac{\varGamma(n+z)}{\varGamma(z+1)n!}=\frac{e^{-z}(n+z)^{z-1}}{\varGamma(z+1)}\left(1+\frac{z}{n}\right)^{n}(1+O(n^{-1}))=\frac{n^{z-1}}{\varGamma(z+1)}(1+O(n^{-1}))$. Let $z_{n}=e^{it/σ_{n}}$. When $n→∞$ and <em>t</em> is fixed, we have $z_{n}→1$; hence $\varGamma(z_{n}+1)→1$, and</p>

  <div class="image"><img src="../Images/e501_05.png"></div>

  <p><em>Notes:</em> This is a theorem of Goncharov [<em>Izv. Akad. Nauk SSSR Ser. Math.</em> <strong>8</strong> (1944), 3–48]. P. Flajolet and M. Soria [<em>Disc. Math.</em> <strong>114</strong> (1993), 159–180] have extended the analysis to show that $G_{n}(z)$ and a large family of related distributions not only are approximately normal near their mean values, they also have uniformly exponential tails, in the sense that</p>

  <div class="image"><img src="../Images/e501_06.png"></div>

  <p>for some positive constant <em>a</em> and for all <em>n</em> and <em>x</em>.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_14" id="ch01ex_2_10_14a">14</a>. $e^{-itpn/\sqrt{pqn}}(q+pe^{it/\sqrt{pqn}})^{n}=(qe^{-itp/\sqrt{pqn}}+pe^{itq/\sqrt{pqn}})^{n}$. Expand the exponentials in power series, to get $(1-t^{2}/2n+O(n^{-3/2}))^{n}=\exp(n\ln(1-t^{2}/2n+O(n^{-3/2})))=\exp(-t^{2}/2+O(n^{-1/2}))→\exp(-t^{2}/2)$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_15" id="ch01ex_2_10_15a">15</a>. (a)$\sum_{k\ge0}e^{-μ}(μz)^{k}/k!=e^{μ(z-1)}$. (b) $\ln e^{μ(e^{t}-1)}=μ(e^{t}-1)$, so all semi-invariants equal <em>μ</em>. (c) $\exp(-itnp/\sqrt{np})\exp(np(it/\sqrt{np}-t^{2}/(2np)+O(n^{-3/2})))=$ $\exp(-t^{2}/2+O(n^{-1/2}))$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_16" id="ch01ex_2_10_16a">16</a>. $g(z)=∑_{k}p_{k}g_{k}(z)$; ${\rm mean}(g)=∑_{k}p_{k}\,{\rm mean}(g_{k})$; and ${\rm var}(g)=∑_{k}p_{k}\,{\rm var}(g_{k})+∑_{j\lt k}p_{j}p_{k}({\rm mean}(g_{j})-{\rm mean}(g_{k}))^{2}$.</p>

  <p><strong><a href="../Text/ch01a.html#ch01ex_2_10_17" id="ch01ex_2_10_17a">17</a></strong>. (a) The coefficients of $f(z)$ and $g(z)$ are nonnegative, and $f(1)=g(1)=1$. Clearly $h(z)$ shares these same characteristics, since $h(1)=g(f(1))$, and the coefficients of <em>h</em> are polynomials in those of $f$ and <em>g</em>, with nonnegative coefficients.</p>

  <p class="indent">(b) Let $f(z)=∑p_{k}z^{k}$ where $p_{k}$ is the probability that some event yields a “score” of <em>k</em>. Let $g(z)=∑q_{k}z^{k}$ where $q_{k}$ is the probability that the event described by $f$ happens exactly <em>k</em> times (each occurrence of the event being independent of the others). Then $h(z)=∑r_{k}z^{k}$, where $r_{k}$ is the probability that the sum of the scores of the events that occurred is equal to <em>k</em>. (This is easy to see if we observe that $f(z)^{k}=∑s_{t}z^{t}$, where $s_{t}$ is the probability that a total score <em>t</em> is obtained in <em>k</em> independent occurrences of the event.) <em>Example:</em> If $f$ gives the probabilities that a woman has <em>k</em> female offspring, and if <em>g</em> gives the probabilities that there are <em>k</em> females in the <em>n</em>th generation, then <em>h</em> gives the probabilities that there are <em>k</em> females in the (<em>n</em> + 1)st generation, assuming independence.</p>

  <p class="indent">(c) ${\rm mean}(h)={\rm mean}(g)\,{\rm mean}(f)$; ${\rm var}(h)={\rm var}(g)\,{\rm mean}^{2}(f)+{\rm mean}(g)\,{\rm var}(f)$.</p>

  <p><a id="page_502"></a><a href="../Text/ch01a.html#ch01ex_2_10_18" id="ch01ex_2_10_18a">18</a>. Consider the choice of $X[1],\ldots,X[n]$ as a process in which we first place all the <em>n</em>’s, then place all the (<em>n</em> − 1)’s among these $n\unicode{39}\rm s,\ldots,$ finally place the ones among the rest. As we place the <em>r</em>’s among the numbers $\{r+1,\ldots,n\}$, the number of local maxima from right to left increases by one if and only if we put an <em>r</em> at the extreme right. This happens with probability $k_{r}/(k_{r}+k_{r+1}+\cdots+k_{n})$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_19" id="ch01ex_2_10_19a">19</a>. Let $a_{k}=l$. Then $a_{k}$ is a left-to-right maximum of $a_{1}\ldots a_{n}⇔j\lt k$ implies $a_{j}\lt l⇔a_{j}\gt l$ implies $j\gt k⇔j\gt l$ implies $b_{j}\gt k⇔k$ is a right-to-left minimum of $b_{1}\ldots b_{n}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_20" id="ch01ex_2_10_20a">20</a>. We have $m_{L}=\max\{a_{1}-b_{1},\ldots,a_{n}-b_{n}\}$. <em>Proof:</em> If not, let <em>k</em> be the smallest subscript such that $a_{k}-b_{k}\gt m_{L}$. Then $a_{k}$ is not a left-to-right maximum, so there is a <em>j</em> &lt; <em>k</em> with $a_{j}≥a_{k}$. But then $a_{j}-b_{j}≥a_{k}-b_{k}\gt m_{L}$, contradicting the minimality of <em>k</em>. Similarly, $m_{R}=\max\{b_{1}-a_{1},\ldots,b_{n}-a_{n}\}$.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_21" id="ch01ex_2_10_21a">21</a>. The result is trivial when $\epsilon≥q$, so we may assume that $\epsilon\lt q$. Setting $x=\frac{p+\epsilon}{p}\frac{q}{q-\epsilon}$ in (<a href="../Text/ch01a.html#ch01eq-lev2sec10-25">25</a>) gives $\Pr(X\ge n(p+\epsilon))\le((\frac{p}{p+\epsilon})^{p+\epsilon}(\frac{q}{q-\epsilon})^{q-\epsilon})^{n}$. Now $(\frac{p}{p+\epsilon})^{p+\epsilon}\le e^{-\epsilon}$ since $t≤e^{t-1}$ for all real <em>t</em>. And $(q-\epsilon)\ln\frac{q}{q-\epsilon}=\epsilon-\frac{1}{2\cdot1}\epsilon^{2}q^{-1}-\frac{1}{3\cdot2}\epsilon^{3}q^{-2}-\cdots≤\epsilon-\frac{1}{2q}\epsilon^{2}$. (A more detailed analysis yields the slightly stronger estimate $\exp(-\epsilon^{2}n/(2pq))$ when $p\ge\frac12$; still further work yields the upper bound $\exp(-2\epsilon^{2}n)$ for all <em>p</em>.)</p>

  <p class="indent">By reversing the roles of heads and tails we find</p>

  <p class="center">$\Pr(X≤n(p-\epsilon))=\Pr(n-X≥n(q+\epsilon))≤e^{-\epsilon^{2}n/(2p)}$.</p>

  <p>(One should not confuse “tails” with the tail of a probability distribution.)</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_22" id="ch01ex_2_10_22a">22</a>. (a) Set <em>x</em> = <em>r</em> in (<a href="../Text/ch01a.html#ch01eq-lev2sec10-24">24</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec10-25">25</a>), and note that $q_{k}+p_{k}r=1+(r-1)p_{k}≤e^{(r-1)p_{k}}$. [See H. Chernoff, <em>Annals of Math. Stat.</em> <strong>23</strong> (1952), 493–507.]</p>

  <p class="indent">(b) Let $r=1+δ$ where $|δ|≤1$. Then $r^{-r}e^{r-1}=\exp(-\frac{1}{2\cdot1}\delta^{2}+\frac{1}{3\cdot2}\delta^{3}-\cdots)$, which is $≤e^{-δ^{2}/2}$ when δ ≤ 0 and $≤e^{-δ^{2}/3}$ when δ ≥ 0.</p>

  <p class="indent">(c) The function $r^{-1}e^{1-1/r}$ decreases from 1 to 0 as <em>r</em> increases from 1 to ∞. If <em>r</em> ≥ 2 it is $≤e^{1/2}/2\lt .825$; if $r≥4.32$ it is $\lt 1/2$.</p>

  <p class="indent">Incidentally, the tail inequalities with <em>x</em> = <em>r</em> give precisely the same estimate $(r^{-r}e^{r-1})^{μ}$ when <em>X</em> has the Poisson distribution of <a href="../Text/ch01a.html#ch01ex_2_10_15">exercise 15</a>.</p>

  <p><a href="../Text/ch01a.html#ch01ex_2_10_23" id="ch01ex_2_10_23a">23</a>. Setting $x=\frac{p-\epsilon}{p}\frac{q}{q-\epsilon}$ in (<a href="../Text/ch01a.html#ch01eq-lev2sec10-24">24</a>) gives $\Pr(X≤n(p-\epsilon))≤((\frac{p}{p-\epsilon})^{p-\epsilon}(\frac{q-\epsilon}{q})^{q-\epsilon})^{n}≤e^{-\epsilon^{2}n/(2pq)}$. Similarly, $x=\frac{p+\epsilon}{p}\frac{q}{q+\epsilon}$ yields $\Pr(X\ge n(p+\epsilon))≤((\frac{p}{p+\epsilon})^{p+\epsilon}(\frac{q+\epsilon}{q})^{q+\epsilon})^{n}$. Let $f(\epsilon)=(q+\epsilon)\ln(1+\frac{\epsilon}{q})-(p+\epsilon)\ln(1+\frac{\epsilon}{p})$, and note that $f'(\epsilon)=\ln(1+\frac{\epsilon}{q})-\ln(1+\frac{\epsilon}{p})$. It follows that $f(\epsilon)≤-\epsilon^{2}/(6pq)$ if $0≤\epsilon≤p$.</p>

  <h5 id="app01lev3sec1">Section 1.2.11.1</h5>

  <p><a href="../Text/ch01b.html#ch01ex_3_1_1" id="ch01ex_3_1_1a">1</a>. Zero.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_1_2" id="ch01ex_3_1_2a">2</a>. Each <em>O</em>-symbol represents a different approximate quantity; since the left-hand side might be $f(n)-(-f(n))=2f(n)$, the best we can say is $O(f(n))-O(f(n))=O(f(n))$, which follows from (<a href="../Text/ch01a.html#ch01eq-lev3sec1-6">6</a>) and (<a href="../Text/ch01a.html#ch01eq-lev3sec1-7">7</a>). To prove (<a href="../Text/ch01a.html#ch01eq-lev3sec1-7">7</a>), note that if $|x_{n}|≤M|f(n)|$ for $n≥n_{0}$ and $|x'_n|≤M'|f(n)|$ for $n≥n'_{0}$, then $|x_{n}\pm x'_n|≤|x_n|+|x'_n|≤(M+M')|f(n)|$ for $n≥\max(n_{0},n'_{0})$. (Signed, J. H. Quick, student.)</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_1_3" id="ch01ex_3_1_3a">3</a>. $n(\ln n)+\gamma n+O(\sqrt{n}\ln n)$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_1_4" id="ch01ex_3_1_4a">4</a>. $\ln a+(\ln a)^{2}/2n+(\ln a)^{3}/6n^{2}+O(n^{-3})$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_1_5" id="ch01ex_3_1_5a">5</a>. If $f(n)=n^{2}$ and $g(n)=1$, then <em>n</em> belongs to the set $O(f(n)+g(n))$ but not to the set $f(n)+O(g(n))$. So the statement is false.</p>

  <p><a id="page_503"></a><a href="../Text/ch01b.html#ch01ex_3_1_6" id="ch01ex_3_1_6a">6</a>. A variable number, <em>n</em>, of <em>O</em>-symbols has been replaced by a single <em>O</em>-symbol, falsely implying that a single value of <em>M</em> will suffice for each term $|kn|≤Mn$. The given sum is actually $Θ(n^{3})$, as we know. The last equality, $\sum_{k=1}^{n}O(n)=O(n^{2})$, is perfectly valid.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_1_7" id="ch01ex_3_1_7a">7</a>. If <em>x</em> is positive, the power series <a href="../Text/ch01a.html#ch01lev2sec9">1.2.9</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec9-22">22</a>) tells us that $e^{x}\gt x^{m+1}/(m+1)!$; hence the ratio of $e^{x}/x^{m}$ is unbounded by any <em>M</em>.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_1_8" id="ch01ex_3_1_8a">8</a>. Replace <em>n</em> by $e^{n}$ and apply the method of the previous exercise.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_1_9" id="ch01ex_3_1_9a">9</a>. If $|f(z)|≤M|z|^{m}$ for $|z|≤r$, then $|e^{f(z)}|≤e^{M|z|^{m}}=1+|z|^{m}(M+M^{2}|z|^{m}/2!+$ $M^{3}|z|^{2m}/3!+\cdots)≤$ $1+|z|^{m}(M+M^{2}r^{m}/2!+M^{3}r^{2m}/3!+\cdots)$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_1_10" id="ch01ex_3_1_10a">10</a>. $\ln(1+O(z^{m}))=O(z^{m})$, if <em>m</em> is a positive integer. <em>Proof:</em> If $f(z)=O(z^{m})$, there exist positive numbers <em>r</em> &lt; 1, <em>r</em>′ &lt; 1, and a constant <em>M</em> such that $|f(z)|≤M|z|^{m}≤r'$ when $|z|≤r$. Then $|\ln(1+f(z))|\le|f(z)|+$ $\frac12|f(z)|^{2}+\cdots\le|z|^{m}M(1+\frac{1}{2}r'+\cdots)$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_1_11" id="ch01ex_3_1_11a">11</a>. We can apply Eq. (<a href="../Text/ch01a.html#ch01eq-lev3sec1-12">12</a>) with <em>m</em> = 1 and $z=\ln n/n$. This is justified since $\ln n/n≤r$ for any given <em>r</em> &gt; 0, when <em>n</em> is sufficiently large.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_1_12" id="ch01ex_3_1_12a">12</a>. Let $f(z)=(ze^{z}/(e^{z}-1))^{1/2}$. If ${1/2}\brack{1/2-k}$ were $O(n^{k})$, the stated identity would show that $[z^{k}]f(z)=O(n^{k}/(k-1)!)$, so $f(z)$ would converge when $z=2πi$. But $f(2πi)=∞$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_1_13" id="ch01ex_3_1_13a">13</a>. <em>Proof:</em> We may take $L=1/M$ in the definitions of <em>O</em> and <em>Ω</em>.</p>

  <h5 id="app01lev3sec2">Section 1.2.11.2</h5>

  <p><a href="../Text/ch01b.html#ch01ex_3_2_1" id="ch01ex_3_2_1a">1</a>. $(B_{0}+B_{1}z+B_{2}z^{2}/2!+\cdots) e^{z}=(B_{0}+B_{1}z+B_{2}z^{2}/2!+\cdots)+z$; apply Eq. <a href="../Text/ch01a.html#ch01lev2sec9">1.2.9</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec9-11">11</a>).</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_2_2" id="ch01ex_3_2_2a">2</a>. The function $B_{m+1}(\{x\})$ must be continuous, for the integration by parts.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_2_3" id="ch01ex_3_2_3a">3</a>. $|R_{mn}|\le|B_m/(m)!|\int_{1}^{n}|f^{(m)}(x)|\,dx$. [<em>Notes:</em> We have $B_{m}(x)=(-1)^{m}B_{m}(1-x)$, and $B_{m}(x)$ is $m!$ times the coefficient of $z^{m}$ in $ze^{xz}/(e^{z}-1)$. In particular, since $e^{z/2}/(e^{z}-1)=1/(e^{z/2}-1)-1/(e^{z}-1)$ we have $B_{m}(\frac12)=(2^{1-m}-1)B_{m}$. It is not difficult to prove that the maximum of $|B_{m}-B_{m}(x)|$ for $0≤x≤1$ occurs at $x=\frac{1}{2}$ when <em>m</em> is even. Now when $m=2k≥4$, let us write simply $R_{m}$ and $C_{m}$ for the quantities $R_{mn}$ and $C_{mn}$. We have $R_{m-2}=C_{m}+R_{m}=\int_{1}^{n}(B_{m}-B_{m}(\{x\}))f^{(m)}(x)\,dx/m!$, and $B_{m}-B_{m}(\{x\})$ is between 0 and $(2-2^{1-m})B_{m}$; hence $R_{m-2}$ lies between 0 and $(2-2^{1-m})C_{m}$. It follows that $R_{m}$ lies between $-C_{m}$ and $(1-2^{1-m})C_{m}$, a slightly stronger result. According to this argument we see that if $f^{(m+2)}(x)f^{(m+4)}(x)\gt 0$ for $1\lt x\lt n$, the quantities $C_{m+2}$ and $C_{m+4}$ have opposite signs, while $R_{m}$ has the sign of $C_{m+2}$ and $R_{m+2}$ has the sign of $C_{m+4}$ and $|R_{m+2}|≤|C_{m+2}|$; this proves (<a href="../Text/ch01b.html#ch01eq-lev3sec2-13">13</a>). See J. F. Steffensen, <em>Interpolation</em> (Baltimore: 1927),§14.]</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_2_4" id="ch01ex_3_2_4a">4</a>. $\sum\limits_{0\le k\lt n}k^{m}=\frac{n^{m+1}}{1+m}+\sum\limits_{k=1}^{m}\frac{B_k}{k!}\frac{m!}{(m-k+1)!}n^{m-k+1}=$ $\frac{1}{m+1}B_{m+1}(n)-\frac{1}{m+1}B_{m+1}$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_2_5" id="ch01ex_3_2_5a">5</a>. It follows that</p>

  <div class="image"><img src="../Images/e503_09.png"></div>

  <p><a href="../Text/ch01b.html#ch01ex_3_2_6" id="ch01ex_3_2_6a">6</a>. Assume that $c\gt 0$ and consider $∑_{0≤k\lt n}\ln(k+c)$. We find</p>

  <div class="image"><img src="../Images/e503_10.png"></div>

  <p><a id="page_504"></a>Also</p>

  <div class="image"><img src="../Images/e504_01.png"></div>

  <p>Now $\ln \varGamma_{n-1}(c)=c\ln(n-1)+\ln(n-1)!-\ln(c\ldots(c+n-1))$; substituting and letting $n→∞$, we get</p>

  <div class="image"><img src="../Images/e504_02.png"></div>

  <p>This shows that $\varGamma(c+1)=ce^{\ln \varGamma(c)}$ has the same expansion we derived for <em>c</em>!.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_2_7" id="ch01ex_3_2_7a">7</a>. $A\,n^{n^{2}/2+n/2+1/12}e^{-n^{2}/4}$ where <em>A</em> is a constant. To obtain this result, apply Euler’s summation formula to $\sum_{k=1}^{n-1}k\ln k$. A more accurate formula is obtained if we multiply the answer above by</p>

  <p class="center">$\exp(-B_{4}/(2·3·4n^{2})-\cdots-B_{2t}/((2t-2)(2t-1)(2t)n^{2t-2})+O(1/n^{2t}))$.</p>

  <p>In these formulas, <em>A</em> is the “Kinkelin–Glaisher constant” 1.2824271… [<em>Crelle</em> <strong>57</strong> (1860), 122–158; <em>Messenger of Math.</em> <strong>7</strong> (1877), 43–47], which can be shown to equal $e^{1/12-\zeta'(-1)}=(2πe^{γ-\zeta'(2)/\zeta(2)})^{1/12}$ [de Bruijn, <em>Asymptotic Methods in Analysis</em>,§3.7].</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_2_8" id="ch01ex_3_2_8a">8</a>. We have, for example, $\ln(an^{2}+bn)=2\ln n+\ln a+\ln(1+b/(an))$. Thus the answer to the first question is found to be $2an^{2}\ln n+a(\ln a-1)n^{2}+2bn\ln n+bn\ln a+\ln n+b^{2}/(2a)+\frac12\ln a+σ+(3a-b^{2})b/(6a^{2}n)+O(n^{-2})$. Massive cancellation occurs when we compute the quantity $\ln(cn^{2})!-\ln (cn^{2}-n)!-n\ln c-\ln n^{2}!+\ln(n^{2}-n)!=$ $(c-1)/(2c)-(c-1)(2c-1)/(6c^{2}n)+O(n^{-2})$. The answer is therefore</p>

  <div class="image"><img src="../Images/e504_05.png"></div>

  <p>Incidentally, $\mybinomf{cn^{2}}{n}/{\big(}c^{n}\mybinomf{n^{2}}{n}{\big)}$ can be written $\prod_{j=1}^{n-1}(1+\alpha j/(n^{2}-j))$ where $α=1-1/c$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_2_9" id="ch01ex_3_2_9a">9</a>. (a) We have $\ln(2n)!=(2n+\frac12)\ln 2n-2n+\sigma+\frac{1}{24n}+O(n^{-3})$, and $\ln(n!)^{2}=(2n+1)\ln n-2n+2\sigma+\frac{1}{6n}+O(n^{-3})$; hence $\mybinomf{2n}{n}=\exp(2n\ln 2-\frac12\ln\pi n-\frac{1}{8n}+O(n^{-3}))=$ $2^{2n}(\pi n)^{-1/2}(1-\frac{1}{8}n^{-1}+\frac{1}{128}n^{-2}+O(n^{-3}))$. (b) Since $\mybinomf{2n}{n}=2^{2n}\mybinomf{n-1/2}{n}$ and $\mybinomf{n-1/2}{n}=\varGamma(n+1/2)/(n\varGamma(n)\varGamma(1/2))=$ $n^{-1}n^{\overline{1/2}}/\sqrt{\pi}$, we obtain the same result from <a href="../Text/ch01a.html#ch01lev3sec1">1.2.11.1</a>–(<a href="../Text/ch01b.html#ch01eq-lev3sec2-16">16</a>) because</p>

  <div class="image"><img src="../Images/e504_13.png"></div>

  <p>Method (b) explains why the denominators in</p>

  <div class="image"><img src="../Images/e504_14.png"></div>

  <p>are all powers of 2 [Knuth and Vardi, <em>AMM</em> <strong>97</strong> (1990), 629–630].</p>

  <h5 id="app01lev3sec3">Section 1.2.11.3</h5>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_1" id="ch01ex_3_3_1a">1</a>. Integrate by parts.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_2" id="ch01ex_3_3_2a">2</a>. Substitute the series for $e^{-t}$ in the integral.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_3" id="ch01ex_3_3_3a">3</a>. See Eq. <a href="../Text/ch01a.html#ch01ex_2_6_48">exercise 1.2.6–48</a>.</p>

  <p><a id="page_505"></a><a href="../Text/ch01b.html#ch01ex_3_3_4" id="ch01ex_3_3_4a">4</a>. $1+1/u$ is bounded as a function of <em>v</em>, since it goes to zero as <em>v</em> goes from <em>r</em> to infinity. Replace it by <em>M</em> and the resulting integral is $Me^{-rx}$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_5" id="ch01ex_3_3_5a">5</a>. $f''(x)=f(x)((n+1/2)(n-1/2)/x^{2}-(2n+1)/x+1)$ changes sign at the point $r=n+1/2-\sqrt{n+1/2}$, so $|R|=O(\int_{0}^{n}|f''(x)|\,dx)=$ $O(\int_{0}^{r}f''(x)\,dx-\int_{r}^{n}f''(x)\,dx)=$ $O(f'(n)-2f'(r)+f'(0))=$ $O(f(n)/\sqrt{n})$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_6" id="ch01ex_3_3_6a">6</a>. It is $n^{n+β}\exp((n+β)(α/n-α^{2}/2n^{2}+O(n^{-3})))$, etc.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_7" id="ch01ex_3_3_7a">7</a>. The integrand as a power series in $x^{-1}$ has the coefficient of $x^{-n}$ as $O(u^{2n})$. After integration, terms in $x^{-3}$ are $Cu^{7}/x^{3}=O(x^{-5/4})$, etc. To get $O(x^{-2})$ in the answer, we can discard terms $u^{n}/x^{m}$ with $4m-n≥9$. Thus, an expansion of the product $\exp(-u^{2}/2x)\exp(u^{3}/3x^{2})\ldots$ leads ultimately to the answer</p>

  <div class="image"><img src="../Images/e505_02.png"></div>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_8" id="ch01ex_3_3_8a">8</a>. (Solution by Miklós Simonovits.) We have $|f(x)|\lt x$ if <em>x</em> is large enough. Let $R(x)=\int_{0}^{f(x)}(e^{-g(u,x)}-e^{-h(u,x)})du$ be the difference between the two given integrals, where $g(u,x)=u-x\ln(1+u/x)$ and $h(u,x)=u^{2}/2x-u^{3}/3x^{2}+\cdots+(-1)^{m}u^{m}/mx^{m-1}$. Notice that $g(u,x)≥0$ and $h(u,x)≥0$ when $|u|\lt x$; also $g(u,x)=h(u,x)+O(u^{m+1}/x^{m})$.</p>

  <p class="indent">According to the mean value theorem, $e^{a}-e^{b}=(a-b) e^{c}$ for some <em>c</em> between <em>a</em> and <em>b</em>. Therefore $|e^{a}-e^{b}|≤|a-b|$ when <em>a</em>, <em>b</em> ≤ 0. It follows that</p>

  <div class="image"><img src="../Images/e505_04.png"></div>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_9" id="ch01ex_3_3_9a">9</a>. We may assume that <em>p</em> ≠ 1, since <em>p</em> = 1 is given by <a href="../Text/ch02b.html#ch02b_the_a">Theorem A</a>. We also assume that <em>p</em> ≠ 0, since the case <em>p</em> = 0 is trivial.</p>

  <p class="indent"><em>Case 1:</em> <em>p</em> &lt; 1. Substitute $t=px(1-u)$ and then $v=-\ln(1-u)-pu$. We have $dv=((1-p+pu)/(1-u))du$, so the transformation is monotone for 0 ≤ <em>u</em> ≤ 1, and we obtain an integral of the form</p>

  <div class="image"><img src="../Images/e505_05.png"></div>

  <p>Since the parenthesized quantity is $(1-p)^{-1}(1-v(1-p)^{-2}+\cdots)$, the answer is</p>

  <div class="image"><img src="../Images/e505_06.png"></div>

  <p class="indent"><em>Case 2:</em> <em>p</em> &gt; 1. This is $1-\int_{px}^{\infty}(\;)$. In the latter integral, substitute $t=px(1+u)$, then $v=pu-\ln(1+u)$, and proceed as in Case 1. The answer turns out to be the same formula as Case 1, plus one. Notice that $pe^{1-p}\lt 1$, so $(pe^{1-p})^{x}$ is <em>very</em> small.</p>

  <p class="indent">The answer to <a href="../Text/ch01b.html#ch01ex_3_3_11">exercise 11</a> gives another way to solve this problem.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_10" id="ch01ex_3_3_10a">10</a>. $\frac{p}{p-1}(pe^{1-p})^{x}e^{-x}x^{x}\left(1-e^{-y}-\frac{e^{-y}(e^{y}-1-y-y^{2}/2)}{x(p-1)^{2}}+O(x^{-2})\right)$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_11" id="ch01ex_3_3_11a">11</a>. First, $xQ_{x}(n)+R_{1/x}(n)=n!\,(x/n)^{n}e^{n/x}$ generalizes (<a href="../Text/ch01b.html#ch01eq-lev3sec3-4">4</a>). Next, we have $R_{x}(n)=n!\,(e^{x}/nx)^{n}γ(n,nx)/(n-1)!$, generalizing (<a href="../Text/ch01b.html#ch01eq-lev3sec3-9">9</a>). Since $aγ(a,x)=γ(a+1,x)+e^{-x}x^{a}$ we can also write $R_{x}(n)=1+(e^{x}/nx)^{n}γ(n+1,nx)$, relating this problem to <a href="../Text/ch01b.html#ch01ex_3_3_9">exercise 9</a>.</p>

  <p><a id="page_506"></a>Moreover, we can tackle $Q_{x}(n)$ and $R_{x}(n)$ directly by using Eqs. <a href="../Text/ch01a.html#ch01lev2sec9">1.2.9</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec9-27">27</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec9-27">28</a>) to derive series expansions involving Stirling numbers:</p>

  <div class="image"><img src="../Images/e506_01.png"></div>

  <p>The sums over <em>k</em> are convergent for fixed <em>m</em> when $|x|\lt 1$, and when $|x|\gt 1$ we can use the relation between $Q_{x}(n)$ and $R_{1/x}(n)$; this leads to the formulas</p>

  <div class="image"><img src="../Images/e506_02.png"></div>

  <p>Here</p>

  <div class="image"><img src="../Images/e506_03.png"></div>

  <p>and</p>

  <div class="image"><img src="../Images/e506_04.png"></div>

  <p>are polynomials whose coefficients are “second-order Eulerian numbers” [<em>CMath</em> §6.2; see L. Carlitz, <em>Proc. Amer. Math. Soc.</em> <strong>16</strong> (1965), 248–252]. The case $x=-1$ is somewhat delicate, but it can be handled by continuity, because the bound implied by $O(n^{-1-m})$ is independent of <em>x</em> when $x\lt 0$. It is interesting to note that $R_{-1}(n)-Q_{-1}(n)=(-1)^{n}n!/(e^{n}n^{n})\approx(-1)^{n}\sqrt{2\pi n}/e^{2n}$ is extremely small.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_12" id="ch01ex_3_3_12a">12</a>. $γ(\frac{1}{2},\frac{1}{2}x^{2})/\sqrt{2}$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_13" id="ch01ex_3_3_13a">13</a>. See P. Flajolet, P. Grabner, P. Kirschenhofer, and H. Prodinger, <em>J. Computational and Applied Math.</em> <strong>58</strong> (1995), 103–116.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_15" id="ch01ex_3_3_15a">15</a>. Expanding the integrand by the binomial theorem, we obtain $1+Q(n)$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_16" id="ch01ex_3_3_16a">16</a>. Write $Q(k)$ as a sum, and interchange the order of summation using Eq. <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec6-53">53</a>).</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_17" id="ch01ex_3_3_17a">17</a>. $S(n)=\sqrt{\pi n/2}+\frac{2}{3}-\frac{1}{24}\sqrt{\pi/2n}-$ $\frac{4}{135}n^{-1}+\frac{49}{1152}\sqrt{\pi/2n^{3}}+O(n^{-2})$. [Note that $S(n+1)+P(n)=∑_{k≥0}k^{n-k}k!/n!$, while $Q(n)+R(n)=∑_{k≥0}n!/k!\,n^{n-k}$.]</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_18" id="ch01ex_3_3_18a">18</a>. Let $S_{n}(x,y)=∑_{k}\mybinomf{n}{k}(x+k)^{k}(y+n-k)^{n-k}$. Then for $n\gt 0$ we have $S_{n}(x,y)=x∑_{k}\mybinomf{n}{k}(x+k)^{k-1}(y+n-k)^{n-k}+$ $n∑_{k}\mybinomf{n-1}{k}(x+1+k)^{k}(y+n-1-k)^{n-1-k}=$ $(x+y+n)^{n}+nS_{n-1}(x+1,y)$ by Abel’s formula <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec6-16">16</a>); consequently $S_{n}(x,y)=∑_{k}\mybinomf{n}{k}k!\,(x+y+n)^{n-k}$. [This formula is due to Cauchy, who proved it using the calculus of residues; see his Œuvres (2) 6, 62–73.] The stated sums are therefore equal respectively to $n^{n}(1+Q(n))$ and $(n+1)^{n}Q(n+1)$.</p>

  <p><a id="page_507"></a><a href="../Text/ch01b.html#ch01ex_3_3_19" id="ch01ex_3_3_19a">19</a>. Suppose $C_{n}$ exists for all $n≥N$ and $|f(x)|≤Mx^{α}$ for $0≤x≤r$. Let $F(x)=\int_{r}^{x}e^{-Nt}f(t)\,dt$. Then when $n\gt N$ we have</p>

  <div class="image"><img src="../Images/e507_02.png"></div>

  <p>[E. W. Barnes, <em>Phil. Trans.</em> <strong>A206</strong> (1906), 249–297; G. N. Watson, <em>Proc. London Math. Soc.</em> <strong>17</strong> (1918), 116–148.]</p>

  <p><a href="../Text/ch01b.html#ch01ex_3_3_20" id="ch01ex_3_3_20a">20</a>. [C. C. Rousseau, <em>Applied Math. Letters</em> <strong>2</strong> (1989), 159–161.] We have $Q(n)+1=n\int_{0}^{\infty}e^{-nx}(1+x)^{n}\,dx=$ $n\int_{0}^{\infty}e^{-n(x-\ln(1+x))}\,dx=n\int_{0}^{\infty}e^{-nu}g(u)\,du$, by substituting $u=x-\ln(1+x)$ and letting $g(u)=dx/du$. Notice that $x=\sum_{k=1}^{\infty}c_{k}(2u)^{k/2}$ when <em>u</em> is sufficiently small. Hence $g(u)=\sum_{k=1}^{m-1}kc_{k}(2u)^{k/2-1}+O(u^{m/2-1})$, and we can apply Watson’s lemma to $Q(n)+1-n\int_{0}^{\infty}e^{-nu}\sum_{k=1}^{m-1}kc_{k}(2u)^{k/2-1}\,du$.</p>

  <h4 id="app01lev2sec11">Section 1.3.1</h4>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_1" id="ch01ex_2_12_1a">1</a>. Four; each byte would then contain $3^{4}=81$ different values.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_2" id="ch01ex_2_12_2a">2</a>. Five, since five bytes is always adequate but four is not.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_3" id="ch01ex_2_12_3a">3</a>. $(0{\colon}2)$; $(3{\colon}3)$; $(4{\colon}4)$; $(5{\colon}5)$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_4" id="ch01ex_2_12_4a">4</a>. Presumably index register 4 contains a value greater than or equal to 2000, so that a valid memory address results after indexing.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_5" id="ch01ex_2_12_5a">5</a>. ‘<code>DIV -80,3(0:5)</code>’ or simply ‘<code>DIV -80,3</code>’.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_6" id="ch01ex_2_12_6a">6</a>.&nbsp;&nbsp;&nbsp;(a) <span class="middle"><img src="../Images/e507_07.png"></span>.</p>

  <p class="indent">(b) ${\rm rI2}←-200$.</p>

  <p class="indent">(c) <span class="middle"><img src="../Images/e507_08.png"></span>.</p>

  <p class="indent">(d) Undefined; we can’t load such a big value into an index register.</p>

  <p class="indent">(e) <span class="middle"><img src="../Images/e507_09.png"></span>.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_7" id="ch01ex_2_12_7a">7</a>. Let $n=\rm|rAX|$ be the magnitude of registers A and X before the operation, and let $d=\rm|V|$ be the magnitude of the divisor. After the operation the magnitude of rA is $\lfloor{n/d}\rfloor$, and the magnitude of rX is $n\bmod d$. The sign of rX afterwards is the previous sign of rA; the sign of rA afterwards is + if the previous signs of rA and V were the same, otherwise it is −.</p>

  <p class="indent">Stating this another way: If the signs of rA and V are the same, $\rm rA←\lfloor{rAX/V}\rfloor$ and $\rm rX←rAX\bmod V$. Otherwise $\rm rA←\lceil{rAX/V}\rceil$ and $\rm rX←rAX\bmod-V$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_8" id="ch01ex_2_12_8a">8</a>. <span class="middle"><img src="../Images/e507_10.png"></span>; <span class="middle"><img src="../Images/e507_11.png"></span>.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_9" id="ch01ex_2_12_9a">9</a>. <code>ADD</code>, <code>SUB</code>, <code>DIV</code>, <code>NUM</code>, <code>JOV</code>, <code>JNOV</code>, <code>INCA</code>, <code>DECA</code>, <code>INCX</code>, <code>DECX</code>.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_10" id="ch01ex_2_12_10a">10</a>. <code>CMPA</code>, <code>CMP1</code>, <code>CMP2</code>, <code>CMP3</code>, <code>CMP4</code>, <code>CMP5</code>, <code>CMP6</code>, <code>CMPX</code>. (Also <code>FCMP</code>, for floating point.)</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_11" id="ch01ex_2_12_11a">11</a>. <code>MOVE</code>, <code>LD1</code>, <code>LD1N</code>, <code>INC1</code>, <code>DEC1</code>, <code>ENT1</code>, <code>ENN1</code>.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_12" id="ch01ex_2_12_12a">12</a>. <code>INC3 0,3</code>.</p>

  <p><a id="page_508"></a><a href="../Text/ch01b.html#ch01ex_2_12_13" id="ch01ex_2_12_13a">13</a>. ‘<code>JOV 1000</code>’ makes no difference except time. ‘<code>JNOV 1001</code>’ makes a different setting of rJ in most cases. ‘<code>JNOV 1000</code>’ makes an extraordinary difference, since it may lock the computer in an infinite loop.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_14" id="ch01ex_2_12_14a">14</a>. <code>NOP</code> with anything; <code>ADD</code>, <code>SUB</code> with $\rm F=(0{\colon}0)$ or with address equal to <code>*</code> (the location of the instruction) and $\rm F=(3{\colon}3)$; <code>HLT</code> (depending on how you interpret the statement of the exercise); any shift with address and index zero; <code>SLC</code> or <code>SRC</code> with index 0 and address a multiple of 10; <code>MOVE</code> with F = 0; <code>STJ *(0:0)</code>, <code>STZ *(0:0)</code>, and <code>STZ *(3:3)</code>; <code>JSJ *+1</code>; any of the <code>INC</code> or <code>DEC</code> instructions with address and index zero. But ‘<code>ENT1 0,1</code>’ is not always a no-op, because it might change rI1 from −0 to +0.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_15" id="ch01ex_2_12_15a">15</a>. 70; 80; 120. (The block size times 5.)</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_16" id="ch01ex_2_12_16a">16</a>. (a) <code>STZ 0</code>; <code>ENT1 1</code>; <code>MOVE 0(49)</code>; <code>MOVE 0(50)</code>. If the byte size were known to equal 100, only one <code>MOVE</code> instruction would have been necessary, but we are not allowed to make assumptions about the byte size.</p>

  <p class="indent">(b) Use 100 <code>STZ</code>’s.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_17" id="ch01ex_2_12_17a">17</a>. (a) <code>STZ 0,2</code>; <code>DEC2 1</code>; <code>J2NN 3000</code>.</p>

  <p class="indent">(b) <span class="top"><img src="../Images/508fig01.png"></span></p>

  <p>(A slightly faster, but quite preposterous, program uses 993 <code>STZ</code>’s: <code>JMP 3995</code>; <code>STZ 1,2</code>; <code>STZ 2,2</code>; …; <code>STZ 993,2</code>; <code>J2N 3999</code>; <code>DEC2 993</code>; <code>J2NN 3001</code>; <code>ENN1 0,2</code>; <code>JMP 3000,1</code>.)</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_18" id="ch01ex_2_12_18a">18</a>. (If you have correctly followed the instructions, an overflow will occur on the <code>ADD</code>, with minus zero in register A afterwards.) <em>Answer:</em> Overflow is set on, comparison is set <code>EQUAL</code>, rA is set to <span class="middle"><img src="../Images/e508_01.png"></span> , rX is set to <span class="middle"><img src="../Images/e508_02.png"></span>, rI1 is set to +3, and memory locations 0001, 0002 are set to +0. (Unless the program itself begins in location 0000.)</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_19" id="ch01ex_2_12_19a">19</a>. $42u=(2+1+2+2+1+1+1+$ $2+2+1+2+2+3+10+10)u$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_20" id="ch01ex_2_12_20a">20</a>. <span class="top"><img src="../Images/e508_03.png"></span></p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_21" id="ch01ex_2_12_21a">21</a>. (a) Not unless it can be set to zero by external means (see the “<code>GO</code> button”, <a href="../Text/ch01b.html#ch01ex_2_12_26">exercise 26</a>), since a program can set ${\rm rJ}←N$ only by jumping from location $N-1$.</p>

  <p class="indent">(b) <span class="top"><img src="../Images/e508_04.png"></span></p>

  <p><a id="page_509"></a><a href="../Text/ch01b.html#ch01ex_2_12_22" id="ch01ex_2_12_22a">22</a>. <em>Minimum time:</em> If <em>b</em> is the byte size, the assumption that $|X^{13}|\lt b^{5}$ implies that $X^{2}\lt b$, so $X^{2}$ can be contained in one byte. The following ingenious solution due to Y. N. Patt makes use of this fact. The sign of rA is the sign of <em>X</em>.</p>

  <div class="image"><img src="../Images/e509_01.png"></div>

  <p>space = 14; time = 54<em>u</em>, not counting the <code>HLT</code>.</p>

  <p>At least five multiplications are “necessary,” according to the theory developed in Section 4.6.3, yet this program uses only four! And in fact there is an even better solution below.</p>

  <div class="image"><img src="../Images/e509_02.png"></div>

  <p><em>True minimum time:</em> As R. W. Floyd points out, the conditions imply that $|X|≤5$, so the minimum execution time is achieved by referring to a table:</p>

  <div class="image"><img src="../Images/e509_03.png"></div>

  <p>space = 14; time = 4<em>u</em>.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_23" id="ch01ex_2_12_23a">23</a>. The following solution by R. D. Dixon appears to satisfy all the conditions:</p>

  <div class="image"><img src="../Images/e509_04.png"></div>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_24" id="ch01ex_2_12_24a">24</a>. (a) <code>DIV 3500</code>, where <span class="middle"><img src="../Images/e509_05.png"></span>.</p>

  <p class="indent">(b) <code>SRC 4</code>; <code>SRA 1</code>; <code>SLC 5</code>.</p>

  <p><a id="page_510"></a><a href="../Text/ch01b.html#ch01ex_2_12_25" id="ch01ex_2_12_25a">25</a>. Some ideas: (a) Obvious things like faster memory, more input-output devices. (b) The I field could be used for J-register indexing, and/or multiple indexing (to specify two different index registers) and/or “indirect addressing” (<a href="../Text/ch01c.html#ch01ex_2_18_3">exercise 1.4.4–4</a>. (e) A “real time clock” could be added, in a negative memory address. (f) Bitwise operations, jumps on register even or odd, and binary shifts could be added to binary versions of <code>MIX</code> (see, for example, exercises 2.5–28, 5.2.2–12, and 6.3–9; also Program 4.5.2B, 6.4–(24), and Section 7.1). (g) An “execute” command, meaning to perform the instruction at location M, could be another variant of C = 5. (h) Another variant of $\rm C=48,\ldots,55$ could set $\rm CI←register: M$.</p>

  <p><a href="../Text/ch01b.html#ch01ex_2_12_26" id="ch01ex_2_12_26a">26</a>. It is tempting to use a (2:5) field to get at columns 7–10 of the card, but this cannot be done since $2·8+5=21$. To make the program easier to follow, it is presented here in symbolic language, anticipating <a href="../Text/ch01b.html#ch01lev2sec13">Section 1.3.2</a>.</p>

  <div class="image"><img src="../Images/510fig01.png"></div>
</body>
</html>
