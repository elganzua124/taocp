<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      extensions: ["tex2jax.js"],
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        inlineMath: [["$","$"]],
        displayMath: [["$$","$$"]],
        processEscapes: true
      },
      "HTML-CSS": { availableFonts: ["TeX"] }
    });
  </script>
  <script src="MathJax-2.4-latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

  <title></title>
  <link href="../Styles/caps.css" rel="stylesheet" type="text/css">
</head>

<body>
  <div style="display:none">
    $\newcommand{\phihat}{\skew{3}\widehat{\smash{\phi}\vphantom{a}}}$
  </div>
  <p class="ex-title"><a id="page_51"></a>Exercises</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_5_1a" id="ch01ex_2_5_1">1</a>.</strong> [<em>00</em>] How many ways are there to shuffle a 52-card deck?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_5_2a" id="ch01ex_2_5_2">2</a>.</strong> [<em>10</em>] In the notation of Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-2">2</a>), show that $p_{n(n-1)}=p_{nn}$, and explain why this happens.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_5_3a" id="ch01ex_2_5_3">3</a>.</strong> [<em>10</em>] What permutations of ${1, 2, 3, 4, 5}$ would be constructed from the permutation 3 1 2 4 using Methods 1 and 2, respectively?</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_5_4a" id="ch01ex_2_5_4">4</a>.</strong> [<em>13</em>] Given the fact that log<sub>10</sub> 1000! = 2567.60464 ..., determine exactly how many decimal digits are present in the number 1000!. What is the <em>most significant</em> digit? What is the <em>least significant</em> digit?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_5_5a" id="ch01ex_2_5_5">5</a>.</strong> [<em>15</em>] Estimate 8! using the following more exact version of Stirling’s approximation:</p>

  <div class="image"><img src="../Images/ch01/e051_01.png"></div>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_5_6a" id="ch01ex_2_5_6">6</a>.</strong> [<em>17</em>] Using Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-8">8</a>), write 20! as a product of prime factors.</p>

  <p class="exercises"><a id="ch01ex_2_5_7"></a><strong>7.</strong> [<em>M10</em>] Show that the “generalized termial” function in Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-10">10</a>) satisfies the identity $x?=x+(x-1)$? for all real numbers <em>x</em>.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_5_8a" id="ch01ex_2_5_8">8</a>.</strong> [<em>HM15</em>] Show that the limit in Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-13">13</a>) does equal $n!$ when <em>n</em> is a nonnegative integer.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_5_9a" id="ch01ex_2_5_9">9</a>.</strong> [<em>M10</em>] Determine the values of <span class="middle"><img src="../Images/ch01/e051_02.png"></span> and <span class="middle"><img src="../Images/ch01/e051_03.png"></span>, given that <span class="middle"><img src="../Images/ch01/e051_04.png"></span>.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_5_10a" id="ch01ex_2_5_10">10</a>.</strong> [<em>HM20</em>] Does the identity $Γ (x+1)=xΓ (x)$ hold for all real numbers <em>x</em>? (See <a href="../Text/ch01a.html#ch01ex_2_5_7">exercise 7</a>.)</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_5_11a" id="ch01ex_2_5_11">11</a>.</strong> [<em>M15</em>] Let the representation of <em>n</em> in the binary system be $n=2^{e_{1}}+2^{e_{2}}+...+2^{e_{r}}$ where $e_{1}\gt e_{2}\gt...\gt e_{r} ≥ 0$. Show that $n!$ is divisible by $2^{n-r}$ but not by $2^{n-r+1}$.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_5_12a" id="ch01ex_2_5_12">12</a>.</strong> [<em>M22</em>] (A. Legendre, 1808.) Generalizing the result of the previous exercise, let <em>p</em> be a prime number, and let the representation of <em>n</em> in the p-ary number system be $n=a_{k}p^{k}+a_{k-1}p^{k-1}+...+a_{1}p+a_{0}$. Express the number μ of Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-8">8</a>) in a simple formula involving <em>n</em>, <em>p</em>, and <em>a</em>’s.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_5_13a" id="ch01ex_2_5_13">13</a>.</strong> [<em>M23</em>] (<em>Wilson’s theorem</em>, actually due to Leibniz, 1682.) If <em>p</em> is prime, then $(p-1)!\bmod p=p-1$. Prove this, by pairing off numbers among ${1, 2,..., p-1}$ whose product modulo <em>p</em> is 1.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_5_14a" id="ch01ex_2_5_14">14</a>.</strong> [<em>M28</em>] (L. Stickelberger, 1890.) In the notation of <a href="../Text/ch01a.html#ch01ex_2_5_12">exercise 12</a>, we can determine $n!\bmod p$ in terms of the <em>p</em>-ary representation, for <em>any</em> positive integer <em>n</em>, thus generalizing Wilson’s theorem. In fact, prove that $n!/p^{μ}≡(-1)^{μ}a_{0} ! a_{1} !... a_{k} ! (modulo p)$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_5_15a" id="ch01ex_2_5_15">15</a>.</strong> [<em>HM15</em>] The <em>permanent</em> of a square matrix is defined by the same expansion as the determinant except that each term of the permanent is given a plus sign while the determinant alternates between plus and minus. Thus the permanent of</p>

  <div class="image"><img src="../Images/ch01/e051_05.png"></div>

  <p class="exercisesp">is $aei+bfg+cdh+gec+hfa+idb$. What is the permanent of</p>

  <div class="image"><img src="../Images/ch01/e051_06.png"></div>

  <p class="exercises1"><a id="page_52"></a><strong><a href="../Text/app01.html#ch01ex_2_5_16a" id="ch01ex_2_5_16">16</a>.</strong> [<em>HM15</em>] Show that the infinite sum in Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-11">11</a>) does not converge unless <em>n</em> is a nonnegative integer.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_5_17a" id="ch01ex_2_5_17">17</a>.</strong> [<em>HM20</em>] Prove that the infinite product</p>

  <div class="image"><img src="../Images/ch01/e052_01.png"></div>

  <p class="exercisesp">equals $Γ (1+β_{1})... Γ (1+β_{k}) /Γ (1+α_{1})... Γ (1+α_{k}), if α_{1}+···+α_{k}=β_{1}+···+β_{k}$ and if none of the β’s is a negative integer.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_5_18a" id="ch01ex_2_5_18">18</a>.</strong> [<em>M20</em>] Assume that <span class="middle"><img src="../Images/ch01/e052_02.png"></span>. (This is “Wallis’s product,” obtained by J. Wallis in 1655, and we will prove it in exercise <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–<a href="../Text/ch01a.html#ch01ex_2_6_43">43</a>.) Using the previous exercise, prove that <span class="middle"><img src="../Images/ch01/e052_03.png"></span>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_5_19a" id="ch01ex_2_5_19">19</a>.</strong> [<em>HM22</em>] Denote the quantity appearing after “$\lim_{m→∞}$” in Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-15">15</a>) by $Γ_{m}(x)$. Show that</p>

  <div class="image"><img src="../Images/ch01/e052_04.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_5_20a" id="ch01ex_2_5_20">20</a>.</strong> [<em>HM21</em>] Using the fact that $0≤e^{-t}-(1-t/m)^{m}≤t^{2}e^{-t}/m$, if 0 ≤ <em>t</em> ≤ <em>m</em>, and the previous exercise, show that <span class="middle"><img src="../Images/ch01/e052_05.png"></span>, if <em>x</em> &gt; 0.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_5_21a" id="ch01ex_2_5_21">21</a>.</strong> [<em>HM25</em>] (L. F. A. Arbogast, 1800.) Let <span class="middle"><img src="../Images/ch01/e052_06.png"></span> represent the <em>k</em>th derivative of a function <em>u</em> with respect to <em>x</em>. The chain rule states that <span class="middle"><img src="../Images/ch01/e052_07.png"></span>. If we apply this to second derivatives, we find <span class="middle"><img src="../Images/ch01/e052_08.png"></span>. Show that the <em>general formula</em> is</p>

  <div class="image"><img src="../Images/ch01/e052_09.png"></div>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_5_22a" id="ch01ex_2_5_22">22</a>.</strong> [<em>HM20</em>] Try to put yourself in Euler’s place, looking for a way to generalize <em>n</em>! to noninteger values of <em>n</em>. Since <span class="middle"><img src="../Images/ch01/e052_10.png"></span> times <span class="middle"><img src="../Images/ch01/e052_11.png"></span> equals $(n+1)!/n!=n+1$, it seems natural that <span class="middle"><img src="../Images/ch01/e052_12.png"></span> should be approximately <span class="middle"><img src="../Images/ch01/052_01.png"></span>. Similarly, <span class="middle"><img src="../Images/ch01/e052_13.png"></span> should be <span class="middle"><img src="../Images/ch01/e052_14.png"></span>. Invent a hypothesis about the ratio $(n+x)!/n!$ as <em>n</em> approaches infinity. Is your hypothesis correct when <em>x</em> is an integer? Does it tell anything about the appropriate value of $x!$ when <em>x</em> is not an integer?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_5_23a" id="ch01ex_2_5_23">23</a>.</strong> [<em>HM20</em>] Prove (<a href="../Text/ch01.html#ch01eq-lev2sec5-16">16</a>), given that <span class="middle"><img src="../Images/ch01/e052_15.png"></span>.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_5_24a" id="ch01ex_2_5_24">24</a>.</strong> [<em>HM21</em>] Prove the handy inequalities</p>

  <div class="image"><img src="../Images/ch01/e052_16.png"></div>

  <p class="exercisesp">[<em>Hint:</em> $1+x≤e^{x}$ for all real <em>x</em>; hence $(k+1)/k≤e^{1/k}≤k/(k-1)$.]</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_5_25a" id="ch01ex_2_5_25">25</a>.</strong> [<em>M20</em>] Do factorial powers satisfy a law analogous to the ordinary law of exponents, $x^{m+n}=x^{m}x^{n}$?</p>

  <div class="heading">
    <h4 id="ch01lev2sec6">1.2.6. Binomial Coefficients</h4>

    <p>The <em>combinations of <em>n</em> objects taken k at a time</em> are the possible choices of <em>k</em> different elements from a collection of <em>n</em> objects, disregarding order. The <a id="page_53"></a>combinations of the five objects ${a, b, c, d, e}$ taken three at a time are</p>
  </div>

  <div class="equation"><a id="ch01eq-lev2sec6-1"></a><img src="../Images/ch01/053equ01.png"></div>

  <p>It is a simple matter to count the total number of <em>k</em>-combinations of <em>n</em> objects: Equation (<a href="../Text/ch01a.html#ch01eq-lev2sec6-2">2</a>) of the previous section told us that there are $n(n-1)... (n-k+1)$ ways to choose the first <em>k</em> objects for a permutation; and every <em>k</em>-combination appears exactly $k!$ times in these arrangements, since each combination appears in all its permutations. Therefore the number of combinations, which we denote by <span class="middle"><img src="../Images/ch01/nbyk.png"></span>, is</p>

  <div class="equation"><a id="ch01eq-lev2sec6-2"></a><img src="../Images/ch01/053equ02.png"></div>

  <p>For example,</p>

  <div class="image"><img src="../Images/ch01/e053_01.png"></div>

  <p>which is the number of combinations we found in (<a href="../Text/ch01a.html#ch01eq-lev2sec6-1">1</a>).</p>

  <p class="indent">The quantity <span class="middle"><img src="../Images/ch01/nbyk.png"></span>, read “<em>n</em> choose <em>k</em>,” is called a <em>binomial coefficient</em>; these numbers have an extraordinary number of applications. They are probably the most important quantities entering into the analysis of algorithms, so the reader is urged to become familiar with them.</p>

  <p class="indent">Equation (<a href="../Text/ch01a.html#ch01eq-lev2sec6-2">2</a>) may be used to define <span class="middle"><img src="../Images/ch01/nbyk.png"></span> even when <em>n</em> is not an integer. To be precise, we define the symbol <span class="middle"><img src="../Images/ch01/rbyk.png"></span> for all real numbers <em>r</em> and all integers <em>k</em> as follows:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-3"></a><img src="../Images/ch01/053equ03.png"></div>

  <p>In particular cases we have</p>

  <div class="equation"><a id="ch01eq-lev2sec6-4"></a><img src="../Images/ch01/053equ04.png"></div>

  <p><a href="../Text/ch01a.html#ch01tab01">Table 1</a> gives values of the binomial coefficients for small integer values of <em>r</em> and <em>k</em>; the values for 0 ≤ <em>r</em> ≤ 4 should be memorized.</p>

  <div class="image">
    <a id="ch01tab01"></a><img src="../Images/ch01/054tab01.png">

    <p class="tab-caption"><strong>Table 1</strong> Table of Binomial Coefficients (Pascal’s Triangle)</p>
  </div>

  <p class="indent">Binomial coefficients have a long and interesting history. <a href="../Text/ch01a.html#ch01tab01">Table 1</a> is called “Pascal’s triangle” because it appeared in Blaise Pascal’s <em>Traité du Triangle Arithmétique</em> in 1653. This treatise was significant because it was one of the first works on probability theory, but Pascal did not invent the binomial coefficients (which were well-known in Europe at that time). <a href="../Text/ch01a.html#ch01tab01">Table 1</a> also appeared in the treatise <em>Szu-yüan Yü-chien</em> (“The Precious Mirror of the Four Elements”) by the Chinese mathematician Chu Shih-Chieh in 1303, where they were said to be an old invention. Yang Hui, in 1261, credited them to Chia Hsien (c. 1100), whose work is now lost. The earliest known detailed discussion of binomial coefficients is in a tenth-century commentary, due to Halāyudha, on an ancient Hindu classic, Pi<span class="middle"><img src="../Images/ch01/n-dot.png"></span>gala’s <em>Chanda<span class="middle"><img src="../Images/ch01/h-dot.png"></span>śāstra</em>. [See G. Chakravarti, <em>Bull.</em> <a id="page_54"></a><em>Calcutta Math. Soc.</em> <strong>24</strong> (1932), 79–88.] Another Indian mathematician, Mahāvīra, had previously explained rule (<a href="../Text/ch01a.html#ch01eq-lev2sec6-3">3</a>) for computing <span class="middle"><img src="../Images/ch01/rbyk.png"></span> in Chapter 6 of his <em>Gan. ita Sāra Sa<span class="middle"><img src="../Images/ch01/n-dot.png"></span>graha</em>, written about 850; and in 1150 Bhāskara repeated Mahāvīra’s rule near the end of his famous book <em>Līlāvat</em>ī. For small values of <em>k</em>, binomial coefficients were known much earlier; they appeared in Greek and Roman writings with a geometric interpretation (see <a href="../Text/ch01a.html#ch01fig08">Fig. 8</a>). The notation <span class="middle"><img src="../Images/ch01/rbyk.png"></span> was introduced by Andreas von Ettingshausen in §31 of his book <em>Die combinatorische Analysis</em> (Vienna: 1826).</p>

  <div class="image">
    <a id="ch01fig08"></a><img src="../Images/ch01/01fig08.png">

    <p class="fig-caption"><strong>Fig. 8.</strong> Geometric interpretation of <span class="middle"><img src="../Images/ch01/e054_01.png"></span>, <em>n</em> = 4.</p>
  </div>

  <p class="indent">The reader has probably noticed several interesting patterns in <a href="../Text/ch01a.html#ch01tab01">Table 1</a>. Binomial coefficients satisfy literally thousands of identities, and for centuries their amazing properties have been continually explored. In fact, there are so many relations present that when someone finds a new identity, not many people get excited about it any more, except the discoverer. In order to manipulate the formulas that arise in the analysis of algorithms, a facility for handling binomial coefficients is a must, and so an attempt has been made in this section to explain in a simple way how to maneuver with these numbers. Mark Twain once tried to reduce all jokes to a dozen or so primitive kinds (farmer’s daughter, mother-in-law, etc.); we will try to condense the thousands of identities into a small set of basic operations with which we can solve nearly every problem involving binomial coefficients that we will meet.</p>

  <p class="indent">In most applications, both of the numbers <em>r</em> and <em>k</em> that appear in <span class="middle"><img src="../Images/ch01/rbyk.png"></span> will be integers, and some of the techniques we will describe are applicable only in such cases. Therefore we will be careful to list, at the right of each numbered <a id="page_55"></a>equation, any restrictions on the variables that appear. For example, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-3">3</a>) mentions the requirement that <em>k</em> is an integer; there is no restriction on <em>r</em>. The identities with fewest restrictions are the most useful.</p>

  <p class="indent">Now let us study the basic techniques for operating on binomial coefficients:</p>

  <p><strong>A. Representation by factorials.</strong> From Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-3">3</a>) we have immediately</p>

  <div class="equation"><a id="ch01eq-lev2sec6-5"></a><img src="../Images/ch01/055equ01.png"></div>

  <p>This allows combinations of factorials to be represented as binomial coefficients and conversely.</p>

  <p><strong>B. Symmetry condition.</strong> From Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-3">3</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-5">5</a>), we have</p>

  <div class="equation"><a id="ch01eq-lev2sec6-6"></a><img src="../Images/ch01/055equ02.png"></div>

  <p>This formula holds for all integers <em>k</em>. <em>When <em>k</em> is negative or greater than n, the binomial coefficient is zero</em> (provided that <em>n</em> is a nonnegative integer).</p>

  <p><strong>C. Moving in and out of parentheses.</strong> From the definition (<a href="../Text/ch01a.html#ch01eq-lev2sec6-3">3</a>), we have</p>

  <div class="equation"><a id="ch01eq-lev2sec6-7"></a><img src="../Images/ch01/055equ03.png"></div>

  <p>This formula is very useful for combining a binomial coefficient with other parts of an expression. By elementary transformation we have the rules</p>

  <div class="image"><img src="../Images/ch01/e055_01.png"></div>

  <p>the first of which is valid for all integers <em>k</em>, and the second when no division by zero has been performed. We also have a similar relation:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-8"></a><img src="../Images/ch01/055equ04.png"></div>

  <p class="indent">Let us illustrate these transformations, by proving Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-8">8</a>) using Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-6">6</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-7">7</a>) alternately:</p>

  <div class="image"><img src="../Images/ch01/e055_02.png"></div>

  <p>[<em>Note:</em> This derivation is valid only when <em>r</em> is a positive integer ≠ <em>k</em>, because of the constraints involved in Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-6">6</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-7">7</a>); yet Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-8">8</a>) claims to be valid for <em>arbitrary r</em> ≠ <em>k</em>. This can be proved in a simple and important manner: We have verified that</p>

  <div class="image"><img src="../Images/ch01/e055_03.png"></div>

  <p>for <em>infinitely many values of r</em>. Both sides of this equation are <em>polynomials</em> in <em>r</em>. A nonzero polynomial of degree <em>n</em> can have at most <em>n</em> distinct zeros; so (by subtraction) <em>if two polynomials of degree</em> ≤ <em>n agree at n</em> + 1 <em>or more different points, the polynomials are identically equal</em>. This principle may be used to extend the validity of many identities from integers to all real numbers.]</p>

  <p><a id="page_56"></a><strong>D. Addition formula.</strong> The basic relation</p>

  <div class="equation"><a id="ch01eq-lev2sec6-9"></a><img src="../Images/ch01/056equ01.png"></div>

  <p>is clearly valid in <a href="../Text/ch01a.html#ch01tab01">Table 1</a> (every value is the sum of the two values above and to the left) and we may easily verify it in general from Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-3">3</a>). Alternatively, Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-7">7</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-8">8</a>) tell us that</p>

  <div class="image"><img src="../Images/ch01/e056_01.png"></div>

  <p>Equation (<a href="../Text/ch01a.html#ch01eq-lev2sec6-9">9</a>) is often useful in obtaining proofs by induction on <em>r</em>, when <em>r</em> is an integer.</p>

  <p><strong>E. Summation formulas.</strong> Repeated application of (<a href="../Text/ch01a.html#ch01eq-lev2sec6-9">9</a>) gives</p>

  <div class="image"><img src="../Images/ch01/e056_02.png"></div>

  <p>or</p>

  <div class="image"><img src="../Images/ch01/e056_03.png"></div>

  <p>Thus we are led to two important summation formulas that can be expressed as follows:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-10"></a><img src="../Images/ch01/056equ02.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec6-11"></a><img src="../Images/ch01/056equ03.png"></div>

  <p class="indent">Equation (<a href="../Text/ch01a.html#ch01eq-lev2sec6-11">11</a>) can easily be proved by induction on <em>n</em>, but it is interesting to see how it can also be derived from Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-10">10</a>) with two applications of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-6">6</a>):</p>

  <div class="image"><img src="../Images/ch01/e056_04.png"></div>

  <p>assuming that <em>n</em> ≥ <em>m</em>. If <em>n &lt; m</em>, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-11">11</a>) is obvious.</p>

  <p class="indent">Equation (<a href="../Text/ch01a.html#ch01eq-lev2sec6-11">11</a>) occurs very frequently in applications; in fact, we have already derived special cases of it in previous sections. For example, when <em>m</em> = 1, we have our old friend, the sum of an arithmetic progression:</p>

  <div class="image"><img src="../Images/ch01/e056_05.png"></div>

  <p class="indent"><a id="page_57"></a>Suppose that we want a simple formula for the sum $1^{2}+2^{2}+···+n^{2}$. This can be obtained by observing that <span class="middle"><img src="../Images/ch01/e057_01.png"></span>; hence</p>

  <div class="image"><img src="../Images/ch01/e057_00.png"></div>

  <p>And this answer, obtained in terms of binomial coefficients, can be put back into polynomial notation if desired:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-12"></a><img src="../Images/ch01/057equ00.png"></div>

  <p class="indent">The sum $1^{3}+2^{3}+···+n^{3}$ can be obtained in a similar way; <em>any</em> polynomial $a_{0}+a_{1}k+a_{2}k^{2}+···+a_{m}k^{m}$ can be expressed as <span class="middle"><img src="../Images/ch01/e057_02.png"></span> for suitably chosen coefficients $b_{0},..., b_{m}$. We will return to this subject later.</p>

  <p><strong>F. The binomial theorem.</strong> Of course, the binomial theorem is one of our principal tools:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-13"></a><img src="../Images/ch01/057equ01.png"></div>

  <p>For example, $(x+y)^{4}=x^{4}+4x^{3}y+6x^{2}y^{2}+4xy^{3}+y^{4}$. (At last we are able to justify the name “binomial coefficient” for the numbers <span class="middle"><img src="../Images/ch01/rbyk.png"></span>.)</p>

  <p class="indent">It is important to notice that we have written ∑<sub><em>k</em></sub> in Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-13">13</a>), rather than <span class="middle"><img src="../Images/ch01/e057_03.png"></span> as might have been expected. If no restriction is placed on <em>k</em>, we are summing over <em>all</em> integers, $-∞\lt k\lt +∞$; but the two notations are exactly equivalent in this case, since the terms in Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-13">13</a>) are zero when <em>k</em> &lt; 0 or <em>k &gt; r</em>. The simpler form $∑_{k}$ is to be preferred, since all manipulations with sums are simpler when the conditions of summation are simpler. We save a good deal of tedious effort if we do not need to keep track of the lower and/or upper limits of summation, so the limits should be left unspecified whenever possible. Our notation has another advantage also: If <em>r</em> is not a nonnegative integer, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-13">13</a>) becomes an <em>infinite</em> sum, and the <em>binomial theorem</em> of calculus states that <em>Eq</em>. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-13">13</a>) <em>is valid for all r</em>, if |<em>x/y</em>| &lt; 1.</p>

  <p class="indent">It should be noted that formula (<a href="../Text/ch01a.html#ch01eq-lev2sec6-13">13</a>) gives</p>

  <div class="equation"><a id="ch01eq-lev2sec6-14"></a><img src="../Images/ch01/057equ02.png"></div>

  <p>We will use this convention consistently.</p>

  <p class="indent">The special case <em>y</em> = 1 in Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-13">13</a>) is so important, we state it specially:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-15"></a><img src="../Images/ch01/057equ03.png"></div>

  <p class="indent">The discovery of the binomial theorem was announced by Isaac Newton in letters to Oldenburg on June 13, 1676 and October 24, 1676. [See D. Struik, <em>Source Book in Mathematics</em> (Harvard Univ. Press, 1969), 284–291.] But he apparently had no real proof of the formula; at that time the necessity for rigorous proof was not fully realized. The first attempted proof was given by L. Euler <a id="page_58"></a>in 1774, although his effort was incomplete. Finally, C. F. Gauss gave the first actual proof in 1812. In fact, Gauss’s work represented the first time <em>anything</em> about infinite sums was proved satisfactorily.</p>

  <p class="indent">Early in the nineteenth century, N. H. Abel found a surprising generalization of the binomial formula (<a href="../Text/ch01a.html#ch01eq-lev2sec6-13">13</a>):</p>

  <div class="equation"><a id="ch01eq-lev2sec6-16"></a><img src="../Images/ch01/058equ01.png"></div>

  <p>This is an identity in <em>three</em> variables, <em>x</em>, <em>y</em>, and <em>z</em> (see <a href="../Text/ch01a.html#ch01ex_2_6_50">exercises 50</a> through <a href="../Text/ch01a.html#ch01ex_2_6_52">52</a>). Abel published and proved this formula in Volume 1 of A. L. Crelle’s soon-to-be-famous <em>Journal für die reine und angewandte Mathematik</em> (1826), pages <a href="../Text/ch01b.html#page_159">159</a>–<a href="../Text/ch01b.html#page_160">160</a>. It is interesting to note that Abel contributed many other papers to the same Volume 1, including his famous memoirs on the unsolvability of algebraic equations of degree 5 or more by radicals, and on the binomial theorem. See H. W. Gould, <em>AMM</em> <strong>69</strong> (1962), 572, for a number of references to Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-16">16</a>).</p>

  <p><strong>G. Negating the upper index.</strong> The basic identity</p>

  <div class="equation"><a id="ch01eq-lev2sec6-17"></a><img src="../Images/ch01/058equ02.png"></div>

  <p>follows immediately from the definition (<a href="../Text/ch01a.html#ch01eq-lev2sec6-3">3</a>) when each term of the numerator is negated. This is often a useful transformation on the upper index.</p>

  <p class="indent">One easy consequence of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-17">17</a>) is the summation formula</p>

  <div class="equation"><a id="ch01eq-lev2sec6-18"></a><img src="../Images/ch01/058equ03.png"></div>

  <p>This identity could be proved by induction using Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-9">9</a>), but we can use Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-17">17</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-10">10</a>) directly:</p>

  <div class="image"><img src="../Images/ch01/e058_01.png"></div>

  <p class="indent">Another important application of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-17">17</a>) can be made when <em>r</em> is an integer:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-19"></a><img src="../Images/ch01/058equ04.png"></div>

  <p>(Set <em>r</em> = <em>n</em> and <em>k</em> = <em>n</em> − <em>m</em> in Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-17">17</a>) and use (<a href="../Text/ch01a.html#ch01eq-lev2sec6-6">6</a>).) We have moved <em>n</em> from the upper position to the lower.</p>

  <p><strong>H. Simplifying products.</strong> When products of binomial coefficients appear, they can usually be reexpressed in several different ways by expanding into factorials and out again using Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-5">5</a>). For example,</p>

  <div class="equation"><a id="ch01eq-lev2sec6-20"></a><img src="../Images/ch01/058equ05.png"></div>

  <p><a id="page_59"></a>It suffices to prove Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-20">20</a>) when <em>r</em> is an integer ≥ <em>m</em> (see the remarks after Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-8">8</a>)), and when 0 ≤ <em>k</em> ≤ <em>m</em>. Then</p>

  <div class="image"><img src="../Images/ch01/e059_01.png"></div>

  <p>Equation (<a href="../Text/ch01a.html#ch01eq-lev2sec6-20">20</a>) is very useful when an index (namely <em>m</em>) appears in both the upper and the lower position, and we wish to have it appear in one place rather than two. Notice that Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-7">7</a>) is the special case of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-20">20</a>) when <em>k</em> = 1.</p>

  <p><strong>I. Sums of products.</strong> To complete our set of binomial-coefficient manipulations, we present the following very general identities, which are proved in the exercises at the end of this section. These formulas show how to sum over a product of two binomial coefficients, considering various places where the running variable <em>k</em> might appear:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-21"></a><img src="../Images/ch01/059equ01.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec6-22"></a><img src="../Images/ch01/059equ02.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec6-23"></a><img src="../Images/ch01/059equ03.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec6-24"></a><img src="../Images/ch01/059equ04.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec6-25"></a><img src="../Images/ch01/059equ05.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec6-26"></a><img src="../Images/ch01/059equ06.png"></div>

  <p>Of these identities, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-21">21</a>) is by far the most important, and it should be memorized. One way to remember it is to interpret the right-hand side as the number of ways to select <em>n</em> people from among <em>r</em> men and <em>s</em> women; each term on the left is the number of ways to choose <em>k</em> of the men and <em>n</em> − <em>k</em> of the women. Equation (<a href="../Text/ch01a.html#ch01eq-lev2sec6-21">21</a>) is commonly called Vandermonde’s convolution, since A. Vandermonde published it in <em>Mém. Acad. Roy. Sciences</em> (Paris, 1772), part 1, 489–498. However, it had appeared already in Chu Shih-Chieh’s 1303 treatise mentioned earlier [see J. Needham, <em>Science and Civilisation in China</em> <strong>3</strong> (Cambridge University Press, 1959), 138–139].</p>

  <p class="indent"><a id="page_60"></a>If $r=tk$ in Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>), we avoid the zero denominator by canceling with a factor in the numerator; therefore Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>) is a polynomial identity in the variables <em>r</em>, <em>s</em>, <em>t</em>. Obviously Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-21">21</a>) is a special case of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>) with <em>t</em> = 0.</p>

  <p class="indent">We should point out a nonobvious use of Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-23">23</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-25">25</a>): It is often helpful to replace the simple binomial coefficient on the right-hand side by the more complicated expression on the left, interchange the order of summation, and simplify. We may regard the left-hand sides as expansions of</p>

  <div class="image"><img src="../Images/ch01/e060_01.png"></div>

  <p>Formula (<a href="../Text/ch01a.html#ch01eq-lev2sec6-23">23</a>) is used for negative <em>a</em>, formula (<a href="../Text/ch01a.html#ch01eq-lev2sec6-25">25</a>) for positive <em>a</em>.</p>

  <p class="indent">This completes our study of binomial-coefficientology. The reader is advised to learn especially Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-5">5</a>), (<a href="../Text/ch01a.html#ch01eq-lev2sec6-6">6</a>), (<a href="../Text/ch01a.html#ch01eq-lev2sec6-7">7</a>), (<a href="../Text/ch01a.html#ch01eq-lev2sec6-9">9</a>), (<a href="../Text/ch01a.html#ch01eq-lev2sec6-13">13</a>), (<a href="../Text/ch01a.html#ch01eq-lev2sec6-17">17</a>), (<a href="../Text/ch01a.html#ch01eq-lev2sec6-20">20</a>), and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-21">21</a>) — frame them with your favorite highlighter pen!</p>

  <p class="indent">With all these methods at our disposal, we should be able to solve almost any problem that comes along, in at least three different ways. The following examples illustrate the techniques.</p>

  <p><a id="ch01exam01"></a><strong>Example 1.</strong> When <em>r</em> is a positive integer, what is the value of <span class="middle"><img src="../Images/ch01/e060_02.png"></span></p>

  <p><em>Solution.</em> Formula (<a href="../Text/ch01a.html#ch01eq-lev2sec6-7">7</a>) is useful for disposing of the outside <em>k</em>:</p>

  <div class="image"><img src="../Images/ch01/e060_03.png"></div>

  <p>Now formula (<a href="../Text/ch01a.html#ch01eq-lev2sec6-22">22</a>) applies, with <em>m</em> = 0 and <em>n</em> = −1. The answer is therefore</p>

  <div class="image"><img src="../Images/ch01/e060_04.png"></div>

  <p><a id="ch01exam02"></a><strong>Example 2.</strong> What is the value of <span class="middle"><img src="../Images/ch01/e060_05.png"></span>, if <em>n</em> is a nonnegative integer?</p>

  <p><em>Solution.</em> This problem is tougher; the summation index <em>k</em> appears in six places! First we apply Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-20">20</a>), and we obtain</p>

  <div class="image"><img src="../Images/ch01/e060_06.png"></div>

  <p>We can now breathe more easily, since several of the menacing characteristics of the original formula have disappeared. The next step should be obvious; we apply Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-7">7</a>) in a manner similar to the technique used in <a href="../Text/ch01a.html#ch01exam01">Example 1</a>:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-27"></a><img src="../Images/ch01/060equ01.png"></div>

  <p>Good, another <em>k</em> has vanished. At this point there are two equally promising lines of attack. We can replace the <span class="middle"><img src="../Images/ch01/e060_07.png"></span> by <span class="middle"><img src="../Images/ch01/e060_08.png"></span>, assuming that <em>k</em> ≥ 0, and <a id="page_61"></a>evaluate the sum with Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-23">23</a>):</p>

  <div class="image"><img src="../Images/ch01/e061_01.png"></div>

  <p>The binomial coefficient <span class="middle"><img src="../Images/ch01/e061_00.png"></span> equals zero except when <em>n</em> = 0, in which case it equals one. So we can conveniently state the answer to our problem as [<em>n</em> = 0], using Iverson’s convention (Eq. <a href="../Text/ch01.html#ch01lev2sec3">1.2.3</a>–(<a href="../Text/ch01.html#ch01eq-lev2sec3-16">16</a>)), or as <em>δ</em><sub><em>n</em>0</sub>, using the Kronecker delta (Eq. <a href="../Text/ch01.html#ch01lev2sec3">1.2.3</a>–(<a href="../Text/ch01.html#ch01eq-lev2sec3-19">19</a>)).</p>

  <p class="indent">Another way to proceed from Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-27">27</a>) is to use Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-17">17</a>), obtaining</p>

  <div class="image"><img src="../Images/ch01/e061_02.png"></div>

  <p>We can now apply Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-22">22</a>), which yields the sum</p>

  <div class="image"><img src="../Images/ch01/e061_03.png"></div>

  <p>Once again we have derived the answer:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-28"></a><img src="../Images/ch01/061equ01.png"></div>

  <p><a id="ch01exam03"></a><strong>Example 3.</strong> What is the value of <span class="middle"><img src="../Images/ch01/e061_04.png"></span>, for positive integers <em>m</em> and <em>n</em>?</p>

  <p><em>Solution.</em> If <em>m</em> were zero, we would have the same formula to work with that we had in <a href="../Text/ch01a.html#ch01exam02">Example 2</a>. However, the presence of <em>m</em> means that we cannot even begin to use the method of the previous solution, since the first step there was to use Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-20">20</a>) — which no longer applies. In this situation it pays to complicate things even more by replacing the unwanted <span class="middle"><img src="../Images/ch01/e061_05.png"></span> by a sum of terms of the form <span class="middle"><img src="../Images/ch01/e061_06.png"></span>, since our problem will then become a sum of problems that we know how to solve. Accordingly, we use Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-25">25</a>) with</p>

  <p class="center">$r=n+k-1$,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$m=2k$,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s=0$,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$n=m-1$,</p>

  <p>and we have</p>

  <div class="equation"><a id="ch01eq-lev2sec6-29"></a><img src="../Images/ch01/061equ02.png"></div>

  <p><a id="page_62"></a>We wish to perform the summation on <em>k</em> first; but interchanging the order of summation demands that we sum on the values of <em>k</em> that are ≥ 0 and $≥ j-n+1$. Unfortunately, the latter condition raises problems, because we do <em>not</em> know the desired sum if <em>j</em> ≥ <em>n</em>. Let us save the situation, however, by observing the terms of (<a href="../Text/ch01a.html#ch01eq-lev2sec6-29">29</a>) are zero when $n≤j≤n+k-1$. This condition implies that <em>k</em> ≥ 1; thus $0≤n+k-1-j≤k-1\lt2k$, and the first binomial coefficient in (<a href="../Text/ch01a.html#ch01eq-lev2sec6-29">29</a>) will vanish. We may therefore replace the condition on the second sum by 0 ≤ <em>j &lt; n</em>, and the interchange of summation is routine. Summing on <em>k</em> by Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-28">28</a>) now gives</p>

  <div class="image"><img src="../Images/ch01/e062_01.png"></div>

  <p>and all terms are zero except when <em>j</em> = <em>n</em> − 1. Hence our final answer is</p>

  <div class="image"><img src="../Images/ch01/e062_02.png"></div>

  <p class="indent">The solution to this problem was fairly complicated, but not really mysterious; there was a good reason for each step. The derivation should be studied closely because it illustrates some delicate maneuvering with the conditions in our equations. There is actually a better way to attack this problem, however; it is left to the reader to figure out a way to transform the given sum so that Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>) applies (see <a href="../Text/ch01a.html#ch01ex_2_6_30">exercise 30</a>).</p>

  <p><a id="ch01exam04"></a><strong>Example 4.</strong> Prove that</p>

  <div class="equation"><a id="ch01eq-lev2sec6-30"></a><img src="../Images/ch01/062equ01.png"></div>

  <p>where $A_{n}(x, t)$ is the <em>n</em>th degree polynomial in <em>x</em> that satisfies</p>

  <div class="image"><img src="../Images/ch01/e062_03.png"></div>

  <p><em>Solution.</em> We may assume that $r ≠ kt ≠ s$ for 0 ≤ <em>k</em> ≤ <em>n</em>, since both sides of (<a href="../Text/ch01a.html#ch01eq-lev2sec6-30">30</a>) are polynomials in <em>r</em>, <em>s</em>, <em>t</em>. Our problem is to evaluate</p>

  <div class="image"><img src="../Images/ch01/e062_04.png"></div>

  <p>which, if anything, looks much worse than our previous horrible problems! Notice the strong similarity to Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>), however, and also note the case <em>t</em> = 0.</p>

  <p class="indent">We are tempted to change</p>

  <div class="image"><img src="../Images/ch01/e062_05.png"></div>

  <p>except that the latter tends to lose the analogy with Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>) and it fails when <em>k</em> = 0. A better way to proceed is to use the technique of <em>partial fractions</em>, <a id="page_63"></a>whereby a fraction with a complicated denominator can often be replaced by a sum of fractions with simpler denominators. Indeed, we have</p>

  <div class="image"><img src="../Images/ch01/e063_01.png"></div>

  <p>Putting this into our sum we get</p>

  <div class="image"><img src="../Images/ch01/e063_02.png"></div>

  <p>and Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>) evaluates both of these formulas if we change <em>k</em> to <em>n</em> − <em>k</em> in the second; the desired result follows immediately. Identities (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-30">30</a>) are due to H. A. Rothe, <em>Formulæ de Serierum Reversione</em> (Leipzig: 1793); special cases of these formulas are still being “discovered” frequently. For the interesting history of these identities and some generalizations, see H. W. Gould and J. Kaucký, <em>Journal of Combinatorial Theory</em> <strong>1</strong> (1966), 233–247.</p>

  <p><a id="ch01exam05"></a><strong>Example 5.</strong> Determine the values of $a_{0}, a_{1}, a_{2},...$ such that</p>

  <div class="equation"><a id="ch01eq-lev2sec6-31"></a><img src="../Images/ch01/063equ01.png"></div>

  <p>for all nonnegative integers <em>n</em>.</p>

  <p><em>Solution.</em> Equation <a href="../Text/ch01.html#ch01lev2sec5">1.2.5</a>–(<a href="../Text/ch01.html#ch01eq-lev2sec5-11">11</a>), which was presented without proof in the previous section, gives the answer. Let us pretend that we don’t know it yet. It is clear that the problem does have a solution, since we can set <em>n</em> = 0 and determine $a_{0}$, then set <em>n</em> = 1 and determine $a_{1}$, etc.</p>

  <p class="indent">First we would like to write Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-31">31</a>) in terms of binomial coefficients:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-32"></a><img src="../Images/ch01/063equ02.png"></div>

  <p>The problem of solving implicit equations like this for $a_{k}$ is called the <em>inversion problem</em>, and the technique we shall use applies to similar problems as well.</p>

  <p class="indent">The idea is based on the special case <em>s</em> = 0 of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-23">23</a>):</p>

  <div class="equation"><a id="ch01eq-lev2sec6-33"></a><img src="../Images/ch01/063equ03.png"></div>

  <p>The importance of this formula is that when <em>n</em> ≠ <em>r</em>, the sum is zero; this enables us to solve our problem since a lot of terms cancel out as they did in <a href="../Text/ch01a.html#ch01exam03">Example 3</a>:</p>

  <div class="image"><img src="../Images/ch01/e063_03.png"></div>

  <p><a id="page_64"></a>Notice how we were able to get an equation in which only one value $a_{m}$ appears, by adding together suitable multiples of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-32">32</a>) for <em>n</em> = 0, 1, ... . We have now</p>

  <div class="image"><img src="../Images/ch01/e064_01.png"></div>

  <p class="indent">This completes the solution to <a href="../Text/ch01a.html#ch01exam05">Example 5</a>. Let us now take a closer look at the implications of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-33">33</a>): When <em>r</em> and <em>m</em> are nonnegative integers we have</p>

  <div class="image"><img src="../Images/ch01/e064_02.png"></div>

  <p>since the other terms vanish after summation. By properly choosing the coefficients $c_{i}$, we can represent <em>any</em> polynomial in <em>k</em> as a sum of binomial coefficients with upper index <em>k</em>. We find therefore that</p>

  <div class="equation"><a id="ch01eq-lev2sec6-34"></a><img src="../Images/ch01/064equ01.png"></div>

  <p>where $b_{0}+···+b_{r}k^{r}$ represents any polynomial whatever of degree <em>r</em> or less. (This formula will be of no great surprise to students of numerical analysis, since <span class="middle"><img src="../Images/ch01/e064_03.png"></span> is the “<em>r</em>th difference” of the function $f(x)$.)</p>

  <p class="indent">Using Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-34">34</a>), we can immediately obtain many other relations that appear complicated at first and that are often given very lengthy proofs, such as</p>

  <div class="equation"><a id="ch01eq-lev2sec6-35"></a><img src="../Images/ch01/064equ02.png"></div>

  <p class="indent">It is customary in textbooks such as this to give a lot of impressive examples of neat tricks, etc., but never to mention simple-looking problems where the techniques fail. The examples above may have given the impression that all things are possible with binomial coefficients; it should be mentioned, however, that in spite of Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-10">10</a>), (<a href="../Text/ch01a.html#ch01eq-lev2sec6-11">11</a>), and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-18">18</a>), there seems to be no simple formula for the analogous sum</p>

  <div class="equation"><a id="ch01eq-lev2sec6-36"></a><img src="../Images/ch01/064equ03.png"></div>

  <p>when <em>n &lt; m</em>. (For <em>n</em> = <em>m</em> the answer is simple; what is it? See <a href="../Text/ch01a.html#ch01ex_2_6_36">exercise 36</a>.)</p>

  <p class="indent">On the other hand this sum does have a closed form as a function of <em>n</em> when <em>m</em> is an explicit negative integer; for example,</p>

  <div class="equation"><a id="ch01eq-lev2sec6-37"></a><img src="../Images/ch01/064equ04.png"></div>

  <p>There is also a simple formula</p>

  <div class="equation"><a id="ch01eq-lev2sec6-38"></a><img src="../Images/ch01/064equ05.png"></div>

  <p>for a sum that looks as though it should be harder, not easier.</p>

  <p class="indent"><a id="page_65"></a>How can we decide when to stop working on a sum that resists simplification? Fortunately, there is now a good way to answer that question in many important cases: An algorithm due to R. W. Gosper and D. Zeilberger will discover closed forms in binomial coefficients when they exist, and will prove the impossibility when they do not exist. The Gosper–Zeilberger algorithm is beyond the scope of this book, but it is explained in <em>CMath</em> §5.8. See also the book <em>A = B</em> by Petkovšek, Wilf, and Zeilberger (Wellesley, Mass.: A. K. Peters, 1996).</p>

  <p class="indent">The principal tool for dealing with sums of binomial coefficients in a systematic, mechanical way is to exploit the properties of <em>hypergeometric functions</em>, which are infinite series defined as follows in terms of rising factorial powers:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-39"></a><img src="../Images/ch01/065equ01.png"></div>

  <p>An introduction to these important functions can be found in Sections 5.5 and 5.6 of <em>CMath</em>. See also J. Dutka, <em>Archive for History of Exact Sciences</em> <strong>31</strong> (1984), 15–34, for historical references.</p>

  <p class="indent">The concept of binomial coefficients has several significant generalizations, which we should discuss briefly. First, we can consider arbitrary real values of the lower index <em>k</em> in <span class="middle"><img src="../Images/ch01/rbyk.png"></span>; see <a href="../Text/ch01a.html#ch01ex_2_6_40">exercises 40</a> through <a href="../Text/ch01a.html#ch01ex_2_6_45">45</a>. We also have the generalization</p>

  <div class="equation"><a id="ch01eq-lev2sec6-40"></a><img src="../Images/ch01/065equ02.png"></div>

  <p>which becomes the ordinary binomial coefficient <span class="middle"><img src="../Images/ch01/e065_01.png"></span> when <em>q</em> approaches the limiting value 1; this can be seen by dividing each term in numerator and denominator by $1-q$. The basic properties of such “<em>q</em>-nomial coefficients” are discussed in <a href="../Text/ch01a.html#ch01ex_2_6_58">exercise 58</a>.</p>

  <p class="indent">However, for our purposes the most important generalization is the <em>multinomial coefficient</em></p>

  <div class="equation"><a id="ch01eq-lev2sec6-41"></a><img src="../Images/ch01/065equ03.png"></div>

  <p>The chief property of multinomial coefficients is the generalization of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-13">13</a>):</p>

  <div class="equation"><a id="ch01eq-lev2sec6-42"></a><img src="../Images/ch01/065equ04.png"></div>

  <p>It is important to observe that any multinomial coefficient can be expressed in terms of binomial coefficients:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-43"></a><img src="../Images/ch01/065equ05.png"></div>

  <p>so we may apply the techniques that we already know for manipulating binomial coefficients. Both sides of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-20">20</a>) are the trinomial coefficient</p>

  <div class="image"><img src="../Images/ch01/e065_02.png"></div>

  <div class="image4">
    <a id="page_66"></a><a id="ch01tab02"></a><img src="../Images/ch01/066tab01.png">

    <p class="tab-caption"><strong>Table 2</strong> Stirling Numbers of Both Kinds</p>
  </div>

  <p>For approximations valid when <em>n</em> is large, see L. Moser and M. Wyman, <em>J. London Math. Soc.</em> <strong>33</strong> (1958), 133–146; <em>Duke Math. J.</em> <strong>25</strong> (1958), 29–43; D. E. Barton, F. N. David, and M. Merrington, <em>Biometrika</em> <strong>47</strong> (1960), 439–445; <strong>50</strong> (1963), 169–176; N. M. Temme, <em>Studies in Applied Math.</em> <strong>89</strong> (1993), 233–243; H. S. Wilf, <em>J. Combinatorial Theory</em> <strong>A64</strong> (1993), 344–349; H.-K. Hwang, <em>J. Combinatorial Theory</em> <strong>A71</strong> (1995), 343–351.</p>

  <p class="indent">We conclude this section with a brief analysis of the transformation from a polynomial expressed in powers of <em>x</em> to a polynomial expressed in binomial coefficients. The coefficients involved in this transformation are called <em>Stirling numbers</em>, and these numbers arise in the study of numerous algorithms.</p>

  <p class="indent">Stirling numbers come in two flavors: We denote Stirling numbers of the first kind by <span class="middle"><img src="../Images/ch01/nbyk-2.png"></span>, and those of the second kind by <span class="middle"><img src="../Images/ch01/nbyk-1.png"></span>. These notations, due to Jovan Karamata [<em>Mathematica</em> (Cluj) <strong>9</strong> (1935), 164–178], have compelling advantages over the many other symbolisms that have been tried [see D. E. Knuth, <em>AMM</em> <strong>99</strong> (1992), 403–422]. We can remember the curly braces in <span class="middle"><img src="../Images/ch01/nbyk-1.png"></span> because curly braces denote sets, and <span class="middle"><img src="../Images/ch01/nbyk-1.png"></span> is the number of ways to partition a set of <em>n</em> elements into <em>k</em> disjoint subsets (<a href="../Text/ch01a.html#ch01ex_2_6_64">exercise 64</a>). The other Stirling numbers <span class="middle"><img src="../Images/ch01/nbyk-2.png"></span> also have a combinatorial interpretation, which we will study in <a href="../Text/ch01b.html#ch01lev2sec14">Section 1.3.3</a>: <span class="middle"><img src="../Images/ch01/nbyk-2.png"></span> is the number of permutations on <em>n</em> letters having <em>k</em> cycles.</p>

  <p class="indent"><a href="../Text/ch01a.html#ch01tab02">Table 2</a> displays Stirling’s triangles, which are in some ways analogous to Pascal’s triangle.</p>

  <p class="indent"><a id="page_67"></a>Stirling numbers of the first kind are used to convert from factorial powers to ordinary powers:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-44"></a><img src="../Images/ch01/067equ01.png"></div>

  <p>For example, from <a href="../Text/ch01a.html#ch01tab02">Table 2</a>,</p>

  <div class="image"><img src="../Images/ch01/e067_01.png"></div>

  <p class="indent">Stirling numbers of the second kind are used to convert from ordinary powers to factorial powers:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-45"></a><img src="../Images/ch01/067equ02.png"></div>

  <p>This formula was, in fact, Stirling’s original reason for studying the numbers <span class="middle"><img src="../Images/ch01/nbyk-1.png"></span> in his <em>Methodus Differentialis</em> (London: 1730). From <a href="../Text/ch01a.html#ch01tab02">Table 2</a> we have, for example,</p>

  <div class="image"><img src="../Images/ch01/e067_02.png"></div>

  <p class="indent">We shall now list the most important identities involving Stirling numbers. In these equations, the variables <em>m</em> and <em>n</em> always denote nonnegative integers.</p>

  <p>Addition formulas:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-46"></a><img src="../Images/ch01/067equ03.png"></div>

  <p>Inversion formulas (compare with Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-33">33</a>)):</p>

  <div class="equation"><a id="ch01eq-lev2sec6-47"></a><img src="../Images/ch01/067equ04.png"></div>

  <p>Special values:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-48"></a><img src="../Images/ch01/067equ05.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec6-49"></a><img src="../Images/ch01/067equ06.png"></div>

  <div class="equation"><a id="page_68"></a><a id="ch01eq-lev2sec6-50"></a><img src="../Images/ch01/068equ01.png"></div>

  <p>Expansion formulas:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-51"></a><img src="../Images/ch01/068equ02.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec6-52"></a><img src="../Images/ch01/068equ03.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec6-53"></a><img src="../Images/ch01/068equ04.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec6-54"></a><img src="../Images/ch01/068equ05.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec6-55"></a><img src="../Images/ch01/068equ06.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec6-56"></a><img src="../Images/ch01/068equ07.png"></div>

  <p>Some other fundamental Stirling number identities appear in <a href="../Text/ch01a.html#ch01ex_2_6_61">exercises 1.2.6–61</a> and <a href="../Text/ch01a.html#ch01ex_2_7_6">1.2.7–6</a>, and in Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-23">23</a>), (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>), (<a href="../Text/ch01a.html#ch01eq-lev2sec6-27">27</a>), and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-28">28</a>) of <a href="../Text/ch01a.html#ch01lev2sec9">Section 1.2.9</a>.</p>

  <p class="indent">Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-49">49</a>) is just one instance of a general phenomenon: Both kinds of Stirling numbers <span class="middle"><img src="../Images/ch01/e068_01.png"></span> and <span class="middle"><img src="../Images/ch01/e068_02.png"></span> are polynomials in <em>n</em> of degree $2m$, whenever <em>m</em> is a nonnegative integer. For example, the formulas for <em>m</em> = 2 and <em>m</em> = 3 are</p>

  <div class="equation"><a id="ch01eq-lev2sec6-57"></a><img src="../Images/ch01/068equ08.png"></div>

  <p>Therefore it makes sense to define the numbers <span class="middle"><img src="../Images/ch01/e068_03.png"></span> and <span class="middle"><img src="../Images/ch01/e068_04.png"></span> for arbitrary real (or complex) values of <em>r</em>. With this generalization, the two kinds of Stirling numbers are united by an interesting duality law</p>

  <div class="equation"><a id="ch01eq-lev2sec6-58"></a><img src="../Images/ch01/068equ09.png"></div>

  <p><a id="page_69"></a>which was implicit in Stirling’s original discussion. Moreover, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-45">45</a>) remains true in general, in the sense that the infinite series</p>

  <div class="equation"><a id="ch01eq-lev2sec6-59"></a><img src="../Images/ch01/069equ01.png"></div>

  <p>converges whenever the real part of <em>z</em> is positive. The companion formula, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-44">44</a>), generalizes in a similar way to an asymptotic (but not convergent) series:</p>

  <div class="equation"><a id="ch01eq-lev2sec6-60"></a><img src="../Images/ch01/069equ02.png"></div>

  <p>(See <a href="../Text/ch01a.html#ch01ex_2_6_65">exercise 65</a>.) Sections 6.1, 6.2, and 6.5 of <em>CMath</em> contain additional information about Stirling numbers and how to manipulate them in formulas. See also exercise 4.7–21 for a general family of triangles that includes Stirling numbers as a very special case.</p>

  <p class="ex-title">Exercises</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_6_1a" id="ch01ex_2_6_1">1</a>.</strong> [<em>00</em>] How many combinations of <em>n</em> things taken <em>n</em> − 1 at a time are possible?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_6_2a" id="ch01ex_2_6_2">2</a>.</strong> [<em>00</em>] What is <span class="middle"><img src="../Images/ch01/0by0.png"></span>?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_6_3a" id="ch01ex_2_6_3">3</a>.</strong> [<em>00</em>] How many bridge hands (13 cards out of a 52-card deck) are possible?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_6_4a" id="ch01ex_2_6_4">4</a>.</strong> [<em>10</em>] Give the answer to <a href="../Text/ch01a.html#ch01ex_2_6_3">exercise 3</a> as a product of prime numbers.</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_6_5a" id="ch01ex_2_6_5">5</a>.</strong> [<em>05</em>] Use Pascal’s triangle to explain the fact that 11<sup>4</sup> = 14641.</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_6_6a" id="ch01ex_2_6_6">6</a>.</strong> [<em>10</em>] Pascal’s triangle (<a href="../Text/ch01a.html#ch01tab01">Table 1</a>) can be extended in all directions by use of the addition formula, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-9">9</a>). Find the three rows that go on <em>top</em> of <a href="../Text/ch01a.html#ch01tab01">Table 1</a> (i.e., for <em>r</em> = −1, −2, and −3).</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_6_7a" id="ch01ex_2_6_7">7</a>.</strong> [<em>12</em>] If <em>n</em> is a fixed positive integer, what value of <em>k</em> makes <span class="middle"><img src="../Images/ch01/nbyk.png"></span> a maximum?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_6_8a" id="ch01ex_2_6_8">8</a>.</strong> [<em>00</em>] What property of Pascal’s triangle is reflected in the “symmetry condition,” Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-6">6</a>)?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_6_9a" id="ch01ex_2_6_9">9</a>.</strong> [<em>01</em>] What is the value of <span class="middle"><img src="../Images/ch01/nbyn.png"></span>? (Consider all integers <em>n</em>.)</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_6_10a" id="ch01ex_2_6_10">10</a>.</strong> [<em>M25</em>] If <em>p</em> is prime, show that:</p>

  <p class="indenthanging-A">a) $<span class="middle"><img src="../Images/ch01/e069_01.png"></span> (modulo p)$.</p>

  <p class="indenthanging-A">b) $<span class="middle"><img src="../Images/ch01/e069_02.png"></span> (modulo p)$, for $1≤k≤p-1$.</p>

  <p class="indenthanging-A">c) $<span class="middle"><img src="../Images/ch01/e069_03.png"></span> (modulo p)$, for $0≤k≤p-1$.</p>

  <p class="indenthanging-A">d) $<span class="middle"><img src="../Images/ch01/e069_04.png"></span> (modulo p)$, for $2≤k≤p-1$.</p>

  <p class="indenthanging-A">e) (É. Lucas, 1877.)</p>

  <div class="image"><img src="../Images/ch01/e069_05.png"></div>

  <p class="indenthanging-A">f) If the <em>p</em>-ary number system representations of <em>n</em> and <em>k</em> are</p>

  <div class="image"><img src="../Images/ch01/e069_06.png"></div>

  <p class="exercises3"><a id="page_70"></a><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_6_11a" id="ch01ex_2_6_11">11</a>.</strong> [<em>M20</em>] (E. Kummer, 1852.) Let <em>p</em> be prime. Show that if $p^{n}$ divides</p>

  <div class="image"><img src="../Images/ch01/e070_01.png"></div>

  <p class="exercisesp">but <em>p</em><sup><em>n</em>+1</sup> does not, then <em>n</em> is equal to the number of <em>carries</em> that occur when <em>a</em> is added to <em>b</em> in the <em>p</em>-ary number system. [<em>Hint:</em> See exercise <a href="../Text/ch01.html#ch01lev2sec5">1.2.5</a>–<a href="../Text/ch01a.html#ch01ex_2_5_12">12</a>.]</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_12a" id="ch01ex_2_6_12">12</a>.</strong> [<em>M22</em>] Are there any positive integers <em>n</em> for which all the nonzero entries in the <em>n</em>th row of Pascal’s triangle are <em>odd</em>? If so, find all such <em>n</em>.</p>

  <p class="exercises1"><strong>13.</strong> [<em>M13</em>] Prove the summation formula, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-10">10</a>).</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_14a" id="ch01ex_2_6_14">14</a>.</strong> [<em>M21</em>] Evaluate <span class="middle"><img src="../Images/ch01/e070_02.png"></span>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_15a" id="ch01ex_2_6_15">15</a>.</strong> [<em>M15</em>] Prove the binomial formula, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-13">13</a>).</p>

  <p class="exercises1"><strong>16.</strong> [<em>M15</em>] Given that <em>n</em> and <em>k</em> are positive integers, prove the symmetrical identity</p>

  <div class="image"><img src="../Images/ch01/e070_03.png"></div>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_6_17a" id="ch01ex_2_6_17">17</a>.</strong> [<em>M18</em>] Prove the Chu–Vandermonde formula (<a href="../Text/ch01a.html#ch01eq-lev2sec6-21">21</a>) from Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-15">15</a>), using the idea that $(1+x)^{r+s}=(1+x)^{r} (1+x)^{s}$.</p>

  <p class="exercises1"><strong><a id="ch01ex_2_6_18"></a>18.</strong> [<em>M15</em>] Prove Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-22">22</a>) using Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-21">21</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-6">6</a>).</p>

  <p class="exercises1"><strong>19.</strong> [<em>M18</em>] Prove Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-23">23</a>) by induction.</p>

  <p class="exercises1"><strong><a id="ch01ex_2_6_20"></a>20.</strong> [<em>M20</em>] Prove Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-24">24</a>) by using Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-21">21</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-19">19</a>), then show that another use of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-19">19</a>) yields Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-25">25</a>).</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_6_21a" id="ch01ex_2_6_21">21</a>.</strong> [<em>M05</em>] Both sides of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-25">25</a>) are polynomials in <em>s</em>; why isn’t that equation an identity in <em>s</em>?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_22a" id="ch01ex_2_6_22">22</a>.</strong> [<em>M20</em>] Prove Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>) for the special case $s=n-1-r+nt$.</p>

  <p class="exercises1"><strong>23.</strong> [<em>M13</em>] Assuming that Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>) holds for $(r, s, t, n)$ and $(r, s-t, t, n-1)$, prove it for $(r, s+1, t, n)$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_24a" id="ch01ex_2_6_24">24</a>.</strong> [<em>M15</em>] Explain why the results of the previous two exercises combine to give a proof of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>).</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_25a" id="ch01ex_2_6_25">25</a>.</strong> [<em>HM30</em>] Let the polynomial $A_{n}(x,t)$ be defined as in <a href="../Text/ch01a.html#ch01exam04">Example 4</a> (see Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-30">30</a>)). Let $z=x^{t+1}-x^{t}$. Prove that $∑_{k}A_{k}(r,t)z^{k}=x^{r}$, provided that <em>x</em> is close enough to 1. [<em>Note:</em> If <em>t</em> = 0, this result is essentially the binomial theorem, and this equation is an important generalization of that theorem. The binomial theorem (<a href="../Text/ch01a.html#ch01eq-lev2sec6-15">15</a>) may be assumed in the proof.] <em>Hint:</em> Start with multiples of a special case of (<a href="../Text/ch01a.html#ch01eq-lev2sec6-34">34</a>),</p>

  <div class="image"><img src="../Images/ch01/e070_04.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_26a" id="ch01ex_2_6_26">26</a>.</strong> [<em>HM25</em>] Using the assumptions of the previous exercise, prove that</p>

  <div class="image"><img src="../Images/ch01/e070_05.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_27a" id="ch01ex_2_6_27">27</a>.</strong> [<em>HM21</em>] Solve <a href="../Text/ch01a.html#ch01exam04">Example 4</a> in the text by using the result of <a href="../Text/ch01a.html#ch01ex_2_6_25">exercise 25</a>; and prove Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>) from the preceding two exercises. [<em>Hint:</em> See <a href="../Text/ch01a.html#ch01ex_2_6_17">exercise 17</a>.]</p>

  <p class="exercises1"><a id="page_71"></a><strong><a href="../Text/app01.html#ch01ex_2_6_28a" id="ch01ex_2_6_28">28</a>.</strong> [<em>M25</em>] Prove that</p>

  <div class="image"><img src="../Images/ch01/e071_01.png"></div>

  <p class="exercisesp">if <em>n</em> is a nonnegative integer.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_29a" id="ch01ex_2_6_29">29</a>.</strong> [<em>M20</em>] Show that Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-34">34</a>) is just a special case of the general identity proved in exercise <a href="../Text/ch01.html#ch01lev2sec3">1.2.3</a>–<a href="../Text/ch01.html#ch01ex_2_3_33">33</a>.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_6_30a" id="ch01ex_2_6_30">30</a>.</strong> [<em>M24</em>] Show that there is a better way to solve <a href="../Text/ch01a.html#ch01exam03">Example 3</a> than the way used in the text, by manipulating the sum so that Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>) applies.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_6_31a" id="ch01ex_2_6_31">31</a>.</strong> [<em>M20</em>] Evaluate</p>

  <div class="image"><img src="../Images/ch01/e071_02.png"></div>

  <p class="exercisesp">in terms of <em>r</em>, <em>s</em>, <em>m</em>, and <em>n</em>, given that <em>m</em> and <em>n</em> are integers. Begin by replacing</p>

  <div class="image"><img src="../Images/ch01/e071_03.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_32a" id="ch01ex_2_6_32">32</a>.</strong> [<em>M20</em>] Show that <span class="middle"><img src="../Images/ch01/e071_04.png"></span>, where <span class="middle"><img src="../Images/ch01/e071_05.png"></span> is the rising factorial power defined in Eq. <a href="../Text/ch01.html#ch01lev2sec5">1.2.5</a>–(<a href="../Text/ch01.html#ch01eq-lev2sec5-19">19</a>).</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_33a" id="ch01ex_2_6_33">33</a>.</strong> [<em>M20</em>] (A. Vandermonde, 1772.) Show that the binomial formula is valid also when it involves factorial powers instead of the ordinary powers. In other words, prove that</p>

  <div class="image"><img src="../Images/ch01/e071_06.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_34a" id="ch01ex_2_6_34">34</a>.</strong> [<em>M23</em>] (<em>Torelli’s sum</em>.) In the light of the previous exercise, show that Abel’s generalization, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-16">16</a>), of the binomial formula is true also for rising powers:</p>

  <div class="image"><img src="../Images/ch01/e071_07.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_35a" id="ch01ex_2_6_35">35</a>.</strong> [<em>M23</em>] Prove the addition formulas (<a href="../Text/ch01a.html#ch01eq-lev2sec6-46">46</a>) for Stirling numbers directly from the definitions, Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-44">44</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-45">45</a>).</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_36a" id="ch01ex_2_6_36">36</a>.</strong> [<em>M10</em>] What is the sum <span class="middle"><img src="../Images/ch01/e071_08.png"></span> of the numbers in each row of Pascal’s triangle? What is the sum of these numbers with alternating signs,<span class="middle"><img src="../Images/ch01/e071_09.png"></span></p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_37a" id="ch01ex_2_6_37">37</a>.</strong> [<em>M10</em>] From the answers to the preceding exercise, deduce the value of the sum of every other entry in a row, <span class="middle"><img src="../Images/ch01/e071_10.png"></span>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_38a" id="ch01ex_2_6_38">38</a>.</strong> [<em>HM30</em>] (C. Ramus, 1834.) Generalizing the result of the preceding exercise, show that we have the following formula, given that 0 ≤ <em>k &lt; m</em>:</p>

  <div class="image"><img src="../Images/ch01/e071_11.png"></div>

  <p class="exercisesp">For example,</p>

  <div class="image"><img src="../Images/ch01/e071_12.png"></div>

  <p class="exercisesp">[<em>Hint:</em> Find the right combinations of these coefficients multiplied by <em>m</em>th roots of unity.] This identity is particularly remarkable when <em>m</em> ≥ <em>n</em>.</p>

  <p class="exercises1"><a id="page_72"></a><strong><a href="../Text/app01.html#ch01ex_2_6_39a" id="ch01ex_2_6_39">39</a>.</strong> [<em>M10</em>] What is the sum <span class="middle"><img src="../Images/ch01/e072_01.png"></span> of the numbers in each row of Stirling’s first triangle? What is the sum of these numbers with alternating signs? (See <a href="../Text/ch01a.html#ch01ex_2_6_36">exercise 36</a>.)</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_40a" id="ch01ex_2_6_40">40</a>.</strong> [<em>HM17</em>] The <em>beta function</em> {\rm B}(<em>x, y</em>) is defined for positive real numbers <em>x</em>, <em>y</em> by the formula <span class="middle"><img src="../Images/ch01/e072_02.png"></span></p>

  <p class="indenthanging-A">a) Show that ${\rm B}(x, 1)={\rm B}(1, x)=1/x$.</p>

  <p class="indenthanging-A">b) Show that ${\rm B}(x+1, y)+{\rm B}(x, y+1)={\rm B}(x, y)$.</p>

  <p class="indenthanging-A">c) Show that ${\rm B}(x, y)=((x+y)/y) {\rm B}(x, y+1)$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_41a" id="ch01ex_2_6_41">41</a>.</strong> [<em>HM22</em>] We proved a relation between the gamma function and the beta function in exercise <a href="../Text/ch01.html#ch01lev2sec5">1.2.5</a>–<a href="../Text/ch01a.html#ch01ex_2_5_19">19</a>, by showing that $Γ_{m} (x)=m^{x} {\rm B}(x, m+1)$, if <em>m</em> is a positive integer.</p>

  <p class="indenthanging-A">a) Prove that</p>

  <div class="image"><img src="../Images/ch01/e072_03.png"></div>

  <p class="indenthanging-A">b) Show that</p>

  <div class="image"><img src="../Images/ch01/e072_04.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_42a" id="ch01ex_2_6_42">42</a>.</strong> [<em>HM10</em>] Express the binomial coefficient <span class="middle"><img src="../Images/ch01/rbyk.png"></span> in terms of the beta function defined above. (This gives us a way to extend the definition to all real values of <em>k</em>.)</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_43a" id="ch01ex_2_6_43">43</a>.</strong> [<em>HM20</em>] Show that ${\rm B}(1/2, 1/2)=π$. (From <a href="../Text/ch01a.html#ch01ex_2_6_41">exercise 41</a> we may now conclude that <span class="middle"><img src="../Images/ch01/e072_05.png"></span>.)</p>

  <p class="exercises1"><strong>44.</strong> [<em>HM20</em>] Using the generalized binomial coefficient suggested in <a href="../Text/ch01a.html#ch01ex_2_6_42">exercise 42</a>, show that</p>

  <div class="image"><img src="../Images/ch01/e072_06.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_45a" id="ch01ex_2_6_45">45</a>.</strong> [<em>HM21</em>] Using the generalized binomial coefficient suggested in <a href="../Text/ch01a.html#ch01ex_2_6_42">exercise 42</a>, find <span class="middle"><img src="../Images/ch01/e072_07.png"></span>.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_6_46a" id="ch01ex_2_6_46">46</a>.</strong> [<em>M21</em>] Using Stirling’s approximation, Eq. <a href="../Text/ch01.html#ch01lev2sec5">1.2.5</a>–(<a href="../Text/ch01.html#ch01eq-lev2sec5-7">7</a>), find an approximate value of <span class="middle"><img src="../Images/ch01/e072_08.png"></span>, assuming that both <em>x</em> and <em>y</em> are large. In particular, find the approximate size of <span class="middle"><img src="../Images/ch01/e072_09.png"></span> when <em>n</em> is large.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_47a" id="ch01ex_2_6_47">47</a>.</strong> [<em>M21</em>] Given that <em>k</em> is an integer, show that</p>

  <div class="image"><img src="../Images/ch01/e072_10.png"></div>

  <p class="exercisesp">Give a simpler formula for the special case $r=-1/2$.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_6_48a" id="ch01ex_2_6_48">48</a>.</strong> [<em>M25</em>] Show that</p>

  <div class="image"><img src="../Images/ch01/e072_11.png"></div>

  <p class="exercisesp">if the denominators are not zero. [Note that this formula gives us the reciprocal of a binomial coefficient, as well as the partial fraction expansion of $1/x(x+1)... (x+n)$.]</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_49a" id="ch01ex_2_6_49">49</a>.</strong> [<em>M20</em>] Show that the identity $(1+x)^{r}=(1-x^{2})^{r} (1-x)^{-r}$ implies a relation on binomial coefficients.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_50a" id="ch01ex_2_6_50">50</a>.</strong> [<em>M20</em>] Prove Abel’s formula, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-16">16</a>), in the special case <em>x</em> + <em>y</em> = 0.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_51a" id="ch01ex_2_6_51">51</a>.</strong> [<em>M21</em>] Prove Abel’s formula, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-16">16</a>), by writing $y=(x+y)-x$, expanding the right-hand side in powers of $(x+y)$, and applying the result of the previous exercise.</p>

  <p class="exercises1"><a id="page_73"></a><strong><a href="../Text/app01.html#ch01ex_2_6_52a" id="ch01ex_2_6_52">52</a>.</strong> [<em>HM11</em>] Prove that Abel’s binomial formula (<a href="../Text/ch01a.html#ch01eq-lev2sec6-16">16</a>) is not always valid when <em>n</em> is not a nonnegative integer, by evaluating the right-hand side when <em>n</em> = <em>x</em> = −1, <em>y</em> = <em>z</em> = 1.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_53a" id="ch01ex_2_6_53">53</a>.</strong> [<em>M25</em>] (a) Prove the following identity by induction on <em>m</em>, where <em>m</em> and <em>n</em> are integers:</p>

  <div class="image"><img src="../Images/ch01/e073_01.png"></div>

  <p class="exercisesp">(b) Making use of important relations from <a href="../Text/ch01a.html#ch01ex_2_6_47">exercise 47</a>,</p>

  <div class="image"><img src="../Images/ch01/e073_02.png"></div>

  <p class="exercisesp">show that the following formula can be obtained as a special case of the identity in part (a):</p>

  <div class="image"><img src="../Images/ch01/e073_03.png"></div>

  <p class="exercisesp">(This result is considerably more general than Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-26">26</a>) in the case <em>r</em> = −1, <em>s</em> = 0, <em>t</em> = − 2.)</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_54a" id="ch01ex_2_6_54">54</a>.</strong> [<em>M21</em>] Consider Pascal’s triangle (as shown in <a href="../Text/ch01a.html#ch01tab01">Table 1</a>) as a matrix. What is the <em>inverse</em> of that matrix?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_55a" id="ch01ex_2_6_55">55</a>.</strong> [<em>M21</em>] Considering each of Stirling’s triangles (<a href="../Text/ch01a.html#ch01tab02">Table 2</a>) as matrices, determine their inverses.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_56a" id="ch01ex_2_6_56">56</a>.</strong> [<em>20</em>] (<em>The combinatorial number system</em>.) For each integer $n=0, 1, 2,..., 20$, find three integers <em>a</em>, <em>b</em>, <em>c</em> for which <span class="middle"><img src="../Images/ch01/e073_04.png"></span> and <em>a &gt; b &gt; c</em> ≥ 0. Can you see how this pattern can be continued for higher values of <em>n</em>?</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong>57.</strong> [<em>M22</em>] Show that the coefficient a_{m} in Stirling’s attempt at generalizing the factorial function, Eq. <a href="../Text/ch01.html#ch01lev2sec5">1.2.5</a>–(<a href="../Text/ch01.html#ch01eq-lev2sec5-12">12</a>), is</p>

  <div class="image"><img src="../Images/ch01/e073_05.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_58a" id="ch01ex_2_6_58">58</a>.</strong> [<em>M23</em>] (H. A. Rothe, 1811.) In the notation of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-40">40</a>), prove the “<em>q</em>-nomial theorem”:</p>

  <div class="image"><img src="../Images/ch01/e073_06.png"></div>

  <p class="exercisesp">Also find <em>q</em>-nomial generalizations of the fundamental identities (<a href="../Text/ch01a.html#ch01eq-lev2sec6-17">17</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-21">21</a>).</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_59a" id="ch01ex_2_6_59">59</a>.</strong> [<em>M25</em>] A sequence of numbers $A<sub>nk</sub>$, $n ≥ 0$, $k ≥ 0$, satisfies the relations $A<sub>n0</sub>=1$, $A<sub>0k=δ0k,</sub><span class="middle"><img src="../Images/ch01/e073_07.png"></span>$ for $nk\gt0$. Find $A<sub>nk</sub>$.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_6_60a" id="ch01ex_2_6_60">60</a>.</strong> [<em>M23</em>] We have seen that <span class="middle"><img src="../Images/ch01/nbyk.png"></span> is the number of combinations of <em>n</em> things, <em>k</em> at a time, namely the number of ways to choose <em>k</em> different things out of a set of <em>n</em>. The <em>combinations with repetitions</em> are similar to ordinary combinations, except that we may choose each object any number of times. Thus, the list (<a href="../Text/ch01a.html#ch01eq-lev2sec6-1">1</a>) would be extended to include also <em>aaa</em>, <em>aab</em>, <em>aac</em>, <em>aad</em>, <em>aae</em>, <em>abb</em>, etc., if we were considering combinations with repetition. How many <em>k</em>-combinations of <em>n</em> objects are there, if repetition is allowed?</p>

  <p class="exercises1"><a id="page_74"></a><strong><a href="../Text/app01.html#ch01ex_2_6_61a" id="ch01ex_2_6_61">61</a>.</strong> [<em>M25</em>] Evaluate the sum</p>

  <div class="image"><img src="../Images/ch01/e074_01.png"></div>

  <p class="exercisesp">thereby obtaining a companion formula for Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-55">55</a>).</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_6_62a" id="ch01ex_2_6_62">62</a>.</strong> [<em>M23</em>] The text gives formulas for sums involving a product of two binomial coefficients. Of the sums involving a product of three binomial coefficients, the following one and the identity of <a href="../Text/ch01a.html#ch01ex_2_6_31">exercise 31</a> seem to be most useful:</p>

  <div class="image"><img src="../Images/ch01/e074_02.png"></div>

  <p class="exercisesp">(The sum includes both positive and negative values of <em>k</em>.) Prove this identity. [<em>Hint:</em> There is a very short proof, which begins by applying the result of <a href="../Text/ch01a.html#ch01ex_2_6_31">exercise 31</a>.]</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_63a" id="ch01ex_2_6_63">63</a>.</strong> [<em>M30</em>] If <em>l</em>, <em>m</em>, and <em>n</em> are integers and <em>n</em> ≥ 0, prove that</p>

  <div class="image"><img src="../Images/ch01/e074_03.png"></div>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_6_64a" id="ch01ex_2_6_64">64</a>.</strong> [<em>M20</em>] Show that <span class="middle"><img src="../Images/ch01/nbym.png"></span> is the number of ways to partition a set of <em>n</em> elements into <em>m</em> nonempty disjoint subsets. For example, the set $\{1, 2, 3, 4\}$ can be partitioned into two subsets in <span class="middle"><img src="../Images/ch01/e074_04.png"></span> ways: $\{1, 2, 3\}\{4\}$; $\{1, 2, 4\}\{3\}$; $\{1, 3, 4\}\{2\}$; $\{2, 3, 4\}\{1\}$; $\{1, 2\}\{3, 4\}$; $\{1, 3\}\{2, 4\}$; $\{1, 4\}\{2, 3\}$. <em>Hint:</em> Use Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-46">46</a>).</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_65a" id="ch01ex_2_6_65">65</a>.</strong> [<em>HM35</em>] (B. F. Logan.) Prove Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec6-59">59</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec6-60">60</a>).</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_66a" id="ch01ex_2_6_66">66</a>.</strong> [<em>HM30</em>] Suppose <em>x</em>, <em>y</em>, and <em>z</em> are real numbers satisfying</p>

  <div class="image"><img src="../Images/ch01/e074_05.png"></div>

  <p class="exercisesp">where $x ≥ n-1$, $y ≥ n-1$, $z\gt n-2$, and <em>n</em> is an integer ≥ 2. Prove that</p>

  <div class="image"><img src="../Images/ch01/e074_06.png"></div>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_6_67a" id="ch01ex_2_6_67">67</a>.</strong> [<em>M20</em>] We often need to know that binomial coefficients aren’t too large. Prove the easy-to-remember upper bound</p>

  <div class="image"><img src="../Images/ch01/e074_07.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_6_68a" id="ch01ex_2_6_68">68</a>.</strong> [<em>M25</em>] (A. de Moivre.) Prove that, if <em>n</em> is a nonnegative integer,</p>

  <div class="image"><img src="../Images/ch01/e074_08.png"></div>

  <div class="heading">
    <h4 id="ch01lev2sec7"><a id="page_75"></a>1.2.7. Harmonic Numbers</h4>

    <p>The following sum will be of great importance in our later work:</p>
  </div>

  <div class="equation"><a id="ch01eq-lev2sec7-1"></a><img src="../Images/ch01/075equ01.png"></div>

  <p>This sum does not occur very frequently in classical mathematics, and there is no standard notation for it; but in the analysis of algorithms it pops up nearly every time we turn around, and we will consistently call it $H_{n}$. Besides $H_{n}$, the notations $h_{n}$ and $S_{n}$ and $Ψ(n+1)+γ$ are found in mathematical literature. The letter <em>H</em> stands for “harmonic,” and we speak of $H_{n}$ as a <em>harmonic number</em> because (<a href="../Text/ch01a.html#ch01eq-lev2sec7-1">1</a>) is customarily called the harmonic series. Chinese bamboo strips written before 186 B.C. already explained how to compute $H<sub>10</sub>=7381/2520$, as an exercise in arithmetic. [See C. Cullen, <em>Historia Math.</em> <strong>34</strong> (2007), 10–44.]</p>

  <p class="indent">It may seem at first that $H_{n}$ does not get too large when <em>n</em> has a large value, since we are always adding smaller and smaller numbers. But actually it is not hard to see that $H_{n}$ will get as large as we please if we take <em>n</em> to be big enough, because</p>

  <div class="equation"><a id="ch01eq-lev2sec7-2"></a><img src="../Images/ch01/075equ02.png"></div>

  <p>This lower bound follows from the observation that, for <em>m</em> ≥ 0, we have</p>

  <div class="image"><img src="../Images/ch01/e075_01.png"></div>

  <p>So as <em>m</em> increases by 1, the left-hand side of (<a href="../Text/ch01a.html#ch01eq-lev2sec7-2">2</a>) increases by at least <span class="middle"><img src="../Images/ch01/1by2.png"></span>.</p>

  <p class="indent">It is important to have more detailed information about the value of $H_{n}$ than is given in Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec7-2">2</a>). The approximate size of $H_{n}$ is a well-known quantity (at least in mathematical circles) that may be expressed as follows:</p>

  <div class="equation"><a id="ch01eq-lev2sec7-3"></a><img src="../Images/ch01/075equ03.png"></div>

  <p>Here $γ=0.5772156649...$ is <em>Euler’s constant</em>, introduced by Leonhard Euler in <em>Commentarii Acad. Sci. Imp. Pet</em>. <strong>7</strong> (1734), 150–161. Exact values of $H_{n}$ for small <em>n</em>, and a 40-place value for <em>γ</em>, are given in the tables in <a href="../Text/app02.html#app02">Appendix A</a>. We shall derive Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec7-3">3</a>) in <a href="../Text/ch01b.html#ch01lev3sec2">Section 1.2.11.2</a>.</p>

  <p class="indent">Thus $H_{n}$ is reasonably close to the natural logarithm of <em>n</em>. <a href="../Text/ch01a.html#ch01ex_2_7_7">Exercise 7(a)</a> demonstrates in a simple way that $H_{n}$ has a somewhat logarithmic behavior.</p>

  <p class="indent">In a sense, $H_{n}$ just barely goes to infinity as <em>n</em> gets large, because the similar sum</p>

  <div class="equation"><a id="ch01eq-lev2sec7-4"></a><img src="../Images/ch01/075equ04.png"></div>

  <p>stays bounded for all <em>n</em>, when <em>r</em> is any real-valued exponent <em>greater</em> than unity. (See <a href="../Text/ch01a.html#ch01ex_2_7_3">exercise 3</a>.) We denote the sum in Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec7-4">4</a>) by <span class="middle"><img src="../Images/ch01/e075_02.png"></span>.</p>

  <p class="indent"><a id="page_76"></a>When the exponent <em>r</em> in Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec7-4">4</a>) is at least 2, the value of <span class="middle"><img src="../Images/ch01/e076_01.png"></span> is fairly close to its maximum value <span class="middle"><img src="../Images/ch01/e076_02.png"></span>, except for very small <em>n</em>. The quantity <span class="middle"><img src="../Images/ch01/e076_03.png"></span> is very well known in mathematics as <em>Riemann’s zeta function</em>:</p>

  <div class="equation"><a id="ch01eq-lev2sec7-5"></a><img src="../Images/ch01/076equ01.png"></div>

  <p>If <em>r</em> is an even integer, the value of $ζ (r)$ is known to be equal to</p>

  <div class="equation"><a id="ch01eq-lev2sec7-6"></a><img src="../Images/ch01/076equ02.png"></div>

  <p>where $B_{r}$ is a Bernoulli number (see <a href="../Text/ch01b.html#ch01lev3sec2">Section 1.2.11.2</a> and <a href="../Text/app02.html#app02">Appendix A</a>). In particular,</p>

  <div class="equation"><a id="ch01eq-lev2sec7-7"></a><img src="../Images/ch01/076equ03.png"></div>

  <p>These results are due to Euler; for discussion and proof, see <em>CMath</em>, §6.5.</p>

  <p class="indent">Now we will consider a few important sums that involve harmonic numbers. First,</p>

  <div class="equation"><a id="ch01eq-lev2sec7-8"></a><img src="../Images/ch01/076equ04.png"></div>

  <p>This follows from a simple interchange of summation:</p>

  <div class="image"><img src="../Images/ch01/e076_04.png"></div>

  <p class="indent">Formula (<a href="../Text/ch01a.html#ch01eq-lev2sec7-8">8</a>) is a special case of the sum <span class="middle"><img src="../Images/ch01/e076_05.png"></span>, which we will now determine using an important technique called summation by parts (see <a href="../Text/ch01a.html#ch01ex_2_7_10">exercise 10</a>). Summation by parts is a useful way to evaluate ∑ a_{k}b_{k} whenever the quantities $∑ a_{k}$ and $(b_{k+1}-b_{k})$ have simple forms. We observe in this case that</p>

  <div class="image"><img src="../Images/ch01/e076_06.png"></div>

  <p>and therefore</p>

  <div class="image"><img src="../Images/ch01/e076_07.png"></div>

  <p>hence</p>

  <div class="image"><img src="../Images/ch01/e076_08.png"></div>

  <p><a id="page_77"></a>Applying Eq. <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec6-11">11</a>) yields the desired formula:</p>

  <div class="equation"><a id="ch01eq-lev2sec7-9"></a><img src="../Images/ch01/077equ01.png"></div>

  <p>(This derivation and its final result are analogous to the evaluation of</p>

  <div class="image"><img src="../Images/ch01/e077_01.png"></div>

  <p>using what calculus books call integration by parts.)</p>

  <p class="indent">We conclude this section by considering a different kind of sum, <span class="middle"><img src="../Images/ch01/e077_02.png"></span>, which we will temporarily denote by $S_{n}$ for brevity. We find that</p>

  <div class="image"><img src="../Images/ch01/e077_03.png"></div>

  <p>Hence $S_{n+1}=(x+1)S_{n}+((x+1)^{n+1}-1)/(n+1)$, and we have</p>

  <div class="image"><img src="../Images/ch01/e077_04.png"></div>

  <p>This equation, together with the fact that $S_{1}=x$, shows us that</p>

  <div class="equation"><a id="ch01eq-lev2sec7-10"></a><img src="../Images/ch01/077equ02.png"></div>

  <p>The new sum is part of the infinite series <a href="../Text/ch01a.html#ch01lev2sec9">1.2.9</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec9-17">17</a>) for $\ln(1/(1-1/(x+1)))=\ln(1+1/x)$, and when <em>x</em> &gt; 0, the series is convergent; the difference is</p>

  <div class="image"><img src="../Images/ch01/e077_05.png"></div>

  <p>This proves the following theorem:</p>

  <p><a id="the_b"></a><strong>Theorem A.</strong> <em>If x</em> &gt; 0, <em>then</em></p>

  <div class="image"><img src="../Images/ch01/e077_06.png"></div>

  <p class="exercisesp"><em>where</em> 0 &lt; <span class="ent">∊</span> &lt; 1/(<em>x</em>(<em>n</em> + 1)). <span class="middle"><img src="../Images/ch01/common-01.png"></span></p>

  <p class="ex-title">Exercises</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_7_1a" id="ch01ex_2_7_1">1</a>.</strong> [<em>01</em>] What are $H_{0}$, $H_{1}$, and $H_{2}$?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_7_2a" id="ch01ex_2_7_2">2</a>.</strong> [<em>13</em>] Show that the simple argument used in the text to prove that $H<sub>2m</sub> ≥ 1+m/2$ can be slightly modified to prove that $H<sub>2m</sub>≤1+m$.</p>

  <p class="exercises"><a id="page_78"></a><strong><a href="../Text/app01.html#ch01ex_2_7_3a" id="ch01ex_2_7_3">3</a>.</strong> [<em>M21</em>] Generalize the argument used in the previous exercise to show that, for r &gt; 1, the sum <span class="middle"><img src="../Images/ch01/e078_01.png"></span> remains bounded for all <em>n</em>. Find an upper bound.</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_7_4a" id="ch01ex_2_7_4">4</a>.</strong> [10] Decide which of the following statements are true for all positive integers <em>n</em>: (a) $H_{n}\lt\ln n$. (b) $H_{n}\gt\ln n$. (c) $H_{n}\gt\ln n+γ$.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_7_5a" id="ch01ex_2_7_5">5</a>.</strong> [<em>15</em>] Give the value of $H_{10000}$ to 15 decimal places, using the tables in <a href="../Text/app02.html#app02">Appendix A</a>.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_7_6a" id="ch01ex_2_7_6">6</a>.</strong> [<em>M15</em>] Prove that the harmonic numbers are directly related to Stirling’s numbers, which were introduced in the previous section; in fact,</p>

  <div class="image"><img src="../Images/ch01/e078_02.png"></div>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_7_7a" id="ch01ex_2_7_7">7</a>.</strong> [M21] Let $T (m, n)=H_{m}+H_{n}-H_{mn}$. (a) Show that when <em>m</em> or <em>n</em> increases, $T (m, n)$ never increases (assuming that <em>m</em> and <em>n</em> are positive). (b) Compute the minimum and maximum values of $T (m, n)$ for <em>m, n</em> &gt; 0.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_7_8a" id="ch01ex_2_7_8">8</a>.</strong> [<em>HM18</em>] Compare Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec7-8">8</a>) with <span class="middle"><img src="../Images/ch01/e078_03.png"></span> ln <em>k</em>; estimate the difference as a function of <em>n</em>.</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_7_9a" id="ch01ex_2_7_9">9</a>.</strong> [<em>M18</em>] <a href="../Text/ch01a.html#the_b">Theorem A</a> applies only when <em>x</em> &gt; 0; what is the value of the sum considered when $x=-1$?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_7_10a" id="ch01ex_2_7_10">10</a>.</strong> [<em>M20</em>] (<em>Summation by parts.</em>) We have used special cases of the general method of summation by parts in exercise <a href="../Text/ch01.html#ch01lev2sec4">1.2.4</a>–<a href="../Text/ch01.html#ch01ex_2_4_42">42</a> and in the derivation of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec7-9">9</a>). Prove the general formula</p>

  <div class="image"><img src="../Images/ch01/e078_04.png"></div>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_7_11a" id="ch01ex_2_7_11">11</a>.</strong> [<em>M21</em>] Using summation by parts, evaluate</p>

  <div class="image"><img src="../Images/ch01/e078_05.png"></div>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_7_12a" id="ch01ex_2_7_12">12</a>.</strong> [<em>M10</em>] Evaluate <span class="middle"><img src="../Images/ch01/e078_06.png"></span> correct to at least 100 decimal places.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_7_13a" id="ch01ex_2_7_13">13</a>.</strong> [<em>M22</em>] Prove the identity</p>

  <div class="image"><img src="../Images/ch01/e078_07.png"></div>

  <p class="exercisesp">(Note in particular the special case <em>x</em> = 0, which gives us an identity related to exercise <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–<a href="../Text/ch01a.html#ch01ex_2_6_48">48</a>.)</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_7_14a" id="ch01ex_2_7_14">14</a>.</strong> [<em>M22</em>] Show that <span class="middle"><img src="../Images/ch01/e078_08.png"></span>, and evaluate <span class="middle"><img src="../Images/ch01/e078_09.png"></span>.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_7_15a" id="ch01ex_2_7_15">15</a>.</strong> [<em>M23</em>] Express <span class="middle"><img src="../Images/ch01/e078_10.png"></span> in terms of <em>n</em> and $H_{n}$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_7_16a" id="ch01ex_2_7_16">16</a>.</strong> [<em>18</em>] Express the sum <span class="middle"><img src="../Images/ch01/e078_11.png"></span> in terms of harmonic numbers.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_7_17a" id="ch01ex_2_7_17">17</a>.</strong> [<em>M24</em>] (E. Waring, 1782.) Let <em>p</em> be an odd prime. Show that the numerator of $H_{p-1}$ is divisible by <em>p</em>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_7_18a" id="ch01ex_2_7_18">18</a>.</strong> [<em>M33</em>] (J. Selfridge.) What is the highest power of 2 that divides the numerator of <span class="middle"><img src="../Images/ch01/e078_12.png"></span></p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_7_19a" id="ch01ex_2_7_19">19</a>.</strong> [<em>M30</em>] List all nonnegative integers <em>n</em> for which $H_{n}$ is an integer. [<em>Hint:</em> If $H_{n}$ has odd numerator and even denominator, it cannot be an integer.]</p>

  <p class="exercises1"><a id="page_79"></a><strong><a href="../Text/app01.html#ch01ex_2_7_20a" id="ch01ex_2_7_20">20</a>.</strong> [<em>HM22</em>] There is an analytic way to approach summation problems such as the one leading to <a href="../Text/ch01a.html#the_a">Theorem A</a> in this section: If <span class="middle"><img src="../Images/ch01/79fig01.png"></span>, and this series converges for $x=x_{0}$, prove that</p>

  <div class="image"><img src="../Images/ch01/e079_01.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_7_21a" id="ch01ex_2_7_21">21</a>.</strong> [<em>M24</em>] Evaluate <span class="middle"><img src="../Images/ch01/e079_02.png"></span>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_7_22a" id="ch01ex_2_7_22">22</a>.</strong> [<em>M28</em>] Evaluate <span class="middle"><img src="../Images/ch01/e079_03.png"></span>.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_7_23a" id="ch01ex_2_7_23">23</a>.</strong> [<em>HM20</em>] By considering the function $Γ′(x)/Γ(x)$, generalize $H_{n}$ to noninteger values of <em>n</em>. You may use the fact that $Γ′(1)=-γ$, anticipating the next exercise.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_7_24a" id="ch01ex_2_7_24">24</a>.</strong> [<em>HM21</em>] Show that</p>

  <div class="image"><img src="../Images/ch01/e079_04.png"></div>

  <p class="exercisesp">(Consider the partial products of this infinite product.)</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_7_25a" id="ch01ex_2_7_25">25</a>.</strong> [<em>M21</em>] Let <span class="middle"><img src="../Images/ch01/e079_05.png"></span>. What are <span class="middle"><img src="../Images/ch01/e079_06.png"></span> and <span class="middle"><img src="../Images/ch01/e079_07.png"></span> Prove the general identity <span class="middle"><img src="../Images/ch01/e079_08.png"></span>.</p>

  <div class="heading">
    <h4 id="ch01lev2sec8">1.2.8. Fibonacci Numbers</h4>

    <p>The sequence</p>
  </div>

  <div class="equation"><a id="ch01eq-lev2sec8-1"></a><img src="../Images/ch01/079equ01.png"></div>

  <p>in which each number is the sum of the preceding two, plays an important role in at least a dozen seemingly unrelated algorithms that we will study later. The numbers in the sequence are denoted by $F_{n}$, and we formally define them as</p>

  <div class="equation"><a id="ch01eq-lev2sec8-2"></a><img src="../Images/ch01/079equ02.png"></div>

  <p class="indent">This famous sequence was published in 1202 by Leonardo Pisano (Leonardo of Pisa), who is sometimes called Leonardo Fibonacci (<em>Filius Bonaccii</em>, son of Bonaccio). His <em>Liber Abaci</em> (Book of the Abacus) contains the following exercise: “How many pairs of rabbits can be produced from a single pair in a year’s time?” To solve this problem, we are told to assume that each pair produces a new pair of offspring every month, and that each new pair becomes fertile at the age of one month. Furthermore, the rabbits never die. After one month there will be 2 pairs of rabbits; after two months, there will be 3; the following month the original pair and the pair born during the first month will both usher in a new pair and there will be 5 in all; and so on.</p>

  <p class="indent">Fibonacci was by far the greatest European mathematician of the Middle Ages. He studied the work of al-Khwārizmī (after whom “algorithm” is named, see <a href="../Text/ch01.html#ch01lev1sec1">Section 1.1</a>) and he added numerous original contributions to arithmetic and geometry. The writings of Fibonacci were reprinted in 1857 [B. Boncompagni, <em>Scritti di Leonardo Pisano</em> (Rome, 1857–1862), 2 vols.; $F_{n}$ appears in Vol. 1, 283– 285]. His rabbit problem was, of course, not posed as a practical application to biology and the population explosion; it was an exercise in addition. In fact, it still makes a rather good computer exercise about addition (see <a href="../Text/ch01a.html#ch01ex_2_8_3">exercise 3</a>); <a id="page_80"></a>Fibonacci wrote: “It is possible to do [the addition] in this order for an infinite number of months.”</p>

  <p class="indent">Before Fibonacci wrote his work, the sequence $\langle{F_{n}}\rangle$ had already been discussed by Indian scholars, who had long been interested in rhythmic patterns that are formed from one-beat and two-beat notes or syllables. The number of such rhythms having <em>n</em> beats altogether is $F_{n+1}$; therefore both Gopāla (before 1135) and Hemacandra (c. 1150) mentioned the numbers 1, 2, 3, 5, 8, 13, 21, 34, ... explicitly. [See P. Singh, <em>Historia Math.</em> <strong>12</strong> (1985), 229–244; see also exercise 4.5.3–32.]</p>

  <p class="indent">The same sequence also appears in the work of Johannes Kepler, 1611, who was musing about the numbers he saw around him [J. Kepler, <em>The Six-Cornered Snowflake</em> (Oxford: Clarendon Press, 1966), 21]. Kepler was presumably unaware of Fibonacci’s brief mention of the sequence. Fibonacci numbers have often been observed in nature, probably for reasons similar to the original assumptions of the rabbit problem. [See Conway and Guy, <em>The Book of Numbers</em> (New York: Copernicus, 1996), 113–126, for an especially lucid explanation.]</p>

  <p class="indent">A first indication of the intimate connections between $F_{n}$ and algorithms came to light in 1837, when É. Léger used Fibonacci’s sequence to study the efficiency of Euclid’s algorithm. He observed that if the numbers <em>m</em> and <em>n</em> in <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm 1.1E</a> are not greater than F_{k}, step E2 will be executed at most <em>k</em> − 1 times. This was the first practical application of Fibonacci’s sequence. (See Theorem 4.5.3F.) During the 1870s the mathematician É. Lucas obtained very profound results about the Fibonacci numbers, and in particular he used them to prove that the 39-digit number $2^{127}-1$ is prime. Lucas gave the name “<a href="../Text/ch01a.html#ch01lev2sec8">Fibonacci numbers</a>” to the sequence $\langle{F_{n}}\rangle$, and that name has been used ever since.</p>

  <p class="indent">We already have examined the Fibonacci sequence briefly in <a href="../Text/ch01.html#ch01lev2sec1">Section 1.2.1</a> (Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec8-3">3</a>) and <a href="../Text/ch01a.html#ch01ex_2_8_4">exercise 4</a>), where we found that $φ^{n-2}≤F_{n}≤φ^{n-1}$ if <em>n</em> is a positive integer and if</p>

  <div class="equation"><a id="ch01eq-lev2sec8-3"></a><img src="../Images/ch01/080equ01.png"></div>

  <p>We will see shortly that this quantity, <em>φ</em>, is intimately connected with the Fibonacci numbers.</p>

  <p class="indent">The number <em>φ</em> itself has a very interesting history. Euclid called it the “extreme and mean ratio”; the ratio of <em>A</em> to <em>B</em> is the ratio of <em>A</em> + <em>B</em> to <em>A</em>, if the ratio of <em>A</em> to <em>B</em> is <em>φ</em>. Renaissance writers called it the “divine proportion”; and in the last century it has commonly been called the “golden ratio.” Many artists and writers have said that the ratio of <em>φ</em> to 1 is the most aesthetically pleasing proportion, and their opinion is confirmed from the standpoint of computer programming aesthetics as well. For the story of <em>φ</em>, see the excellent article “The Golden Section, Phyllotaxis, and Wythoff’s Game,” by H. S. M. Coxeter, <em>Scripta Math.</em> <strong>19</strong> (1953), 135–143; see also Chapter 8 of <em>The 2nd Scientific American Book of Mathematical Puzzles and Diversions,</em> by Martin Gardner (New York: Simon and Schuster, 1961). Several popular myths about <em>φ</em> have been debunked by George Markowsky in <em>College Math. J.</em> <strong>23</strong> (1992), 2–19. The fact that the ratio <a id="page_81"></a><em>F</em><sub><em>n</em>+1</sub>/F_{n} approaches <em>φ</em> was known to the early European reckoning master Simon Jacob, who died in 1564 [see P. Schreiber, <em>Historia Math.</em> <strong>22</strong> (1995), 422–424].</p>

  <p class="indent">The notations we are using in this section are a little undignified. In much of the sophisticated mathematical literature, $F_{n}$ is called $u_{n}$ instead, and <em>φ</em> is called $τ$. Our notations are almost universally used in recreational mathematics (and some crank literature!) and they are rapidly coming into wider use. The designation <em>φ</em> comes from the name of the Greek artist Phidias who is said to have used the golden ratio in his sculpture. [See T. A. Cook, <em>The Curves of Life</em> (1914), 420.] The notation $F_{n}$ is in accordance with that used in the <em>Fibonacci Quarterly</em>, where the reader may find numerous facts about the Fibonacci sequence. A good reference to the classical literature about $F_{n}$ is Chapter 17 of L. E. Dickson’s <em>History of the Theory of Numbers</em> <strong>1</strong> (Carnegie Inst. of Washington, 1919).</p>

  <p class="indent">The Fibonacci numbers satisfy many interesting identities, some of which appear in the exercises at the end of this section. One of the most commonly discovered relations, mentioned by Kepler in a letter he wrote in 1608 but first published by J. D. Cassini [<em>Histoire Acad. Roy. Paris</em> <strong>1</strong> (1680), 201], is</p>

  <div class="equation"><a id="ch01eq-lev2sec8-4"></a><img src="../Images/ch01/081equ01.png"></div>

  <p>which is easily proved by induction. A more esoteric way to prove the same formula starts with a simple inductive proof of the matrix identity</p>

  <div class="equation"><a id="ch01eq-lev2sec8-5"></a><img src="../Images/ch01/081equ02.png"></div>

  <p>We can then take the determinant of both sides of this equation.</p>

  <p class="indent">Relation (<a href="../Text/ch01a.html#ch01eq-lev2sec8-4">4</a>) shows that $F_{n}$ and $F_{n+1}$ are relatively prime, since any common divisor would have to be a divisor of $(-1)^{n}$.</p>

  <p class="indent">From the definition (<a href="../Text/ch01a.html#ch01eq-lev2sec8-2">2</a>) we find immediately that</p>

  <p class="center">$F_{n+3}=F_{n+2}+F_{n+1}=2F_{n+1}+F_{n}$;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$F_{n+4}=3F_{n+1}+2F_{n}$;</p>

  <p>and, in general, by induction that</p>

  <div class="equation"><a id="ch01eq-lev2sec8-6"></a><img src="../Images/ch01/081equ03.png"></div>

  <p>for any positive integer <em>m</em>.</p>

  <p class="indent">If we take <em>m</em> to be a multiple of <em>n</em> in Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec8-6">6</a>), we find inductively that</p>

  <p class="center"><em>$F_{nk}$ is a multiple of $F_{n}$.</em></p>

  <p>Thus every third number is even, every fourth number is a multiple of 3, every fifth is a multiple of 5, and so on.</p>

  <p class="indent">In fact, much more than this is true. If we write $\gcd(m, n)$ to stand for the greatest common divisor of <em>m</em> and <em>n</em>, a rather surprising theorem emerges:</p>

  <p><a id="the_c"></a><strong>Theorem A</strong> (É. Lucas, 1876). <em>A number divides both $F_{m}$ and $F_{n}$ if and only if it is a divisor of $F_{d}$, where $d=\gcd(m, n)$; in particular</em>,</p>

  <div class="equation"><a id="ch01eq-lev2sec8-7"></a><img src="../Images/ch01/081equ04.png"></div>

  <p><a id="page_82"></a><em>Proof.</em> This result is proved by using Euclid’s algorithm. We observe that because of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec8-6">6</a>) any common divisor of $F_{m}$ and $F_{n}$ is also a divisor of $F_{n+m}$; and, conversely, any common divisor of $F_{n+m}$ and $F_{n}$ is a divisor of $F_{m} F_{n+1}$. Since $F_{n+1}$ is relatively prime to $F_{n}$, a common divisor of $F_{n+m}$ and $F_{n}$ also divides $F_{m}$. Thus we have proved that, for any number <em>d</em>,</p>

  <div class="equation"><a id="ch01eq-lev2sec8-8"></a><img src="../Images/ch01/082equ01.png"></div>

  <p>We will now show that <em>any</em> sequence $\langle{F_{n}}\rangle$ for which statement (<a href="../Text/ch01a.html#ch01eq-lev2sec8-8">8</a>) holds, and for which $F_{0}=0$, satisfies <a href="#the_a">Theorem A</a>.</p>

  <p class="indent">First it is clear that statement (<a href="../Text/ch01a.html#ch01eq-lev2sec8-8">8</a>) may be extended by induction on <em>k</em> to the rule</p>

  <p class="center"><em>d divides $F_{m}$ and $F_{n}$ if and only if d divides $F_{m+kn}$ and $F_{n}$,</em></p>

  <p>where <em>k</em> is any nonnegative integer. This result may be stated more succinctly:</p>

  <div class="equation"><a id="ch01eq-lev2sec8-9"></a><img src="../Images/ch01/082equ02.png"></div>

  <p>Now if <em>r</em> is the remainder after division of <em>m</em> by <em>n</em>, that is, if $r=m\bmod n$, then the common divisors of $\{F_{m}, F_{n}\}$ are the common divisors of $\{F_{n}, F_{r}\}$. It follows that throughout the manipulations of <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm 1.1E</a> the set of common divisors of $\{F_{m}, F_{n}\}$ remains unchanged as <em>m</em> and <em>n</em> change; finally, when <em>r</em> = 0, the common divisors are simply the divisors of $F_{0}=0$ and $F_{\gcd(m,n)}$. <span class="middle"><img src="../Images/ch01/common-01.png"></span></p>

  <p class="indent">Most of the important results involving Fibonacci numbers can be deduced from the representation of $F_{n}$ in terms of <em>φ</em>, which we now proceed to derive. The method we shall use in the following derivation is extremely important, and the mathematically oriented reader should study it carefully; we will study the same method in detail in the next section.</p>

  <p class="indent">We start by setting up the infinite series</p>

  <div class="equation"><a id="ch01eq-lev2sec8-10"></a><img src="../Images/ch01/082equ03.png"></div>

  <p>We have no <em>a priori</em> reason to expect that this infinite sum exists or that the function $G(z)$ is at all interesting — but let us be optimistic and see what we can conclude about the function $G(z)$ if it does exist. The advantage of such a procedure is that $G(z)$ is a single quantity that represents the <em>entire</em> Fibonacci sequence at once; and if we find out that $G(z)$ is a “known” function, its coefficients can be determined. We call $G(z)$ the <em>generating function</em> for the sequence $\langle{F_{n}}\rangle$.</p>

  <p class="indent">We can now proceed to investigate $G(z)$ as follows:</p>

  <div class="image"><img src="../Images/ch01/e082_01.png"></div>

  <p>by subtraction, therefore,</p>

  <div class="image"><img src="../Images/ch01/e082_02.png"></div>

  <p><a id="page_83"></a>All terms but the second vanish because of the definition of $F_{n}$, so this expression equals <em>z</em>. Therefore we see that, if $G(z)$ exists,</p>

  <div class="equation"><a id="ch01eq-lev2sec8-11"></a><img src="../Images/ch01/083equ01.png"></div>

  <p>In fact, this function <em>can</em> be expanded in an infinite series in <em>z</em> (a Taylor series); working backwards we find that the coefficients of the power series expansion of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec8-11">11</a>) must be the Fibonacci numbers.</p>

  <p class="indent">We can now manipulate $G(z)$ and find out more about the Fibonacci sequence. The denominator $1-z-z^{2}$ is a quadratic polynomial with the two roots <span class="middle"><img src="../Images/ch01/e083_01.png"></span>; after a little calculation we find that $G(z)$ can be expanded by the method of partial fractions into the form</p>

  <div class="equation"><a id="ch01eq-lev2sec8-12"></a><img src="../Images/ch01/083equ02.png"></div>

  <p>where</p>

  <div class="equation"><a id="ch01eq-lev2sec8-13"></a><img src="../Images/ch01/083equ03.png"></div>

  <p>The quantity $1/(1-φz)$ is the sum of the infinite geometric series $1+φz+φ^{2} z^{2}+···$, so we have</p>

  <div class="image"><img src="../Images/ch01/e083_04.png"></div>

  <p>We now look at the coefficient of $z^{n}$, which must be equal to $F_{n}$; hence</p>

  <div class="equation"><a id="ch01eq-lev2sec8-14"></a><img src="../Images/ch01/083equ04.png"></div>

  <p>This is an important closed form expression for the Fibonacci numbers, first discovered early in the eighteenth century. (See D. Bernoulli, <em>Comment. Acad. Sci. Petrop.</em> <strong>3</strong> (1728), 85–100, §7; see also A. de Moivre, <em>Philos. Trans.</em> <strong>32</strong> (1722), 162–178, who showed how to solve general linear recurrences in essentially the way we have derived (<a href="../Text/ch01a.html#ch01eq-lev2sec8-14">14</a>).)</p>

  <p class="indent">We could have merely stated Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec8-14">14</a>) and proved it by induction. However, the point of the rather long derivation above was to show how it would be possible to <em>discover</em> the equation in the first place, using the important method of generating functions, which is a valuable technique for solving a wide variety of problems.</p>

  <p class="indent">Many things can be proved from Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec8-14">14</a>). First we observe that $\phihat$ is a <em>negative</em> number $(-0.61803...)$ whose magnitude is less than unity, so <span class="middle"><img src="../Images/ch01/e083_02.png"></span> gets very small as <em>n</em> gets large. In fact, the quantity <span class="middle"><img src="../Images/ch01/e083_03.png"></span> is always small enough so that we have</p>

  <div class="equation"><a id="ch01eq-lev2sec8-15"></a><img src="../Images/ch01/083equ05.png"></div>

  <p class="indent">Other results can be obtained directly from $G(z)$; for example,</p>

  <div class="equation"><a id="ch01eq-lev2sec8-16"></a><img src="../Images/ch01/083equ06.png"></div>

  <p><a id="page_84"></a>and the coefficient of $z^{n}$ in $G(z)^{2}$ is <span class="middle"><img src="../Images/ch01/e084_01.png"></span>. We deduce therefore that</p>

  <div class="equation"><a id="ch01eq-lev2sec8-17"></a><img src="../Images/ch01/084equ01.png"></div>

  <p class="exercisesp">(The second step in this derivation follows from the result of <a href="../Text/ch01a.html#ch01ex_2_8_11">exercise 11</a>.)</p>

  <p class="ex-title">Exercises</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_8_1a" id="ch01ex_2_8_1">1</a>.</strong> [<em>10</em>] What is the answer to Leonardo Fibonacci’s original problem: How many pairs of rabbits are present after a year?</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_2a" id="ch01ex_2_8_2">2</a>.</strong> [<em>20</em>] In view of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec8-15">15</a>), what is the approximate value of $F_{1000}$? (Use logarithms found in <a href="../Text/app02.html#app02">Appendix A</a>.)</p>

  <p class="exercises"><a id="ch01ex_2_8_3"></a><strong>3.</strong> [<em>25</em>] Write a computer program that calculates and prints $F_{1}$ through $F_{1000}$ in decimal notation. (The previous exercise determines the size of numbers that must be handled.)</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_4a" id="ch01ex_2_8_4">4</a>.</strong> [<em>14</em>] Find all <em>n</em> for which $F_{n}=n$.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_8_5a" id="ch01ex_2_8_5">5</a>.</strong> [<em>20</em>] Find all <em>n</em> for which $F_{n}=n^{2}$.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_8_6a" id="ch01ex_2_8_6">6</a>.</strong> [<em>HM10</em>] Prove Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec8-5">5</a>).</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_7a" id="ch01ex_2_8_7">7</a>.</strong> [<em>15</em>] If <em>n</em> is not a prime number, $F_{n}$ is not a prime number (with one exception). Prove this and find the exception.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_8_8a" id="ch01ex_2_8_8">8</a>.</strong> [<em>15</em>] In many cases it is convenient to define $F_{n}$ for <em>negative n</em>, by assuming that $F_{n+2}=F_{n+1}+F_{n}$ for <em>all</em> integers <em>n</em>. Explore this possibility: What is $F_{-1}$? What is $F_{-2}$? Can $F_{-n}$ be expressed in a simple way in terms of $F_{n}$?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_8_9a" id="ch01ex_2_8_9">9</a>.</strong> [<em>M20</em>] Using the conventions of <a href="../Text/ch01a.html#ch01ex_2_8_8">exercise 8</a>, determine whether Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec8-4">4</a>), (<a href="../Text/ch01a.html#ch01eq-lev2sec8-6">6</a>), (<a href="../Text/ch01a.html#ch01eq-lev2sec8-14">14</a>), and (<a href="../Text/ch01a.html#ch01eq-lev2sec8-15">15</a>) still hold when the subscripts are allowed to be <em>any</em> integers.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_10a" id="ch01ex_2_8_10">10</a>.</strong> [<em>15</em>] Is <span class="middle"><img src="../Images/ch01/e084_02.png"></span> greater than $F_{n}$ or less than $F_{n}$?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_11a" id="ch01ex_2_8_11">11</a>.</strong> [<em>M20</em>] Show that $φ^{n}=F_{nφ}+F_{n-1}$ and <span class="middle"><img src="../Images/ch01/e084_03.png"></span>, for <em>all</em> integers <em>n</em>.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_12a" id="ch01ex_2_8_12">12</a>.</strong> [<em>M26</em>] The “second order” Fibonacci sequence is defined by the rule</p>

  <div class="image"><img src="../Images/ch01/e084_05.png"></div>

  <p class="indenthangingNP">Express <span class="middle"><img src="../Images/ch01/fn.png"></span> in terms of $F_{n}$ and $F_{n+1}$. [<em>Hint:</em> Use generating functions.]</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_13a" id="ch01ex_2_8_13">13</a>.</strong> [<em>M22</em>] Express the following sequences in terms of the Fibonacci numbers, when <em>r</em>, <em>s</em>, and <em>c</em> are given constants:</p>

  <p class="indenthanging-A">a) $a_{0}=r$, $a_{1}=s$; $a_{n+2}=a_{n+1}+a_{n}$, for <em>n</em> ≥ 0.</p>

  <p class="indenthanging-A">b) $b_{0}=0$, $b_{1}=1$; $b_{n+2}=b_{n+1}+b_{n}+c$, for <em>n</em> ≥ 0.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_14a" id="ch01ex_2_8_14">14</a>.</strong> [<em>M28</em>] Let <em>m</em> be a fixed positive integer. Find $a_{n}$, given that</p>

  <div class="image"><img src="../Images/ch01/e084_04.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_15a" id="ch01ex_2_8_15">15</a>.</strong> [<em>M22</em>] Let $f(n)$ and $g(n)$ be arbitrary functions, and for <em>n</em> ≥ 0 let</p>

  <div class="image"><img src="../Images/ch01/e084_06.png"></div>

  <p class="indenthangingNP">Express $c_{n}$ in terms of <em>x</em>, <em>y</em>, $a_{n}$, $b_{n}$, and $F_{n}$</p>

  <p class="exercises3"><a id="page_85"></a><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_16a" id="ch01ex_2_8_16">16</a>.</strong> [<em>M20</em>] Fibonacci numbers appear implicitly in Pascal’s triangle if it is viewed from the right angle. Show that the following sum of binomial coefficients is a Fibonacci number:</p>

  <div class="image"><img src="../Images/ch01/e085_01.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_17a" id="ch01ex_2_8_17">17</a>.</strong> [<em>M24</em>] Using the conventions of <a href="../Text/ch01a.html#ch01ex_2_8_8">exercise 8</a>, prove the following generalization of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec8-4">4</a>): $F_{n+k}F_{m-k}-F_{n}F_{m}=(-1)^{n}F_{m-n-k}F_{k}$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_18a" id="ch01ex_2_8_18">18</a>.</strong> [<em>20</em>] Is <span class="middle"><img src="../Images/ch01/e085_02.png"></span> always a Fibonacci number?</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_19a" id="ch01ex_2_8_19">19</a>.</strong> [<em>M27</em>] What is $\cos 36^{°}$?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_20a" id="ch01ex_2_8_20">20</a>.</strong> [<em>M16</em>] Express <span class="middle"><img src="../Images/ch01/e085_03.png"></span> in terms of Fibonacci numbers.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_21a" id="ch01ex_2_8_21">21</a>.</strong> [<em>M25</em>] What is <span class="middle"><img src="../Images/ch01/e085_04.png"></span></p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_22a" id="ch01ex_2_8_22">22</a>.</strong> [<em>M20</em>] Show that <span class="middle"><img src="../Images/ch01/e085_05.png"></span> is a Fibonacci number.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_23a" id="ch01ex_2_8_23">23</a>.</strong> [<em>M23</em>] Generalizing the preceding exercise, show that <span class="middle"><img src="../Images/ch01/e085_06.png"></span> is always a Fibonacci number.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_24a" id="ch01ex_2_8_24">24</a>.</strong> [<em>HM20</em>] Evaluate the $n × n$ determinant</p>

  <div class="image"><img src="../Images/ch01/e085_07.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_25a" id="ch01ex_2_8_25">25</a>.</strong> [<em>M21</em>] Show that</p>

  <div class="image"><img src="../Images/ch01/e085_08.png"></div>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_26a" id="ch01ex_2_8_26">26</a>.</strong> [<em>M20</em>] Using the previous exercise, show that $F_{p}≡5^{(p-1)/2} (modulo p)$ if <em>p</em> is an odd prime.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_27a" id="ch01ex_2_8_27">27</a>.</strong> [<em>M20</em>] Using the previous exercise, show that if <em>p</em> is a prime different from 5, then either $F_{p-1}$ or $F_{p+1}$ (not both) is a multiple of <em>p</em>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_28a" id="ch01ex_2_8_28">28</a>.</strong> [<em>M21</em>] What is $F_{n+1}-φF_{n}$?</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_29a" id="ch01ex_2_8_29">29</a>.</strong> [<em>M23</em>] (<em>Fibonomial coefficients.</em>) Édouard Lucas defined the quantities</p>

  <div class="image"><img src="../Images/ch01/e085_09.png"></div>

  <p class="exercisesp">in a manner analogous to binomial coefficients. (a) Make a table of <span class="middle"><img src="../Images/ch01/e085_10.png"></span> for 0 ≤ <em>k</em> ≤ <em>n</em> ≤ 6. (b) Show that <span class="middle"><img src="../Images/ch01/e085_11.png"></span> is always an integer because we have</p>

  <div class="image"><img src="../Images/ch01/e085_12.png"></div>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_30a" id="ch01ex_2_8_30">30</a>.</strong> [<em>M38</em>] (D. Jarden, T. Motzkin.) The sequence of <em>m</em>th powers of Fibonacci numbers satisfies a recurrence relation in which each term depends on the preceding <em>m</em> + 1 terms. Show that</p>

  <div class="image"><img src="../Images/ch01/e085_13.png"></div>

  <p class="exercisesp">For example, when <em>m</em> = 3 we get the identity <span class="middle"><img src="../Images/ch01/e085_14.png"></span>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_31a" id="ch01ex_2_8_31">31</a>.</strong> [<em>M20</em>] Show that $F_{2n}φ\bmod 1=1-φ^{-2n}$ and $F_{2n+1}φ\bmod 1=φ^{-2n-1}$.</p>

  <p class="exercises1"><a id="page_86"></a><strong><a href="../Text/app01.html#ch01ex_2_8_32a" id="ch01ex_2_8_32">32</a>.</strong> [<em>M24</em>] The remainder of one Fibonacci number divided by another is ± a Fibonacci number: Show that, modulo $F_{n}$,</p>

  <div class="image"><img src="../Images/ch01/e086_01.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_33a" id="ch01ex_2_8_33">33</a>.</strong> [<em>HM24</em>] Given that $z=π/2+i\ln φ$, show that $\sin nz/\sin z=i^{1-n}F_{n}$.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_34a" id="ch01ex_2_8_34">34</a>.</strong> [<em>M24</em>] (<em>The Fibonacci number system.</em>) Let the notation <em>k</em> <span class="ent">≫</span> <em>m</em> mean that $k ≥ m+2$. Show that every positive integer <em>n</em> has a <em>unique</em> representation <span class="middle"><img src="../Images/ch01/e086_03.png"></span> where $k_{1}≫ k_{2}≫···≫ k_{r}≫ 0$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_35a" id="ch01ex_2_8_35">35</a>.</strong> [<em>M24</em>] (<em>A phi number system.</em>) Consider real numbers written with the digits 0 and 1 using base <em>φ</em>; thus $(100.1)_{φ}=φ^{2}+φ^{-1}$. Show that there are infinitely many ways to represent the number 1; for example, $1=(.11)_{φ}=(.011111...)_{φ}$. But if we require that no two adjacent 1s occur and that the representation does not end with the infinite sequence 01010101..., then every nonnegative number has a unique representation. What are the representations of integers?</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_36a" id="ch01ex_2_8_36">36</a>.</strong> [<em>M32</em>] (<em>Fibonacci strings.</em>) Let $S_{1}=“a”$, $S_{2}=“b”$, and $S_{n+2}=S_{n+1}S_{n}$, <em>n</em> &gt; 0; in other words, $S_{n+2}$ is formed by placing $S_{n}$ at the right of $S_{n+1}$. We have $S_{3}=“ba”$, $S_{4}=“bab”$, $S_{5}=“babba”$, etc. Clearly $S_{n}$ has $F_{n}$ letters. Explore the properties of $S_{n}$. (Where do double letters occur? Can you predict the value of the <em>k</em>th letter of $S_{n}$? What is the density of the <em>b</em>’s? And so on.)</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_37a" id="ch01ex_2_8_37">37</a>.</strong> [<em>M35</em>] (R. E. Gaskell, M. J. Whinihan.) Two players compete in the following game: There is a pile containing <em>n</em> chips; the first player removes any number of chips except that he cannot take the whole pile. From then on, the players alternate moves, each person removing one or more chips but <em>not more than twice as many chips as the preceding player has taken</em>. The player who removes the last chip wins. (For example, suppose that <em>n</em> = 11; player <em>A</em> removes 3 chips; player <em>B</em> may remove up to 6 chips, and he takes 1. There remain 7 chips; player <em>A</em> may take 1 or 2 chips, and he takes 2; player <em>B</em> may remove up to 4, and he picks up 1. There remain 4 chips; player <em>A</em> now takes 1; player <em>B</em> must take at least one chip and player <em>A</em> wins in the following turn.)</p>

  <p class="indent">What is the best move for the first player to make if there are initially 1000 chips?</p>

  <p class="exercises1"><strong>38.</strong> [<em>35</em>] Write a computer program that plays the game described in the previous exercise and that plays optimally.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_39a" id="ch01ex_2_8_39">39</a>.</strong> [<em>M24</em>] Find a closed form expression for $a_{n}$, given that $a_{0}=0$, $a_{1}=1$, and $a_{n+2}=a_{n+1}+6a_{n}$ for <em>n</em> ≥ 0.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_40a" id="ch01ex_2_8_40">40</a>.</strong> [<em>M25</em>] Solve the recurrence</p>

  <div class="image"><img src="../Images/ch01/e086_02.png"></div>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_8_41a" id="ch01ex_2_8_41">41</a>.</strong> [<em>M25</em>] (Yuri Matiyasevich, 1990.) Let $f(x)=\lfloor{x+φ^{-1}}\rfloor$. Prove that if $n=F_{k_{1}}+···+F_{k_{r}}$ is the representation of <em>n</em> in the Fibonacci number system of <a href="../Text/ch01a.html#ch01ex_2_8_34">exercise 34</a>, then $F<sub>k_{1}+1</sub>+···+F_{k_{r} +1}=f(φn)$. Find a similar formula for $F<sub>k_{1}-1</sub>+···+F_{k_{r}-1}$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_8_42a" id="ch01ex_2_8_42">42</a>.</strong> [<em>M26</em>] (D. A. Klarner.) Show that if <em>m</em> and <em>n</em> are nonnegative integers, there is a unique sequence of indices $k_{1}≫ k_{2}≫···≫ k_{r}$ such that</p>

  <p class="center">$m=F_{k_{1}}+F_{k_{2}}+···+F_{k_{r}}$,&nbsp;&nbsp;&nbsp;$n=F_{k_{1}+1}+F_{k_{2}+1}+···+F_{k_{r}+1}$.</p>

  <p>(See <a href="../Text/ch01a.html#ch01ex_2_8_34">exercise 34</a>. The <em>k</em>’s may be negative, and <em>r</em> may be zero.)</p>

  <div class="heading">
    <h4 id="ch01lev2sec9"><a id="page_87"></a>1.2.9. Generating Functions</h4>

    <p>Whenever we want to obtain information about a sequence of numbers $\langle{a_{n}}\rangle=a_{0}, a_{1}, a_{2},...$, we can set up an infinite sum in terms of a “parameter” <em>z</em></p>
  </div>

  <div class="equation"><a id="ch01eq-lev2sec9-1"></a><img src="../Images/ch01/087equ01.png"></div>

  <p>We can then try to obtain information about the function <em>G</em>. This function is a single quantity that represents the whole sequence; if the sequence $\langle{a_{n}}\rangle$ has been defined inductively (that is, if $a_{n}$ has been defined in terms of $a_{0}, a_{1},..., a_{n-1}$) this is an important advantage. Furthermore, we can recover the individual values of a_{0}, a_{1}, ... from the function $G(z)$, assuming that the infinite sum in Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-1">1</a>) exists for some nonzero value of <em>z</em>, by using techniques of differential calculus.</p>

  <p class="indent">We call $G(z)$ the <em>generating function</em> for the sequence $a_{0}, a_{1}, a_{2},...$. The use of generating functions opens up a whole new range of techniques, and it broadly increases our capacity for problem solving. As mentioned in the previous section, A. de Moivre introduced generating functions in order to solve the general linear recurrence problem. De Moivre’s theory was extended to slightly more complicated recurrences by James Stirling, who showed how to apply differentiation and integration as well as arithmetic operations [<em>Methodus Differentialis</em> (London: 1730), Proposition 15]. A few years later, L. Euler began to use generating functions in several new ways, for example in his papers on partitions [<em>Commentarii Acad. Sci. Pet.</em> <strong>13</strong> (1741), 64–93; <em>Novi Comment. Acad. Sci. Pet</em>. <strong>3</strong> (1750), 125–169]. Pierre S. Laplace developed the techniques further in his classic work <em>Théorie Analytique des Probabilités</em> (Paris: 1812).</p>

  <p class="indent">The question of convergence of the infinite sum (<a href="../Text/ch01a.html#ch01eq-lev2sec9-1">1</a>) is of some importance. Any textbook about the theory of infinite series will prove that:</p>

  <p class="indenthanging-A">a) If the series converges for a particular value of <em>z</em> = z_{0}, then it converges for all values of <em>z</em> with $|z|\lt |z_{0}|$.</p>

  <p class="indenthanging-A">b) The series converges for some <em>z</em> ≠ 0 if and only if the sequence <span class="middle"><img src="../Images/ch01/e087_01.png"></span> is bounded. (If this condition is not satisfied, we may be able to get a convergent series for the sequence $\langle{a_{n}/n!}\rangle$ or for some other related sequence.)</p>

  <p class="indent">On the other hand, it often does not pay to worry about convergence of the series when we work with generating functions, since we are only exploring possible approaches to the solution of some problem. When we discover the solution by <em>any</em> means, however sloppy, we may be able to justify the solution independently. For example, in the previous section we used a generating function to deduce Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-14">14</a>); yet once such an equation has been found, it is a simple matter to prove it by induction, and we need not even mention that we used generating functions to discover it. Furthermore one can show that most (if not all) of the operations we do with generating functions can be rigorously justified without regard to the convergence of the series. See, for example, E. T. Bell, <em>Trans. Amer. Math. Soc.</em> <strong>25</strong> (1923), 135–154; Ivan Niven, <em>AMM</em> <strong>76</strong> (1969), <a id="page_88"></a>871–889; Peter Henrici, <em>Applied and Computational Complex Analysis</em> <strong>1</strong> (Wiley, 1974), <a href="../Text/ch01.html#ch01">Chapter 1</a>.</p>

  <p class="indent">Let us now study the principal techniques used with generating functions.</p>

  <p><strong>A. Addition.</strong> If $G(z)$ is the generating function for $\langle{a_{n}}\rangle=a_{0}, a_{1},...$ and $H (z)$ is the generating function for $\langle{b_{n}}\rangle=b_{0}, b_{1},...$, then $αG(z)+βH (z)$ is the generating function for $\langle{αa_{n}+βb_{n}}\rangle=αa_{0}+βb_{0}, αa_{1}+βb_{1},...$:</p>

  <div class="equation"><a id="ch01eq-lev2sec9-2"></a><img src="../Images/ch01/088equ01.png"></div>

  <p><strong>B. Shifting.</strong> If $G(z)$ is the generating function for $\langle{a_{n}}\rangle=a_{0}, a_{1},...$ then $z^{m}G(z)$ is the generating function for $\langle{a_{n-m}}\rangle=0,..., 0, a_{0}, a_{1},...$:</p>

  <div class="equation"><a id="ch01eq-lev2sec9-3"></a><img src="../Images/ch01/088equ02.png"></div>

  <p>The last summation may be extended over all <em>n</em> ≥ 0 if we regard $a_{n}=0$ for any negative value of <em>n</em>.</p>

  <p class="indent">Similarly, $(G(z)-a_{0}-a_{1}z-...-a_{m-1}z^{m-1})/z^{m}$ is the generating function for $\langle{a_{n+m}}\rangle=a_{m}, a_{m+1},...$:</p>

  <div class="equation"><a id="ch01eq-lev2sec9-4"></a><img src="../Images/ch01/088equ03.png"></div>

  <p class="indent">We combined operations A and B to solve the Fibonacci problem in the previous section: $G(z)$ was the generating function for $\langle{F_{n}}\rangle$, $z G(z)$ for $\langle{F_{n-1}}\rangle$, $z^{2}G(z)$ for $\langle{F_{n-2}}\rangle$, and $(1-z-z^{2}) G(z) for\langle{F_{n}-F_{n-1}-F_{n-2}}\rangle$. Then, since $F_{n}-F_{n-1}-F_{n-2}$ is zero when <em>n</em> ≥ 2, we found that $(1-z-z^{2})G(z)$ is a polynomial. Similarly, given any <em>linearly recurrent</em> sequence, that is, a sequence where $a_{n}=c_{1}a_{n-1}+···+c_{m}a_{n-m}$, the generating function will be a polynomial divided by $(1-c_{1}z-···-c_{m}z^{m})$.</p>

  <p class="indent">Let us consider the simplest example of all: If $G(z)$ is the generating function for the <em>constant</em> sequence $1, 1, 1,...$, then $z G(z)$ generates $0, 1, 1,...$, so $(1-z)G(z)=1$. This gives us the simple but very important formula</p>

  <div class="equation"><a id="ch01eq-lev2sec9-5"></a><img src="../Images/ch01/088equ04.png"></div>

  <p><strong>C. Multiplication.</strong> If $G(z)$ is the generating function for $a_{0}, a_{1},...$ and $H (z)$ is the generating function for $b_{0}, b_{1},...$, then</p>

  <div class="image"><img src="../Images/ch01/e088_01.png"></div>

  <p>thus $G(z)H (z)$ is the generating function for the sequence $c_{0}, c_{1},...$, where</p>

  <div class="equation"><a id="ch01eq-lev2sec9-6"></a><img src="../Images/ch01/088equ05.png"></div>

  <p><a id="page_89"></a>Equation (<a href="../Text/ch01a.html#ch01eq-lev2sec9-3">3</a>) is a very special case of this. Another important special case occurs when each $b_{n}$ is equal to unity:</p>

  <div class="equation"><a id="ch01eq-lev2sec9-7"></a><img src="../Images/ch01/089equ01.png"></div>

  <p>Here we have the generating function for the sums of the original sequence.</p>

  <p class="indent">The rule for a product of <em>three</em> functions follows from (<a href="../Text/ch01a.html#ch01eq-lev2sec9-6">6</a>); $F (z)G(z)H (z)$ generates $d_{0}, d_{1}, d_{2},...$, where</p>

  <div class="equation"><a id="ch01eq-lev2sec9-8"></a><img src="../Images/ch01/089equ02.png"></div>

  <p>The general rule for products of <em>any number</em> of functions (whenever this is meaningful) is</p>

  <div class="equation"><a id="ch01eq-lev2sec9-9"></a><img src="../Images/ch01/089equ03.png"></div>

  <p class="indent">When the recurrence relation for some sequence involves binomial coefficients, we often want to get a generating function for a sequence $c_{0}, c_{1},...$ defined by</p>

  <div class="equation"><a id="ch01eq-lev2sec9-10"></a><img src="../Images/ch01/089equ04.png"></div>

  <p>In this case it is usually better to use generating functions for the sequences $\langle{a_{n}/n!}\rangle$, $\langle{b_{n}/n!}\rangle$, $\langle{c_{n}/n!}\rangle$, since we have</p>

  <div class="equation"><a id="ch01eq-lev2sec9-11"></a><img src="../Images/ch01/089equ05.png"></div>

  <p>where $c_{n}$ is given by Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-10">10</a>).</p>

  <p><strong>D. Change of</strong> <em><strong>z</strong></em><strong>.</strong> Clearly $G(cz)$ is the generating function for the sequence $a_{0}, ca_{1}, c_{2}a_{2},...$. As a particular case, the generating function for $1, c, c^{2}, c^{3},...$ is $1/(1-cz)$.</p>

  <p class="indent">There is a familiar trick for extracting alternate terms of a series:</p>

  <div class="equation"><a id="ch01eq-lev2sec9-12"></a><img src="../Images/ch01/089equ06.png"></div>

  <p>Using complex roots of unity, we can extend this idea and extract every <em>m</em>th term: Let $ω=e^{2πi/m}=\cos(2π/m)+i\sin(2π/m)$; we have</p>

  <div class="equation"><a id="ch01eq-lev2sec9-13"></a><img src="../Images/ch01/089equ07.png"></div>

  <p>(See <a href="../Text/ch01a.html#ch01ex_2_9_14">exercise 14</a>.) For example, if <em>m</em> = 3 and <em>r</em> = 1, we have <span class="middle"><img src="../Images/ch01/e089_01.png"></span>, a complex cube root of unity; it follows that</p>

  <div class="image"><img src="../Images/ch01/e089_02.png"></div>

  <p><a id="page_90"></a><strong>E. Differentiation and integration.</strong> The techniques of calculus give us further operations. If $G(z)$ is given by Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-1">1</a>), the derivative is</p>

  <div class="equation"><a id="ch01eq-lev2sec9-14"></a><img src="../Images/ch01/090equ01.png"></div>

  <p>The generating function for the sequence $\langle{na_{n}}\rangle$ is $z G′ (z)$. Hence we can combine the <em>n</em>th term of a sequence with polynomials in <em>n</em> by manipulating the generating function.</p>

  <p class="indent">Reversing the process, integration gives another useful operation:</p>

  <div class="equation"><a id="ch01eq-lev2sec9-15"></a><img src="../Images/ch01/090equ02.png"></div>

  <p class="indent">As special cases, we have the derivative and integral of (<a href="../Text/ch01a.html#ch01eq-lev2sec9-5">5</a>):</p>

  <div class="equation"><a id="ch01eq-lev2sec9-16"></a><img src="../Images/ch01/090equ03.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec9-17"></a><img src="../Images/ch01/090equ04.png"></div>

  <p>We can combine the second formula with Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-7">7</a>) to get the generating function for the harmonic numbers:</p>

  <div class="equation"><a id="ch01eq-lev2sec9-18"></a><img src="../Images/ch01/090equ05.png"></div>

  <p><strong>F. Known generating functions.</strong> Whenever it is possible to determine the power series expansion of a function, we have implicitly found the generating function for a particular sequence. These special functions can be quite useful in conjunction with the operations described above. The most important power series expansions are given in the following list.</p>

  <p class="indenti">i) <em>Binomial theorem</em>.</p>

  <div class="equation"><a id="ch01eq-lev2sec9-19"></a><img src="../Images/ch01/090equ06.png"></div>

  <p>When <em>r</em> is a negative integer, we get a special case already reflected in Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-5">5</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec9-16">16</a>):</p>

  <div class="equation"><a id="ch01eq-lev2sec9-20"></a><img src="../Images/ch01/090equ07.png"></div>

  <p>There is also a generalization, which was proved in exercise <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–<a href="../Text/ch01a.html#ch01ex_2_6_25">25</a>:</p>

  <div class="equation"><a id="ch01eq-lev2sec9-21"></a><img src="../Images/ch01/090equ08.png"></div>

  <p>if <em>x</em> is the continuous function of <em>z</em> that solves the equation $x^{t+1}=x^{t}+z$, where <em>x</em> = 1 when <em>z</em> = 0.</p>

  <p class="indenti"><a id="page_91"></a>ii) <em>Exponential series</em>.</p>

  <div class="equation"><a id="ch01eq-lev2sec9-22"></a><img src="../Images/ch01/091equ01.png"></div>

  <p>In general, we have the following formula involving Stirling numbers:</p>

  <div class="equation"><a id="ch01eq-lev2sec9-23"></a><img src="../Images/ch01/091equ02.png"></div>

  <p class="indenti">iii) <em>Logarithm series</em> (see (<a href="../Text/ch01a.html#ch01eq-lev2sec9-17">17</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec9-18">18</a>)).</p>

  <div class="equation"><a id="ch01eq-lev2sec9-24"></a><img src="../Images/ch01/091equ03.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec9-25"></a><img src="../Images/ch01/091equ04.png"></div>

  <p>Stirling numbers, as in (<a href="../Text/ch01a.html#ch01eq-lev2sec9-23">23</a>), give us a more general equation:</p>

  <div class="equation"><a id="ch01eq-lev2sec9-26"></a><img src="../Images/ch01/091equ05.png"></div>

  <p>Further generalizations, including many sums of harmonic numbers, appear in papers by D. A. Zave, <em>Inf. Proc. Letters</em> <strong>5</strong> (1976), 75–77; J. Spieß, <em>Math. Comp.</em> <strong>55</strong> (1990), 839–863.</p>

  <p class="indenti">iv) <em>Miscellaneous</em>.</p>

  <div class="equation"><a id="ch01eq-lev2sec9-27"></a><img src="../Images/ch01/091equ06.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec9-28"></a><img src="../Images/ch01/091equ07.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec9-29"></a><img src="../Images/ch01/091equ08.png"></div>

  <p>The coefficients $B_{k}$ that appear in the last formula are the <em>Bernoulli numbers</em>; they will be examined further in <a href="../Text/ch01b.html#ch01lev3sec2">Section 1.2.11.2</a>. A table of Bernoulli numbers appears in <a href="../Text/app02.html#app02">Appendix A</a>.</p>

  <p class="indenthangingNPI">The next identity, analogous to (<a href="../Text/ch01a.html#ch01eq-lev2sec9-21">21</a>), will be proved in exercise 2.3.4.4–29:</p>

  <div class="equation"><a id="ch01eq-lev2sec9-30"></a><img src="../Images/ch01/091equ09.png"></div>

  <p>if <em>x</em> is the continuous function of <em>z</em> that solves the equation $x=e<sup>zx^{t}</sup>$, where <em>x</em> = 1 when <em>z</em> = 0. Significant generalizations of (<a href="../Text/ch01a.html#ch01eq-lev2sec9-21">21</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec9-30">30</a>) are discussed in exercise 4.7–22.</p>

  <p><a id="page_92"></a><strong>G. Extracting a coefficient.</strong> It is often convenient to use the notation</p>

  <div class="equation"><a id="ch01eq-lev2sec9-31"></a><img src="../Images/ch01/092equ01.png"></div>

  <p>for the coefficient of $z^{n}$ in $G(z)$. For example, if $G(z)$ is the generating function in (<a href="../Text/ch01a.html#ch01eq-lev2sec9-1">1</a>) we have $[z^{n}] G(z)=a_{n}$ and <span class="middle"><img src="../Images/ch01/e092_01.png"></span>. One of the most fundamental results in the theory of complex variables is a formula of A. L. Cauchy [<em>Exercices de Math.</em> <strong>1</strong> (1826), 95–113 = <em>Œuvres</em> (2) <strong>6</strong>, 124–145, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-11">11</a>)], by which we can extract any desired coefficient with the help of a contour integral:</p>

  <div class="equation"><a id="ch01eq-lev2sec9-32"></a><img src="../Images/ch01/092equ02.png"></div>

  <p>if $G(z)$ converges for $z=z_{0}$ and $0\lt r\lt |z_{0} |$. The basic idea is that <span class="middle"><img src="../Images/ch01/e092_02.png"></span> is zero for all integers <em>m</em> except <em>m</em> = −1, when the integral is</p>

  <div class="image"><img src="../Images/ch01/e092_03.png"></div>

  <p>Equation (<a href="../Text/ch01a.html#ch01eq-lev2sec9-32">32</a>) is of importance primarily when we want to study the approximate value of a coefficient.</p>

  <p class="indent">We conclude this section by returning to a problem that was only partially solved in <a href="../Text/ch01.html#ch01lev2sec3">Section 1.2.3</a>. We saw in Eq. <a href="../Text/ch01.html#ch01lev2sec3">1.2.3</a>–(<a href="../Text/ch01.html#ch01eq-lev2sec3-13">13</a>) and exercise <a href="../Text/ch01.html#ch01lev2sec3">1.2.3</a>–<a href="../Text/ch01.html#ch01ex_2_3_29">29</a> that</p>

  <div class="image"><img src="../Images/ch01/e092_04.png"></div>

  <p class="indent">In general, suppose that we have <em>n</em> numbers $x_{1}, x_{2},..., x^{n}$ and we want the sum</p>

  <div class="equation"><a id="ch01eq-lev2sec9-33"></a><img src="../Images/ch01/092equ03.png"></div>

  <p>If possible, this sum should be expressed in terms of $S_{1}, S_{2},..., S_{m}$, where</p>

  <div class="equation"><a id="ch01eq-lev2sec9-34"></a><img src="../Images/ch01/092equ04.png"></div>

  <p>the sum of <em>j</em> th powers. Using this more compact notation, the formulas above become <span class="middle"><img src="../Images/ch01/e092_05.png"></span>; <span class="middle"><img src="../Images/ch01/e092_06.png"></span>.</p>

  <p class="indent">We can attack this problem by setting up the generating function</p>

  <div class="equation"><a id="ch01eq-lev2sec9-35"></a><img src="../Images/ch01/092equ05.png"></div>

  <p><a id="page_93"></a>By our rules for multiplying series, we find that</p>

  <div class="equation"><a id="ch01eq-lev2sec9-36"></a><img src="../Images/ch01/093equ01.png"></div>

  <p>So $G(z)$ is the reciprocal of a polynomial. It often helps to take the logarithm of a product, and we find from (<a href="../Text/ch01a.html#ch01eq-lev2sec9-17">17</a>) that</p>

  <div class="equation"><a id="ch01eq-lev2sec9-37"></a><img src="../Images/ch01/093equ02.png"></div>

  <p>Now $\ln G(z)$ has been expressed in terms of the <em>S</em>’s; so all we must do to obtain the answer to our problem is to compute the power series expansion of $G(z)$ again, with the help of (<a href="../Text/ch01a.html#ch01eq-lev2sec9-22">22</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec9-9">9</a>):</p>

  <div class="equation"><a id="ch01eq-lev2sec9-38"></a><img src="../Images/ch01/093equ04.png"></div>

  <p>The parenthesized quantity is $h_{m}$. This rather imposing sum is really not complicated when it is examined carefully. The number of terms for a particular value of <em>m</em> is $p(m)$, the number of partitions of <em>m</em> (<a href="../Text/ch01.html#ch01lev2sec1">Section 1.2.1</a>). For example, one partition of 12 is</p>

  <p class="center">12 = 5 + 2 + 2 + 2 + 1;</p>

  <p>this corresponds to a solution of the equation $k_{1}+2k_{2}+···+12k_{12}=12$, where $k_{j}$ is the number of <em>j</em>’s in the partition. In our example $k_{1}=1$, $k_{2}=3$, $k_{5}=1$, and the other <em>k</em>’s are zero; so we get the term</p>

  <div class="image"><img src="../Images/ch01/e093_01.png"></div>

  <p>as part of the expression for $h_{12}$. By differentiating (<a href="../Text/ch01a.html#ch01eq-lev2sec9-37">37</a>) it is not difficult to derive the recurrence</p>

  <div class="equation"><a id="ch01eq-lev2sec9-39"></a><img src="../Images/ch01/093equ03.png"></div>

  <p class="indent">An enjoyable introduction to the applications of generating functions has been given by G. Pólya, “On picture writing,” <em>AMM</em> <strong>63</strong> (1956), 689–697; his approach is continued in <em>CMath</em>, Chapter 7. See also the book <em>generatingfunctionology</em> by H. S. Wilf, second edition (Academic Press, 1994). 94</p>

  <p class="blockquote"><a id="page_94"></a><span class="roman_italic">A generating function is a clothesline<br>
  on which we hang up a sequence of numbers for display.</span></p>

  <p class="attribution">— H. S. WILF (1989)</p>

  <p class="ex-title">Exercises</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_9_1a" id="ch01ex_2_9_1">1</a>.</strong> [<em>M12</em>] What is the generating function for the sequence $2, 5, 13, 35,...=\langle{2^{n} +3^{n}}\rangle$?</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_9_2a" id="ch01ex_2_9_2">2</a>.</strong> [<em>M13</em>] Prove Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-11">11</a>).</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_9_3a" id="ch01ex_2_9_3">3</a>.</strong> [<em>HM21</em>] Differentiate the generating function (<a href="../Text/ch01a.html#ch01eq-lev2sec9-18">18</a>) for $\langle{H_{n}}\rangle$, and compare this with the generating function for <span class="middle"><img src="../Images/ch01/e094_01.png"></span>. What relation can you deduce?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_9_4a" id="ch01ex_2_9_4">4</a>.</strong> [<em>M01</em>] Explain why Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-19">19</a>) is a special case of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-21">21</a>).</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_9_5a" id="ch01ex_2_9_5">5</a>.</strong> [<em>M20</em>] Prove Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-23">23</a>) by induction on <em>n</em>.</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_9_6a" id="ch01ex_2_9_6">6</a>.</strong> [<em>HM15</em>] Find the generating function for</p>

  <div class="image"><img src="../Images/ch01/e094_02.png"></div>

  <p class="exercisesp">differentiate it and express the coefficients in terms of harmonic numbers.</p>

  <p class="exercises"><strong>7.</strong> [<em>M15</em>] Verify all the steps leading to Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-38">38</a>).</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_9_8a" id="ch01ex_2_9_8">8</a>.</strong> [<em>M23</em>] Find the generating function for $p(n)$, the number of partitions of <em>n</em>.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_9_9a" id="ch01ex_2_9_9">9</a>.</strong> [<em>M11</em>] In the notation of Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-34">34</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec9-35">35</a>), what is $h_{4}$ in terms of $S_{1}$, $S_{2}$, $S_{3}$, and $S_{4}$?</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_9_10a" id="ch01ex_2_9_10">10</a>.</strong> [<em>M25</em>] An <em>elementary symmetric function</em> is defined by the formula</p>

  <div class="image"><img src="../Images/ch01/e094_03.png"></div>

  <p class="exercisesp">(This is the same as $h_{m}$ of Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-33">33</a>), except that equal subscripts are not allowed.) Find the generating function for $e_{m}$, and express $e_{m}$ in terms of the $S_{j}$ in Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-34">34</a>). Write out the formulas for $e_{1}$, $e_{2}$, $e_{3}$, and $e_{4}$.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_9_11a" id="ch01ex_2_9_11">11</a>.</strong> [<em>M25</em>] Equation (<a href="../Text/ch01a.html#ch01eq-lev2sec9-39">39</a>) can also be used to express the <em>S</em>’s in terms of the <em>h</em>’s: We find $S_{1}=h_{1}$, <span class="middle"><img src="../Images/ch01/e094_04.png"></span>, <span class="middle"><img src="../Images/ch01/e094_05.png"></span>, etc. What is the coefficient of <span class="middle"><img src="../Images/ch01/e094_06.png"></span> in this representation of $S_{m}$, when $k_{1}+2k_{2}+···+mk_{m}=m$?</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_9_12a" id="ch01ex_2_9_12">12</a>.</strong> [<em>M20</em>] Suppose we have a doubly subscripted sequence $\langle{a_{mn}}\rangle$ for $m, n=0, 1,...$; show how this double sequence can be represented by a <em>single</em> generating function of two variables, and determine the generating function for <span class="middle"><img src="../Images/ch01/e094_07.png"></span>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_9_13a" id="ch01ex_2_9_13">13</a>.</strong> [<em>HM22</em>] The <em>Laplace transform</em> of a function $f(x)$ is the function</p>

  <div class="image"><img src="../Images/ch01/e094_08.png"></div>

  <p class="exercisesp">Given that $a_{0}, a_{1}, a_{2},...$ is an infinite sequence having a convergent generating function, let $f(x)$ be the step function $∑_{k}a_{k}[0≤k≤x]$. Express the Laplace transform of $f(x)$ in terms of the generating function <em>G</em> for this sequence.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_9_14a" id="ch01ex_2_9_14">14</a>.</strong> [<em>HM21</em>] Prove Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-13">13</a>).</p>

  <p class="exercises1"><a id="page_95"></a><strong><a href="../Text/app01.html#ch01ex_2_9_15a" id="ch01ex_2_9_15">15</a>.</strong> [<em>M28</em>] By considering $H (w)=∑_{n≥0}G_{n}(z)w^{n}$, find a closed form for the generating function</p>

  <div class="image"><img src="../Images/ch01/e095_01.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_9_16a" id="ch01ex_2_9_16">16</a>.</strong> [<em>M22</em>] Give a simple formula for the generating function $G_{nr}(z)=∑_{k}a_{nkr} z^{k}$, where $a_{nkr}$ is the number of ways to choose <em>k</em> out of <em>n</em> objects, subject to the condition that each object may be chosen at most <em>r</em> times. (If <em>r</em> = 1, we have <span class="middle"><img src="../Images/ch01/nbyk.png"></span> ways, and if <em>r</em> ≥ <em>k</em>, we have the number of combinations with repetitions as in exercise <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–<a href="../Text/ch01a.html#ch01ex_2_6_60">60</a>.)</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_9_17a" id="ch01ex_2_9_17">17</a>.</strong> [<em>M25</em>] What are the coefficients of $1/(1-z)^{w}$ if this function is expanded into a <em>double</em> power series in terms of both <em>z</em> and <em>w</em>?</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_9_18a" id="ch01ex_2_9_18">18</a>.</strong> [<em>M25</em>] Given positive integers <em>n</em> and <em>r</em>, find a simple formula for the value of the following sums: (a) $∑_{1≤k_{1}\lt k_{2}\lt...\lt k_{r}≤n}k_{1}k_{2}... k_{r}$; (b) $∑_{1≤k_{1}≤k_{2}≤k_{r}≤n}k_{1}k_{2}... k_{r}$. (For example, when <em>n</em> = 3 and <em>r</em> = 2 the sums are, respectively, $1·2+1·3+2·3$ and $1·1+1·2+1·3+2·2+2·3+3·3$.)</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_9_19a" id="ch01ex_2_9_19">19</a>.</strong> [<em>HM32</em>] (C. F. Gauss, 1812.) The sums of the following infinite series are well known:</p>

  <div class="image"><img src="../Images/ch01/e095_02.png"></div>

  <p class="exercisesp">Using the definition</p>

  <div class="image"><img src="../Images/ch01/e095_03.png"></div>

  <p class="exercisesp">found in the answer to exercise <a href="../Text/ch01a.html#ch01lev2sec7">1.2.7</a>–<a href="../Text/ch01a.html#ch01ex_2_7_24">24</a>, these series may be written respectively as</p>

  <div class="image"><img src="../Images/ch01/e095_04.png"></div>

  <p class="exercisesp">Prove that, in general, $H_{p/q}$ has the value</p>

  <div class="image"><img src="../Images/ch01/e095_05.png"></div>

  <p class="exercisesp">when <em>p</em> and <em>q</em> are integers with 0 <em>&lt; p &lt; q</em>. [<em>Hint:</em> By Abel’s limit theorem the sum is</p>

  <div class="image"><img src="../Images/ch01/e095_06.png"></div>

  <p class="exercisesp">Use Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec9-13">13</a>) to express this power series in such a way that the limit can be evaluated.]</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_9_20a" id="ch01ex_2_9_20">20</a>.</strong> [<em>M21</em>] For what coefficients $c_{mk}$ is <span class="middle"><img src="../Images/ch01/e095_07.png"></span></p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_9_21a" id="ch01ex_2_9_21">21</a>.</strong> [<em>HM30</em>] Set up the generating function for the sequence $\langle{n!}\rangle$ and study properties of this function.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_9_22a" id="ch01ex_2_9_22">22</a>.</strong> [<em>M21</em>] Find a generating function $G(z)$ for which</p>

  <div class="image"><img src="../Images/ch01/e095_08.png"></div>

  <p class="exercises1"><a id="page_96"></a><strong><a href="../Text/app01.html#ch01ex_2_9_23a" id="ch01ex_2_9_23">23</a>.</strong> [<em>M33</em>] (L. Carlitz.) (a) Prove that for all integers <em>m</em> ≥ 1 there are polynomials $f_{m}(z_{1},..., z_{m})$ and $g_{m}(z_{1},..., z_{m})$ such that the formula</p>

  <div class="image"><img src="../Images/ch01/e096_01.png"></div>

  <p class="exercisesp">is an identity for all integers <em>n</em> ≥ <em>r</em> ≥ 0.</p>

  <p class="indenthangingA">(b) Generalizing <a href="../Text/ch01a.html#ch01ex_2_9_15">exercise 15</a>, find a closed form for the sum</p>

  <div class="image"><img src="../Images/ch01/e096_02.png"></div>

  <p class="exercisesp">in terms of the functions $f_{m}$ and $g_{m}$ in part (a).</p>

  <p class="indenthangingA">(c) Find a simple expression for $S_{n}(z_{1},..., z_{m})$ when $z_{1}=···= z_{m}=z$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_9_24a" id="ch01ex_2_9_24">24</a>.</strong> [<em>M22</em>] Prove that, if $G(z)$ is any generating function, we have</p>

  <div class="image"><img src="../Images/ch01/e096_03.png"></div>

  <p class="exercisesp">Evaluate both sides of this identity when $G(z)$ is (a) $1/(1-z)$; (b) $(e^{z}-1)/z$.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_9_25a" id="ch01ex_2_9_25">25</a>.</strong> [<em>M23</em>] Evaluate the sum <span class="middle"><img src="../Images/ch01/e096_04.png"></span> by simplifying the equivalent formula $∑_{k}[w^{k}] (1-2w)^{n}[z^{n-k}] (1+z)^{2n-2k}$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_9_26a" id="ch01ex_2_9_26">26</a>.</strong> [<em>M40</em>] Explore a generalization of the notation (<a href="../Text/ch01a.html#ch01eq-lev2sec9-31">31</a>) according to which we might write, for example, $[z^{2}-2z^{5}] G(z)=a_{2}-2a_{5}$ when $G(z)$ is given by (<a href="../Text/ch01a.html#ch01eq-lev2sec9-1">1</a>).</p>

  <div class="heading">
    <h4 id="ch01lev2sec10">1.2.10. Analysis of an Algorithm</h4>

    <p>Let us now apply some of the techniques of the preceding sections to the study of a typical algorithm.</p>
  </div>

  <p><a id="ch01alg-lev2sec10-M"></a><strong>Algorithm M</strong> (<em>Find the maximum</em>). Given <em>n</em> elements $X[1], X[2],..., X[n]$, we will find <em>m</em> and <em>j</em> such that $m=X[j]=\max_{1≤i≤n}X[i]$, where <em>j</em> is the largest index that satisfies this relation.</p>

  <p class="indenthanging"><strong>M1.</strong> [Initialize.] Set $j←n$, $k←n-1$, $m←x[n]$. (During this algorithm we will have $m=X[j]=\max_{k\lt i≤n}X[i]$.)</p>

  <p class="indenthanging"><strong>M2.</strong> [All tested?] If <em>k</em> = 0, the algorithm terminates.</p>

  <p class="indenthanging"><strong>M3.</strong> [Compare.] If $X[k]≤m$, go to M5.</p>

  <p class="indenthanging"><strong>M4.</strong> [Change <em>m</em>.] Set $j←k$, $m←X[k]$. (This value of <em>m</em> is a new current maximum.)</p>

  <p class="indenthanging"><strong>M5.</strong> [Decrease <em>k</em>.] Decrease <em>k</em> by one and return to M2. <span class="middle"><img src="../Images/ch01/common-01.png"></span></p>

  <p class="indent">This rather obvious algorithm may seem so trivial that we shouldn’t bother to analyze it in detail; but it actually makes a good demonstration of the way in which more complicated algorithms may be studied. Analysis of algorithms is quite important in computer programming, because there are usually several algorithms available for a particular application and we would like to know which is best.</p>

  <p class="indent"><a id="page_97"></a><a href="../Text/ch01a.html#ch01alg-lev2sec10-M">Algorithm M</a> requires a fixed amount of storage, so we will analyze only the time required to perform it. To do this, we will count the number of times each step is executed (see <a href="../Text/ch01a.html#ch01fig09">Fig. 9</a>):</p>

  <div class="image"><img src="../Images/ch01/097tab01.png"></div>

  <div class="image">
    <a id="ch01fig09"></a><img src="../Images/ch01/01fig09.png">

    <p class="fig-caption"><strong>Fig. 9.</strong> <a href="../Text/ch01a.html#ch01alg-lev2sec10-M">Algorithm M</a>. Labels on the arrows indicate the number of times each path is taken. Note that “Kirchhoff’s first law” must be satisfied: The amount of flow into each node must equal the amount of flow going out.</p>
  </div>

  <p>Knowing the number of times each step is executed gives us the information necessary to determine the running time on a particular computer.</p>

  <p class="indent">In the table above we know everything except the quantity <em>A</em>, which is the number of times we must change the value of the current maximum. To complete the analysis, we shall study this interesting quantity <em>A</em>.</p>

  <p class="indent">The analysis usually consists of finding the <em>minimum</em> value of <em>A</em> (for optimistic people), the <em>maximum</em> value of <em>A</em> (for pessimistic people), the <em>average</em> value of <em>A</em> (for probabilistic people), and the <em>standard deviation</em> of <em>A</em> (a quantitative indication of how close to the average we may expect the value to be).</p>

  <p class="indent">The <em>minimum</em> value of <em>A</em> is zero; this happens if</p>

  <div class="image"><img src="../Images/ch01/e097_01.png"></div>

  <p>The <em>maximum</em> value is $n-1$; this happens in case</p>

  <p class="center">$X[1]\gt X[2]\gt···\gt x[n]$.</p>

  <p class="indent">Thus the average value lies between 0 and $n-1$. Is it <span class="middle"><img src="../Images/ch01/1by2.png"></span> <em>n</em>? Is it <span class="middle"><img src="../Images/ch01/root-n.png"></span>? To answer this question we need to define what we mean by the average; and to define the average properly, we must make some assumptions about the characteristics of the input data $X[1], x[2],..., x[n]$. <em>We will assume that the $X[k]$ are distinct values, and that each of the n! permutations of these values is equally likely</em>. (This is a reasonable assumption to make in most situations, but the analysis can be carried out under other assumptions, as shown in the exercises at the end of this section.)</p>

  <p class="indent"><a id="page_98"></a>The performance of <a href="../Text/ch01a.html#ch01alg-lev2sec10-M">Algorithm <em>M</em></a> does not depend on the precise values of the <em>X</em> [<em>k</em>]; only the relative order is involved. For example, if <em>n</em> = 3 we are assuming that each of the following six possibilities is equally probable:</p>

  <div class="image"><img src="../Images/ch01/098tab01.png"></div>

  <p>The average value of <em>A</em> when <em>n</em> = 3 comes to $(0+1+0+1+1+2)/6=5/6$.</p>

  <p class="indent">It is clear that we may take $X[1], X[2],..., X[n]$ to be the numbers $1, 2,..., n$ in some order; under our assumption we regard each of the $n!$ permutations as equally likely. The <em>probability</em> that <em>A</em> has the value <em>k</em> will be</p>

  <div class="equation"><a id="ch01eq-lev2sec10-1"></a><img src="../Images/ch01/098equ01.png"></div>

  <p>For example, from our table above, <span class="middle"><img src="../Images/ch01/e098_01.png"></span>, <span class="middle"><img src="../Images/ch01/e098_02.png"></span>, <span class="middle"><img src="../Images/ch01/e098_03.png"></span>.</p>

  <p class="indent">The <em>average</em> (“mean” or “expected”) value is defined, as usual, to</p>

  <div class="equation"><a id="ch01eq-lev2sec10-2"></a><img src="../Images/ch01/098equ02.png"></div>

  <p>The <em>variance</em> $V_{n}$ is defined to be the average value of $(A-A_{n})^{2}$; we have therefore</p>

  <div class="equation"><a id="ch01eq-lev2sec10-3"></a><img src="../Images/ch01/098equ03.png"></div>

  <p>Finally, the <em>standard deviation</em> $σ_{n}$ is defined to be <span class="middle"><img src="../Images/ch01/e098_04.png"></span>.</p>

  <p class="indent">The significance of $σ_{n}$ can perhaps best be understood by noting that, for all <em>r</em> ≥ 1, the probability that <em>A</em> fails to lie within $rσ_{n}$ of its average value is less than $1/r^{2}$. For example, $|A-A_{n} |\gt2σ_{n}$ with probability &lt; 1/4. (<em>Proof:</em> Let <em>p</em> be the stated probability. Then if <em>p</em> &gt; 0, the average value of $(A-A_{n}) ^{2}$ is more than $p·(rσ_{n})^{2}+(1-p)·0$; that is, $V_{n}\gt pr^{2}V_{n}$.) This is usually called <em>Chebyshev’s inequality,</em> although it was actually discovered first by J. Bienaymé [<em>Comptes Rendus Acad. Sci.</em> <strong>37</strong> (Paris, 1853), 320–321].</p>

  <p class="indent">We can determine the behavior of <em>A</em> by determining the probabilities $p^{nk}$. It is not hard to do this inductively: By Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-1">1</a>) we want to count the number of permutations on <em>n</em> elements that have <em>A</em> = <em>k</em>. Let this number be $p_{nk}=n! p_{nk}$.</p>

  <p class="indent">Consider the permutations $x_{1}x_{2}... x_{n}$ on $/{1, 2,..., n/}$, as in <a href="../Text/ch01.html#ch01lev2sec5">Section 1.2.5</a>. If $x_{1}=n$, the value of <em>A</em> is <em>one higher</em> than the value obtained on $x_{2}... x^{n}$; if $x_{1} ≠ n$, the value of <em>A</em> is <em>exactly the same</em> as its value on $x_{2}... x_{n}$. Therefore we find that $p_{nk}=P<sub>(n-1)(k-1)</sub>+(n-1)P<sub>(n-1) k</sub>$, or equivalently</p>

  <div class="equation"><a id="ch01eq-lev2sec10-4"></a><img src="../Images/ch01/e098_05.png"></div>

  <div class="image">
    <a id="page_99"></a><a id="ch01fig10"></a><img src="../Images/ch01/01fig10.png">

    <p class="fig-caption"><strong>Fig. 10.</strong> Probability distribution for step M4, when <em>n</em> = 12. The mean is $58301/27720$, or approximately 2.10. The variance is approximately 1.54.</p>
  </div>

  <p>This equation will determine $p_{nk}$ if we provide the initial conditions</p>

  <div class="equation"><a id="ch01eq-lev2sec10-5"></a><img src="../Images/ch01/099equ01.png"></div>

  <p class="indent">We can now get information about the quantities <em>Pnk</em> by using generating functions. Let</p>

  <div class="equation"><a id="ch01eq-lev2sec10-6"></a><img src="../Images/ch01/099equ02.png"></div>

  <p>We know that <em>A ≤ n –</em> 1, so $p_{nk}= 0$ for large values of <em>k;</em> thus $G_{n}(z)$ is actually a polynomial, even though an infinite sum has been specified for convenience.</p>

  <p class="indent">From Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-5">5</a>) we have $G_{1}(z)=1$; and from Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-4">4</a>) we have</p>

  <div class="equation"><a id="ch01eq-lev2sec10-7"></a><img src="../Images/ch01/099equ03.png"></div>

  <p>(The reader should study the relation between Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-4">4</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec10-7">7</a>) carefully.) We can now see that</p>

  <div class="equation"><a id="ch01eq-lev2sec10-8"></a><img src="../Images/ch01/099equ04.png"></div>

  <p>So $G_{n}(z)$ is essentially a binomial coefficient!</p>

  <p class="indent">This function appears in the previous section, Eq. <a href="../Text/ch01a.html#ch01lev2sec9">1.2.9</a>-(<a href="../Text/ch01a.html#ch01eq-lev2sec9-27">27</a>), where we have</p>

  <div class="image"><img src="../Images/ch01/e099_01.png"></div>

  <p class="indent">Therefore $p_{nk}$ can be expressed in terms of Stirling numbers:</p>

  <div class="equation"><a id="ch01eq-lev2sec10-9"></a><img src="../Images/ch01/099equ05.png"></div>

  <p><a href="../Text/ch01a.html#ch01fig10">Figure 10</a> shows the approximate sizes of $p_{nk}$ when <em>n</em> = 12.</p>

  <p class="indent"><a id="page_100"></a>Now all we must do is plug this value of <em>p</em><sub>nk</sub> into Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-2">2</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec10-3">3</a>) and we have the desired average value. But this is easier said than done. It is, in fact, unusual to be able to determine the probabilities $p_{nk}$ explicitly; in most problems we will know the generating function $G_{n}(z)$, but we will not have any special knowledge about the actual probabilities. The important fact is that <em>we can determine the mean and variance easily from the generating function itself</em>.</p>

  <p class="indent">To see this, let’s suppose that we have a generating function whose coefficients represent probabilities:</p>

  <p class="center">$G(z)=p_{0}+p_{1}z+p_{2}z^{2}+···$.</p>

  <p>Here $p_{k}$ is the probability that some event has a value <em>k</em>. We wish to calculate the quantities</p>

  <div class="equation"><a id="ch01eq-lev2sec10-10"></a><img src="../Images/ch01/100equ01.png"></div>

  <p>Using differentiation, it is not hard to discover how to do this. Note that</p>

  <div class="equation"><a id="ch01eq-lev2sec10-11"></a><img src="../Images/ch01/100equ02.png"></div>

  <p>since $G(1)=p_{0}+p_{1}+p_{2}+···$ is the sum of all possible probabilities. Similarly, since $G′(z)=∑_{k}kp_{k}z^{k-1}$, we have</p>

  <div class="equation"><a id="ch01eq-lev2sec10-12"></a><img src="../Images/ch01/100equ03.png"></div>

  <p>Finally, we apply differentiation again and we obtain (see <a href="../Text/ch01a.html#ch01ex_2_10_2">exercise 2</a>)</p>

  <div class="equation"><a id="ch01eq-lev2sec10-13"></a><img src="../Images/ch01/100equ04.png"></div>

  <p>Equations (<a href="../Text/ch01a.html#ch01eq-lev2sec10-12">12</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec10-13">13</a>) give the desired expressions of the mean and variance in terms of the generating function.</p>

  <p class="indent">In our case, we wish to calculate $G′ (1)=a_{n}$. From Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-7">7</a>) we have</p>

  <div class="image"><img src="../Images/ch01/e100_02.png"></div>

  <p>From the initial condition <span class="middle"><img src="../Images/ch01/e100_03.png"></span>, we find therefore</p>

  <div class="equation"><a id="ch01eq-lev2sec10-14"></a><img src="../Images/ch01/100equ05.png"></div>

  <p>This is the desired average number of times step M4 is executed; it is approximately ln <em>n</em> when <em>n</em> is large. [<em>Note:</em> The <em>r</em>th moment of $A+1$, namely the quantity $∑_{k}(k+1)^{r}p_{nk}$, is <span class="middle"><img src="../Images/ch01/e100_04.png"></span>, and it has the approximate value $(\ln n)^{r}$; see P. B. M. Roes <em>CACM</em> <strong>9</strong> (1966), 342. The distribution of <em>A</em> was first studied by F. G. Foster and A. Stuart, <em>J. Roy. Stat. Soc.</em> <strong>B16</strong> (1954), 1–22.]</p>

  <p class="indent">We can proceed similarly to calculate the variance $V_{n}$. Before doing this, let us state an important simplification:</p>

  <p><a id="page_101"></a><a id="the_a"></a><strong>Theorem A.</strong> <em>Let G and H be two generating functions with $G(1)=H (1)=1$. <em>If the quantities $mean(G)$ <em>and</em> $var(G)$ are defined by Eqs.</em> (<a href="../Text/ch01a.html#ch01eq-lev2sec10-12">12</a>) <em>and</em> (<a href="../Text/ch01a.html#ch01eq-lev2sec10-13">13</a>), <em>we have</em></p>

  <div class="equation"><a id="ch01eq-lev2sec10-15"></a><img src="../Images/ch01/101equ01.png"></div>

  <p class="indent">We will prove this theorem later. It tells us that the mean and variance of a product of generating functions may be reduced to a sum. <span class="middle"><img src="../Images/ch01/common-01.png"></span></p>

  <p class="indent">Letting $Q_{n}(z)=(z+n-1)/n$, we have <span class="middle"><img src="../Images/ch01/e101_01.png"></span>; hence</p>

  <div class="image"><img src="../Images/ch01/e101_02.png"></div>

  <p>Finally, since <span class="middle"><img src="../Images/ch01/e101_03.png"></span>, it follows that</p>

  <div class="image"><img src="../Images/ch01/e101_04.png"></div>

  <p class="indent">Summing up, we have found the desired statistics related to quantity <em>A</em>:</p>

  <div class="equation"><a id="ch01eq-lev2sec10-16"></a><img src="../Images/ch01/101equ02.png"></div>

  <p>The notation used in Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-16">16</a>) will be used to describe the statistical characteristics of other probabilistic quantities throughout this book.</p>

  <p class="indent">We have completed the analysis of <a href="../Text/ch01a.html#ch01alg-lev2sec10-M">Algorithm M</a>; the new feature that has appeared in this analysis is the introduction of probability theory. Elementary probability theory is sufficient for most of the applications in this book: The simple counting techniques and the definitions of mean, variance, and standard deviation already given will answer most of the questions we want to ask. More complicated algorithms will help us develop an ability to reason fluently about probabilities.</p>

  <p class="indent">Let us consider some simple probability problems, to get a little more practice using these methods. In all probability the first question that comes to mind is a coin-tossing problem: Suppose we flip a coin <em>n</em> times and there is a probability <em>p</em> that heads turns up after any particular toss; what is the average number of heads that will occur? What is the standard deviation?</p>

  <p class="indent">We will consider our coin to be biased; that is, we will not assume that <em>p</em> = <span class="middle"><img src="../Images/ch01/1by2.png"></span>. This makes the problem more interesting, and, furthermore, every real coin is biased (or we could not tell one side from the other).</p>

  <p class="indent">Proceeding as before, we let $p_{nk}$ be the probability that <em>k</em> heads will occur, and let $G_{n}(z)$ be the corresponding generating function. We have clearly</p>

  <div class="equation"><a id="ch01eq-lev2sec10-17"></a><img src="../Images/ch01/101equ03.png"></div>

  <p>where $q=1-p$ is the probability that tails turns up. As before, we argue from Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-17">17</a>) that $G_{n}(z)=(q+pz)G_{n-1}(z)$; and from the obvious initial condition $G_{1}(z)=q+pz$ we have</p>

  <div class="equation"><a id="page_102"></a><a id="ch01eq-lev2sec10-18"></a><img src="../Images/ch01/102equ01.png"></div>

  <p>Hence, by <a href="#the_a">Theorem A</a>,</p>

  <p class="center">$mean(G_{n})=n mean(G_{1})=pn$;<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$var(G_{n})=n var(G_{1})=(p-p^{2}) n=pqn$.</p>

  <p>For the number of heads, we have therefore</p>

  <div class="equation"><a id="ch01eq-lev2sec10-19"></a><img src="../Images/ch01/102equ02.png"></div>

  <p><a href="../Text/ch01a.html#ch01fig11">Figure 11</a> shows the values of $p_{nk}$ when <span class="middle"><img src="../Images/ch01/e102_01.png"></span>, <em>n</em> = 12. When the standard deviation is proportional to <span class="middle"><img src="../Images/ch01/root-n.png"></span> and the difference between maximum and minimum is proportional to <em>n</em>, we may consider the situation “stable” about the average.</p>

  <div class="image">
    <a id="ch01fig11"></a><img src="../Images/ch01/01fig11.png">

    <p class="fig-caption"><strong>Fig. 11.</strong> Probability distribution for coin-tossing: 12 independent tosses with a chance of success equal to 3/5 at each toss.</p>
  </div>

  <p class="indent">Let us work one more simple problem. Suppose that in some process there is <em>equal</em> probability of obtaining the values $1, 2,..., n$. The generating function for this situation is</p>

  <div class="equation"><a id="ch01eq-lev2sec10-20"></a><img src="../Images/ch01/102equ03.png"></div>

  <p>We find after some rather laborious calculation that</p>

  <div class="image"><img src="../Images/ch01/e102_02.png"></div>

  <p>Now to calculate the mean and variance, we need to know <em>G</em>′(1) and $G″(1)$; but the form in which we have expressed these equations reduces to $0/0$ when we substitute <em>z</em> = 1. This makes it necessary to find the limit as <em>z</em> approaches unity, and that is a nontrivial task.</p>

  <p class="indent">Fortunately there is a much simpler way to proceed. By Taylor’s theorem we have</p>

  <div class="equation"><a id="ch01eq-lev2sec10-21"></a><img src="../Images/ch01/102equ04.png"></div>

  <p><a id="page_103"></a>therefore we merely have to replace <em>z</em> by <em>z</em> + 1 in (<a href="../Text/ch01a.html#ch01eq-lev2sec10-20">20</a>) and read off the coefficients:</p>

  <div class="image"><img src="../Images/ch01/e103_01.png"></div>

  <p>It follows that <span class="middle"><img src="../Images/ch01/e103_02.png"></span>, <span class="middle"><img src="../Images/ch01/e103_03.png"></span>, and the statistics for the uniform distribution are</p>

  <div class="equation"><a id="ch01eq-lev2sec10-22"></a><img src="../Images/ch01/103equ01.png"></div>

  <p>In this case the deviation of approximately $0.289n$ gives us a recognizably <em>unstable</em> situation.</p>

  <p class="indent">We conclude this section by proving <a href="../Text/ch01a.html#the_a">Theorem A</a> and relating our notions to classical probability theory. Suppose <em>X</em> is a random variable that takes on only nonnegative integer values, where <em>X</em> = <em>k</em> with probability $p_{k}$. Then $G(z)=p_{0}+p_{1}z+p_{2}z^{2}+···$ is called the <em>probability generating function</em> for <em>X</em>, and the quantity $G(e^{it})=p_{0} +p_{1} e^{it} +p_{2}e^{2it} +···$ is conventionally called the <em>characteristic function</em> of this distribution. The distribution given by the product of two such generating functions is called the <em>convolution</em> of the two distributions, and it represents the sum of two independent random variables belonging to those respective distributions.</p>

  <p class="indent">The mean or average value of a random quantity <em>X</em> is often called its <em>expected value</em>, and denoted by ${\rm E}X$. The variance of <em>X</em> is then ${\rm E}X^{2}-({\rm E}X)^{2}$. Using this notation, the probability generating function for <em>X</em> is $G(z)={\rm E}z^{X}$, the expected value of $z^{X}$, in cases when <em>X</em> takes only nonnegative integer values. Similarly, if <em>X</em> is a statement that is either true or false, the probability that <em>X</em> is true is $\Pr(X)={\rm E}[X ]$, using Iverson’s convention (Eq. <a href="../Text/ch01.html#ch01lev2sec3">1.2.3</a>–(<a href="../Text/ch01.html#ch01eq-lev2sec3-16">16</a>)).</p>

  <p class="indent">The mean and variance are just two of the so-called <em>semi-invariants</em> or <em>cumulants</em> introduced by T. N. Thiele in 1889 [see A. Hald, <em>International Statistical Review</em> <strong>68</strong> (2000), 137–153]. The semi-invariants $κ_{1}, κ_{2}, κ_{3},...$ are defined by the rule</p>

  <div class="equation"><a id="ch01eq-lev2sec10-23"></a><img src="../Images/ch01/103equ02.png"></div>

  <p>We have</p>

  <div class="image"><img src="../Images/ch01/e103_04.png"></div>

  <p>in particular,</p>

  <div class="image"><img src="../Images/ch01/e103_05.png"></div>

  <p>because $G(1)=∑_{k}p_{k}=1$, and</p>

  <div class="image"><img src="../Images/ch01/e103_06.png"></div>

  <p>Since the semi-invariants are defined in terms of the <em>logarithm</em> of a generating function, <a href="#the_a">Theorem A</a> is obvious, and, in fact, it can be generalized to apply to all of the semi-invariants.</p>

  <p class="indent"><a id="page_104"></a>A <em>normal distribution</em> is one for which all semi-invariants are zero except the mean and variance. In a normal distribution, we can improve significantly on Chebyshev’s inequality: The probability that a normally distributed random value differs from the mean by less than the standard deviation is</p>

  <div class="image"><img src="../Images/ch01/e104_01.png"></div>

  <p>that is, about $68.268949213709\%$ of the time. The difference is less than twice the standard deviation about $95.449973610364\%$ of the time, and it is less than three times the standard deviation about $99.730020393674\%$ of the time. The distributions specified by Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-8">8</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec10-18">18</a>) are <em>approximately</em> normal when <em>n</em> is large (see <a href="../Text/ch01a.html#ch01ex_2_10_13">exercises 13</a> and <a href="../Text/ch01a.html#ch01ex_2_10_14">14</a>).</p>

  <p class="indent">We often need to know that a random variable is unlikely to be much larger or smaller than its mean value. Two extremely simple yet powerful formulas, called the <em>tail inequalities</em>, provide convenient estimates of such probabilities. If <em>X</em> has the probability generating function $G(z)$, then</p>

  <div class="equation"><a id="ch01eq-lev2sec10-24"></a><img src="../Images/ch01/104equ01.png"></div>

  <div class="equation"><a id="ch01eq-lev2sec10-25"></a><img src="../Images/ch01/104equ02.png"></div>

  <p>The proofs are easy: If $G(z)=p_{0}+p_{1}z+p_{2}z^{2}+···$, we have</p>

  <p>$\Pr(X≤r)=p_{0}+p_{1}+···+p_{\lfloor{r}\rfloor}≤x^{-r}p_{0}+x^{1-r}p_{1}+···+x^{\lfloor{r}\rfloor-r}p_{\lfloor{r}\rfloor}≤x^{-r}G(x)$</p>

  <p>when 0 <em>&lt; x</em> ≤ 1, and</p>

  <p>$\Pr(X ≥ r)=p_{\lceil{r}\rceil}+p_{\lceil{r}\rceil+1}+···≤x^{\lceil{r}\rceil-r}p_{\lceil{r}\rceil}+x^{\lceil{r}\rceil+1-r}p_{\lceil{r}\rceil+1}+···≤x^{-r}G(x)$</p>

  <p>when <em>x</em> ≥ 1. By choosing values of <em>x</em> that minimize or approximately minimize the right-hand sides of (<a href="../Text/ch01a.html#ch01eq-lev2sec10-24">24</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec10-25">25</a>), we often obtain upper bounds that are fairly close to the true tail probabilities on the left-hand sides.</p>

  <p class="indent"><a href="../Text/ch01a.html#ch01ex_2_10_21">Exercises 21</a>–<a href="../Text/ch01a.html#ch01ex_2_10_23">23</a> illustrate the tail inequalities in several important cases. These inequalities are special cases of a general principle pointed out by A. N. Kolmogorov in his book <em>Grundbegriffe der Wahrscheinlichkeitsrechnung</em> (1933): If $f(t) ≥ s\gt0$ for all <em>t</em> ≥ <em>r</em>, and if $f(t) ≥ 0$ for all t in the domain of the random variable <em>X</em>, then $\Pr(X ≥ r)≤s^{-1} {\rm E}f(X)$ whenever ${\rm E}f(X)$ exists. We obtain (<a href="../Text/ch01a.html#ch01eq-lev2sec10-25">25</a>) when $f(t)=x^{t}$ and $s=x^{r}$. [S. Bernstein had contributed key ideas in <em>Uchenye zapiski Nauchno-Issledovatel’skikh kafedr Ukrainy</em> <strong>1</strong> (1924), 38–48.]</p>

  <p class="ex-title">Exercises</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_10_1a" id="ch01ex_2_10_1">1</a>.</strong> [<em>10</em>] Determine the value of $p<sub>n0</sub>$ from Eqs. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-4">4</a>) and (<a href="../Text/ch01a.html#ch01eq-lev2sec10-5">5</a>) and interpret this result from the standpoint of <a href="../Text/ch01a.html#ch01alg-lev2sec10-M">Algorithm M</a>.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_10_2a" id="ch01ex_2_10_2">2</a>.</strong> [<em>HM16</em>] Derive Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-13">13</a>) from Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-10">10</a>).</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_10_3a" id="ch01ex_2_10_3">3</a>.</strong> [<em>M15</em>] What are the minimum, maximum, average, and standard deviation of the number of times step M4 is executed, if we are using <a href="../Text/ch01a.html#ch01alg-lev2sec10-M">Algorithm M</a> to find the maximum of 1000 randomly ordered, distinct items? (Give your answer as decimal approximations to these quantities.)</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_10_4a" id="ch01ex_2_10_4">4</a>.</strong> [<em>M10</em>] Give an explicit, closed formula for the values of <em>p<sub>nk</sub></em> in the coin-tossing experiment, Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-17">17</a>).</p>

  <p class="exercises"><a id="page_105"></a><strong><a href="../Text/app01.html#ch01ex_2_10_5a" id="ch01ex_2_10_5">5</a>.</strong> [<em>M13</em>] What are the mean and standard deviation of the distribution in <a href="../Text/ch01a.html#ch01fig11">Fig. 11</a>?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_10_6a" id="ch01ex_2_10_6">6</a>.</strong> [<em>HM27</em>] We’ve computed the mean and the variance of the important probability distributions (<a href="../Text/ch01a.html#ch01eq-lev2sec10-8">8</a>), (<a href="../Text/ch01a.html#ch01eq-lev2sec10-18">18</a>), (<a href="../Text/ch01a.html#ch01eq-lev2sec10-20">20</a>). What is the <em>third</em> semi-invariant, $k_{3}$, in each of those cases?</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_10_7a" id="ch01ex_2_10_7">7</a>.</strong> [<em>M27</em>] In our analysis of <a href="../Text/ch01a.html#ch01alg-lev2sec10-M">Algorithm M</a>, we assumed that all the $X[k]$ were distinct. Suppose, instead, that we make only the weaker assumption that $X[1], X[2],..., X[n]$ contain precisely <em>m</em> distinct values; the values are otherwise random, subject to this constraint. What is the probability distribution of <em>A</em> in this case?</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_10_8a" id="ch01ex_2_10_8">8</a>.</strong> [<em>M20</em>] Suppose that each $X[k]$ is taken at random from a set of <em>M</em> distinct elements, so that each of the $M ^{n}$ possible choices for $X[1], X[2],..., X[n]$ is considered equally likely. What is the probability that all the $X[k]$ will be distinct?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_10_9a" id="ch01ex_2_10_9">9</a>.</strong> [<em>M25</em>] Generalize the result of the preceding exercise to find a formula for the probability that exactly <em>m</em> distinct values occur among the <em>X</em>’s. Express your answer in terms of Stirling numbers.</p>

  <p class="exercises1"><strong><a id="ch01ex_2_10_10"></a>10.</strong> [<em>M20</em>] Combine the results of the preceding three exercises to obtain a formula for the probability that <em>A</em> = <em>k</em> under the assumption that each <em>X</em> is selected at random from a set of <em>M</em> objects.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_10_11a" id="ch01ex_2_10_11">11</a>.</strong> [<em>M15</em>] What happens to the semi-invariants of a distribution if we change $G(z)$ to $F (z)=z^{n}G(z)$?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_10_12a" id="ch01ex_2_10_12">12</a>.</strong> [<em>HM21</em>] When $G(z)=p_{0}+p_{1}z+p_{2}z^{2}+···$ represents a probability distribution, the quantities $M_{n}=∑_{k}k^{n}p_{k}$ and $m_{n}=∑_{k} (k-M_{1}) ^{n}p_{k}$ are called the “<em>n</em>th moment” and “<em>n</em>th central moment,” respectively. Show that $G(e^{t})=1+M_{1}t+M_{2}t^{2}/2!+...$; then use Arbogast’s formula (exercise <a href="../Text/ch01.html#ch01lev2sec5">1.2.5</a>–<a href="../Text/ch01a.html#ch01ex_2_5_21">21</a>) to show that</p>

  <div class="image"><img src="../Images/ch01/e105_01.png"></div>

  <p class="exercisesp">In particular, $κ_{1}=M_{1}$, <span class="middle"><img src="../Images/ch01/e105_02.png"></span> (as we already knew), <span class="middle"><img src="../Images/ch01/e105_03.png"></span>, and <span class="middle"><img src="../Images/ch01/e105_04.png"></span>. What are the analogous expressions for $κ_{n}$ in terms of the central moments $m_{2}, m_{3},...$, when <em>n</em> ≥ 2?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_10_13a" id="ch01ex_2_10_13">13</a>.</strong> [<em>HM38</em>] A sequence of probability generating functions $G_{n}(z)$ with means $μ_{n}$ and deviations $σ_{n}$ is said to <em>approach a normal distribution</em> if</p>

  <div class="image"><img src="../Images/ch01/e105_05.png"></div>

  <p class="exercisesp">for all real values of <em>t</em>. Using $G_{n}(z)$ as given by Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-8">8</a>), show that $G_{n}(z)$ approaches a normal distribution.</p>

  <p class="indent"><em>Note:</em> “Approaching the normal distribution,” as defined here, can be shown to be equivalent to the fact that</p>

  <div class="image"><img src="../Images/ch01/e105_06.png"></div>

  <p class="exercisesp">where $X_{n}$ is a random quantity whose probabilities are specified by $G_{n}(z)$. This is a special case of P. Lévy’s important “continuity theorem,” a basic result in mathematical probability theory. A proof of Lévy’s theorem would take us rather far afield, although it is not extremely difficult [for example, see <em>Limit Distributions for Sums of Independent Random Variables</em> by B. V. Gnedenko and A. N. Kolmogorov, translated by K. L. Chung (Reading, Mass.: Addison–Wesley, 1954)].</p>

  <p class="exercises1"><a id="page_106"></a><strong><a href="../Text/app01.html#ch01ex_2_10_14a" id="ch01ex_2_10_14">14</a>.</strong> [<em>HM30</em>] (A. de Moivre.) Using the conventions of the previous exercise, show that the binomial distribution $G_{n}(z)$ given by Eq. (<a href="../Text/ch01a.html#ch01eq-lev2sec10-18">18</a>) approaches the normal distribution.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_10_15a" id="ch01ex_2_10_15">15</a>.</strong> [<em>HM23</em>] When the probability that some quantity has the value <em>k</em> is $e^{-μ} (μ^{k}/k!)$, it is said to have the <em>Poisson distribution with mean μ</em>.</p>

  <p class="indenthanging-A">a) What is the generating function for this set of probabilities?</p>

  <p class="indenthanging-A">b) What are the values of the semi-invariants?</p>

  <p class="indenthanging-A">c) Show that as $n → ∞$ the Poisson distribution with mean <em>np</em> approaches the normal distribution in the sense of <a href="../Text/ch01a.html#ch01ex_2_10_13">exercise 13</a>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_10_16a" id="ch01ex_2_10_16">16</a>.</strong> [<em>M25</em>] Suppose <em>X</em> is a random variable whose values are a <em>mixture</em> of the probability distributions generated by $g_{1}(z), g_{2}(z),..., g_{r}(z)$, in the sense that it uses $g_{k}(z)$ with probability $p_{k}$, where $p_{1}+p_{2}+···+p_{r}=1$. What is the generating function for <em>X</em>? Express the mean and variance of <em>X</em> in terms of the means and variances of $g_{1}, g_{2},..., g_{r}$.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_10_17a" id="ch01ex_2_10_17">17</a>.</strong> [<em>M27</em>] Let <em>f</em> (<em>z</em>) and $g(z)$ be generating functions that represent probability distributions.</p>

  <p class="indenthanging-A">a) Show that $h(z)=g(f(z))$ is also a generating function representing a probability distribution.</p>

  <p class="indenthanging-A">b) Interpret the significance of $h(z)$ in terms of $f(z)$ and $g(z)$. (What is the <em>meaning</em> of the probabilities represented by the coefficients of $h(z)$?)</p>

  <p class="indenthanging-A">c) Give formulas for the mean and variance of <em>h</em> in terms of those for <em>f</em> and <em>g</em>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_10_18a" id="ch01ex_2_10_18">18</a>.</strong> [<em>M28</em>] Suppose that the values taken on by $X[1], X[2],..., X[n]$ in <a href="../Text/ch01a.html#ch01alg-lev2sec10-M">Algorithm M</a> include exactly $k_{1}$ ones, $k_{2}$ twos, ..., $k_{n}$ <em>n</em>’s, arranged in random order. (Here</p>

  <p class="center">$k_{1}+k_{2}+···+k_{n}=n$.</p>

  <p class="exercisesp">The assumption in the text is that $k_{1}=k_{2}=···= k_{n}=1$.) Show that in this generalized situation, the generating function (<a href="../Text/ch01a.html#ch01eq-lev2sec10-8">8</a>) becomes</p>

  <div class="image"><img src="../Images/ch01/e106_01.png"></div>

  <p class="exercisesp">using the convention $0/0=1$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_10_19a" id="ch01ex_2_10_19">19</a>.</strong> [<em>M21</em>] If a_{k} &gt; a_{j} for 1 ≤ <em>j</em> &lt; <em>k</em>, we say that a_{k} is a <em>left-to-right maximum</em> of the sequence a_{1}a_{2} ... a_{n}. Suppose a_{1}a_{2} ... a_{n} is a permutation of {1, 2, ..., n}, and let b_{1}b_{2} ... b_{n} be the inverse permutation, so that a_{k} = <em>l</em> if and only if b_{l} = <em>k</em>. Show that a_{k} is a left-to-right maximum of a<sub>1</sub> a<sub>2</sub> ... a<sub><em>n</em></sub> if and only if <em>k</em> is a right-to-left minimum of b_{1}b_{2} ... b_{n}.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_10_20a" id="ch01ex_2_10_20">20</a>.</strong> [<em>M22</em>] Suppose we want to calculate max{|a_{1} − b_{1} |, |a_{2} − b_{2} |, ..., |a_{n} − b_{n} |} when b_{1} ≤ b_{2} ≤ · · · ≤ b_{n}. Show that it is sufficient to calculate max{<em>m<sub><em>L</em></sub></em>, <em>m<sub><em>R</em></sub></em> }, where</p>

  <p class="center"><em>m<sub><em>L</em></sub></em> = max{<em>a<sub><em>k</em></sub></em> − <em>b<sub><em>k</em></sub></em> | <em>a<sub><em>k</em></sub></em> is a left-to-right maximum of a_{1}a_{2} ... a_{n} },</p>

  <p class="center"><em>m<sub><em>R</em></sub></em> = max{<em>b<sub><em>k</em></sub></em> − <em>a<sub><em>k</em></sub></em> | <em>a<sub><em>k</em></sub></em> is a right-to-left minimum of a_{1}a_{2} ... a_{n} } .</p>

  <p class="exercisesp">(Thus, if the <em>a</em>’s are in random order, the number of <em>k</em>’s for which a subtraction must be performed is only about 2 ln <em>n</em>.)</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_10_21a" id="ch01ex_2_10_21">21</a>.</strong> [<em>HM21</em>] Let <em>X</em> be the number of heads that occur when a random coin is flipped <em>n</em> times, with generating function (<a href="../Text/ch01a.html#ch01eq-lev2sec10-18">18</a>). Use (<a href="../Text/ch01a.html#ch01eq-lev2sec10-25">25</a>) to prove that</p>

  <p class="center">Pr(<em>X</em> ≥ <em>n</em>(<em>p</em> + <span class="ent">∊</span>)) ≤ <em>e</em><sup>−<span class="ent">∊</span><sup>2</sup><em>n</em>/(2<em>q</em>)</sup></p>

  <p class="exercisesp">when <span class="ent"><em>∊</em></span> ≥ 0, and obtain a similar estimate for Pr(<em>X</em> ≤ <em>n</em>(<em>p</em> − <span class="ent"><em>∊</em></span>)).</p>

  <p class="exercises3"><a id="page_107"></a><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_10_22a" id="ch01ex_2_10_22">22</a>.</strong> [<em>HM22</em>] Suppose <em>X</em> has the generating function (q_{1} + p_{1}<em>z</em>)(q_{2} + p_{2}<em>z</em>) ... (q_{n} + p_{n}<em>z</em>), where p_{k} + q_{k} = 1 for 1 ≤ <em>k</em> ≤ <em>n</em>. Let <em>μ</em> = {\rm E}<em>X</em> = p_{1} + p_{2} + · · · + p_{n}. (a) Prove that</p>

  <p class="uln-indent1">Pr(<em>X</em> ≤ μ<em>r</em>) ≤ (<em>r</em><sup>−<em>r</em></sup> e<sup><em>r</em>−1</sup>) <sup>μ</sup>, when 0 &lt; <em>r</em> ≤ 1;<br>
  Pr(<em>X</em> ≥ μ<em>r</em>) ≤ (<em>r</em><sup>−<em>r</em></sup> e<sup><em>r</em>−1</sup>) <sup>μ</sup>, when <em>r</em> ≥ 1.</p>

  <p class="indenthanging-A">(b) Express the right-hand sides of these estimates in convenient form when <em>r</em> ≈ 1.</p>

  <p class="indenthanging-A">(c) Show that if <em>r</em> is sufficiently large we have Pr(<em>X</em> ≥ <em>μr</em>) ≤ 2<sup>−<em>μr</em></sup>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_10_23a" id="ch01ex_2_10_23">23</a>.</strong> [<em>HM23</em>] Estimate the tail probabilities for a random variable that has the <em>negative binomial distribution</em> generated by (<em>q − pz</em>)<sup>−<em>n</em></sup>, where <em>q</em> = <em>p</em> + 1.</p>

  <div class="heading">
    <h4 id="ch01lev2sec11">*1.2.11. Asymptotic Representations</h4>

    <p>We often want to know a quantity approximately, instead of exactly, in order to compare it to another. For example, Stirling’s approximation to <em>n</em>! is a useful representation of this type, when <em>n</em> is large, and we have also made use of the fact that $H_{n}≈\ln n+γ$. The derivations of such <em>asymptotic formulas</em> generally involve higher mathematics, although in the following subsections we will use nothing more than elementary calculus to get the results we need.</p>
  </div>

  <div class="heading">
    <h5 id="ch01lev3sec1">*1.2.11.1. The <span class="Rotsan_italic">O</span>-notation</h5>

    <p>Paul Bachmann introduced a very convenient notation for approximations in his book <em>Analytische Zahlentheorie</em> (1894). It is the <em>O</em>-notation, which allows us to replace the “≈” sign by “=” and to quantify the degree of accuracy; for example,</p>
  </div>

  <div class="equation"><a id="ch01eq-lev3sec1-1"></a><img src="../Images/ch01/107equ01.png"></div>

  <p>(Read, “<em>H</em> sub <em>n</em> equals the natural log of <em>n</em> plus Euler’s constant [pronounced ‘Oiler’s constant’] plus big-oh of one over <em>n</em>.”)</p>

  <p class="indent">In general, the notation <em>O</em>(<em>f</em> (<em>n</em>)) may be used whenever <em>f</em> (<em>n</em>) is a function of the positive integer <em>n</em>; it stands for a <em>quantity that is not explicitly known,</em> except that its magnitude isn’t too large. Every appearance of <em>O</em>(<em>f</em> (<em>n</em>)) means precisely this: There are positive constants <em>M</em> and n_{0} such that the number x_{n} represented by <em>O</em>(<em>f</em> (<em>n</em>)) satisfies the condition |x<sub><em>n</em></sub> | ≤ <em>M</em> |<em>f</em>(<em>n</em>)|, for all integers <em>n</em> ≥ n_{0}. We do not say <em>what</em> the constants <em>M</em> and n_{0} are, and indeed those constants are usually different for each appearance of <em>O</em>.</p>

  <p class="indent">For example, Eq. (<a href="../Text/ch01a.html#ch01eq-lev3sec1-1">1</a>) means that |H_{n} − ln <em>n</em> − <em>γ</em>| ≤ <em>M/n</em> when <em>n</em> ≥ n_{0}. Although the constants <em>M</em> and n_{0} are not stated, we can be sure that the quantity <em>O</em>(1/<em>n</em>) will be arbitrarily small if n is large enough.</p>

  <p class="indent">Let’s look at some more examples. We know that</p>

  <div class="image"><img src="../Images/ch01/e107_01.png"></div>

  <p>so it follows that</p>

  <div class="equation"><a id="ch01eq-lev3sec1-2"></a><img src="../Images/ch01/107equ02.png"></div>

  <div class="equation"><a id="ch01eq-lev3sec1-3"></a><img src="../Images/ch01/107equ03.png"></div>

  <div class="equation"><a id="ch01eq-lev3sec1-4"></a><img src="../Images/ch01/107equ04.png"></div>

  <p><a id="page_108"></a>Equation (<a href="../Text/ch01a.html#ch01eq-lev3sec1-2">2</a>) is rather crude, but not incorrect; Eq. (<a href="../Text/ch01a.html#ch01eq-lev3sec1-3">3</a>) is a stronger statement; and Eq. (<a href="../Text/ch01a.html#ch01eq-lev3sec1-4">4</a>) is stronger yet. To justify these equations we shall prove that <em>if P</em> (<em>n</em>) = a_{0} + a_{1}<em>n</em> + · · · + a_{m}n^{m}<em>is any polynomial of degree m or less, then we have P</em> (<em>n</em>) = <em>O</em>(n^{m}). This follows because</p>

  <div class="image"><img src="../Images/ch01/e108_01.png"></div>

  <p>when <em>n</em> ≥ 1. So we may take <em>M</em> = |a_{0}| + |a_{1}| + · · · + |a_{m}| and n_{0} = 1. Or we could take, say, <em>M</em> = |a_{0}|<em>/</em>2<sup><em>m</em></sup> + |a_{1}|<em>/</em>2<sup>m−1</sup> + · · · + |a_{m}| and n_{0} = 2.</p>

  <p class="indent">The <em>O</em>-notation is a big help in approximation work, since it describes briefly a concept that occurs often and it suppresses detailed information that is usually irrelevant. Furthermore, it can be manipulated algebraically in familiar ways, although certain important differences need to be kept in mind. The most important consideration is the idea of <em>one-way equalities</em>: We write <span class="middle"><img src="../Images/ch01/e108_02.png"></span>, but we <em>never</em> write <span class="middle"><img src="../Images/ch01/e108_03.png"></span>. (Or else, since <span class="middle"><img src="../Images/ch01/e108_04.png"></span>, we might come up with the absurd relation <span class="middle"><img src="../Images/ch01/e108_05.png"></span>.) We always use the convention that <em>the right-hand side of an equation does not give more information than the left-hand side;</em> the right-hand side is a “crudification” of the left.</p>

  <p class="indent">This convention about the use of “=” may be stated more precisely as follows: Formulas that involve the <em>O</em>(<em>f</em> (<em>n</em>))-notation may be regarded as sets of functions of <em>n</em>. The symbol <em>O</em>(<em>f</em> (<em>n</em>)) stands for the set of all functions <em>g</em> of integers such that there exist constants <em>M</em> and n_{0} with |<em>g</em>(<em>n</em>)| ≤ <em>M</em> |<em>f</em>(<em>n</em>)| for all integers <em>n</em> ≥ n_{0}. If <em>S</em> and <em>T</em> are sets of functions, then <em>S</em> + <em>T</em> denotes the set \{<em>g</em> + <em>h</em> | <em>g</em> <span class="ent">∊</span> <em>S</em> and <em>h</em> <span class="ent">∊</span> <em>T</em>\}; we define <em>S + c, S − T, S · T</em>, log <em>S</em>, etc., in a similar way. If $α(n)$ and $β(n)$ are formulas that involve the <em>O</em>-notation, then the notation <em>α</em>(<em>n</em>) = <em>β</em>(<em>n</em>) means that the set of functions denoted by $α(n)$ is <em>contained in</em> the set denoted by $β(n)$.</p>

  <p class="indent">Consequently we may perform most of the operations we are accustomed to doing with the “=” sign: If <em>α</em>(<em>n</em>) = <em>β</em>(<em>n</em>) and <em>β</em>(<em>n</em>) = <em>γ</em>(<em>n</em>), then <em>α</em>(<em>n</em>) = <em>γ</em>(<em>n</em>). Also, if <em>α</em>(<em>n</em>) = <em>β</em>(<em>n</em>) and if <em>δ</em>(<em>n</em>) is a formula resulting from the substitution of <em>β</em>(<em>n</em>) for some occurrence of <em>α</em>(<em>n</em>) in a formula <em>γ</em>(<em>n</em>), then <em>γ</em>(<em>n</em>) = <em>δ</em>(<em>n</em>). These two statements imply, for example, that if g(x_{1}, x_{2}, ..., x_{m}) is any real function whatever, and if α_{k} (n) = β_{k} (n) for 1 ≤ <em>k</em> ≤ m, then <em>g</em>(α_{1} (<em>n</em>), α_{2} (<em>n</em>), ..., α_{m} (<em>n</em>)) = <em>g</em>(β_{1} (<em>n</em>), β_{2} (<em>n</em>), ..., β_{m} (<em>n</em>)).</p>

  <p class="indent">Here are some of the simple operations we can do with the <em>O</em>-notation:</p>

  <div class="equation"><a id="ch01eq-lev3sec1-5"></a><img src="../Images/ch01/108equ01.png"></div>

  <div class="equation"><a id="ch01eq-lev3sec1-6"></a><img src="../Images/ch01/108equ02.png"></div>

  <div class="equation"><a id="ch01eq-lev3sec1-7"></a><img src="../Images/ch01/108equ03.png"></div>

  <div class="equation"><a id="ch01eq-lev3sec1-8"></a><img src="../Images/ch01/108equ04.png"></div>

  <div class="equation"><a id="ch01eq-lev3sec1-9"></a><img src="../Images/ch01/108equ05.png"></div>

  <div class="equation"><a id="ch01eq-lev3sec1-10"></a><img src="../Images/ch01/108equ06.png"></div>

  <p class="indent"><a id="page_109"></a>The <em>O</em>-notation is also frequently used with functions of a complex variable <em>z</em>, in the neighborhood of <em>z</em> = 0. We write <em>O</em>(<em>f</em> (<em>z</em>)) to stand for any quantity <em>g</em>(<em>z</em>) such that |<em>g</em>(<em>z</em>)| ≤ <em>M</em> |<em>f</em>(<em>z</em>)| whenever |<em>z</em>| &lt; <em>r</em>. (As before, <em>M</em> and <em>r</em> are unspecified constants, although we could specify them if we wanted to.) The context of <em>O</em>-notation should always identify the variable that is involved and the range of that variable. When the variable is called <em>n</em>, we implicitly assume that <em>O</em>(<em>f</em> (<em>n</em>)) refers to functions of a large integer <em>n</em>; when the variable is called <em>z</em>, we implicitly assume that <em>O</em>(<em>f</em> (<em>z</em>)) refers to functions of a small complex number <em>z</em>.</p>

  <p class="indent">Suppose that <em>g</em>(<em>z</em>) is a function given by an infinite power series</p>

  <div class="image"><img src="../Images/ch01/e109_01.png"></div>

  <p>that converges for <em>z</em> = z_{0}. Then the sum of absolute values ∑<sub><em>k</em>≥0</sub> |a<sub><em>k</em></sub> z<sup><em>k</em></sup>| also converges whenever |<em>z</em>| &lt; |z_{0} |. If z_{0} ≠ 0, we can therefore always write</p>

  <div class="equation"><a id="ch01eq-lev3sec1-11"></a><img src="../Images/ch01/109equ01.png"></div>

  <p>For we have <em>g</em>(<em>z</em>) = a_{0} + a_{1}<em>z</em> + · · · + a_{m}z^{m} + <em>z</em><sup><em>m</em> + 1</sup> (<em>a</em><sub><em>m</em> + 1</sub> + <em>a</em><sub><em>m</em> + 2</sub><em>z</em> + · · ·); we need only show that the parenthesized quantity is bounded when |<em>z</em>| ≤ <em>r</em>, for some positive <em>r</em>, and it is easy to see that |<em>a</em><sub><em>m</em> + 1</sub>| + |<em>a</em><sub><em>m</em> + 2</sub>| <em>r</em> + |<em>a</em><sub><em>m</em> + 3</sub>| r^{2} + · · · is an upper bound whenever |<em>z</em>| ≤ <em>r</em> &lt; |z_{0}|.</p>

  <p class="indent">For example, the generating functions listed in <a href="../Text/ch01a.html#ch01lev2sec9">Section 1.2.9</a> give us many important asymptotic formulas valid when <em>z</em> is sufficiently small, including</p>

  <div class="equation"><a id="ch01eq-lev3sec1-12"></a><img src="../Images/ch01/109equ02.png"></div>

  <div class="equation"><a id="ch01eq-lev3sec1-13"></a><img src="../Images/ch01/109equ03.png"></div>

  <div class="equation"><a id="ch01eq-lev3sec1-14"></a><img src="../Images/ch01/109equ04.png"></div>

  <div class="equation"><a id="ch01eq-lev3sec1-15"></a><img src="../Images/ch01/109equ05.png"></div>

  <p>for all nonnegative integers <em>m</em>. It is important to note that the hidden constants <em>M</em> and <em>r</em> implied by any particular <em>O</em> are related to each other. For example, the function <em>e<sup><em>z</em></sup></em> is obviously <em>O</em>(1) when |<em>z</em>| ≤ <em>r</em>, for any fixed <em>r</em>, since |e^{z} | ≤ <em>e</em><sup>|<em>z</em>|</sup>; but there is no constant <em>M</em> such that |e<sup><em>z</em></sup> | ≤ <em>M</em> for all values of <em>z</em>. Therefore we need to use larger and larger bounds <em>M</em> as the range <em>r</em> increases.</p>

  <p class="indent">Sometimes an asymptotic series is correct although it does not correspond to a convergent infinite series. For example, the basic formulas that express factorial powers in terms of ordinary powers,</p>

  <div class="equation"><a id="ch01eq-lev3sec1-16"></a><img src="../Images/ch01/109equ06.png"></div>

  <div class="equation"><a id="ch01eq-lev3sec1-17"></a><img src="../Images/ch01/109equ07.png"></div>

  <p><a id="page_110"></a>are asymptotically valid for any real <em>r</em> and any fixed integer <em>m</em> ≥ 0, yet the sum</p>

  <div class="image"><img src="../Images/ch01/e110_01.png"></div>

  <p>diverges for all <em>n</em>. (See <a href="../Text/ch01b.html#ch01ex_3_1_12">exercise 12</a>.) Of course, when <em>r</em> is a nonnegative integer, <span class="middle"><img src="../Images/ch01/e110_02.png"></span> and <span class="middle"><img src="../Images/ch01/e110_03.png"></span> are simply polynomials of degree <em>r</em>, and (<a href="../Text/ch01a.html#ch01eq-lev3sec1-17">17</a>) is essentially the same as <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec6-44">44</a>). When <em>r</em> is a negative integer and |<em>n</em>| &gt; |<em>r</em>|, the infinite sum <span class="middle"><img src="../Images/ch01/e110_04.png"></span> does converge to <span class="middle"><img src="../Images/ch01/e110_05.png"></span>; this sum can also be written in the more natural form <span class="middle"><img src="../Images/ch01/e110_06.png"></span>, using Eq. <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec6-58">58</a>).</p>

  <p class="indent">Let us give one simple example of the concepts we have introduced so far. Consider the quantity <span class="middle"><img src="../Images/ch01/n-rootn.png"></span>; as <em>n</em> gets large, the operation of taking an <em>n</em>th root tends to decrease the value, but it is not immediately obvious whether <span class="middle"><img src="../Images/ch01/n-rootn.png"></span> decreases or increases. It turns out that <span class="middle"><img src="../Images/ch01/n-rootn.png"></span> decreases to unity. Let us consider the slightly more complicated quantity <span class="middle"><img src="../Images/ch01/e110_07.png"></span>. Now <span class="middle"><img src="../Images/ch01/e110_08.png"></span> gets smaller as <em>n</em> gets bigger; what happens to <span class="middle"><img src="../Images/ch01/e110_09.png"></span></p>

  <p class="indent">This problem is easily solved by applying the formulas above. We have</p>

  <div class="equation"><a id="ch01eq-lev3sec1-18"></a><img src="../Images/ch01/110equ01.png"></div>

  <p>because ln <em>n/n</em> → 0 as <em>n</em> → ∞; see <a href="../Text/ch01b.html#ch01ex_3_1_8">exercises 8</a> and <a href="../Text/ch01b.html#ch01ex_3_1_11">11</a>. This equation proves our previous contention that <span class="middle"><img src="../Images/ch01/e110_10.png"></span> → 1. Furthermore, it tells us that</p>

  <div class="equation"><a id="ch01eq-lev3sec1-19"></a><img src="../Images/ch01/110equ02.png"></div>

  <p>In other words, <span class="middle"><img src="../Images/ch01/e110_11.png"></span> is approximately equal to ln <em>n</em>; the difference is <em>O</em>((ln <em>n</em>)<sup>2</sup>/<em>n</em>), which approaches zero as n approaches infinity.</p>

  <p class="indent">People often abuse <em>O</em>-notation by assuming that it gives an exact order of growth; they use it as if it specifies a lower bound as well as an upper bound. For example, an algorithm to sort <em>n</em> numbers might be called inefficient “because its running time is <em>O</em>(n^{2}).” But a running time of <em>O</em>(n^{2}) does not necessarily imply that the running time is not also <em>O</em>(<em>n</em>). There’s another notation, Big Omega, for lower bounds: The statement</p>

  <div class="equation"><a id="ch01eq-lev3sec1-20"></a><img src="../Images/ch01/110equ03.png"></div>

  <p>means that there are positive constants <em>L</em> and n_{0} such that</p>

  <p class="center">|<em>g</em>(<em>n</em>)| ≥ <em>L</em>|<em>f</em> (<em>n</em>)| for all <em>n</em> ≥ n_{0}.</p>

  <p>Using this notation we can correctly conclude that a sorting algorithm whose running time is <em>Ω</em>(n^{2}) will not be as efficient as one whose running time is <em>O</em>(<em>n</em> log <em>n</em>), if <em>n</em> is large enough. However, without knowing the constant factors implied by <em>O</em> and <em>Ω</em>, we cannot say anything about how large <em>n</em> must be before the <em>O</em>(<em>n</em> log <em>n</em>) method will begin to win.</p>

  <p class="indent">Finally, if we want to state an exact order of growth without being precise about constant factors, we can use Big Theta:</p>

  <div class="equation"><a id="ch01eq-lev3sec1-21"></a><img src="../Images/ch01/110equ04.png"></div>
</body>
</html>