<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      extensions: ["tex2jax.js"],
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        inlineMath: [["$","$"]],
        displayMath: [["$$","$$"]],
        processEscapes: true
      },
      "HTML-CSS": { availableFonts: ["TeX"] }
    });
  </script>
  <script src="MathJax-2.4-latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

  <title></title>
  <link href="../Styles/caps.css" rel="stylesheet" type="text/css">
</head>

<body>
  <p class="ex-title"><a id="page_111"></a>Exercises</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_3_1_1a" id="ch01ex_3_1_1">1</a>.</strong> [<em>HM01</em>] What is lim<sub><em>n</em>→∞</sub><em>O</em>(<em>n</em><sup>− 1<em>/</em>3</sup>)?</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_1_2a" id="ch01ex_3_1_2">2</a>.</strong> [<em>M10</em>] Mr. B. C. Dull obtained astonishing results by using the “self-evident” formula <em>O</em>(<em>f</em> (<em>n</em>)) − <em>O</em>(<em>f</em> (<em>n</em>)) = 0. What was his mistake, and what should the righthand side of his formula have been?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_3_1_3a" id="ch01ex_3_1_3">3</a>.</strong> [<em>M15</em>] Multiply (ln <em>n</em> + <em>γ</em> + <em>O</em>(1<em>/n</em>)) by <span class="middle"><img src="../Images/ch01/e111_01.jpg"></span>, and express your answer in <em>O</em>-notation.</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_1_4a" id="ch01ex_3_1_4">4</a>.</strong> [<em>M15</em>] Give an asymptotic expansion of <span class="middle"><img src="../Images/ch01/e111_02.jpg"></span>, if <em>a</em> &gt; 0, to terms <em>O</em>(1<em>/n</em><sup>3</sup>).</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_3_1_5a" id="ch01ex_3_1_5">5</a>.</strong> [<em>M20</em>] Prove or disprove: <em>O</em>(<em>f</em> (<em>n</em>) + <em>g</em>(<em>n</em>)) = <em>f</em> (<em>n</em>) + <em>O</em>(<em>g</em>(<em>n</em>)), if <em>f</em> (<em>n</em>) and <em>g</em>(<em>n</em>) are positive for all <em>n</em>. (Compare with (<a href="../Text/ch01a.html#ch01eq-lev3sec1-10">10</a>).)</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_1_6a" id="ch01ex_3_1_6">6</a>.</strong> [<em>M20</em>] What is wrong with the following argument? “Since <em>n</em> = <em>O</em>(<em>n</em>), and 2<em>n</em> = <em>O</em>(<em>n</em>), ..., we have</p>

  <div class="image"><img src="../Images/ch01/e111_03.jpg"></div>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_3_1_7a" id="ch01ex_3_1_7">7</a>.</strong> [<em>HM15</em>] Prove that if <em>m</em> is any integer, there is no <em>M</em> such that <em>e</em><sup><em>x</em></sup> ≤ <em>Mx</em><sup><em>m</em></sup> for arbitrarily large values of <em>x</em>.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_3_1_8a" id="ch01ex_3_1_8">8</a>.</strong> [<em>HM20</em>] Prove that as <em>n</em> → ∞, (ln <em>n</em>)<sup><em>m</em></sup><em>/n</em> → 0.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_3_1_9a" id="ch01ex_3_1_9">9</a>.</strong> [<em>HM20</em>] Show that <em>e</em><sup><em>O</em>(<em>z</em><sup><em>m</em></sup>)</sup> = 1 + <em>O</em>(<em>z</em><sup><em>m</em></sup>), for all fixed <em>m</em> ≥ 0.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_3_1_10a" id="ch01ex_3_1_10">10</a>.</strong> [<em>HM22</em>] Make a statement similar to that in <a href="../Text/ch01b.html#ch01ex_3_1_9">exercise 9</a> about ln(1 + <em>O</em>(<em>z</em><sup><em>m</em></sup>)).</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_1_11a" id="ch01ex_3_1_11">11</a>.</strong> [<em>M11</em>] Explain why Eq. (<a href="../Text/ch01a.html#ch01eq-lev3sec1-18">18</a>) is true.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_3_1_12a" id="ch01ex_3_1_12">12</a>.</strong> [<em>HM25</em>] Prove that <span class="middle"><img src="../Images/ch01/e111_04.jpg"></span> does not approach zero as <em>k</em> → ∞ for any integer <em>n</em>, using the fact that <span class="middle"><img src="../Images/ch01/e111_05.jpg"></span>.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_1_13a" id="ch01ex_3_1_13">13</a>.</strong> [<em>M10</em>] Prove or disprove: <em>g</em>(<em>n</em>) = Ω(<em>f</em> (<em>n</em>)) if and only if <em>f</em> (<em>n</em>) = <em>O</em>(<em>g</em>(<em>n</em>)).</p>

  <div class="heading">
    <h5 id="ch01lev3sec2">*1.2.11.2. Euler’s summation formula</h5>

    <p class="noindent">One of the most useful ways to obtain good approximations to a sum is an approach due to Leonhard Euler. His method approximates a finite sum by an integral, and gives us a means to get better and better approximations in many cases. [<em>Commentarii Academiæ Scientiarum Imperialis Petropolitan</em>æ <strong>6</strong> (1732), 68–97.]</p>
  </div>

  <p class="indent"><a href="../Text/ch01b.html#ch01fig12">Figure 12</a> shows a comparison of <span class="middle"><img src="../Images/ch01/e111_06.jpg"></span> and <span class="middle"><img src="../Images/ch01/e111_07.jpg"></span>, when <em>n</em> = 7. Euler’s strategy leads to a useful formula for the difference between these two quantities, assuming that <em>f</em> (<em>x</em>) is a differentiable function.</p>

  <div class="image">
    <a id="ch01fig12"></a><img src="../Images/ch01/01fig12.jpg">

    <p class="fig-caption"><strong>Fig. 12.</strong> Comparing a sum with an integral.</p>
  </div>

  <p class="indent"><a id="page_112"></a>For convenience we shall use the notation</p>

  <div class="equation"><a id="ch01eq-lev3sec2-1"></a><img src="../Images/ch01/112equ01.jpg"></div>

  <p class="noindent">Our derivation starts with the following identity:</p>

  <div class="equation"><a id="ch01eq-lev3sec2-2"></a><img src="../Images/ch01/112equ02.jpg"></div>

  <p class="noindent">(This follows from integration by parts.) Adding both sides of this equation for 1 ≤ <em>k &lt; n</em>, we find that</p>

  <div class="image"><img src="../Images/ch01/e112_00.jpg"></div>

  <p class="noindent">that is,</p>

  <div class="equation"><a id="ch01eq-lev3sec2-3"></a><img src="../Images/ch01/112equ03.jpg"></div>

  <p class="noindent">where <em>B</em><sub>1</sub>(<em>x</em>) is the polynomial <span class="middle"><img src="../Images/ch01/e112_01.jpg"></span>. This is the desired connection between the sum and the integral.</p>

  <p class="indent">The approximation can be carried further if we continue to integrate by parts. Before doing this, however, we shall discuss the <em>Bernoulli numbers</em>, which are the coefficients in the following infinite series:</p>

  <div class="equation"><a id="ch01eq-lev3sec2-4"></a><img src="../Images/ch01/112equ04.jpg"></div>

  <p class="noindent">The coefficients of this series, which occur in a wide variety of problems, were introduced to European mathematicians in James Bernoulli’s <em>Ars Conjectandi</em>, published posthumously in 1713. Curiously, they were also discovered at about the same time by Takakazu Seki in Japan — and first published in 1712, shortly after <em>his</em> death. [See <em>Takakazu Seki’s Collected Works</em> (Osaka: 1974), 39–42.]</p>

  <p class="indent">We have</p>

  <div class="equation"><a id="ch01eq-lev3sec2-5"></a><img src="../Images/ch01/112equ05.jpg"></div>

  <p class="noindent">further values appear in <a href="../Text/app02.html#app02">Appendix A</a>. Since</p>

  <div class="image"><img src="../Images/ch01/e112_02.jpg"></div>

  <p class="noindent">is an even function, we see that</p>

  <div class="equation"><a id="ch01eq-lev3sec2-6"></a><img src="../Images/ch01/112equ06.jpg"></div>

  <p class="indent"><a id="page_113"></a>If we multiply both sides of the defining equation (<a href="../Text/ch01b.html#ch01eq-lev3sec2-4">4</a>) by <em>e</em><sup><em>z</em></sup> − 1, and equate coefficients of equal powers of <em>z</em>, we obtain the formula</p>

  <div class="equation"><a id="ch01eq-lev3sec2-7"></a><img src="../Images/ch01/113equ01.jpg"></div>

  <p class="noindent">(See <a href="../Text/ch01b.html#ch01ex_3_2_1">exercise 1</a>.) We now define the <em>Bernoulli polynomial</em></p>

  <div class="equation"><a id="ch01eq-lev3sec2-8"></a><img src="../Images/ch01/113equ02.jpg"></div>

  <p class="noindent">If <em>m</em> = 1, then <span class="middle"><img src="../Images/ch01/e113_01.jpg"></span>, corresponding to the polynomial used above in Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec2-3">3</a>). If <em>m</em> &gt; 1, we have <em>B</em><sub><em>m</em></sub>(1) = <em>B</em><sub><em>m</em></sub> = <em>B</em><sub><em>m</em></sub>(0), by (<a href="../Text/ch01b.html#ch01eq-lev3sec2-7">7</a>); in other words, <em>B</em><sub><em>m</em></sub>({<em>x</em>}) has no discontinuities at integer points <em>x</em>.</p>

  <p class="indent">The relevance of Bernoulli polynomials and Bernoulli numbers to our problem will soon be clear. We find by differentiating Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec2-8">8</a>) that</p>

  <div class="equation"><a id="ch01eq-lev3sec2-9"></a><img src="../Images/ch01/113equ03.jpg"></div>

  <p class="noindent">and therefore when <em>m</em> ≥ 1, we can integrate by parts as follows:</p>

  <div class="image"><img src="../Images/ch01/e113_02.jpg"></div>

  <p class="noindent">From this result we can continue to improve the approximation, Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec2-3">3</a>), and we obtain Euler’s general formula:</p>

  <div class="equation"><a id="ch01eq-lev3sec2-10"></a><img src="../Images/ch01/113equ04.jpg"></div>

  <p class="noindent">using (<a href="../Text/ch01b.html#ch01eq-lev3sec2-6">6</a>), where</p>

  <div class="equation"><a id="ch01eq-lev3sec2-11"></a><img src="../Images/ch01/113equ05.jpg"></div>

  <p class="noindent">The remainder <em>R</em><sub><em>mn</em></sub> will be small when <em>B</em><sub><em>m</em></sub>({<em>x</em>})<em>f</em><sup>(<em>m</em>)</sup>(<em>x</em>)<em>/m</em>! is very small, and in fact, one can show that</p>

  <div class="equation"><a id="ch01eq-lev3sec2-12"></a><img src="../Images/ch01/113equ06.jpg"></div>

  <p class="noindent"><a id="page_114"></a>when <em>m</em> is even. [See <em>CMath</em>, §9.5.] On the other hand, it usually turns out that the magnitude of <em>f</em><sup>(<em>m</em>)</sup>(<em>x</em>) gets large as <em>m</em> increases, so there is a “best” value of <em>m</em> at which |<em>R</em><sub><em>mn</em></sub> | has its least value when <em>n</em> is given.</p>

  <p class="indent">It is known that, when <em>m</em> is even, there is a number <em>θ</em> such that</p>

  <div class="equation"><a id="ch01eq-lev3sec2-13"></a><img src="../Images/ch01/114equ01.jpg"></div>

  <p class="noindent"><em>provided that f</em> <sup>(<em>m</em>+2)</sup> (<em>x</em>) <em>f</em><sup>(<em>m</em>+4)</sup>(<em>x</em>) &gt; 0 for 1 &lt; <em>x</em> &lt; <em>n</em>. So in these circumstances the remainder has the same sign as, and is less in absolute value than, the first discarded term. A simpler version of this result is proved in <a href="../Text/ch01b.html#ch01ex_3_2_3">exercise 3</a>.</p>

  <p class="indent">Let us now apply Euler’s formula to some important examples. First, we set <em>f</em>(<em>x</em>) = 1<em>/x</em>. The derivatives are <em>f</em><sup>(<em>m</em>)</sup>(<em>x</em>) = (−1)<sup><em>m</em></sup><em>m</em>!<em>/x</em><sup><em>m</em>+1</sup>, so we have, by Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec2-10">10</a>),</p>

  <div class="equation"><a id="ch01eq-lev3sec2-14"></a><img src="../Images/ch01/114equ02.jpg"></div>

  <p class="noindent">Now we find</p>

  <div class="equation"><a id="ch01eq-lev3sec2-15"></a><img src="../Images/ch01/114equ03.jpg"></div>

  <p class="noindent">The fact that <span class="middle"><img src="../Images/ch01/e114_01.jpg"></span> exists proves that the constant <em>γ</em> does in fact exist. We can therefore put Eqs. (<a href="../Text/ch01b.html#ch01eq-lev3sec2-14">14</a>) and (<a href="../Text/ch01b.html#ch01eq-lev3sec2-15">15</a>) together, to deduce a general approximation for the harmonic numbers:</p>

  <div class="image"><img src="../Images/ch01/e114_02.jpg"></div>

  <p class="noindent">Replacing <em>m</em> by <em>m</em> + 1 yields</p>

  <div class="equation"><a id="ch01eq-lev3sec2-16"></a><img src="../Images/ch01/114equ04.jpg"></div>

  <p class="noindent">Furthermore, by Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec2-13">13</a>) we see that the error is less than the first term discarded. As a particular case we have (adding 1<em>/n</em> to both sides)</p>

  <div class="image"><img src="../Images/ch01/e114_03.jpg"></div>

  <p class="noindent">This is Eq. <a href="../Text/ch01a.html#ch01lev2sec7">1.2.7</a>–(<a href="../Text/ch01a.html#ch01eq-lev2sec7-3">3</a>). The Bernoulli numbers <em>B</em><sub><em>k</em></sub> for large <em>k</em> get very large (approximately (−1)<sup>1+<em>k</em>/2</sup>2(<em>k</em>!<em>/</em>(2<em>π</em>)<sup><em>k</em></sup>) when <em>k</em> is even), so Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec2-16">16</a>) cannot be extended to a convergent infinite series for any fixed value of <em>n</em>.</p>

  <p class="indent"><a id="page_115"></a>The same technique can be applied to deduce Stirling’s approximation. This time we set <em>f</em>(<em>x</em>) = ln <em>x</em>, and Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec2-10">10</a>) yields</p>

  <div class="equation"><a id="ch01eq-lev3sec2-17"></a><img src="../Images/ch01/115equ01.jpg"></div>

  <p class="noindent">Proceeding as above, we find that the limit</p>

  <div class="image"><img src="../Images/ch01/e115_01.jpg"></div>

  <p class="noindent">exists; let it be called σ (“Stirling’s constant”) temporarily. We get Stirling’s result</p>

  <div class="equation"><a id="ch01eq-lev3sec2-18"></a><img src="../Images/ch01/115equ02.jpg"></div>

  <p class="noindent">In particular, let <em>m</em> = 5; we have</p>

  <div class="image"><img src="../Images/ch01/e115_02.jpg"></div>

  <p class="noindent">Now we can take the exponential of both sides:</p>

  <div class="image"><img src="../Images/ch01/e115_03.jpg"></div>

  <p class="noindent">Using the fact that <span class="middle"><img src="../Images/ch01/e115_04.jpg"></span> (see <a href="../Text/ch01b.html#ch01ex_3_2_5">exercise 5</a>), and expanding the exponential, we get our final result:</p>

  <div class="equation"><a id="ch01eq-lev3sec2-19"></a><img src="../Images/ch01/115equ03.jpg"></div>

  <p class="ex-title">Exercises</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_3_2_1a" id="ch01ex_3_2_1">1</a>.</strong> [<em>M18</em>] Prove Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec2-7">7</a>).</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_3_2_2a" id="ch01ex_3_2_2">2</a>.</strong> [<em>HM20</em>] Note that Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec2-9">9</a>) follows from Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec2-8">8</a>) for <em>any</em> sequence <em>B</em><sub><em>n</em></sub>, not only for the sequence defined by Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec2-4">4</a>). Explain why the latter sequence is necessary for the validity of Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec2-10">10</a>).</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_3_2_3a" id="ch01ex_3_2_3">3</a>.</strong> [<em>HM20</em>] Let <em>C</em><sub><em>mn</em></sub> = (<em>B</em><sub><em>m</em></sub><em>/m</em>!)(<em>f</em><sup>(<em>m</em>−1)</sup>(<em>n</em>) − <em>f</em><sup>(<em>m</em>−1)</sup>(1)) be the <em>m</em>th correction term in Euler’s summation formula. Assuming that <em>f</em><sup>(<em>m</em>)</sup>(<em>x</em>) has a constant sign for all <em>x</em> in the range 1 ≤ <em>x</em> ≤ <em>n</em>, prove that |<em>R</em><sub><em>mn</em></sub> | ≤ |<em>C<sub>mn</sub></em> | when <em>m</em> = 2<em>k</em> &gt; 0; in other words, show that the remainder is not larger in absolute value than the last term computed.</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_2_4a" id="ch01ex_3_2_4">4</a>.</strong> [<em>HM20</em>] (<em>Sums of powers.</em>) When <em>f</em>(<em>x</em>) = <em>x</em><sup><em>m</em></sup>, the high-order derivatives of <em>f</em> are all zero, so Euler’s summation formula gives an <em>exact</em> value for the sum</p>

  <div class="image"><img src="../Images/ch01/e115_05.jpg"></div>

  <p class="exercisesp">in terms of Bernoulli numbers. (It was the study of <em>S</em><sub><em>m</em></sub> (<em>n</em>) for <em>m</em> = 1, 2, 3, ... that led Bernoulli and Seki to discover those numbers in the first place.) Express <em>S</em><sub><em>m</em></sub> (<em>n</em>) in terms of Bernoulli <em>polynomials</em>. Check your answer for <em>m</em> = 0, 1, and 2. (Note that the desired sum is performed for 0 ≤ <em>k</em> &lt; <em>n</em> instead of 1 ≤ <em>k</em> &lt; <em>n</em>; Euler’s summation formula may be applied with 0 replacing 1 throughout.)</p>

  <p class="exercises"><a id="page_116"></a><strong><a href="../Text/app01.html#ch01ex_3_2_5a" id="ch01ex_3_2_5">5</a>.</strong> [<em>HM30</em>] Given that</p>

  <div class="image"><img src="../Images/ch01/e116_01.jpg"></div>

  <p class="exercisesp">show that <span class="middle"><img src="../Images/ch01/e116_02.jpg"></span> by using Wallis’s product (exercise <a href="../Text/ch01.html#ch01lev2sec5">1.2.5</a>–<a href="../Text/ch01a.html#ch01ex_2_5_18">18</a>). [<em>Hint:</em> Consider <span class="middle"><img src="../Images/ch01/e116_03.jpg"></span> for large values of <em>n</em>.]</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_2_6a" id="ch01ex_3_2_6">6</a>.</strong> [<em>HM30</em>] Show that Stirling’s approximation holds for noninteger <em>n</em> as well:</p>

  <div class="image"><img src="../Images/ch01/e116_04.jpg"></div>

  <p class="exercisesp">[<em>Hint:</em> Let <em>f</em>(<em>x</em>) = ln(<em>x</em> + <em>c</em>) in Euler’s summation formula, and apply the definition of Γ(<em>x</em>) given in <a href="../Text/ch01.html#ch01lev2sec5">Section 1.2.5</a>.]</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_2_7a" id="ch01ex_3_2_7">7</a>.</strong> [<em>HM32</em>] What is the approximate value of 1<sup>1</sup> 2<sup>2</sup> 3<sup>3</sup><em>... n</em><sup><em>n</em></sup>?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_3_2_8a" id="ch01ex_3_2_8">8</a>.</strong> [<em>M23</em>] Find the asymptotic value of ln (<em>an</em><sup>2</sup>+ <em>bn</em>)! with absolute error <em>O</em>(<em>n</em><sup>−2</sup>). Use it to compute the asymptotic value of <span class="middle"><img src="../Images/ch01/e116_05.jpg"></span> with relative error <em>O</em>(<em>n</em><sup>−2</sup>), when <em>c</em> is a positive constant. Here <em>absolute error</em> <span class="roman_italic"><span class="ent">∊</span></span> means that (truth) = (approximation)+<span class="ent">∊</span>; <em>relative error</em> <span class="roman_italic"><span class="ent">∊</span></span> means that (truth) = (approximation)(1 + <span class="roman_italic"><span class="ent">∊</span></span>).</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_2_9a" id="ch01ex_3_2_9">9</a>.</strong> [<em>M25</em>] Find the asymptotic value of <span class="middle"><img src="../Images/ch01/e116_06.jpg"></span> with a relative error of <em>O</em>(<em>n</em><sup>−3</sup>), in two ways: (a) via Stirling’s approximation; (b) via exercise <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>–<a href="../Text/ch01a.html#ch01ex_2_6_2">2</a> and Eq. <a href="../Text/ch01a.html#ch01lev3sec1">1.2.11.1</a>–(<a href="../Text/ch01b.html#ch01eq-lev3sec2-16">16</a>).</p>

  <div class="heading">
    <h5 id="ch01lev3sec3">*1.2.11.3. Some asymptotic calculations</h5>

    <p class="noindent">In this subsection we shall investigate the following three intriguing sums, in order to deduce their approximate values:</p>
  </div>

  <div class="equation"><a id="ch01eq-lev3sec3-1"></a><img src="../Images/ch01/116equ01.jpg"></div>

  <div class="equation"><a id="ch01eq-lev3sec3-2"></a><img src="../Images/ch01/116equ02.jpg"></div>

  <div class="equation"><a id="ch01eq-lev3sec3-3"></a><img src="../Images/ch01/116equ03.jpg"></div>

  <p class="noindent">These functions, which are similar in appearance yet intrinsically different, arise in several algorithms that we shall encounter later. Both <em>P</em>(<em>n</em>) and <em>Q</em>(<em>n</em>) are finite sums, while <em>R</em>(<em>n</em>) is an infinite sum. It seems that when <em>n</em> is large, all three sums will be nearly equal, although it is not obvious what the approximate value of <em>any</em> of them will be. Our quest for approximate values of these functions will lead us through a number of very instructive side results. (You may wish to stop reading temporarily and try your hand at studying these functions before going on to see how they are attacked here.)</p>

  <p class="indent">First, we observe an important connection between <em>Q</em>(<em>n</em>) and <em>R</em>(<em>n</em>):</p>

  <div class="equation"><a id="ch01eq-lev3sec3-4"></a><img src="../Images/ch01/116equ04.jpg"></div>

  <p class="noindent"><a id="page_117"></a>Stirling’s formula tells us that <em>n</em>! <em>e</em><sup><em>n</em></sup><em>/n</em><sup><em>n</em></sup> is approximately <span class="middle"><img src="../Images/ch01/e117_01.jpg"></span>, so we can guess that <em>Q</em>(<em>n</em>) and <em>R</em>(<em>n</em>) will each turn out to be roughly equal to <span class="middle"><img src="../Images/ch01/e117_02.jpg"></span>.</p>

  <p class="indent">To get any further we must consider the partial sums of the series for <em>e</em><sup><em>n</em></sup>. By using Taylor’s formula with remainder,</p>

  <div class="equation"><a id="ch01eq-lev3sec3-5"></a><img src="../Images/ch01/117equ01.jpg"></div>

  <p class="noindent">we are soon led to an important function known as the <em>incomplete gamma function:</em></p>

  <div class="equation"><a id="ch01eq-lev3sec3-6"></a><img src="../Images/ch01/117equ02.jpg"></div>

  <p class="noindent">We shall assume that <em>a</em> &gt; 0. By exercise <a href="../Text/ch01.html#ch01lev2sec5">1.2.5</a>–<a href="../Text/ch01a.html#ch01ex_2_5_20">20</a>, we have <em>γ</em>(<em>a,</em> ∞) = <em>Γ</em> (<em>a</em>); this accounts for the name “incomplete gamma function.” It has two useful series expansions in powers of <em>x</em> (see <a href="../Text/ch01b.html#ch01ex_3_3_2">exercises 2</a> and <a href="../Text/ch01b.html#ch01ex_3_3_3">3</a>):</p>

  <div class="equation"><a id="ch01eq-lev3sec3-7"></a><img src="../Images/ch01/117equ03.jpg"></div>

  <div class="equation"><a id="ch01eq-lev3sec3-8"></a><img src="../Images/ch01/117equ04.jpg"></div>

  <p class="noindent">From the second formula we see the connection with <em>R</em>(<em>n</em>):</p>

  <div class="equation"><a id="ch01eq-lev3sec3-9"></a><img src="../Images/ch01/117equ05.jpg"></div>

  <p class="noindent">This equation has purposely been written in a more complicated form than necessary, since <em>γ</em>(<em>n</em>, <em>n</em>) is a fraction of <em>γ</em>(<em>n</em>, ∞) = <em>Γ</em> (<em>n</em>) = (<em>n</em> − 1)!, and <em>n</em>! e<sup><em>n</em></sup>/<em>n</em><sup><em>n</em></sup> is the quantity in (<a href="../Text/ch01b.html#ch01eq-lev3sec3-4">4</a>).</p>

  <p class="indent">The problem boils down to getting good estimates of <em>γ</em>(<em>n, n</em>)<em>/</em>(<em>n</em> − 1)!. We shall now determine the approximate value of <em>γ</em>(<em>x</em> + 1<em>, x</em> + <em>y</em>)<em>/</em><em>Γ</em> (<em>x</em> + 1), when <em>y</em> is fixed and <em>x</em> is large. The methods to be used here are more important than the results, so the reader should study the following derivation carefully.</p>

  <p class="indent">By definition, we have</p>

  <div class="equation"><a id="ch01eq-lev3sec3-10"></a><img src="../Images/ch01/117equ06.jpg"></div>

  <p class="noindent">Let us set</p>

  <div class="image"><img src="../Images/ch01/e117_03.jpg"></div>

  <p class="noindent">and consider each integral in turn.</p>

  <p class="noindent"><a id="page_118"></a><em>Estimate of I</em><sub>1</sub>: We convert <em>I</em><sub>1</sub> to an integral from 0 to infinity by substituting <em>t</em> = <em>x</em>(1 + <em>u</em>); we further substitute <em>υ</em> = <em>u</em> − ln(1 + <em>u</em>), <em>dv</em> = (1 − 1<em>/</em>(1 + <em>u</em>)) <em>du</em>, which is legitimate since <em>υ</em> is a monotone function of <em>u</em>:</p>

  <div class="equation"><a id="ch01eq-lev3sec3-11"></a><img src="../Images/ch01/118equ01.jpg"></div>

  <p class="noindent">In the last integral we will replace 1 + 1<em>/u</em> by a power series in <em>υ</em>. We have</p>

  <div class="image"><img src="../Images/ch01/e118_01.jpg"></div>

  <p class="noindent">Setting <span class="middle"><img src="../Images/ch01/e118_02.jpg"></span>, we have therefore</p>

  <div class="image"><img src="../Images/ch01/e118_03.jpg"></div>

  <p class="noindent">(This expansion may be obtained by the binomial theorem; efficient methods for performing such transformations, and for doing the other power series manipulations needed below, are considered in Section 4.7.) We can now solve for <em>u</em> as a power series in <em>w</em>:</p>

  <div class="equation"><a id="ch01eq-lev3sec3-12"></a><img src="../Images/ch01/118equ02.jpg"></div>

  <p class="indent">In all of these formulas, the <em>O</em>-notation refers to small values of the argument, that is, |<em>u</em>| ≤ <em>r</em>, |<em>υ</em>| ≤ <em>r</em>, |<em>w</em>| ≤ <em>r</em> for sufficiently small positive <em>r</em>. Is this good enough? The substitution of 1 + 1<em>/u</em> in terms of <em>υ</em> in Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec3-11">11</a>) is supposed to be valid for 0 ≤ <em>υ</em> &lt; ∞, not only for |<em>υ</em>| ≤ <em>r</em>. Fortunately, it turns out that the value of the integral from 0 to ∞ depends almost entirely on the values of the integrand near zero. In fact, we have (see <a href="../Text/ch01b.html#ch01ex_3_3_4">exercise 4</a>)</p>

  <div class="equation"><a id="ch01eq-lev3sec3-13"></a><img src="../Images/ch01/118equ03.jpg"></div>

  <p class="noindent">for any fixed <em>r</em> &gt; 0 and for large <em>x</em>. We are interested in an approximation up to terms <em>O</em>(<em>x</em><sup>−m</sup>), and since <em>O</em>((1<em>/e</em><sup><em>r</em></sup>) <sup><em>x</em></sup>) is much smaller than <em>O</em>(<em>x</em><sup>−<em>m</em></sup>) for any positive <em>r</em> and <em>m</em>, we need integrate only from 0 to <em>r</em>, for any fixed positive <em>r</em>. We therefore take <em>r</em> to be small enough so that all the power series manipulations done above are justified (see Eqs. <a href="../Text/ch01a.html#ch01lev3sec1">1.2.11.1</a>–(<a href="../Text/ch01a.html#ch01eq-lev3sec1-11">11</a>) and <a href="../Text/ch01b.html#ch01lev3sec3">1.2.11.3</a>–(<a href="../Text/ch01b.html#ch01eq-lev3sec3-13">13</a>)).</p>

  <p class="indent">Now</p>

  <div class="equation"><a id="ch01eq-lev3sec3-14"></a><img src="../Images/ch01/118equ04.jpg"></div>

  <p class="noindent">so by plugging the series (<a href="../Text/ch01b.html#ch01eq-lev3sec3-12">12</a>) into the integral (<a href="../Text/ch01b.html#ch01eq-lev3sec3-11">11</a>) we have finally</p>

  <div class="equation"><a id="ch01eq-lev3sec3-15"></a><img src="../Images/ch01/118equ05.jpg"></div>

  <p class="noindent"><a id="page_119"></a><em>Estimate of I</em><sub>2</sub>: In the integral <em>I</em><sub>2</sub>, we substitute <em>t</em> = <em>u</em> + <em>x</em> and obtain</p>

  <div class="equation"><a id="ch01eq-lev3sec3-16"></a><img src="../Images/ch01/119equ01.jpg"></div>

  <p class="noindent">Now</p>

  <div class="image"><img src="../Images/ch01/e119_01.jpg"></div>

  <p class="noindent">for 0 ≤ <em>u</em> ≤ <em>y</em> and large <em>x</em>. Therefore we find that</p>

  <div class="equation"><a id="ch01eq-lev3sec3-17"></a><img src="../Images/ch01/119equ02.jpg"></div>

  <p class="indent">Finally, we analyze the coefficient <em>e</em><sup>−<em>x</em></sup><em>x</em><sup><em>x</em></sup><em>/</em><em>Γ</em> (<em>x</em> + 1) that appears when we multiply Eqs. (<a href="../Text/ch01b.html#ch01eq-lev3sec3-15">15</a>) and (<a href="../Text/ch01b.html#ch01eq-lev3sec3-17">17</a>) by the factor 1<em>/</em><em>Γ</em> (<em>x</em> + 1) in (<a href="../Text/ch01b.html#ch01eq-lev3sec3-10">10</a>). By Stirling’s approximation, which is valid for the gamma function by exercise <a href="../Text/ch01b.html#ch01lev3sec2">1.2.11.2</a>–<a href="../Text/ch01b.html#ch01ex_3_2_6">6</a>, we have</p>

  <div class="equation"><a id="ch01eq-lev3sec3-18"></a><img src="../Images/ch01/119equ03.jpg"></div>

  <p class="noindent">And now the grand summing up: Equations (<a href="../Text/ch01b.html#ch01eq-lev3sec3-10">10</a>), (<a href="../Text/ch01b.html#ch01eq-lev3sec3-15">15</a>), (<a href="../Text/ch01b.html#ch01eq-lev3sec3-17">17</a>), and (<a href="../Text/ch01b.html#ch01eq-lev3sec3-18">18</a>) yield</p>

  <p class="noindent"><a id="theo_a"></a><strong>Theorem A.</strong> <em>For large values of x, and fixed y,</em></p>

  <div class="equation"><a id="ch01eq-lev3sec3-19"></a><img src="../Images/ch01/119equ04.jpg"></div>

  <p class="noindent">The method we have used shows how this approximation could be extended to further powers of <em>x</em> as far as we please.</p>

  <p class="indent"><a href="../Text/ch01b.html#theo_a">Theorem A</a> can be used to obtain the approximate values of <em>R</em>(<em>n</em>) and <em>Q</em>(<em>n</em>), by using Eqs. (<a href="../Text/ch01b.html#ch01eq-lev3sec3-4">4</a>) and (<a href="../Text/ch01b.html#ch01eq-lev3sec3-9">9</a>), but we shall defer that calculation until later. Let us now turn to <em>P</em> (<em>n</em>), for which somewhat different methods seem to be required. We have</p>

  <div class="equation"><a id="ch01eq-lev3sec3-20"></a><img src="../Images/ch01/119equ05.jpg"></div>

  <p class="noindent">Thus to get the values of <em>P</em>(<em>n</em>), we must study sums of the form</p>

  <div class="image"><img src="../Images/ch01/e119_03.jpg"></div>

  <p class="indent"><a id="page_120"></a>Let <em>f</em>(<em>x</em>) = <em>x</em><sup><em>n</em>+1/2</sup>e<sup>−x</sup> and apply Euler’s summation formula:</p>

  <div class="equation"><a id="ch01eq-lev3sec3-21"></a><img src="../Images/ch01/120equ01.jpg"></div>

  <p class="noindent">A crude analysis of the remainder (see <a href="../Text/ch01b.html#ch01ex_3_3_5">exercise 5</a>) shows that <em>R</em> = <em>O</em>(<em>n</em><sup><em>n</em></sup><em>e</em><sup>−n</sup>); and since the integral is an incomplete gamma function, we have</p>

  <div class="equation"><a id="ch01eq-lev3sec3-22"></a><img src="../Images/ch01/120equ02.jpg"></div>

  <p class="indent">Our formula, Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec3-20">20</a>), also requires an estimate of the sum</p>

  <div class="image"><img src="../Images/ch01/e120_01.jpg"></div>

  <p class="noindent">and this can also be obtained by Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec3-22">22</a>).</p>

  <p class="indent">We now have enough formulas at our disposal to determine the approximate values of <em>P</em>(<em>n</em>), <em>Q</em>(<em>n</em>), and <em>R</em>(<em>n</em>), and it is only a matter of substituting and multiplying, etc. In this process we shall have occasion to use the expansion</p>

  <div class="equation"><a id="ch01eq-lev3sec3-23"></a><img src="../Images/ch01/120equ03.jpg"></div>

  <p class="noindent">which is proved in <a href="../Text/ch01b.html#ch01ex_3_3_6">exercise 6</a>. The method of (<a href="../Text/ch01b.html#ch01eq-lev3sec3-21">21</a>) yields only the first two terms in the asymptotic series for <em>P</em>(<em>n</em>); further terms can be obtained by using the instructive technique described in <a href="../Text/ch01b.html#ch01ex_3_3_14">exercise 14</a>.</p>

  <p class="indent">The result of all these calculations gives us the desired asymptotic formulas:</p>

  <div class="equation"><a id="ch01eq-lev3sec3-24"></a><img src="../Images/ch01/120equ04.jpg"></div>

  <div class="equation"><a id="ch01eq-lev3sec3-25"></a><img src="../Images/ch01/120equ05.jpg"></div>

  <div class="equation"><a id="ch01eq-lev3sec3-26"></a><img src="../Images/ch01/120equ06.jpg"></div>

  <p class="indent">The functions studied here have received only light treatment in the published literature. The first term <span class="middle"><img src="../Images/ch01/e119_04.jpg"></span> in the expansion of <em>P</em>(<em>n</em>) was given by H. B. Demuth [Ph.D. thesis (Stanford University, October 1956), 67–68]. Using this result, a table of <em>P</em>(<em>n</em>) for <em>n</em> ≤ 2000, and a good slide rule, the author proceeded in 1963 to deduce the empirical estimate <span class="middle"><img src="../Images/ch01/e119_05.jpg"></span>. It was natural to conjecture that 0.6667 was really an approximation to 2<em>/</em>3, and that 0.575 would perhaps turn out to be an approximation to <em>γ</em> = 0.57721 ... (why not be optimistic?). Later, as this section was being written, the correct expansion of <em>P</em>(<em>n</em>) was developed, and the conjecture 2/3 was verified; for the other coefficient 0.575 we have not <em>γ</em> but <span class="middle"><img src="../Images/ch01/e119_06.jpg"></span> This nicely confirms both the theory and the empirical estimates.</p>

  <p class="indent"><a id="page_121"></a>Formulas equivalent to the asymptotic values of <em>Q</em>(<em>n</em>) and <em>R</em>(<em>n</em>) were first determined by the brilliant self-taught Indian mathematician S. Ramanujan, who posed the problem of estimating <em>n</em>! <em>e</em><sup><em>n</em></sup>/2<em>n</em><sup><em>n</em></sup> − <em>Q</em>(<em>n</em>) in <em>J. Indian Math. Soc</em>. <strong>3</strong> (1911), 128; <strong>4</strong> (1912), 151–152. In his answer to the problem, he gave the asymptotic series <span class="middle"><img src="../Images/ch01/e121_01.jpg"></span> which goes considerably beyond Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec3-25">25</a>). His derivation was somewhat more elegant than the method described above; to estimate <em>I</em><sub>1</sub>, he substituted <span class="middle"><img src="../Images/ch01/e121_02.jpg"></span>, and expressed the integrand as a sum of terms of the form <span class="middle"><img src="../Images/ch01/e121_03.jpg"></span> exp(−<em>u</em><sup>2</sup>) <em>u</em><sup><em>j</em></sup><em>x</em><sup>–<em>k/2</em></sup><em>du</em>. The integral <em>I</em><sub>2</sub> can be avoided completely, since <em>a</em><em>γ</em>(<em>a, x</em>) = <em>x</em><sup><em>a</em></sup><em>e</em><sup>−<em>x</em></sup> + <em>γ</em>(<em>a</em> + 1<em>, x</em>) when <em>a</em> &gt; 0; see (<a href="../Text/ch01b.html#ch01eq-lev3sec3-8">8</a>). An even simpler approach to the asymptotics of <em>Q</em>(<em>n</em>), perhaps the simplest possible, appears in <a href="../Text/ch01b.html#ch01ex_3_3_20">exercise 20</a>. The derivation we have used, which is instructive in spite of its unnecessary complications, is due to R. Furch [<em>Zeitschrift für Physik</em> <strong>112</strong> (1939), 92–95], who was primarily interested in the value of <em>y</em> that makes <em>γ</em>(<em>x</em> + 1<em>, x</em> + <em>y</em>) = <em>Γ</em> (<em>x</em> + 1)<em>/</em>2. The asymptotic properties of the incomplete gamma function were later extended to complex arguments by F. G. Tricomi [<em>Math. Zeitschrift</em> <strong>53</strong> (1950), 136–148]. See also N. M. Temme, <em>Math. Comp.</em> <strong>29</strong> (1975), 1109–1114; <em>SIAM J. Math. Anal</em>. <strong>10</strong> (1979), 757–766. H. W. Gould has listed references to several other investigations of <em>Q</em>(<em>n</em>) in <em>AMM</em> <strong>75</strong> (1968), 1019–1021.</p>

  <p class="indent">Our derivations of the asymptotic series for <em>P</em>(<em>n</em>), <em>Q</em>(<em>n</em>), and <em>R</em>(<em>n</em>) use only simple techniques of elementary calculus; notice that we have used different methods for each function! Actually we could have solved all three problems using the techniques of <a href="../Text/ch01b.html#ch01ex_3_3_14">exercise 14</a>, which are explained further in Sections 5.1.4 and 5.2.2. That would have been more elegant but less instructive.</p>

  <p class="indent">For additional information, interested readers should consult the beautiful book <em>Asymptotic Methods in Analysis</em> by N. G. de Bruijn (Amsterdam: North-Holland, 1958). See also the more recent survey by A. M. Odlyzko [<em>Handbook of Combinatorics</em> <strong>2</strong> (MIT Press, 1995), 1063–1229], which includes 65 detailed examples and an extensive bibliography.</p>

  <p class="ex-title">Exercises</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_3_3_1a" id="ch01ex_3_3_1">1</a>.</strong> [<em>HM20</em>] Prove Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec3-5">5</a>) by induction on <em>n</em>.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_3_3_2a" id="ch01ex_3_3_2">2</a>.</strong> [<em>HM20</em>] Obtain Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec3-7">7</a>) from Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec3-6">6</a>).</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_3_3_3a" id="ch01ex_3_3_3">3</a>.</strong> [<em>M20</em>] Derive Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec3-8">8</a>) from Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec3-7">7</a>).</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_3_4a" id="ch01ex_3_3_4">4</a>.</strong> [<em>HM10</em>] Prove Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec3-13">13</a>).</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_3_3_5a" id="ch01ex_3_3_5">5</a>.</strong> [<em>HM24</em>] Show that <em>R</em> in Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec3-21">21</a>) is <em>O</em>(<em>n</em><sup><em>n</em></sup><em>e</em><sup>−<em>n</em></sup>).</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_3_6a" id="ch01ex_3_3_6">6</a>.</strong> [<em>HM20</em>] Prove Eq. (<a href="../Text/ch01b.html#ch01eq-lev3sec3-23">23</a>).</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_3_7a" id="ch01ex_3_3_7">7</a>.</strong> [<em>HM30</em>] In the evaluation of <em>I</em><sub>2</sub>, we had to consider <span class="middle"><img src="../Images/ch01/e121_04.jpg"></span>. Give an asymptotic representation of</p>

  <div class="image"><img src="../Images/ch01/e121_05.jpg"></div>

  <p class="exercisesp">to terms of order <em>O</em>(<em>x</em><sup>−2</sup>), when <em>y</em> is fixed and <em>x</em> is large.</p>

  <p class="exercises"><a id="page_122"></a><strong><a href="../Text/app01.html#ch01ex_3_3_8a" id="ch01ex_3_3_8">8</a>.</strong> [<em>HM30</em>] If <em>f</em>(<em>x</em>) = <em>O</em>(<em>x</em><sup><em>r</em></sup>) as <em>x</em> → ∞ and 0 ≤ <em>r</em> &lt; 1, show that</p>

  <div class="image"><img src="../Images/ch01/e122_01.jpg"></div>

  <p class="exercisesp">if <em>m</em> = <span class="middle"><img src="../Images/ch01/en0477_01.jpg"></span>(<em>s</em> + 2<em>r</em>)<em>/</em>(1 − <em>r</em>)<span class="middle"><img src="../Images/ch01/en0477_02.jpg"></span>. [This proves in particular a result due to Tricomi: If <span class="middle"><img src="../Images/ch01/e122_02.jpg"></span>, then</p>

  <div class="image"><img src="../Images/ch01/e122_03.jpg"></div>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_3_9a" id="ch01ex_3_3_9">9</a>.</strong> [<em>HM36</em>] What is the behavior of <em>γ</em>(<em>x</em> + 1<em>, px</em>)<em>/</em><em>Γ</em>(<em>x</em> + 1) for large <em>x</em>? (Here <em>p</em> is a real constant; and if <em>p</em> &lt; 0, we assume that <em>x</em> is an integer, so that <em>t</em><sup><em>x</em></sup> is well defined for negative <em>t</em>.) Obtain at least two terms of the asymptotic expansion, before resorting to <em>O</em>-terms.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_3_3_10a" id="ch01ex_3_3_10">10</a>.</strong> [<em>HM34</em>] Under the assumptions of the preceding problem, with <em>p</em> ≠ 1, obtain the asymptotic expansion of <em>γ</em>(<em>x</em> + 1, <em>px</em> + <em>py</em>/(<em>p</em> − 1)) − <em>γ</em>(<em>x</em> + 1, <em>px</em>), for fixed <em>y</em>, to terms of the same order as obtained in the previous exercise.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_3_11a" id="ch01ex_3_3_11">11</a>.</strong> [<em>HM35</em>] Let us generalize the functions <em>Q</em>(<em>n</em>) and <em>R</em>(<em>n</em>) by introducing a parameter <em>x</em>:</p>

  <div class="image"><img src="../Images/ch01/e122_04.jpg"></div>

  <p class="exercisesp">Explore this situation and find asymptotic formulas when <em>x</em> ≠ 1.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_3_3_12a" id="ch01ex_3_3_12">12</a></strong>. [<em>HM20</em>] The function <span class="middle"><img src="../Images/ch01/e122_05.jpg"></span> that appeared in connection with the normal distribution (see <a href="../Text/ch01a.html#ch01lev2sec10">Section 1.2.10</a>) can be expressed as a special case of the incomplete gamma function. Find values of <em>a</em>, <em>b</em>, and <em>y</em> such that <em>b</em> <em>γ</em>(<em>a, y</em>) equals <span class="middle"><img src="../Images/ch01/e122_06.jpg"></span>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_3_3_13a" id="ch01ex_3_3_13">13</a>.</strong> [<em>HM42</em>] (S. Ramanujan.) Prove that <span class="middle"><img src="../Images/ch01/e122_07.jpg"></span>, where <span class="middle"><img src="../Images/ch01/e122_08.jpg"></span>. (This implies the much weaker result <em>R</em>(<em>n</em> + 1) − <em>Q</em>(<em>n</em> + 1) &lt; <em>R</em>(<em>n</em>) − <em>Q</em>(<em>n</em>).)</p>

  <p class="exercises3"><a id="ch01ex_3_3_14"></a><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong>14.</strong> [<em>HM39</em>] (N. G. de Bruijn.) The purpose of this exercise is to find the asymptotic expansion of <span class="middle"><img src="../Images/ch01/e122_09.jpg"></span> for fixed <em>α</em>, as n → ∞.</p>

  <p class="indenthangingAA">a) Replacing <em>k</em> by <em>n−k</em>, show that the given sum equals <span class="middle"><img src="../Images/ch01/e122_10.jpg"></span>, where</p>

  <div class="image"><img src="../Images/ch01/e122_11.jpg"></div>

  <p class="indenthangingAA">b) Show that for all <em>m</em> ≥ 0 and <em><span class="ent">∊</span></em> &gt; 0, the quantity <em>f</em>(<em>k, n</em>) can be written in the form</p>

  <div class="image"><img src="../Images/ch01/e122_12.jpg"></div>

  <p class="indenthangingAA">c) Prove that as a consequence of (b), we have</p>

  <div class="image"><img src="../Images/ch01/e122_13.jpg"></div>

  <p class="indenthangingAAP">for all <em>δ</em> &gt; 0. [<em>Hint</em>: The sums over the range <em>n</em><sup>1/2+<em><span class="ent">∊</span></em></sup> &lt; <em>k</em> &lt; ∞ are <em>O</em>(<em>n</em><sup>−r</sup>) for all <em>r</em>.]</p>

  <p class="indenthangingAA"><a id="page_123"></a>d) Show that the asymptotic expansion of Σ<sub><em>k</em> ≥0</sub><em>k<sup><em>t</em></sup>e</em><sup>–<em>k</em><sup>2</sup>/2<em>n</em></sup> for fixed <em>t</em> ≥ 0 can be obtained by Euler’s summation formula.</p>

  <p class="indenthangingAA">e) Finally therefore</p>

  <div class="image"><img src="../Images/ch01/e123_01.jpg"></div>

  <p class="indenthangingAAP">this computation can in principle be extended to <em>O</em>(<em>n</em><sup>−r</sup>) for any desired <em>r</em>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_3_3_15a" id="ch01ex_3_3_15">15</a>.</strong> [<em>HM20</em>] Show that the following integral is related to <em>Q</em>(<em>n</em>):</p>

  <div class="image"><img src="../Images/ch01/e123_02.jpg"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_3_3_16a" id="ch01ex_3_3_16">16</a>.</strong> [<em>M24</em>] Prove the identity</p>

  <div class="image"><img src="../Images/ch01/e123_03.jpg"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_3_3_17a" id="ch01ex_3_3_17">17</a>.</strong> [<em>HM29</em>] (K. W. Miller.) Symmetry demands that we consider also a fourth series, which is to <em>P</em>(<em>n</em>) as <em>R</em>(<em>n</em>) is to <em>Q</em>(<em>n</em>):</p>

  <div class="image"><img src="../Images/ch01/e123_04.jpg"></div>

  <p class="exercisesp">What is the asymptotic behavior of this function?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_3_3_18a" id="ch01ex_3_3_18">18</a>.</strong> [<em>M25</em>] Show that the sums <span class="middle"><img src="../Images/ch01/e123_05.jpg"></span> and <span class="middle"><img src="../Images/ch01/e123_06.jpg"></span> can be expressed very simply in terms of the <em>Q</em> function.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_3_3_19a" id="ch01ex_3_3_19">19</a>.</strong> [<em>HM30</em>] (<em>Watson’s lemma.</em>) Show that if the integral <span class="middle"><img src="../Images/ch01/e123_07.jpg"></span> exists for all large <em>n</em>, and if <em>f</em>(<em>x</em>) = <em>O</em>(<em>x</em><sup><em>α</em></sup>) for 0 ≤ <em>x</em> ≤ <em>r</em>, where <em>r</em> &gt; 0 and <em>α</em> &gt; −1, then <em>C</em><sub><em>n</em></sub> = <em>O</em>(<em>n</em><sup>−1−<em>α</em></sup>).</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_3_3_20a" id="ch01ex_3_3_20">20</a>.</strong> [<em>HM30</em>] Let <span class="middle"><img src="../Images/ch01/e123_08.jpg"></span> be the power series solution to the equation <span class="middle"><img src="../Images/ch01/e123_09.jpg"></span>, as in (<a href="../Text/ch01b.html#ch01eq-lev3sec3-12">12</a>). Show that</p>

  <div class="image"><img src="../Images/ch01/e123_10.jpg"></div>

  <p class="exercisesp">for all <em>m</em> ≥ 1. [<em>Hint:</em> Apply Watson’s lemma to the identity of <a href="../Text/ch01b.html#ch01ex_3_3_15">exercise 15</a>.]</p>

  <p class="blockquote"><span class="roman_italic">I feel as if I should succeed in doing something in mathematics,<br>
  although I cannot see why it is so very important.</span></p>

  <p class="attribution">— HELEN KELLER (1898)</p>

  <div class="heading">
    <h3 id="ch01lev1sec3"><a id="page_124"></a>1.3. <span class="EmpStrong">MIX</span></h3>

    <p class="noindent">In many places throughout this book we will have occasion to refer to a computer’s internal machine language. The machine we use is a mythical computer called “<code>MIX</code>.” <code>MIX</code> is very much like nearly every computer of the 1960s and 1970s, except that it is, perhaps, nicer. The language of <code>MIX</code> has been designed to be powerful enough to allow brief programs to be written for most algorithms, yet simple enough so that its operations are easily learned.</p>
  </div>

  <p class="indent">The reader is urged to study this section carefully, since <code>MIX</code> language appears in so many parts of this book. There should be no hesitation about learning a machine language; indeed, the author once found it not uncommon to be writing programs in a half dozen different machine languages during the same week! Everyone with more than a casual interest in computers will probably get to know at least one machine language sooner or later. <code>MIX</code> has been specially designed to preserve the simplest aspects of historic computers, so that its characteristics are easy to assimilate.</p>

  <p class="noindent"><span class="middle"><img src="../Images/ch01/signal.jpg"></span> <em>However, it must be admitted that <span class="EmpItalic">MIX</span> is now quite obsolete. Therefore <span class="EmpItalic">MIX</span> will be replaced in subsequent editions of this book by a new machine called <span class="EmpItalic">MMIX</span>, the 2009. <span class="EmpItalic">MMIX</span> will be a so-called reduced instruction set computer (RISC), which will do arithmetic on 64-bit words. It will be even nicer than <span class="EmpItalic">MIX</span>, and it will be similar to machines that have become dominant during the 1990s.</em></p>

  <p class="indent"><em>The task of converting everything in this book from <span class="EmpItalic">MIX</span> to <span class="EmpItalic">MMIX</span> will take a long time; volunteers are solicited to help with that conversion process. Meanwhile, the author hopes that people will be content to live for a few more years with the old-fashioned <span class="EmpItalic">MIX</span> architecture — which is still worth knowing, because it helps to provide a context for subsequent developments.</em></p>

  <div class="heading">
    <h4 id="ch01lev2sec12">1.3.1. Description of <span class="EmpStrong">MIX</span></h4>

    <p class="noindent"><code>MIX</code> is the world’s first polyunsaturated computer. Like most machines, it has an identifying number — the 1009. This number was found by taking 16 actual computers very similar to <code>MIX</code> and on which <code>MIX</code> could easily be simulated, then averaging their numbers with equal weight:</p>
  </div>

  <div class="equation"><a id="ch01eq-lev2sec12-1"></a><img src="../Images/ch01/124equ01.jpg"></div>

  <p class="noindent">The same number may also be obtained in a simpler way by taking Roman numerals.</p>

  <p class="indent"><code>MIX</code> has a peculiar property in that it is both binary and decimal at the same time. <span class="EmpItalic">MIX</span> <em>programmers don’t actually know whether they are programming a machine with base 2 or base 10 arithmetic.</em> Therefore algorithms written in <code>MIX</code> can be used on either type of machine with little change, and <code>MIX</code> can be simulated easily on either type of machine. Programmers who are accustomed to a binary machine can think of <code>MIX</code> as binary; those accustomed to decimal may regard <code>MIX</code> as decimal. Programmers from another planet might choose to think of <code>MIX</code> as a ternary computer.</p>

  <p class="noindent"><a id="page_125"></a><strong>Words.</strong> The basic unit of <code>MIX</code> data is a <em>byte</em>. Each byte contains an <em>unspecified</em> amount of information, but it must be capable of holding at least 64 distinct values. That is, we know that any number between 0 and 63, inclusive, can be contained in one byte. Furthermore, each byte contains <em>at most</em> 100 distinct values. On a binary computer a byte must therefore be composed of six bits; on a decimal computer we have two digits per byte.<a href="../Text/ch01b.html#ch01bfn01" id="ch01bfn01a">*</a></p>

  <p class="footnote"><a href="../Text/ch01b.html#ch01bfn01a" id="ch01bfn01">*</a> Since 1975 or so, the word “byte” has come to mean a sequence of precisely eight binary digits, capable of representing the numbers 0 to 255. Real-world bytes are therefore larger than the bytes of the hypothetical <code>MIX</code> machine; indeed, <code>MIX</code>’s old-style bytes are just barely bigger than nybbles. When we speak of bytes in connection with <code>MIX</code> we shall confine ourselves to the former sense of the word, harking back to the days when bytes were not yet standardized.</p>

  <p class="indent">Programs expressed in <code>MIX</code>’s language should be written so that no more than sixty-four values are ever assumed for a byte. If we wish to treat the number 80, we should always leave two adjacent bytes for expressing it, even though one byte is sufficient on a decimal computer. <em>An algorithm in <code>MIX</code> should work properly regardless of how big a byte is</em>. Although it is quite possible to write programs that depend on the byte size, such actions are anathema to the spirit of this book; the only legitimate programs are those that would give correct results with all byte sizes. It is usually not hard to abide by this ground rule, and we will thereby find that programming a decimal computer isn’t so different from programming a binary one after all.</p>

  <p class="indent">Two adjacent bytes can express the numbers 0 through 4,095.</p>

  <p class="indent">Three adjacent bytes can express the numbers 0 through 262,143.</p>

  <p class="indent">Four adjacent bytes can express the numbers 0 through 16,777,215.</p>

  <p class="indent">Five adjacent bytes can express the numbers 0 through 1,073,741,823.</p>

  <p class="indent"><em>A computer word consists of five bytes and a sign.</em> The sign portion has only two possible values, + and −.</p>

  <p class="noindent"><strong>Registers.</strong> There are nine registers in <code>MIX</code> (see <a href="../Text/ch01b.html#ch01fig13">Fig. 13</a>):</p>

  <p class="indent">The A-register (Accumulator) consists of five bytes and a sign.</p>

  <p class="indent">The X-register (Extension), likewise, comprises five bytes and a sign.</p>

  <p class="indent">The I-registers (Index registers) I1, I2, I3, I4, I5, and I6 each hold two bytes together with a sign.</p>

  <p class="indent">The J-register (Jump address) holds two bytes; it behaves as if its sign is always +.</p>

  <div class="image4">
    <a id="ch01fig13"></a><img class="img1" src="../Images/ch01/01fig13.jpg">

    <p class="fig-caption"><strong>Fig. 13.</strong> The <code>MIX</code> computer.</p>
  </div>

  <p class="noindent">We shall use a small letter “r”, prefixed to the name, to identify a <code>MIX</code> register.</p>

  <p class="noindent">Thus, “rA” means “register A.”</p>

  <p class="indent">The A-register has many uses, especially for arithmetic and for operating on data. The X-register is an extension on the “right-hand side” of rA, and it is used in connection with rA to hold ten bytes of a product or dividend, or it can be used to hold information shifted to the right out of rA. The index registers rI1, rI2, rI3, rI4, rI5, and rI6 are used primarily for counting and for referencing variable memory addresses. The J-register always holds the address of the instruction following the most recent “jump” operation, and it is primarily used in connection with subroutines.</p>

  <p class="indent"><a id="page_126"></a>Besides its registers, <code>MIX</code> contains</p>

  <p class="uln-indent">an <em>overflow toggle</em> (a single bit that is either “on” or “off”); a <em>comparison indicator</em> (having three values: <code>LESS</code>, <code>EQUAL</code>, or <code>GREATER</code>); <em>memory</em> (4000 words of storage, each word with five bytes and a sign); and <em>input-output devices</em> (cards, tapes, disks, etc.).</p>

  <p class="noindent"><strong>Partial fields of words.</strong> The five bytes and sign of a computer word are numbered as follows:</p>

  <div class="equation"><a id="ch01eq-lev2sec12-2"></a><img src="../Images/ch01/126equ01.jpg"></div>

  <p class="noindent"><a id="page_127"></a>Most of the instructions allow a programmer to use only part of a word if desired. In such cases a nonstandard “field specification” can be given. The allowable fields are those that are adjacent in a computer word, and they are represented by (L:R), where L is the number of the left-hand part and R is the number of the right-hand part of the field. Examples of field specifications are:</p>

  <p class="indent">(0:0), the sign only.</p>

  <p class="indent">(0:2), the sign and the first two bytes.</p>

  <p class="indent">(0:5), the whole word; this is the most common field specification.</p>

  <p class="indent">(1:5), the whole word except for the sign.</p>

  <p class="indent">(4:4), the fourth byte only.</p>

  <p class="indent">(4:5), the two least significant bytes.</p>

  <p class="noindent">The use of field specifications varies slightly from instruction to instruction, and it will be explained in detail for each instruction where it applies. Each field specification (L:R) is actually represented inside the machine by the single number 8L + R; notice that this number fits easily in one byte.</p>

  <p class="noindent"><strong>Instruction format.</strong> Computer words used for instructions have the following form:</p>

  <div class="equation"><a id="ch01eq-lev2sec12-3"></a><img src="../Images/ch01/127equ01.jpg"></div>

  <p class="indent">The rightmost byte, C, is the <em>operation code</em> telling what operation is to be performed. For example, C = 8 specifies the operation <code>LDA</code>, “load the A-register.”</p>

  <p class="indent">The F-byte holds a <em>modification</em> of the operation code. It is usually a field specification (L:R) = 8L + R; for example, if C = 8 and F = 11, the operation is “load the A-register with the (1:3) field.” Sometimes F is used for other purposes; on input-output instructions, for example, F is the number of the relevant input or output unit.</p>

  <p class="indent">The left-hand portion of the instruction, ±AA, is the <em>address</em>. (Notice that the sign is part of the address.) The I-field, which comes next to the address, is the <em>index specification</em>, which may be used to modify the effective address. If I = 0, the address ±AA is used without change; otherwise I should contain a number <em>i</em> between 1 and 6, and the contents of index register I<em>i</em> are added algebraically to ±AA before the instruction is carried out; the result is used as the address. This indexing process takes place on <em>every</em> instruction. We will use the letter M to indicate the address after any specified indexing has occurred. (If the addition of the index register to the address ±AA yields a result that does not fit in two bytes, the value of M is undefined.)</p>

  <p class="indent">In most instructions, M will refer to a memory cell. The terms “memory cell” and “memory location” are used almost interchangeably in this book. We assume that there are 4000 memory cells, numbered from 0 to 3999; hence every memory location can be addressed with two bytes. For every instruction in which M refers to a memory cell we must have 0 ≤ M ≤ 3999, and in this case we will write <code>CONTENTS(</code>M<code>)</code> to denote the value stored in memory location M.</p>

  <p class="indent"><a id="page_128"></a>On certain instructions, the “address” M has another significance, and it may even be negative. Thus, one instruction adds M to an index register, and such an operation takes account of the sign of M.</p>

  <p class="noindent"><strong>Notation.</strong> To discuss instructions in a readable manner, we will use the notation</p>

  <div class="equation"><a id="ch01eq-lev2sec12-4"></a><img src="../Images/ch01/128equ01.jpg"></div>

  <p class="noindent">to denote an instruction like (<a href="../Text/ch01b.html#ch01eq-lev2sec12-3">3</a>). Here <code>OP</code> is a symbolic name given to the operation code (the C-part) of the instruction; <code>ADDRESS</code> is the ±AA portion; <code>I</code> and <code>F</code> represent the I- and F-fields, respectively.</p>

  <p class="indent">If I is zero, the ‘<code>,I</code>’ is omitted. If F is the <em>normal</em> F-specification for this particular operator, the ‘<code>(F)</code>’ need not be written. The normal F-specification for almost all operators is (0:5), representing a whole word. If a different F is normal, it will be mentioned explicitly when we discuss a particular operator.</p>

  <p class="indent">For example, the instruction to load a number into the accumulator is called <code>LDA</code> and it is operation code number 8. We have</p>

  <div class="equation"><a id="ch01eq-lev2sec12-5"></a><img src="../Images/ch01/128equ02.jpg"></div>

  <p class="noindent">The instruction ‘<code>LDA 2000,2(0:3)</code>’ may be read “Load A with the contents of location 2000 indexed by 2, the zero-three field.”</p>

  <p class="indent">To represent the numerical contents of a <code>MIX</code> word, we will always use a box notation like that above. Notice that in the word</p>

  <div class="image"><img src="../Images/ch01/e128_01.jpg"></div>

  <p class="noindent">the number +2000 is shown filling two adjacent bytes and sign; the actual contents of byte (1:1) and of byte (2:2) will vary from one <code>MIX</code> computer to another, since byte size is variable. As a further example of this notation for <code>MIX</code> words, the diagram</p>

  <div class="image"><img src="../Images/ch01/e128_02.jpg"></div>

  <p class="noindent">represents a word with two fields, a three-byte-plus-sign field containing −10000 and a two-byte field containing 3000. When a word is split into more than one field, it is said to be “packed.”</p>

  <p class="noindent"><strong>Rules for each instruction.</strong> The remarks following (<a href="../Text/ch01b.html#ch01eq-lev2sec12-3">3</a>) above have defined the quantities M, F, and C for every word used as an instruction. We will now define the actions corresponding to each instruction.</p>

  <p class="noindent"><a id="page_129"></a><strong>Loading operators.</strong></p>

  <p class="indenthangingB">• <code>LDA</code> (load A). C = 8; F = field.</p>

  <p class="noindent">The specified field of <code>CONTENTS(</code>M<code>)</code> replaces the previous contents of register A.</p>

  <p class="indent">On all operations where a partial field is used as an input, the sign is used if it is a part of the field, otherwise the sign + is understood. The field is shifted over to the right-hand part of the register as it is loaded.</p>

  <p class="indent"><em>Examples:</em> If F is the normal field specification (0:5), everything in location M is copied into rA. If F is (1:5), the absolute value of <code>CONTENTS(</code>M<code>)</code> is loaded with a plus sign. If M contains an <em>instruction</em> word and if F is (0:2), the “±AA” field is loaded as</p>

  <div class="image"><img src="../Images/ch01/e129_01.jpg"></div>

  <p class="indent">Suppose location 2000 contains the word</p>

  <div class="equation"><a id="ch01eq-lev2sec12-6"></a><img src="../Images/ch01/129equ01.jpg"></div>

  <p class="noindent">then we get the following results from loading various partial fields:</p>

  <div class="image"><img src="../Images/ch01/e129_02.jpg"></div>

  <p class="noindent">(The last example has a partially unknown effect, since byte size is variable.)</p>

  <p class="indenthangingB">• <code>LDX</code> (load X). C = 15; F = field.</p>

  <p class="noindent">This is the same as <code>LDA</code>, except that rX is loaded instead of rA.</p>

  <p class="indenthangingB">• <code>LD</code><em>i</em> (load <em>i</em>). C = 8 + <em>i</em>; F = field.</p>

  <p class="noindent">This is the same as <code>LDA</code>, except that rI<em>i</em> is loaded instead of rA. An index register contains only two bytes (not five) and a sign; bytes 1, 2, 3 are always assumed to be zero. The <code>LD</code><em>i</em> instruction is undefined if it would result in setting bytes 1, 2, or 3 to anything but zero.</p>

  <p class="indent">In the description of all instructions, “<em>i</em>” stands for an integer, 1 ≤ <em>i</em> ≤ 6. Thus, <code>LD</code><em>i</em> stands for six different instructions: <code>LD1, LD2, ..., LD6.</code></p>

  <p class="indenthangingB">• <code>LDAN</code> (load A negative). C = 16; F = field.</p>

  <p class="indenthangingB">• <code>LDXN</code> (load X negative). C = 23; F = field.</p>

  <p class="indenthangingB">• <code>LD</code><em>i</em><code>N</code> (load <em>i</em> negative). C = 16 + <em>i</em>; F = field.</p>

  <p class="noindent">These eight instructions are the same as <code>LDA</code>, <code>LDX</code>, <code>LD</code><em>i</em>, respectively, except that the <em>opposite</em> sign is loaded.</p>

  <p class="noindent"><a id="page_130"></a><strong>Storing operators.</strong></p>

  <p class="indenthangingB">• <code>STA</code> (store A). C = 24; F = field.</p>

  <p class="noindent">A portion of the contents of rA replaces the field of <code>CONTENTS(</code>M<code>)</code> specified by F. The other parts of <code>CONTENTS(</code>M<code>)</code> are unchanged.</p>

  <p class="indent">On a <em>store</em> operation the field F has the opposite significance from the <em>load</em> operation: The number of bytes in the field is taken from the right-hand portion of the register and shifted <em>left</em> if necessary to be inserted in the proper field of <code>CONTENTS(</code>M<code>)</code>. The sign is not altered unless it is part of the field. The contents of the register are not affected.</p>

  <p class="indent"><em>Examples:</em> Suppose that location 2000 contains</p>

  <div class="image"><img src="../Images/ch01/e130_01.jpg"></div>

  <p class="noindent">and register A contains</p>

  <div class="image"><img src="../Images/ch01/e130_02.jpg"></div>

  <p class="noindent">Then:</p>

  <div class="image"><img src="../Images/ch01/e130_03.jpg"></div>

  <p class="indenthangingB">• <code>STX</code> (store X). C = 31; F = field.</p>

  <p class="noindent">Same as <code>STA</code>, except that rX is stored rather than rA.</p>

  <p class="indenthangingB">• <code>ST</code><em>i</em> (store <em>i</em>). C = 24 + <em>i</em>; F = field.</p>

  <p class="noindent">Same as <code>STA</code>, except that rI<em>i</em> is stored rather than rA. Bytes 1, 2, 3 of an index register are zero; thus if rI1 contains</p>

  <div class="image"><img src="../Images/ch01/e130_04.jpg"></div>

  <p class="noindent">it behaves as though it were</p>

  <div class="image"><img src="../Images/ch01/e130_05.jpg"></div>

  <p class="indenthangingB">• <code>STJ</code> (store J). C = 32; F = field.</p>

  <p class="noindent">Same as <code>ST</code><em>i</em>, except that rJ is stored and its sign is always +.</p>

  <p class="indent"><em>With</em> <span class="EmpItalic">STJ</span> <em>the normal field specification for F is</em> (0:2), <em>not</em> (0:5). This is natural, since <code>STJ</code> is almost always done into the address field of an instruction.</p>

  <p class="indenthangingB">• <code>STZ</code> (store zero). C = 33; F = field.</p>

  <p class="noindent">Same as <code>STA</code>, except that plus zero is stored. In other words, the specified field of <code>CONTENTS(</code>M<code>)</code> is cleared to zero.</p>

  <p class="noindent"><a id="page_131"></a><strong>Arithmetic operators.</strong> On the add, subtract, multiply, and divide operations, a field specification is allowed. A field specification of “(0:6)” can be used to indicate a “floating point” operation (see Section 4.2), but few of the programs we will write for <code>MIX</code> will use this feature, since we will primarily be concerned with algorithms on integers.</p>

  <p class="indent">The standard field specification is, as usual, (0:5). Other fields are treated as in <code>LDA</code>. We will use the letter V to indicate the specified field of <code>CONTENTS(</code>M<code>)</code>; thus, V is the value that would have been loaded into register A if the operation code were <code>LDA</code>.</p>

  <p class="indenthangingB">• <code>ADD</code>. C = 1; F = field.</p>

  <p class="noindent">V is added to rA. If the magnitude of the result is too large for register A, the overflow toggle is set on, and the remainder of the addition appearing in rA is as though a “1” had been carried into another register to the left of rA. (Otherwise the setting of the overflow toggle is unchanged.) If the result is zero, the sign of rA is unchanged.</p>

  <p class="indent"><em>Example:</em> The sequence of instructions below computes the sum of the five bytes of register A.</p>

  <div class="image"><img src="../Images/ch01/e131_01.jpg"></div>

  <p class="noindent">This is sometimes called “sideways addition.”</p>

  <p class="indent">Overflow will occur in some <code>MIX</code> computers when it would not occur in others, because of the variable definition of byte size. We have not said that overflow will occur definitely if the value is greater than 1073741823; overflow occurs when the magnitude of the result is greater than the contents of five bytes, depending on the byte size. One can still write programs that work properly and that give the same final answers, regardless of the byte size.</p>

  <p class="indenthangingB">• <code>SUB</code> (subtract). C = 2; F = field.</p>

  <p class="noindent">V is subtracted from rA. (Equivalent to <code>ADD</code> but with −V in place of V.)</p>

  <p class="indenthangingB">• <code>MUL</code> (multiply). C = 3; F = field.</p>

  <p class="noindent">The 10-byte product, V times rA, replaces registers A and X. The signs of rA and rX are both set to the algebraic sign of the product (namely, + if the signs of V and rA were the same, − if they were different).</p>

  <p class="indenthangingB">• <code>DIV</code> (divide). C = 4; F = field.</p>

  <p class="noindent">The value of rA and rX, treated as a 10-byte number rAX with the sign of rA, is divided by the value V. If V = 0 or if the quotient is more than five bytes in magnitude (this is equivalent to the condition that |rA| ≥ |V|), registers A and X are filled with undefined information and the overflow toggle is set on. Otherwise the quotient ±<span class="middle"><img src="../Images/ch01/en0470_01.jpg"></span>| rAX<em>/</em>V|<span class="middle"><img src="../Images/ch01/en0470_02.jpg"></span> is placed in rA and the remainder ±(|rAX| mod |V|) is placed in rX. The sign of rA afterwards is the algebraic sign of the quotient <a id="page_132"></a>(namely, + if the signs of V and rA were the same, − if they were different). The sign of rX afterwards is the previous sign of rA.</p>

  <p class="indent"><em>Examples of arithmetic instructions:</em> In most cases, arithmetic is done only with <code>MIX</code> words that are single five-byte numbers, not packed with several fields. It is, however, possible to operate arithmetically on packed <code>MIX</code> words, if some caution is used. The following examples should be studied carefully. (As before, <code>?</code> designates an unknown value.)</p>

  <div class="image"><img src="../Images/ch01/e132_01.jpg"></div>

  <div class="image"><img src="../Images/ch01/e132_01a.jpg"></div>

  <p class="noindent"><a id="page_133"></a>(These examples have been prepared with the philosophy that it is better to give a complete, baffling description than an incomplete, straightforward one.)</p>

  <p class="noindent"><strong>Address transfer operators.</strong> In the following operations, the (possibly indexed) “address” M is used as a signed number, not as the address of a cell in memory.</p>

  <p class="indenthangingB">• <code>ENTA</code> (enter A). C = 48; F = 2.</p>

  <p class="noindent">The quantity M is loaded into rA. The action is equivalent to ‘<code>LDA</code>’ from a memory word containing the signed value of M. If M = 0, the sign of the instruction is loaded.</p>

  <p class="indent"><em>Examples:</em> ‘<code>ENTA 0</code>’ sets rA to zeros, with a + sign. ‘<code>ENTA 0,1</code>’ sets rA to the current contents of index register 1, except that −0 is changed to +0. ‘<code>ENTA -0,1</code>’ is similar, except that +0 is changed to −0.</p>

  <p class="indenthangingB">• <code>ENTX</code> (enter X). C = 55; F = 2.</p>

  <p class="indenthangingB">• <code>ENT</code><em>i</em> (enter <em>i</em>). C = 48 + <em>i</em>; F = 2.</p>

  <p class="noindent">Analogous to <code>ENTA</code>, loading the appropriate register.</p>

  <p class="indenthangingB">• <code>ENNA</code> (enter negative A). C = 48; F = 3.</p>

  <p class="indenthangingB">• <code>ENNX</code> (enter negative X). C = 55; F = 3.</p>

  <p class="indenthangingB">• <code>ENN</code><em>i</em> (enter negative <em>i</em>). C = 48 + <em>i</em>; F = 3.</p>

  <p class="noindent">Same as <code>ENTA</code>, <code>ENTX</code>, and <code>ENT</code><em>i</em>, except that the opposite sign is loaded.</p>

  <p class="indent"><em>Example:</em> ‘<code>ENN3 0,3</code>’ replaces rI3 by its negative, although −0 remains −0.</p>

  <p class="indenthangingB">• <code>INCA</code> (increase A). C = 48; F = 0.</p>

  <p class="noindent">The quantity M is added to rA; the action is equivalent to ‘<code>ADD</code>’ from a memory word containing the value of M. Overflow is possible and it is treated just as in <code>ADD</code>.</p>

  <p class="indent">Example: ‘<code>INCA 1</code>’ increases the value of rA by one.</p>

  <p class="indenthangingB">• <code>INCX</code> (increase X). C = 55; F = 0.</p>

  <p class="noindent">The quantity M is added to rX. If overflow occurs, the action is equivalent to <code>ADD</code>, except that rX is used instead of rA. Register A is never affected by this instruction.</p>

  <p class="indenthangingB">• <code>INC</code><em>i</em> (increase <em>i</em>). C = 48 + <em>i</em>; F = 0.</p>

  <p class="noindent">Add M to rI<em>i</em>. Overflow must not occur; if M + rI<em>i</em> doesn’t fit in two bytes, the result of this instruction is undefined.</p>

  <p class="indenthangingB"><a id="page_134"></a>• <code>DECA</code> (decrease A). C = 48; F = 1.</p>

  <p class="indenthangingB">• <code>DECX</code> (decrease X). C = 55; F = 1.</p>

  <p class="indenthangingB">• <code>DEC</code><em>i</em> (decrease <em>i</em>). C = 48 + <em>i</em>; F = 1.</p>

  <p class="noindent">These eight instructions are the same as <code>INCA</code>, <code>INCX</code>, and <code>INC</code><em>i</em>, respectively, except that M is subtracted from the register rather than added.</p>

  <p class="indent">Notice that the operation code C is the same for <code>ENTA</code>, <code>ENNA</code>, <code>INCA</code>, and <code>DECA</code>; the F-field is used to distinguish the various operations from each other.</p>

  <p class="noindent"><strong>Comparison operators.</strong> <code>MIX</code>’s comparison operators all compare the value contained in a register with a value contained in memory. The comparison indicator is then set to <code>LESS</code>, <code>EQUAL</code>, or <code>GREATER</code> according to whether the value of the register is less than, equal to, or greater than the value of the memory cell. A minus zero is <em>equal to</em> a plus zero.</p>

  <p class="indenthangingB">• <code>CMPA</code> (compare A). C = 56; F = field.</p>

  <p class="noindent">The specified field of rA is compared with the <em>same</em> field of <code>CONTENTS(</code>M<code>)</code>. If F does not include the sign position, the fields are both considered nonnegative; otherwise the sign is taken into account in the comparison. (An equal comparison always occurs when F is (0:0), since minus zero equals plus zero.)</p>

  <p class="indenthangingB">• <code>CMPX</code> (compare X). C = 63; F = field.</p>

  <p class="noindent">This is analogous to <code>CMPA</code>.</p>

  <p class="indenthangingB">• <code>CMP</code><em>i</em> (compare <em>i</em>). C = 56 + <em>i</em>; F = field.</p>

  <p class="noindent">Analogous to <code>CMPA</code>. Bytes 1, 2, and 3 of the index register are treated as zero in the comparison. (Thus if F = (1:2), the result cannot be <code>GREATER</code>.)</p>

  <p class="noindent"><strong>Jump operators.</strong> Instructions are ordinarily executed in sequential order; in other words, the command that is performed after the command in location P is usually the one found in location P + 1. But several “jump” instructions allow this sequence to be interrupted. When a typical jump takes place, the J-register is set to the address of the next instruction (that is, to the address of the instruction that would have been next if we hadn’t jumped). A “store J” instruction then can be used by the programmer, if desired, to set the address field of another command that will later be used to return to the original place in the program. The J-register is changed whenever a jump actually occurs in a program, except when the jump operator is <code>JSJ</code>, and it is never changed by non-jumps.</p>

  <p class="indenthangingB">• <code>JMP</code> (jump). C = 39; F = 0.</p>

  <p class="noindent">Unconditional jump: The next instruction is taken from location M.</p>

  <p class="indenthangingB">• <code>JSJ</code> (jump, save J). C = 39; F = 1.</p>

  <p class="noindent">Same as <code>JMP</code> except that the contents of rJ are unchanged.</p>

  <p class="indenthangingB">• <code>JOV</code> (jump on overflow). C = 39; F = 2.</p>

  <p class="noindent">If the overflow toggle is on, it is turned off and a <code>JMP</code> occurs; otherwise nothing happens.</p>

  <p class="indenthangingB">• <code>JNOV</code> (jump on no overflow). C = 39; F = 3.</p>

  <p class="noindent">If the overflow toggle is off, a <code>JMP</code> occurs; otherwise it is turned off.</p>

  <p class="indenthangingB"><a id="page_135"></a>• <code>JL, JE, JG, JGE, JNE, JLE</code> (jump on less, equal, greater, greater-or-equal, unequal, less-or-equal). C = 39; F = 4, 5, 6, 7, 8, 9, respectively.</p>

  <p class="noindent">Jump if the comparison indicator is set to the condition indicated. For example, <code>JNE</code> will jump if the comparison indicator is <code>LESS</code> or <code>GREATER</code>. The comparison indicator is not changed by these instructions.</p>

  <p class="indenthangingB">• <code>JAN, JAZ, JAP, JANN, JANZ, JANP</code> (jump A negative, zero, positive, nonnegative, nonzero, nonpositive). C = 40; F = 0, 1, 2, 3, 4, 5, respectively.</p>

  <p class="noindent">If the contents of rA satisfy the stated condition, a <code>JMP</code> occurs, otherwise nothing happens. “Positive” means <em>greater</em> than zero (not zero); “nonpositive” means the opposite, namely zero or negative.</p>

  <p class="indenthangingB">• <code>JXN, JXZ, JXP, JXNN, JXNZ, JXNP</code> (jump X negative, zero, positive, nonnegative, nonzero, nonpositive). C = 47; F = 0, 1, 2, 3, 4, 5, respectively.</p>

  <p class="indenthangingB">• <code>J</code><em>i</em><code>N, J</code><em>i</em><code>Z, J</code><em>i</em><code>P, J</code><em>i</em><code>NN, J</code><em>i</em><code>NZ, J</code><em>i</em><code>NP</code> (jump <em>i</em> negative, zero, positive, nonnegative, nonzero, nonpositive). C = 40 + <em>i</em>; F = 0, 1, 2, 3, 4, 5, respectively. These 42 instructions are analogous to the corresponding operations for rA.</p>

  <p class="noindent"><strong>Miscellaneous operators.</strong></p>

  <p class="indenthangingB">• <code>SLA, SRA, SLAX, SRAX, SLC, SRC</code> (shift left A, shift right A, shift left AX, shift</p>

  <p class="noindent">right AX, shift left AX circularly, shift right AX circularly). C = 6; F = 0, 1, 2, 3, 4, 5, respectively.</p>

  <p class="noindent">These six are the “shift” commands, in which M specifies a number of <code>MIX</code> bytes to be shifted left or right; M must be nonnegative. <code>SLA</code> and <code>SRA</code> do not affect rX; the other shifts affect both registers A and X as though they were a single 10- byte register. With <code>SLA, SRA, SLAX</code>, and <code>SRAX</code>, zeros are shifted into the register at one side, and bytes disappear at the other side. The instructions <code>SLC</code> and <code>SRC</code> call for a “circulating” shift, in which the bytes that leave one end enter in at the other end. Both rA and rX participate in a circulating shift. The signs of registers A and X are not affected in any way by any of the shift commands.</p>

  <div class="image"><img src="../Images/ch01/e135_01.jpg"></div>

  <p class="indenthangingB">• <code>MOVE</code>. C = 7; F = number, normally 1.</p>

  <p class="noindent">The number of words specified by F is moved, starting from location M to the location specified by the contents of index register 1. The transfer occurs one word at a time, and rI1 is increased by the value of F at the end of the operation. If F = 0, nothing happens.</p>

  <p class="indent">Care must be taken when there’s overlap between the locations involved; for example, suppose that F = 3 and M = 1000. Then if rI1 = 999, we transfer <a id="page_136"></a><code>CONTENTS(1000)</code> to <code>CONTENTS(</code>999<code>)</code>, <code>CONTENTS(</code>1001<code>)</code> to <code>CONTENTS(</code>1000<code>)</code>, and <code>CONTENTS(</code>1002<code>)</code> to <code>CONTENTS(</code>1001<code>)</code>; nothing unusual occurred here. But if rI1 were 1001 instead, we would move <code>CONTENTS(</code>1000<code>)</code> to <code>CONTENTS(</code>1001<code>)</code>, then <code>CONTENTS(</code>1001<code>)</code> to <code>CONTENTS(</code>1002<code>)</code>, then <code>CONTENTS(</code>1002<code>)</code> to <code>CONTENTS(</code>1003<code>)</code>, so we would have moved the <em>same</em> word <code>CONTENTS(</code>1000<code>)</code> into three places.</p>

  <p class="indenthangingB">• <code>NOP</code> (no operation). C = 0.</p>

  <p class="noindent">No operation occurs, and this instruction is bypassed. F and M are ignored.</p>

  <p class="indenthangingB">• <code>HLT</code> (halt). C = 5; F = 2.</p>

  <p class="noindent">The machine stops. When the computer operator restarts it, the net effect is equivalent to <code>NOP</code>.</p>

  <p class="noindent"><strong>Input-output operators.</strong> <code>MIX</code> has a fair amount of input-output equipment (all of which is optional at extra cost). Each device is given a number as follows:</p>

  <div class="image"><img src="../Images/ch01/e136_01.jpg"></div>

  <p class="noindent">Not every <code>MIX</code> installation will have all of this equipment available; we will occasionally make appropriate assumptions about the presence of certain devices. Some devices may not be used both for input and for output. The number of words mentioned in the table above is a fixed block size associated with each unit.</p>

  <p class="indent">Input or output with magnetic tape, disk, or drum units reads or writes full words (five bytes and a sign). Input or output with units 16 through 20, however, is always done in a <em>character code</em> where each byte represents one alphameric character. Thus, five characters per <code>MIX</code> word are transmitted. The character code is given at the top of <a href="../Text/ch01b.html#ch01tab03">Table 1</a>, which appears at the close of this section and on the end papers of this book. The code 00 corresponds to <span class="ent">‘<span class="ent">⊔</span>’</span>, which denotes a <em>blank space</em>. Codes 01–29 are for the letters <code>A</code> through <code>Z</code> with a few Greek letters thrown in; codes 30–39 represent the digits <code>0, 1, ..., 9</code>; and further codes 40, 41, ... represent punctuation marks and other special characters. (<code>MIX</code>’s character set harks back to the days before computers could cope with lowercase letters.) We cannot use character code to read in or write out all possible values that a byte may have, since certain combinations are undefined. Moreover, some input-output devices may be unable to handle all the symbols in the character set; for example, the symbols º and ″ that appear amid the letters will perhaps not be acceptable to the card reader. When character-code input is being done, the signs of all words are set to +; on output, signs are ignored. If a typewriter is used for input, the “carriage return” that is typed at the end of each line causes the remainder of that line to be filled with blanks.</p>

  <p class="indent"><a id="page_137"></a>The disk and drum units are external memory devices each containing 100-word blocks. On every <code>IN, OUT</code>, or <code>IOC</code> instruction as defined below, the particular 100-word block referred to by the instruction is specified by the current contents of rX, which should not exceed the capacity of the disk or drum involved.</p>

  <p class="indenthangingB">• <code>IN</code> (input). C = 36; F = unit.</p>

  <p class="noindent">This instruction initiates the transfer of information from the input unit specified into consecutive locations starting with M. The number of locations transferred is the block size for this unit (see the table above). The machine will wait at this point if a preceding operation for the same unit is not yet complete. The transfer of information that starts with this instruction will not be complete until an unknown future time, depending on the speed of the input device, so a program must not refer to the information in memory until then. It is improper to attempt to read any block from magnetic tape that follows the latest block written on that tape.</p>

  <p class="indenthangingB">• <code>OUT</code> (output). C = 37; F = unit.</p>

  <p class="noindent">This instruction starts the transfer of information from memory locations starting at M to the output unit specified. The machine waits until the unit is ready, if it is not initially ready. The transfer will not be complete until an unknown future time, depending on the speed of the output device, so a program must not alter the information in memory until then.</p>

  <p class="indenthangingB">• <code>IOC</code> (input-output control). C = 35; F = unit.</p>

  <p class="noindent">The machine waits, if necessary, until the specified unit is not busy. Then a control operation is performed, depending on the particular device being used. The following examples are used in various parts of this book:</p>

  <p class="indent"><em>Magnetic tape</em>: If M = 0, the tape is rewound. If M &lt; 0 the tape is skipped backward −M blocks, or to the beginning of the tape, whichever comes first. If M &gt; 0, the tape is skipped forward; it is improper to skip forward over any blocks following the one last written on that tape.</p>

  <p class="indent">For example, the sequence ‘<code>OUT 1000(3); IOC -1(3); IN 2000(3)</code>’ writes out one hundred words onto tape 3, then reads it back in again. Unless the tape reliability is questioned, the last two instructions of that sequence are only a slow way to move words 1000–1099 to locations 2000–2099. The sequence ‘<code>OUT 1000(3)</code>; <code>IOC +1(3)</code>’ is improper.</p>

  <p class="indent"><em>Disk or drum:</em> M should be zero. The effect is to position the device according to rX so that the next <code>IN</code> or <code>OUT</code> operation on this unit will take less time if it uses the same rX setting.</p>

  <p class="indent"><em>Line printer:</em> M should be zero. ‘<code>IOC 0(18)</code>’ skips the printer to the top of the following page.</p>

  <p class="indent"><em>Paper tape:</em> M should be zero. ‘<code>IOC 0(20)</code>’ rewinds the tape.</p>

  <p class="indenthangingB">• <code>JRED</code> (jump ready). C = 38; F = unit.</p>

  <p class="noindent">A jump occurs if the specified unit is ready, that is, finished with the preceding operation initiated by <code>IN, OUT</code>, or <code>IOC</code>.</p>

  <p class="indenthangingB">• <code>JBUS</code> (jump busy). C = 34; F = unit.</p>

  <p class="noindent">Analogous to <code>JRED</code>, but the jump occurs when the specified unit is <em>not</em> ready.</p>

  <p class="indent"><a id="page_138"></a><em>Example:</em> In location 1000, the instruction ‘<code>JBUS 1000(16)</code>’ will be executed repeatedly until unit 16 is ready.</p>

  <p class="indent">The simple operations above complete <code>MIX</code>’s repertoire of input-output instructions. There is no “tape check” indicator, etc., to cover exceptional conditions on the peripheral devices. Any such condition (e.g., paper jam, unit turned off, out of tape, etc.) causes the unit to remain busy, a bell rings, and the skilled computer operator fixes things manually using ordinary maintenance procedures. Some more complicated peripheral units, which are more expensive and more representative of contemporary equipment than the fixed-block-size tapes, drums, and disks described here, are discussed in Sections 5.4.6 and 5.4.9.</p>

  <p class="noindent"><strong>Conversion Operators.</strong></p>

  <p class="indenthangingB">• <code>NUM</code> (convert to numeric). C = 5; F = 0.</p>

  <p class="noindent">This operation is used to change the character code into numeric code. M is ignored. Registers A and X are assumed to contain a 10-byte number in character code; the <code>NUM</code> instruction sets the magnitude of rA equal to the numerical value of this number (treated as a decimal number). The value of rX and the sign of rA are unchanged. Bytes 00, 10, 20, 30, 40, ... convert to the digit zero; bytes 01, 11, 21, ... convert to the digit one; etc. Overflow is possible, and in this case the remainder modulo <em>b</em><sup>5</sup> is retained, where <em>b</em> is the byte size.</p>

  <p class="indenthangingB">• <code>CHAR</code> (convert to characters). C = 5; F = 1.</p>

  <p class="noindent">This operation is used to change numeric code into character code suitable for output to punched cards or tape or the line printer. The value in rA is converted into a 10-byte decimal number that is put into registers A and X in character code. The signs of rA and rX are unchanged. M is ignored.</p>

  <div class="image"><img src="../Images/ch01/e138_01.jpg"></div>

  <p class="noindent"><strong>Timing.</strong> To give quantitative information about the efficiency of <code>MIX</code> programs, each of <code>MIX</code>’s operations is assigned an <em>execution time</em> typical of vintage-1970 computers.</p>

  <p class="indent"><code>ADD, SUB</code>, all <code>LOAD</code> operations, all <code>STORE</code> operations (including <code>STZ</code>), all shift commands, and all comparison operations take <em>two units</em> of time. <code>MOVE</code> requires one unit plus two for each word moved. <code>MUL</code>, <code>NUM</code>, <code>CHAR</code> each require 10 units and <code>DIV</code> requires 12. The execution time for floating point operations is specified in Section 4.2.1. All remaining operations take one unit of time, plus the time the computer may be idle on the <code>IN, OUT, IOC</code>, or <code>HLT</code> instructions.</p>

  <p class="indent">Notice in particular that <code>ENTA</code> takes one unit of time, while <code>LDA</code> takes two units. The timing rules are easily remembered because of the fact that, except <a id="page_139"></a>for shifts, conversions, <code>MUL</code>, and <code>DIV</code>, the number of time units equals the number of references to memory (including the reference to the instruction itself).</p>

  <p class="indent"><code>MIX</code>’s basic unit of time is a relative measure that we will denote simply by <em>u</em>. It may be regarded as, say, 10 microseconds (for a relatively inexpensive computer) or as 10 nanoseconds (for a relatively high-priced machine).</p>

  <p class="indent"><em>Example:</em> The sequence <code>LDA 1000; INCA 1; STA 1000</code> takes exactly 5<em>u</em>.</p>

  <p class="blockquote"><span class="roman_italic">And now I see with eye serene</span><br>
  <span class="roman_italic">The very pulse of the machine.</span></p>

  <p class="attribution">— WILLIAM WORDSWORTH,<br>
  <span class="roman_italic">She Was a Phantom of Delight</span> (1804)</p>

  <p class="noindent"><strong>Summary.</strong> We have now discussed all the features of <code>MIX</code>, except for its “<code>GO</code> button,” which is discussed in <a href="../Text/ch01b.html#ch01ex_2_12_26">exercise 26</a>. Although <code>MIX</code> has nearly 150 different operations, they fit into a few simple patterns so that they can easily be remembered. <a href="../Text/ch01b.html#ch01tab03">Table 1</a> summarizes the operations for each C-setting. The name of each operator is followed in parentheses by its default F-field.</p>

  <div class="image4">
    <a id="page_140"></a><a id="page_141"></a><a id="ch01tab03"></a><img class="img1" src="../Images/ch01/140tab01.jpg">

    <p class="tab-caption"><strong>Table 1</strong></p>
  </div>

  <p class="indent">The following exercises give a quick review of the material in this section. They are mostly quite simple, and the reader should try to do nearly all of them.</p>

  <p class="ex-title">Exercises</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_12_1a" id="ch01ex_2_12_1">1</a>.</strong> [<em>00</em>] If <code>MIX</code> were a ternary (base 3) computer, how many “trits” would there be per byte?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_12_2a" id="ch01ex_2_12_2">2</a>.</strong> [<em>02</em>] If a value to be represented within <code>MIX</code> may get as large as 99999999, how many adjacent bytes should be used to contain this quantity?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_12_3a" id="ch01ex_2_12_3">3</a>.</strong> [<em>02</em>] Give the partial field specifications, (L:R), for the (a) address field, (b) index field, (c) field field, and (d) operation code field of a <code>MIX</code> instruction.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_12_4a" id="ch01ex_2_12_4">4</a>.</strong> [<em>00</em>] The last example in (<a href="../Text/ch01b.html#ch01eq-lev2sec12-5">5</a>) is ‘<code>LDA -2000,4</code>’. How can this be legitimate, in view of the fact that memory addresses should not be negative?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_12_5a" id="ch01ex_2_12_5">5</a>.</strong> [<em>10</em>] What symbolic notation, analogous to (<a href="../Text/ch01b.html#ch01eq-lev2sec12-4">4</a>), corresponds to (<a href="../Text/ch01b.html#ch01eq-lev2sec12-6">6</a>) if (<a href="../Text/ch01b.html#ch01eq-lev2sec12-6">6</a>) is regarded as a <code>MIX</code> instruction?</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_12_6a" id="ch01ex_2_12_6">6</a>.</strong> [<em>10</em>] Assume that location 3000 contains</p>

  <div class="image"><img src="../Images/ch01/e139_01.jpg"></div>

  <p class="exercisesp">What is the result of the following instructions? (State if any of them are undefined or only partially defined.) (a) <code>LDAN 3000</code>; (b) <code>LD2N 3000(3:4)</code>; (c) <code>LDX 3000(1:3)</code>; (d) <code>LD6 3000</code>; (e) <code>LDXN 3000(0:0)</code>.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_12_7a" id="ch01ex_2_12_7">7</a>.</strong> [<em>M15</em>] Give a precise definition of the results of the <code>DIV</code> instruction for all cases in which overflow does not occur, using the algebraic operations <em>X</em> mod <em>Y</em> and <span class="middle"><img src="../Images/ch01/en0470_01.jpg"></span><em>X/Y</em><span class="middle"><img src="../Images/ch01/en0470_02.jpg"></span>.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_12_8a" id="ch01ex_2_12_8">8</a>.</strong> [<em>15</em>] The last example of the <code>DIV</code> instruction that appears on page <a href="../Text/ch01b.html#page_133">133</a> has “rX before” equal to <span class="middle"><img src="../Images/ch01/e139_02.jpg"></span>. If this were <span class="middle"><img src="../Images/ch01/e139_03.jpg"></span> instead, but other parts of that example were unchanged, what would registers A and X contain after the <code>DIV</code> instruction?</p>

  <p class="exercises2"><a id="page_142"></a><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_12_9a" id="ch01ex_2_12_9">9</a>.</strong> [<em>15</em>] List all the <code>MIX</code> operators that can possibly affect the setting of the overflow toggle. (Do not include floating point operators.)</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_12_10a" id="ch01ex_2_12_10">10</a>.</strong> [<em>15</em>] List all the <code>MIX</code> operators that can possibly affect the setting of the comparison indicator.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_12_11a" id="ch01ex_2_12_11">11</a>.</strong> [<em>15</em>] List all the <code>MIX</code> operators that can possibly affect the setting of rI1.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_12_12a" id="ch01ex_2_12_12">12</a>.</strong> [<em>10</em>] Find a single instruction that has the effect of multiplying the current contents of rI3 by two and leaving the result in rI3.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_12_13a" id="ch01ex_2_12_13">13</a>.</strong> [<em>10</em>] Suppose location 1000 contains the instruction ‘<code>JOV 1001</code>’. This instruction turns off the overflow toggle if it is on (and the next instruction executed will be in location 1001, in any case). If this instruction were changed to ‘<code>JNOV 1001</code>’, would there be any difference? What if it were changed to ‘<code>JOV 1000</code>’ or ‘<code>JNOV 1000</code>’?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_12_14a" id="ch01ex_2_12_14">14</a>.</strong> [<em>20</em>] For each <code>MIX</code> operation, consider whether there is a way to set the ±AA, I, and F portions so that the result of the instruction is precisely equivalent to <code>NOP</code> (except that the execution time may be longer). Assume that nothing is known about the contents of any registers or any memory locations. Whenever it is possible to produce a <code>NOP</code>, state how it can be done. <em>Examples:</em> <code>INCA</code> is a no-op if the address and index parts are zero. <code>JMP</code> can never be a no-op, since it affects rJ.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_12_15a" id="ch01ex_2_12_15">15</a>.</strong> [<em>10</em>] How many <em>alphameric characters</em> are there in a typewriter or paper-tape block? in a card-reader or card-punch block? in a line-printer block?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_12_16a" id="ch01ex_2_12_16">16</a>.</strong> [<em>20</em>] Write a program that sets memory cells 0000–0099 all to zero and is (a) as short a program as possible; (b) as fast a program as possible. [<em>Hint:</em> Consider using the <code>MOVE</code> command.]</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_12_17a" id="ch01ex_2_12_17">17</a>.</strong> [<em>26</em>] This is the same as the previous exercise, except that locations 0000 through <em>N</em>, inclusive, are to be set to zero, where <em>N</em> is the current contents of rI2. Your programs (a) and (b) should work for any value 0 ≤ <em>N</em> ≤ 2999; they should start in location 3000.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_12_18a" id="ch01ex_2_12_18">18</a>.</strong> [<em>22</em>] After the following “number one” program has been executed, what changes to registers, toggles, and memory have taken place? (For example, what is the final setting of rI1? of rX? of the overflow and comparison indicators?)</p>

  <p class="uln-indent"><code>STZ 1</code></p>

  <p class="uln-indent"><code>ENNX 1</code></p>

  <p class="uln-indent"><code>STX 1(0:1)</code></p>

  <p class="uln-indent"><code>SLAX 1</code></p>

  <p class="uln-indent"><code>ENNA 1</code></p>

  <p class="uln-indent"><code>INCX 1</code></p>

  <p class="uln-indent"><code>ENT1 1</code></p>

  <p class="uln-indent"><code>SRC 1</code></p>

  <p class="uln-indent"><code>ADD 1</code></p>

  <p class="uln-indent"><code>DEC1 -1</code></p>

  <p class="uln-indent"><code>STZ 1</code></p>

  <p class="uln-indent"><code>CMPA 1</code></p>

  <p class="uln-indent"><code>MOVE -1,1(1)</code></p>

  <p class="uln-indent"><code>NUM 1</code></p>

  <p class="uln-indent"><code>CHAR 1</code></p>

  <p class="uln-indent"><code>HLT 1</code> <span class="middle"><img src="../Images/ch01/common-01.jpg"></span></p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_12_19a" id="ch01ex_2_12_19">19</a>.</strong> [<em>14</em>] What is the execution time of the program in the preceding exercise, not counting the <code>HLT</code> instruction?</p>

  <p class="exercises1"><a id="page_143"></a><strong><a href="../Text/app01.html#ch01ex_2_12_20a" id="ch01ex_2_12_20">20</a>.</strong> [<em>20</em>] Write a program that sets <em>all</em> 4000 memory cells equal to a ‘<code>HLT</code>’ instruction, and then stops.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_12_21a" id="ch01ex_2_12_21">21</a>.</strong> [<em>24</em>] (a) Can the J-register ever be zero? (b) Write a program that, given a number <em>N</em> in rI4, sets register J equal to <em>N</em>, assuming that 0 &lt; <em>N</em> ≤ 3000. Your program should start in location 3000. When your program has finished its execution, the contents of all memory cells must be unchanged.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_12_22a" id="ch01ex_2_12_22">22</a>.</strong> [<em>28</em>] Location 2000 contains an integer number, <em>X</em>. Write two programs that compute <em>X</em><sup>13</sup> and halt with the result in register A. One program should use the minimum number of <code>MIX</code> memory locations; the other should require the minimum execution time possible. Assume that <em>X</em><sup>13</sup> fits into a single word.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_12_23a" id="ch01ex_2_12_23">23</a>.</strong> [<em>27</em>] Location 0200 contains a word</p>

  <div class="image"><img src="../Images/ch01/e143_01.jpg"></div>

  <p class="exercisesp">write two programs that compute the “reflected” word</p>

  <div class="image"><img src="../Images/ch01/e143_02.jpg"></div>

  <p class="exercisesp">and halt with the result in register A. One program should do this without using <code>MIX</code>’s ability to load and store partial fields of words. Both programs should take the minimum possible number of memory locations under the stated conditions (including all locations used for the program and for temporary storage of intermediate results).</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_12_24a" id="ch01ex_2_12_24">24</a>.</strong> [<em>21</em>] Assuming that registers A and X contain</p>

  <div class="image"><img src="../Images/ch01/e143_03.jpg"></div>

  <p class="exercisesp">respectively, write two programs that change the contents of these registers to</p>

  <div class="image"><img src="../Images/ch01/e143_04.jpg"></div>

  <p class="exercisesp">respectively, using (a) minimum memory space and (b) minimum execution time.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_12_25a" id="ch01ex_2_12_25">25</a>.</strong> [<em>30</em>] Suppose that the manufacturer of <code>MIX</code> wishes to come out with a more powerful computer (“Mixmaster”?), and he wants to convince as many as possible of those people now owning a <code>MIX</code> computer to invest in the more expensive machine. He wants to design this new hardware to be an <em>extension</em> of <code>MIX</code>, in the sense that all programs correctly written for <code>MIX</code> will work on the new machines without change. Suggest desirable things that could be incorporated in this extension. (For example, can you make better use of the I-field of an instruction?)</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_12_26a" id="ch01ex_2_12_26">26</a>.</strong> [<em>32</em>] This problem is to write a card-loading routine. Every computer has its own peculiar “bootstrapping” problems for getting information initially into the machine and for starting a job correctly. In <code>MIX</code>’s case, the contents of a card can be read only in character code, and the cards that contain the loading program itself must meet this restriction. Not all possible byte values can be read from a card, and each word read in from cards is positive.</p>

  <p class="exercises1N"><code>MIX</code> has one feature that has not been explained in the text: There is a “<code>GO</code> button,” which is used to get the computer started from scratch when its memory contains arbitrary information. When this button is pushed by the computer operator, the following actions take place:</p>

  <p class="indenthangingA">1) A single card is read into locations 0000–0015; this is essentially equivalent to the instruction ‘<code>IN 0(16)</code>’.</p>

  <p class="indenthangingA"><a id="page_144"></a>2) When the card has been completely read and the card reader is no longer busy, a <code>JMP</code> to location 0000 occurs. The J-register is also set to zero, and the overflow toggle is cleared.</p>

  <p class="indenthangingA">3) The machine now begins to execute the program it has read from the card.</p>

  <p class="noindent"><em>Note:</em> <code>MIX</code> computers without card readers have their <code>GO</code>-button attached to another input device. But in this problem we will assume the presence of a card reader, unit 16.</p>

  <p class="indent">The loading routine to be written must satisfy the following conditions:</p>

  <p class="exercises1I">i) The input deck should begin with the loading routine, followed by information cards containing the numbers to be loaded, followed by a “transfer card” that shuts down the loading routine and jumps to the beginning of the program. The loading routine should fit onto two cards.</p>

  <p class="exercises1I">ii) The information cards have the following format:</p>

  <p class="uln-indent4">Columns 1–5, ignored by the loading routine.</p>

  <p class="uln-indent4">Column 6, the number of consecutive words to be loaded on this card (a number between 1 and 7, inclusive).</p>

  <p class="uln-indent4">Columns 7–10, the location of word 1, which is always greater than 100 (so that it does not overlay the loading routine).</p>

  <p class="uln-indent4">Columns 11–20, word 1.</p>

  <p class="uln-indent4">Columns 21–30, word 2 (if column 6 ≥ 2).</p>

  <p class="uln-indent4">· · ·</p>

  <p class="uln-indent4">Columns 71–80, word 7 (if column 6 = 7).</p>

  <p class="noindent">The contents of words 1, 2, ... are punched numerically as decimal numbers. If a word is to be negative, a minus (“11-punch”) is <em>overpunched</em> over the least significant digit, e.g., in column 20. Assume that this causes the character code input to be 10, 11, 12, ..., 19 rather than 30, 31, 32, ..., 39. For example, a card that has</p>

  <div class="image"><img src="../Images/ch01/e144_01.jpg"></div>

  <p class="noindent">punched in columns 1–40 should cause the following data to be loaded:</p>

  <p class="center">1000:&nbsp;&nbsp;&nbsp;+0123456789;&nbsp;&nbsp;&nbsp;&nbsp;1001:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+0000000001;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1002:&nbsp;&nbsp;&nbsp;−0000000100.</p>

  <p class="exercises1I">iii) The transfer card has the format <code>TRANS0</code>nnnn in columns 1–10, where nnnn is the place where execution should start.</p>

  <p class="exercises1I">iv) The loading routine should work for all byte sizes without any changes to the cards bearing the loading routine. No card should contain any of the characters corresponding to bytes 20, 21, 48, 49, 50, ... (namely, the characters º, ″, <code>=, $, &lt;</code>, ...), since these characters cannot be read by all card readers. In particular, the <code>ENT, INC</code>, and <code>CMP</code> instructions cannot be used; they can’t necessarily be punched on a card.</p>

  <div class="heading">
    <h4 id="ch01lev2sec13">1.3.2. The <span class="EmpStrong">MIX</span> Assembly Language</h4>

    <p class="noindent">A symbolic language is used to make <code>MIX</code> programs considerably easier to read and to write, and to save the programmer from worrying about tedious clerical details that often lead to unnecessary errors. This language, <code>MIXAL</code> (“<code>MIX</code> Assembly Language”), is an extension of the notation used for instructions in the previous section. Its main features are the optional use of alphabetic names to stand for numbers, and a location field to associate names with memory locations.</p>
  </div>

  <p class="indent"><a id="page_145"></a><code>MIXAL</code> can readily be comprehended if we consider first a simple example. The following code is part of a larger program; it is a subroutine to find the maximum of <em>n</em> elements <em>X</em>[1]<em>, ..., X</em> [<em>n</em>], according to <a href="../Text/ch01a.html#ch01alg-lev2sec10-M">Algorithm 1.2.10M</a>.</p>

  <p class="noindent"><strong><a id="ch01b_pro_m"></a>Program M</strong> (<em>Find the maximum</em>). Register assignments: rA ≡ <em>m</em>, rI1 ≡ <em>n</em>, rI2 ≡ <em>j</em>, rI3 ≡ <em>k</em>, <em>X</em>[<em>i</em>] ≡ <code>CONTENTS(X</code> + <em>i</em>).</p>

  <div class="image"><img src="../Images/ch01/e145_01.jpg"></div>

  <p class="indent">This program is an example of several things simultaneously:</p>

  <p class="exercises1I">a) The columns headed “<code>LOC</code>”, “<code>OP</code>”, and “<code>ADDRESS</code>” are of principal interest; they contain a program in the <code>MIXAL</code> symbolic machine language, and we shall explain the details of this program below.</p>

  <p class="exercises1I">b) The column headed “Assembled instructions” shows the actual numeric machine language that corresponds to the <code>MIXAL</code> program. <code>MIXAL</code> has been designed so that any <code>MIXAL</code> program can easily be translated into numeric machine language; the translation is usually carried out by another computer program called an <em>assembly program</em> or <em>assembler</em>. Thus, programmers may do all of their machine language programming in <code>MIXAL</code>, never bothering to determine the equivalent numeric codes by hand. Virtually all <code>MIX</code> programs in this book are written in <code>MIXAL</code>.</p>

  <p class="exercises1I">c) The column headed “Line no.” is not an essential part of the <code>MIXAL</code> program; it is merely included with <code>MIXAL</code> examples in this book so that we can readily refer to parts of the program.</p>

  <p class="exercises1I">d) The column headed “Remarks” gives explanatory information about the program, and it is cross-referenced to the steps of <a href="../Text/ch01a.html#ch01alg-lev2sec10-M">Algorithm 1.2.10M</a>. The reader should compare that algorithm (page <a href="../Text/ch01a.html#page_96">96</a>) with the program above. Notice that a little “programmer’s license” was used during the transcription into <code>MIX</code> code; for example, step M2 has been put last. The “register assignments” stated at the beginning of <a href="../Text/ch01b.html#ch01b_pro_m">Program M</a> show what components of <code>MIX</code> correspond to the variables in the algorithm.</p>

  <p class="exercises1I">e) The column headed “Times” will be instructive in many of the <code>MIX</code> programs we will be studying in this book; it represents the <em>profile</em>, the number of times the instruction on that line will be executed during the course of the program. Thus, <a id="page_146"></a>line 06 will be performed <em>n</em>–1 times, etc. From this information we can determine the length of time required to perform the subroutine; it is (5+5<em>n</em> + 3 <em>A</em>)<em>u</em>, where <em>A</em> is the quantity that was carefully analyzed in <a href="../Text/ch01a.html#ch01lev2sec10">Section 1.2.10</a>.</p>

  <p class="indent">Now let’s discuss the <code>MIXAL</code> part of <a href="../Text/ch01b.html#ch01b_pro_m">Program M</a>. Line 01,</p>

  <p class="center"><code>X EQU 1000</code>,</p>

  <p class="noindent">says that symbol <code>X</code> is to be <em>equivalent</em> to the number 1000. The effect of this may be seen on line 06, where the numeric equivalent of the instruction <code>‘CMPA X,3’</code> appears as</p>

  <div class="image"><img src="../Images/ch01/e146_01.jpg"></div>

  <p class="noindent">that is, ‘<code>CMPA 1000,3</code>’.</p>

  <p class="indent">Line 02 says that the locations for succeeding lines should be chosen sequentially, originating with 3000. Therefore the symbol <code>MAXIMUM</code> that appears in the <code>LOC</code> field of line 03 becomes equivalent to the number 3000, <code>INIT</code> is equivalent to 3001, <code>LOOP</code> is equivalent to 3003, etc.</p>

  <p class="indent">On lines 03 through 12 the <code>OP</code> field contains the symbolic names of <code>MIX</code> instructions: <code>STJ, ENT3</code>, etc. But the symbolic names <code>EQU</code> and <code>ORIG</code>, which appear in the <code>OP</code> column of lines 01 and 02, are somewhat different; <code>EQU</code> and <code>ORIG</code> are called <em>pseudo-operations</em>, because they are operators of <code>MIXAL</code> but not of <code>MIX</code>. Pseudo-operations provide special information about a symbolic program, without being instructions of the program itself. Thus the line</p>

  <p class="center"><code>X EQU 1000</code></p>

  <p class="noindent">only talks <em>about</em> <a href="../Text/ch01b.html#ch01b_pro_m">Program M</a>, it does not signify that any variable is to be set equal to 1000 when the program is run. Notice that no instructions are assembled for lines 01 and 02.</p>

  <p class="indent">Line 03 is a “store J” instruction that stores the contents of register J into the (0:2) field of location <code>EXIT</code>. In other words, it stores rJ into the address part of the instruction found on line 12.</p>

  <p class="indent">As mentioned earlier, <a href="../Text/ch01b.html#ch01b_pro_m">Program M</a> is intended to be part of a larger program; elsewhere the sequence</p>

  <p class="center"><code>&nbsp;ENT1 100</code><br>
  <code>&nbsp;&nbsp;&nbsp;&nbsp;JMP MAXIMUM</code><br>
  <code>STA MAX</code></p>

  <p class="noindent">would, for example, jump to <a href="../Text/ch01b.html#ch01b_pro_m">Program M</a> with <em>n</em> set to 100. <a href="../Text/ch01b.html#ch01b_pro_m">Program M</a> would then find the largest of the elements <em>X</em>[1]<em>, ..., X</em> [100] and would return to the instruction ‘<code>STA MAX</code>’ with the maximum value in rA and with its position, <em>j</em>, in rI2. (See <a href="../Text/ch01b.html#ch01ex_2_13_3">exercise 3</a>.)</p>

  <p class="indent">Line 05 jumps the control to line 08. Lines 04, 05, 06 need no further explanation. Line 07 introduces a new notation: An asterisk (read “self”) refers to the location of the line on which it appears; ‘<code>*+3</code>’ (“self plus three”) therefore refers to three locations past the current line. Since line 07 is an instruction that corresponds to location 3004, the ‘<code>*+3</code>’ appearing there refers to location 3007.</p>

  <p class="indent">The rest of the symbolic code is self-explanatory. Notice the appearance of an asterisk again on line 12 (see <a href="../Text/ch01b.html#ch01ex_2_13_2">exercise 2</a>).</p>

  <p class="indent"><a id="page_147"></a>Our next example introduces a few more features of the assembly language. The object is to compute and print a table of the first 500 prime numbers, with 10 columns of 50 numbers each. The table should appear as follows on the line printer:</p>

  <p class="pre">FIRST FIVE HUNDRED PRIMES<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0002 0233 0547 0877 1229 1597 1993 2371 2749 3187<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0003 0239 0557 0881 1231 1601 1997 2377 2753 3191<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0005 0241 0563 0883 1237 1607 1999 2381 2767 3203<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0007 0251 0569 0887 1249 1609 2003 2383 2777 3209<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0011 0257 0571 0907 1259 1613 2011 2389 2789 3217<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0229 0541 0863 1223 1583 1987 2357 2741 3181 3571</p>

  <p class="noindent">We will use the following method.</p>

  <p class="noindent"><a id="ch01alg-lev2sec13-P"></a><strong>Algorithm P</strong> (<em>Print table of 500 primes</em>). This algorithm has two distinct parts: Steps P1–P8 prepare an internal table of 500 primes, and steps P9–P11 print the answer in the form shown above. The latter part uses two “buffers,” in which line images are formed; while one buffer is being printed, the other one is being filled.</p>

  <p class="indenthanging"><strong>P1.</strong> [Start table.] Set <code>PRIME[1]</code> ← 2, <code>N</code> ← 3, <code>J</code> ← 1. (In the following steps, N will run through the odd numbers that are candidates for primes; J will keep track of how many primes have been found so far.)</p>

  <p class="indenthanging"><strong>P2.</strong> [<code>N</code> is prime.] Set <code>J</code> ← <code>J</code> + 1, <code>PRIME[J]</code> ← <code>N</code>.</p>

  <p class="indenthanging"><strong>P3.</strong> [500 found?] If <code>J</code> = 500, go to step P9.</p>

  <p class="indenthanging"><strong>P4.</strong> [Advance <code>N</code>.] Set <code>N</code> ← <code>N</code> + 2.</p>

  <p class="indenthanging"><strong>P5.</strong> [<code>K</code> ← 2.] Set <code>K</code> ← 2. (<code>PRIME[K]</code> will run through the possible prime divisors of <code>N</code>.)</p>

  <p class="indenthanging"><strong>P6.</strong> [<code>PRIME[K]\N</code>?] Divide <code>N</code> by <code>PRIME[K]</code>; let <code>Q</code> be the quotient and <code>R</code> the remainder. If <code>R</code> = 0 (hence N is not prime), go to P4.</p>

  <p class="indenthanging"><strong>P7.</strong> [<code>PRIME[K]</code> large?] If <code>Q</code> ≤ <code>PRIME[K]</code>, go to P2. (In such a case, N must be prime; the proof of this fact is interesting and a little unusual — see <a href="../Text/ch01b.html#ch01ex_2_13_6">exercise 6</a>.)</p>

  <p class="indenthanging"><strong>P8.</strong> [Advance <code>K</code>.] Increase <code>K</code> by 1, and go to P6.</p>

  <p class="indenthanging"><a id="ch01p09"></a><strong>P9.</strong> [Print title.] Now we are ready to print the table. Advance the printer to the next page. Set <code>BUFFER[0]</code> to the title line and print this line. Set <code>B ← 1, M ← 1</code>.</p>

  <p class="indenthanging1"><strong>P10.</strong> [Set up line.] Put <code>PRIME[M]</code>, <code>PRIME[50 + M], ..., PRIME[450 + M]</code> into <code>BUFFER[B]</code> in the proper format.</p>

  <p class="indenthanging1"><strong>P11.</strong> [Print line.] Print <code>BUFFER[B]</code>; set <code>B ← 1 – B</code> (thereby switching to the other buffer); and increase <code>M</code> by 1. If <code>M</code> ≤ 50, return to P10; otherwise the algorithm terminates. <span class="middle"><img src="../Images/ch01/common-01.jpg"></span></p>

  <div class="image">
    <a id="page_148"></a><a id="ch01fig14"></a><img src="../Images/ch01/01fig14.jpg">

    <p class="fig-caption"><strong>Fig. 14.</strong> <a href="../Text/ch01b.html#ch01alg-lev2sec13-P">Algorithm P</a>.</p>
  </div>

  <p class="noindent"><a id="ch01b_pro_p"></a><strong>Program P</strong> (<em>Print table of 500 primes</em>). This program has deliberately been written in a slightly clumsy fashion in order to illustrate most of the features of <code>MIXAL</code> in a single program. rI1 ≡ <code>J</code> – 500; rI2 ≡ <code>N</code>; rI3 ≡ <code>K</code>; rI4 indicates <code>B</code>; rI5 is <code>M</code> plus multiples of 50.</p>

  <div class="image"><img src="../Images/ch01/148pre01.jpg"></div>

  <div class="image"><a id="page_149"></a><img src="../Images/ch01/148pre01a.jpg"></div>

  <p class="indent">The following points of interest should be noted about this program:</p>

  <p class="number">1. Lines 01, 02, and 39 begin with an asterisk: This signifies a “comment” line that is merely explanatory, having no actual effect on the assembled program.</p>

  <p class="number">2. As in <a href="../Text/ch01b.html#ch01b_pro_m">Program M</a>, the pseudo-operation <code>EQU</code> in line 03 sets the equivalent of a symbol; in this case, the equivalent of <code>L</code> is set to 500. (In the program of lines 10–24, L represents the number of primes to be computed.) Notice that in line 05 the symbol <code>PRIME</code> gets a <em>negative</em> equivalent; the equivalent of a symbol may be any signed five-byte number. In line 07 the equivalent of <code>BUF1</code> is calculated as <code>BUF0+25</code>, namely <code>2025. MIXAL</code> provides a limited amount of arithmetic on numbers; another example appears on line 13, where the value of <code>PRIME+L</code> (in this case, 499) is calculated by the assembly program.</p>

  <p class="number">3. The symbol <code>PRINTER</code> has been used in the F-part on lines 09, 25, and 35. The F-part, which is always enclosed in parentheses, may be numeric or symbolic, just as the other portions of the <code>ADDRESS</code> field are. Line 31 illustrates the partial field specification ‘(<code>1:4</code>)’, using a colon.</p>

  <p class="number">4. <code>MIXAL</code> provides several ways to specify non-instruction words. Line 41 uses the pseudo-operation <code>CON</code> to specify an ordinary constant, ‘2’; the result of <a id="page_150"></a>line 41 is to assemble the word</p>

  <div class="image"><img src="../Images/ch01/e150_01.jpg"></div>

  <p class="noindent">Line 49 shows a slightly more complicated constant, ‘<code>BUF1+10</code>’, which assembles as the word</p>

  <div class="image"><img src="../Images/ch01/e150_02.jpg"></div>

  <p class="indent">A constant may be enclosed in equal signs, in which case we call it a <em>literal constant</em> (see lines 10 and 11). The assembler automatically creates internal names and inserts ‘<code>CON</code>’ lines for literal constants. For example, lines 10 and 11 of <a href="../Text/ch01b.html#ch01b_pro_p">Program P</a> are effectively changed to</p>

  <div class="image"><img src="../Images/ch01/e150_03a.jpg"></div>

  <p class="noindent">and then at the end of the program, between lines 51 and 52, the lines</p>

  <div class="image"><img src="../Images/ch01/e150_03.jpg"></div>

  <p class="noindent">are effectively inserted as part of the assembly procedure (possibly with con2 first). Line 51a will assemble into the word</p>

  <div class="image"><img src="../Images/ch01/e150_05.jpg"></div>

  <p class="indent">The use of literal constants is a decided convenience, because it means that programmers do not have to invent symbolic names for trivial constants, nor do they have to remember to insert constants at the end of each program. Programmers can keep their minds on the central problems and not worry about such routine details. (However, the literal constants in <a href="../Text/ch01b.html#ch01b_pro_p">Program P</a> aren’t especially good examples, because we would have had a slightly better program if we had replaced lines 10 and 11 by the more efficient commands ‘<code>ENT1 1-L</code>’ and ‘<code>ENT2 3</code>’.)</p>

  <p class="number">5. A good assembly language should mimic the way a programmer <em>thinks</em> about machine programs. One example of this philosophy is the use of literal constants, as we have just mentioned; another example is the use of ‘<code>*</code>’, which was explained in <a href="../Text/ch01b.html#ch01b_pro_m">Program M</a>. A third example is the idea of <em>local symbols</em> such as the symbol <code>2H</code>, which appears in the location field of lines 12, 25, and 28.</p>

  <p class="indent">Local symbols are special symbols whose equivalents can be <em>redefined</em> as many times as desired. A global symbol like <code>PRIME</code> has but one significance throughout a program, and if it were to appear in the location field of more than one line an error would be indicated by the assembler. But local symbols have a different nature; we write, for example, 2H (“2 here”) in the location field, and <code>2F</code> (“2 forward”) or <code>2B</code> (“2 backward”) in the address field of a <code>MIXAL</code> line:</p>

  <p class="center"><code>2B</code> means the closest <em>previous</em> location <code>2H</code>;<br>
  &nbsp;&nbsp;<code>2F</code> means the closest <em>following</em> location <code>2H</code>.</p>

  <p class="noindent"><a id="page_151"></a>Thus the ‘<code>2F</code>’ in line 14 refers to line 25; the ‘<code>2B</code>’ in line 24 refers back to line 12; and the ‘<code>2B</code>’ in line 37 refers to line 28. An address of <code>2F</code> or <code>2B</code> never refers to its <em>own</em> line; for example, the three lines of <code>MIXAL</code> code</p>

  <div class="image"><img src="../Images/ch01/e151_01.jpg"></div>

  <p class="noindent">are virtually equivalent to the single line</p>

  <p class="center"><code>MOVE *-3(10).</code></p>

  <p class="indent">The symbols <code>2F</code> and <code>2B</code> should never be used in the location field; the symbol <code>2H</code> should never be used in the address field. There are ten local symbols, which can be obtained by replacing ‘<code>2</code>’ in these examples by any digit from <code>0</code> to <code>9.</code></p>

  <p class="indent">The idea of local symbols was introduced by M. E. Conway in 1958, in connection with an assembly program for the UNIVAC I. Local symbols relieve programmers from the necessity of choosing symbolic names for every address, when all they want to do is refer to an instruction a few lines away. There often is no appropriate name for nearby locations, so programmers have tended to introduce meaningless symbols like <code>X1</code>, <code>X2</code>, <code>X3</code>, etc., with the potential danger of duplication. Local symbols are therefore quite useful and natural in an assembly language.</p>

  <p class="number">6. The address part of lines 30 and 38 is blank. This means that the assembled address will be zero. We could have left the address blank in line 17 as well, but the program would have been less readable without the redundant <code>0</code>.</p>

  <p class="number">7. Lines 43–47 use the pseudo-operation <code>ALF</code>, which creates a five-byte constant in <code>MIX</code> alphameric character code. For example, line 45 causes the word</p>

  <div class="image"><img src="../Images/ch01/e151_02.jpg"></div>

  <p class="noindent">to be assembled, representing ‘<span class="ent">⊔</span><code>HUND</code>’ — part of the title line in <a href="../Text/ch01b.html#ch01b_pro_p">Program P</a>’s output.</p>

  <p class="indent"><em>All locations whose contents are not specified in the <span class="EmpItalic">MIXAL</span> program are ordinarily set to positive zero</em> (except the locations that are used by the loading routine, usually 3700–3999). Thus there is no need to set the other words of the title line to blanks, after line 47.</p>

  <p class="number">8. Arithmetic may be used together with <code>ORIG</code>: See lines 40, 42, 48, and 50.</p>

  <p class="number">9. The last line of a complete <code>MIXAL</code> program always has the <code>OP</code>-code ‘<code>END</code>’. The address on this line is the location at which the program is to begin, once it has been loaded into memory.</p>

  <p class="number1">10. As a final note about <a href="../Text/ch01b.html#ch01b_pro_p">Program P</a>, we can observe that the instructions have been organized so that index registers are counted towards zero, and tested against zero, whenever possible. For example, the quantity <code>J-500</code>, not <code>J</code>, is kept in rI1. Lines 26–34 are particularly noteworthy, although perhaps a bit tricky.</p>

  <p class="indent"><a id="page_152"></a>It may be of interest to note a few of the statistics observed when <a href="../Text/ch01b.html#ch01b_pro_p">Program P</a> was actually run. The division instruction in line 19 was executed 9538 times; the time to perform lines 10-24 was 182144<em>u</em>.</p>

  <p class="indent"><code>MIXAL</code> programs can be punched onto cards or typed on a computer terminal, as shown in <a href="../Text/ch01b.html#ch01fig15">Fig. 15</a>. The following format is used in the case of punched cards:</p>

  <div class="image"><img src="../Images/ch01/e152_01.jpg"></div>

  <div class="image4">
    <a id="ch01fig15"></a><img class="img1" src="../Images/ch01/01fig15.jpg">

    <p class="fig-caption"><strong>Fig. 15.</strong> The first lines of <a href="../Text/ch01b.html#ch01b_pro_p">Program P</a> punched onto cards, or typed on a terminal.</p>
  </div>

  <p class="noindent">However, if column 1 contains an asterisk, the entire card is treated as a comment. The <code>ADDRESS</code> field ends with the first blank column following column 16; any explanatory information may be punched to the right of this first blank column with no effect on the assembled program. <em>(Exception:</em> When the <code>OP</code> field is <code>ALF</code>, the remarks always start in column 22.)</p>

  <p class="indent">When the input comes from a terminal, a less restrictive format is used: The <code>LOC</code> field ends with the first blank space, while the <code>OP</code> and <code>ADDRESS</code> fields (if present) begin with a nonblank character and continue to the next blank; the special <code>OP</code>-code <code>ALF</code> is, however, followed either by two blank spaces and five characters of alphameric data, or by a single blank space and five alphameric <a id="page_153"></a>characters, the first of which is nonblank. The remainder of each line contains optional remarks.</p>

  <p class="indent">The <code>MIX</code> assembly program accepts input files prepared in this manner and converts them to machine language programs in loadable form. Under favorable circumstances the reader will have access to a <code>MIX</code> assembler and <code>MIX</code> simulator, on which various exercises in this book can be worked out.</p>

  <p class="indent">Now we have seen what can be done in <code>MIXAL</code>. We conclude this section by describing the rules more carefully, and in particular we shall observe what is <em>not</em> allowed in <code>MIXAL</code>. The following comparatively few rules define the language.</p>

  <p class="number">1. A <em>symbol</em> is a string of one to ten letters and/or digits, containing at least one letter. <em>Examples:</em> <code>PRIME</code>, <code>TEMP</code>, <code>20BY20</code>. The special symbols <em>d</em><code>H</code>, <em>d</em><code>F</code>, and <em>d</em><code>B</code>, where <em>d</em> is a single digit, will for the purposes of this definition be replaced by other unique symbols according to the “local symbol” convention described earlier.</p>

  <p class="number">2. A <em>number</em> is a string of one to ten digits. <em>Example:</em> <code>00052</code>.</p>

  <p class="number">3. Each appearance of a symbol in a <code>MIXAL</code> program is said to be either a “defined symbol” or a “future reference.” A <em>defined symbol</em> is a symbol that has appeared in the <code>LOC</code> field of a preceding line of this <code>MIXAL</code> program. A <em>future reference</em> is a symbol that has not yet been defined in this way.</p>

  <p class="number">4. An <em>atomic expression</em> is either</p>

  <p class="indenthangingAB">a) a number, or</p>

  <p class="indenthangingAB">b) a defined symbol (denoting the numerical equivalent of that symbol, see rule 13), or</p>

  <p class="indenthangingAB">c) an asterisk (denoting the value of <span class="middle"><img src="../Images/ch01/star.jpg"></span>; see rules 10 and 11).</p>

  <p class="number">5. An <em>expression</em> is either</p>

  <p class="indenthangingAB">a) an atomic expression, or</p>

  <p class="indenthangingAB">b) a plus or minus sign followed by an atomic expression, or</p>

  <p class="indenthangingAB">c) an expression followed by a binary operation followed by an atomic expression.</p>

  <p class="indent">The six admissible binary operations are <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>//</code>, and <code>: .</code> They are defined on numeric <code>MIX</code> words as follows:</p>

  <div class="image"><img src="../Images/ch01/e153_01.jpg"></div>

  <p class="noindent">Here <code>AA</code>, <code>BB</code>, and <code>CC</code> denote locations containing the respective values of the symbols <code>A</code>, <code>B</code>, and <code>C</code>. Operations within an expression are carried out from left <a id="page_154"></a>to right. <em>Examples:</em></p>

  <div class="image"><img src="../Images/ch01/e154_01.jpg"></div>

  <p class="number">6. An <em>A-part</em> (which is used to describe the address field of a <code>MIX</code> instruction) is either</p>

  <p class="indenthangingAB">a) vacuous (denoting the value zero), or</p>

  <p class="indenthangingAB">b) an expression, or</p>

  <p class="indenthangingAB">c) a future reference (denoting the eventual equivalent of the symbol; see rule 13), or</p>

  <p class="indenthangingAB">d) a literal constant (denoting a reference to an internally created symbol; see rule 12).</p>

  <p class="number">7. An <em>index part</em> (which is used to describe the index field of a <code>MIX</code> instruction) is either</p>

  <p class="indenthangingAB">a) vacuous (denoting the value zero), or</p>

  <p class="indenthangingAB">b) a comma followed by an expression (denoting the value of that expression).</p>

  <p class="number">8. An <em>F-part</em> (which is used to describe the F-field of a <code>MIX</code> instruction) is either</p>

  <p class="indenthangingAB">a) vacuous (denoting the normal F-setting, based on the <code>OP</code> field as shown in <a href="../Text/ch01b.html#ch01tab03">Table 1.3.1</a>–<a href="../Text/ch01b.html#ch01tab03">1</a>), or</p>

  <p class="indenthangingAB">b) a left parenthesis followed by an expression followed by a right parenthesis (denoting the value of the expression).</p>

  <p class="number">9. A <em>W-value</em> (which is used to describe a <em>full-word</em> <code>MIX</code> constant) is either</p>

  <p class="indenthangingAB">a) an expression followed by an F-part (in which case a vacuous F-part denotes (0:5)), or</p>

  <p class="indenthangingAB">b) a W-value followed by a comma followed by a W-value of the form (a).</p>

  <p class="indent">A W-value denotes the value of a numeric <code>MIX</code> word determined as follows: Let the W-value have the form “<code>E</code><sub>1</sub><code>(F</code><sub>1</sub><code>)</code>,<code>E</code><sub>2</sub><code>(F</code><sub>2</sub><code>)</code>, ...,<code>E</code><sub><em>n</em></sub><code>(F</code><sub><em>n</em></sub><code>)</code>”, where <em>n</em> ≥ 1, the <code>E</code>’s are expressions, and the <code>F</code>’s are fields. The desired result is the final value that would appear in memory location <code>WVAL</code> if the following hypothetical program were executed:</p>

  <p class="center"><code>STZ WVAL</code>; <code>LDA C</code><sub>1</sub>; <code>STA WVAL(F</code><sub>1</sub><code>)</code>; ...; <code>LDA C</code><sub><em>n</em></sub>; <code>STA WVAL(F</code><sub><em>n</em></sub><code>)</code>.</p>

  <p class="noindent"><a id="page_155"></a>Here <code>C</code><sub>1</sub>, ..., <code>C</code><sub><em>n</em></sub> denote locations containing the values of expressions <code>E</code><sub>1</sub>, ..., <code>E</code><sub><em>n</em></sub>. Each <code>F</code><sub><em>i</em></sub> must have the form 8<code>L</code><sub><em>i</em></sub> + <code>R</code><sub><em>i</em></sub> where 0 ≤ <code>L</code><sub><em>i</em></sub> ≤ <code>R</code><sub><em>i</em></sub> ≤ 5. <em>Examples:</em></p>

  <div class="image"><img src="../Images/ch01/e155_01.jpg"></div>

  <p class="number">10. The assembly process makes use of a value denoted by <span class="middle"><img src="../Images/ch01/star.jpg"></span> (called the <em>location counter</em>), which is initially zero. The value of <span class="middle"><img src="../Images/ch01/star.jpg"></span> should always be a nonnegative number that can fit in two bytes. When the location field of a line is not blank, it must contain a symbol that has not been previously defined. The equivalent of that symbol is then defined to be the current value of <span class="middle"><img src="../Images/ch01/star.jpg"></span>.</p>

  <p class="number">11. After processing the <code>LOC</code> field as described in rule 10, the assembly process depends on the value of the <code>OP</code> field. There are six possibilities for <code>OP</code>:</p>

  <p class="indenthangingAB">a) <code>OP</code> is a symbolic <code>MIX</code> operator (see <a href="../Text/ch01b.html#ch01tab03">Table 1</a> at the end of the previous section). The chart defines the normal C and F values for each <code>MIX</code> operator. In this case the <code>ADDRESS</code> should be an A-part (rule 6), followed by an index part (rule 7), followed by an F-part (rule 8). We thereby obtain four values: C, F, A, and I. The effect is to assemble the word determined by the sequence ‘<code>LDA C</code>; <code>STA WORD</code>; <code>LDA F</code>; <code>STA WORD(4:4)</code>; <code>LDA I</code>; <code>STA WORD(3:3)</code>; <code>LDA A</code>; <code>STA WORD(0:2)</code>’ into the location specified by <span class="middle"><img src="../Images/ch01/star.jpg"></span>, and to advance <span class="middle"><img src="../Images/ch01/star.jpg"></span> by 1.</p>

  <p class="indenthangingAB">b) <code>OP</code> is ‘<code>EQU</code>’. The <code>ADDRESS</code> should be a W-value (see rule 9). If the <code>LOC</code> field is nonblank, the equivalent of the symbol appearing there is set equal to the value specified in <code>ADDRESS</code>. This rule takes precedence over rule 10. The value of <span class="middle"><img src="../Images/ch01/star.jpg"></span> is unchanged. (As a nontrivial example, consider the line</p>

  <p class="center"><code>BYTESIZE EQU 1(4:4)</code></p>

  <p class="indenthangingAP">which allows the programmer to have a symbol whose value depends on the byte size. This is an acceptable situation so long as the resulting program is meaningful with each possible byte size.)</p>

  <p class="indenthangingAB">c) <code>OP</code> is ‘<code>ORIG</code>’. The <code>ADDRESS</code> should be a W-value (see rule 9); the location counter, <span class="middle"><img src="../Images/ch01/star.jpg"></span>, is set to this value. (Notice that because of rule 10, a symbol appearing in the <code>LOC</code> field of an <code>ORIG</code> line gets as its equivalent the value of <span class="middle"><img src="../Images/ch01/star.jpg"></span> <em>before</em> it has changed. For example,</p>

  <p class="center"><code>TABLE ORIG *+100</code></p>

  <p class="indenthangingAP">sets the equivalent of <code>TABLE</code> to the <em>first</em> of 100 locations.)</p>

  <p class="indenthangingAB">d) <code>OP</code> is ‘<code>CON</code>’. The <code>ADDRESS</code> should be a W-value; the effect is to assemble a word, having this value, into the location specified by <span class="middle"><img src="../Images/ch01/star.jpg"></span>, and to advance <span class="middle"><img src="../Images/ch01/star.jpg"></span> by 1.</p>

  <p class="indenthangingAB">e) <code>OP</code> is ‘<code>ALF</code>’. The effect is to assemble the word of character codes formed by the first five characters of the address field, otherwise behaving like <code>CON</code>.</p>

  <p class="indenthangingAB"><a id="page_156"></a>f) <code>OP</code> is ‘<code>END</code>’. The <code>ADDRESS</code> should be a W-value, which specifies in its (4:5) field the location of the instruction at which the program begins. The <code>END</code> line signals the end of a <code>MIXAL</code> program. The assembler effectively inserts additional lines just before the <code>END</code> line, in arbitrary order, corresponding to all undefined symbols and literal constants (see rules 12 and 13). Thus a symbol in the <code>LOC</code> field of the <code>END</code> line will denote the first location following the inserted words.</p>

  <p class="number">12. Literal constants: A W-value that is less than 10 characters long may be enclosed between ‘<code>=</code>’ signs and used as a future reference. The effect is to create a new symbol internally and to insert a <code>CON</code> line defining that symbol, just before the <code>END</code> line (see remark 4 following <a href="../Text/ch01b.html#ch01b_pro_p">Program P</a>).</p>

  <p class="number">13. Every symbol has one and only one equivalent value; this is a fullword <code>MIX</code> number that is normally determined by the symbol’s appearance in <code>LOC</code> according to rule 10 or rule 11(b). If the symbol never appears in <code>LOC</code>, a new line is effectively inserted before the <code>END</code> line, having <code>OP</code> = ‘<code>CON</code>’ and <code>ADDRESS</code> = ‘<code>0</code>’ and the name of the symbol in <code>LOC</code>.</p>

  <p class="indent"><em>Note</em>: The most significant consequence of the rules above is the restriction on future references. A symbol that has not yet been defined in the <code>LOC</code> field of a previous line may not be used except as the A-part of an instruction. In particular, it may not be used (a) in connection with arithmetic operations; or (b) in the <code>ADDRESS</code> field of <code>EQU</code>, <code>ORIG</code>, or <code>CON</code>. For example,</p>

  <p class="center"><code>LDA 2F+1</code></p>

  <p class="noindent">and</p>

  <p class="center"><code>CON 3F</code></p>

  <p class="noindent">are both illegal. This restriction has been imposed in order to allow more efficient assembly of programs, and the experience gained in writing this set of books has shown that it is a mild limitation that rarely makes much difference.</p>

  <p class="indent">Actually <code>MIX</code> has two symbolic languages for low-level programming: <code>MIXAL</code>,<a href="../Text/ch01b.html#ch01bfn02a" id="ch01bfn02">*</a> a machine-oriented language that is designed to facilitate one-pass translation by a very simple assembly program; and <code>PL/MIX</code>, which more adequately reflects data and control structures and which looks rather like the Remarks field of <code>MIXAL</code> programs.</p>

  <p class="footnote"><a href="../Text/ch01b.html#ch01bfn02" id="ch01bfn02a">*</a> The author was astonished to learn in 1971 that <code>MIXAL</code> is also the name of a laundry detergent in Yugoslavia, developed for use with <em>avtomate</em> [automatics].</p>

  <p class="ex-title">Exercises — First set</p>

  <p class="exercises"><strong><a href="../Text/app01a.html#ch01ex_2_13_1a" id="ch01ex_2_13_1">1</a>.</strong> [<em>00</em>] The text remarked that ‘<code>X EQU 1000</code>’ does not assemble any instruction that sets the value of a variable. Suppose that you are writing a <code>MIX</code> program in which the algorithm is supposed to set the value contained in a certain memory cell (whose symbolic name is <code>X</code>) equal to 1000. How could you express this in <code>MIXAL</code>?</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01a.html#ch01ex_2_13_2a" id="ch01ex_2_13_2">2</a>.</strong> [<em>10</em>] Line 12 of <a href="../Text/ch01b.html#ch01b_pro_m">Program M</a> says ‘<code>JMP *</code>’, where <code>*</code> denotes the location of that line. Why doesn’t the program go into an infinite loop, endlessly repeating this instruction?</p>

  <p class="exercises2"><a id="page_157"></a><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01a.html#ch01ex_2_13_3a" id="ch01ex_2_13_3">3</a>.</strong> [<em>23</em>] What is the effect of the following program, if it is used in conjunction with <a href="../Text/ch01b.html#ch01b_pro_m">Program M</a>?</p>

  <div class="image3"><img src="../Images/ch01/157pre01.jpg"></div>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01a.html#ch01ex_2_13_4a" id="ch01ex_2_13_4">4</a>.</strong> [<em>25</em>] Assemble <a href="../Text/ch01b.html#ch01b_pro_p">Program P</a> by hand. (It won’t take as long as you think.) What are the actual numerical contents of memory, corresponding to that symbolic program?</p>

  <p class="exercises"><strong><a href="../Text/app01a.html#ch01ex_2_13_5a" id="ch01ex_2_13_5">5</a>.</strong> [<em>11</em>] Why doesn’t <a href="../Text/ch01b.html#ch01b_pro_p">Program P</a> need a <code>JBUS</code> instruction to determine when the line printer is ready?</p>

  <p class="exercises"><strong><a href="../Text/app01a.html#ch01ex_2_13_6a" id="ch01ex_2_13_6">6</a>.</strong> [<em>HM20</em>] (a) Show that if <em>n</em> is not prime, <em>n</em> has a divisor <em>d</em> with 1 &lt; <em>d</em> ≤ <span class="middle"><img src="../Images/ch01/root-n.jpg"></span>. (b) Use this fact to show that the test in step P7 of <a href="../Text/ch01b.html#ch01alg-lev2sec13-P">Algorithm P</a> proves that <code>N</code> is prime.</p>

  <p class="exercises"><strong><a href="../Text/app01a.html#ch01ex_2_13_7a" id="ch01ex_2_13_7">7</a>.</strong> [<em>10</em>] (a) What is the meaning of ‘<code>4B</code>’ in line 34 of <a href="../Text/ch01b.html#ch01b_pro_p">Program P</a>? (b) What effect, if any, would be caused if the location of line 15 were changed to ‘<code>2H</code>’ and the address of line 20 were changed to ‘<code>2B</code>’?</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01a.html#ch01ex_2_13_8a" id="ch01ex_2_13_8">8</a>.</strong> [<em>24</em>] What does the following program do? (Do not run it on a computer, figure it out by hand!)</p>

  <div class="image3"><img src="../Images/ch01/157pre02.jpg"></div>

  <p class="ex-title"><a id="page_158"></a>Exercises — Second set</p>

  <p class="indent">These exercises are short programming problems, representing typical computer applications and covering a wide range of techniques. Every reader is encouraged to choose a few of these problems, in order to get some experience using <code>MIX</code> as well as a good review of basic programming skills. If desired, these exercises may be worked concurrently as the rest of <a href="../Text/ch01.html#ch01">Chapter 1</a> is being read.</p>

  <p class="indent">The following list indicates the types of programming techniques that are involved:</p>

  <p class="indent">The use of switching tables for multiway decisions: <a href="../Text/ch01b.html#ch01ex_2_13_9">exercises 9</a>, <a href="../Text/ch01b.html#ch01ex_2_13_13">13</a>, and <a href="../Text/ch01b.html#ch01ex_2_13_23">23</a>.</p>

  <p class="indent">The use of index registers with two-dimensional arrays: <a href="../Text/ch01b.html#ch01ex_2_13_10">exercises 10</a>, <a href="../Text/ch01b.html#ch01ex_2_13_21">21</a>, and <a href="../Text/ch01b.html#ch01ex_2_13_23">23</a>.</p>

  <p class="indent">Unpacking characters: <a href="../Text/ch01b.html#ch01ex_2_13_13">exercises 13</a> and <a href="../Text/ch01b.html#ch01ex_2_13_23">23</a>.</p>

  <p class="indent">Integer and scaled decimal arithmetic: <a href="../Text/ch01b.html#ch01ex_2_13_14">exercises 14</a>, <a href="../Text/ch01b.html#ch01ex_2_13_16">16</a>, and <a href="../Text/ch01b.html#ch01ex_2_13_18">18</a>.</p>

  <p class="indent">The use of subroutines: <a href="../Text/ch01b.html#ch01ex_2_13_14">exercises 14</a> and <a href="../Text/ch01b.html#ch01ex_2_13_20">20</a>.</p>

  <p class="indent">Input buffering: <a href="../Text/ch01b.html#ch01ex_2_13_13">exercise 13</a>.</p>

  <p class="indent">Output buffering: <a href="../Text/ch01b.html#ch01ex_2_13_21">exercises 21</a> and <a href="../Text/ch01b.html#ch01ex_2_13_23">23</a>.</p>

  <p class="indent">List processing: <a href="../Text/ch01b.html#ch01ex_2_13_22">exercise 22</a>.</p>

  <p class="indent">Real-time control: <a href="../Text/ch01b.html#ch01ex_2_13_20">exercise 20</a>.</p>

  <p class="indent">Graphical display: <a href="../Text/ch01b.html#ch01ex_2_13_23">exercise 23</a>.</p>

  <p class="indent">Whenever an exercise in this book says, “write a <code>MIX</code> program” or “write a <code>MIX</code> subroutine,” you need only write symbolic <code>MIXAL</code> code for what is asked. This code will not be complete in itself, it will merely be a fragment of a (hypothetical) complete program. No input or output need be done in a code fragment, if the data is to be supplied externally; one need write only <code>LOC</code>, <code>OP</code>, and <code>ADDRESS</code> fields of <code>MIXAL</code> lines, together with appropriate remarks. The numeric machine language, line number, and “times” columns (see <a href="../Text/ch01b.html#ch01b_pro_m">Program M</a>) are not required unless specifically requested, nor will there be an <code>END</code> line.</p>

  <p class="indent">On the other hand, if an exercise says, “write a <em>complete</em> <code>MIX</code> program,” it implies that an executable program should be written in <code>MIXAL</code>, including in particular the final <code>END</code> line. Assemblers and <code>MIX</code> simulators on which such complete programs can be tested are widely available.</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01a.html#ch01ex_2_13_9a" id="ch01ex_2_13_9">9</a>.</strong> [<em>25</em>] Location <code>INST</code> contains a <code>MIX</code> word that purportedly is a <code>MIX</code> instruction. Write a <code>MIX</code> program that jumps to location <code>GOOD</code> if the word has a valid C-field, valid ±AA-field, valid I-field, and valid F-field, according to <a href="../Text/ch01b.html#ch01tab03">Table 1.3.1</a>–<a href="../Text/ch01b.html#ch01tab03">1</a>; your program should jump to location <code>BAD</code> otherwise. Remember that the test for a valid F-field depends on the C-field; for example, if C = 7 (<code>MOVE</code>), any F-field is acceptable, but if C = 8 (<code>LDA</code>), the F-field must have the form 8L + R where 0 ≤ L ≤ R ≤ 5. The “±AA”-field is to be considered valid <em>unless</em> C specifies an instruction requiring a memory address and I = 0 and ±AA is not a valid memory address.</p>

  <p class="indent"><em>Note:</em> Inexperienced programmers tend to tackle a problem like this by writing a long series of tests on the C-field, such as ‘<code>LDA C</code>; <code>JAZ 1F</code>; <code>DECA 5</code>; <code>JAN 2F</code>; <code>JAZ 3F</code>; <code>DECA 2</code>; <code>JAN 4F</code>; ...’. This is <em>not</em> good practice! The best way to make multiway decisions is to prepare an auxiliary <em>table</em> containing information that encapsulates the desired logic. If there were, for example, a table of 64 entries, we could write ‘<code>LD1 C</code>; <code>LD1 TABLE,1</code>; <code>JMP 0,1</code>’ — thereby jumping very speedily to the desired routine. Other useful information can also be kept in such a table. A tabular approach to the present problem makes the program only a little bit longer (including the table) and greatly increases its speed and flexibility.</p>

  <p class="exercises1"><a id="page_159"></a><strong><a href="../Text/app01a.html#ch01ex_2_13_10a" id="ch01ex_2_13_10">10</a>.</strong> [<em>31</em>] Assume that we have a 9 × 8 matrix</p>

  <div class="image"><img src="../Images/ch01/e159_01.jpg"></div>

  <p class="exercisesp">stored in memory so that <em>a</em><sub><em>ij</em></sub> is in location 1000+8<em>i</em>+<em>j</em>. In memory the matrix therefore appears as follows:</p>

  <div class="image"><img src="../Images/ch01/e159_02.jpg"></div>

  <p class="indent">A matrix is said to have a “saddle point” if some position is the smallest value in its row and the largest value in its column. In symbols, <em>a</em><sub><em>ij</em></sub> is a saddle point if</p>

  <div class="image"><img src="../Images/ch01/e159_03.jpg"></div>

  <p class="exercisesp">Write a <code>MIX</code> program that computes the location of a saddle point (if there is at least one) or zero (if there is no saddle point), and stops with this value in rI1.</p>

  <p class="exercises1"><strong><a href="../Text/app01a.html#ch01ex_2_13_11a" id="ch01ex_2_13_11">11</a>.</strong> [<em>M29</em>] What is the <em>probability</em> that the matrix in the preceding exercise has a saddle point, assuming that the 72 elements are distinct and assuming that all 72! arrangements are equally probable? What is the corresponding probability if we assume instead that the elements of the matrix are zeros and ones, and that all 2<sup>72</sup> such matrices are equally probable?</p>

  <p class="exercises1"><strong><a href="../Text/app01a.html#ch01ex_2_13_12a" id="ch01ex_2_13_12">12</a>.</strong> [<em>HM42</em>] Two solutions are given for <a href="../Text/ch01b.html#ch01ex_2_13_10">exercise 10</a> (see page <a href="../Text/app01a.html#page_512">512</a>), and a third is suggested; it is not clear which of them is better. Analyze the algorithms, using each of the assumptions of <a href="../Text/ch01b.html#ch01ex_2_13_11">exercise 11</a>, and decide which is the better method.</p>

  <p class="exercises1"><strong><a href="../Text/app01a.html#ch01ex_2_13_13a" id="ch01ex_2_13_13">13</a>.</strong> [<em>28</em>] A cryptanalyst wants a frequency count of the letters in a certain code. The code has been punched on paper tape; the end is signaled by an asterisk. Write a complete <code>MIX</code> program that reads in the tape, counts the frequency of each character up to the first asterisk, and then types out the results in the form</p>

  <div class="image"><img src="../Images/ch01/e159_04.jpg"></div>

  <p class="exercisesp">etc., one character per line. The number of blanks should not be counted, nor should characters for which the count is zero (like <code>C</code> in the above) be printed. For efficiency, “buffer” the input: While reading a block into one area of memory you can be counting characters from another area. You may assume that an extra block (following the one that contains the terminating asterisk) is present on the input tape.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01a.html#ch01ex_2_13_14a" id="ch01ex_2_13_14">14</a>.</strong> [<em>31</em>] The following algorithm, due to the Neapolitan astronomer Aloysius Lilius and the German Jesuit mathematician Christopher Clavius in the late 16th century, is used by most Western churches to determine the date of Easter Sunday for any year after 1582.</p>

  <p class="noindent"><a id="page_160"></a><a id="ch01alg-lev2sec13-E"></a><strong>Algorithm E</strong> (<em>Date of Easter</em>). Let <em>Y</em> be the year for which the date of Easter is desired.</p>

  <p class="indenthangingE"><strong>E1.</strong> [Golden number.] Set <em>G</em> ← (<em>Y</em> mod 19) + 1. (<em>G</em> is the so-called “golden number” of the year in the 19-year Metonic cycle.)</p>

  <p class="indenthangingE"><strong>E2.</strong> [Century.] Set <em>C</em> ← <span class="middle"><img src="../Images/ch01/en0470_01.jpg"></span><em>Y/</em>100<span class="middle"><img src="../Images/ch01/en0470_02.jpg"></span> + 1. (When <em>Y</em> is not a multiple of 100, <em>C</em> is the century number; for example, 1984 is in the twentieth century.)</p>

  <p class="indenthangingE"><strong>E3.</strong> [Corrections.] Set <em>X</em> ← <span class="middle"><img src="../Images/ch01/en0470_01.jpg"></span>3<em>C/</em>4<span class="middle"><img src="../Images/ch01/en0470_02.jpg"></span> − 12, <em>Z</em> ← <span class="middle"><img src="../Images/ch01/en0470_01.jpg"></span>(8<em>C</em> + 5)<em>/</em>25<span class="middle"><img src="../Images/ch01/en0470_02.jpg"></span> − 5. (Here <em>X</em> is the number of years, such as 1900, in which leap year was dropped in order to keep in step with the sun; <em>Z</em> is a special correction designed to synchronize Easter with the moon’s orbit.)</p>

  <p class="indenthangingE"><strong>E4.</strong> [Find Sunday.] Set <em>D</em> ← <span class="middle"><img src="../Images/ch01/en0470_01.jpg"></span>5<em>Y/</em>4<span class="middle"><img src="../Images/ch01/en0470_02.jpg"></span> − <em>X</em> − 10. (March ((−<em>D</em>) mod 7) will actually be a Sunday.)</p>

  <p class="indenthangingE"><strong>E5.</strong> [Epact.] Set <em>E</em> ← (11<em>G</em> + 20 + <em>Z</em> − <em>X</em>) mod 30. If <em>E</em> = 25 and the golden number <em>G</em> is greater than 11, or if <em>E</em> = 24, then increase <em>E</em> by 1. (This number <em>E</em> is the <em>epact</em>, which specifies when a full moon occurs.)</p>

  <p class="indenthangingE"><strong>E6.</strong> [Find full moon.] Set <em>N</em> ← 44 − <em>E</em>. If <em>N</em> &lt; 21 then set <em>N</em> ← <em>N</em> + 30. (Easter is supposedly the first Sunday following the first full moon that occurs on or after March 21. Actually perturbations in the moon’s orbit do not make this strictly true, but we are concerned here with the “calendar moon” rather than the actual moon. The <em>N</em>th of March is a calendar full moon.)</p>

  <p class="indenthangingE"><strong>E7.</strong> [Advance to Sunday.] Set <em>N</em> ← <em>N</em> + 7 − ((<em>D</em> + <em>N</em>) mod 7).</p>

  <p class="indenthangingE"><strong>E8.</strong> [Get month.] If <em>N</em> &gt; 31, the date is (<em>N</em> − 31) <code>APRIL</code>; otherwise the date is <em>N</em> <code>MARCH</code>.</p>

  <p class="exercises1N">Write a subroutine to calculate and print Easter date given the year, assuming that the year is less than 100000. The output should have the form “<em>dd</em> <code>MONTH</code>, <em>yyyyy</em>” where <em>dd</em> is the day and <em>yyyyy</em> is the year. Write a complete <code>MIX</code> program that uses this subroutine to prepare a table of the dates of Easter from 1950 through 2000.</p>

  <p class="exercises1"><strong><a href="../Text/app01a.html#ch01ex_2_13_15a" id="ch01ex_2_13_15">15</a>.</strong> [<em>M30</em>] A fairly common error in the coding of the previous exercise is to fail to realize that the quantity (11<em>G</em> + 20 + <em>Z</em> − <em>X</em>) in step E5 may be negative; therefore the positive remainder mod 30 might not be computed properly. (See <em>CACM</em> <strong>5</strong> (1962), 556.) For example, in the year 14250 we would find <em>G</em> = 1, <em>X</em> = 95, <em>Z</em> = 40; so if we had <em>E</em> = −24 instead of <em>E</em> = +6 we would get the ridiculous answer ‘<code>42 APRIL</code>’. Write a complete <code>MIX</code> program that finds the <em>earliest</em> year for which this error would actually cause the wrong date to be calculated for Easter.</p>

  <p class="exercises1"><strong><a href="../Text/app01a.html#ch01ex_2_13_16a" id="ch01ex_2_13_16">16</a>.</strong> [<em>31</em>] We showed in <a href="../Text/ch01a.html#ch01lev2sec7">Section 1.2.7</a> that the sum <span class="middle"><img src="../Images/ch01/e160_01.jpg"></span> becomes infinitely large. But if it is calculated with finite accuracy by a computer, the sum actually exists, in some sense, because the terms eventually get so small that they contribute nothing to the sum if added one by one. For example, suppose we calculate the sum by rounding to one decimal place; then we have 1 + 0.5 + 0.3 + 0.3 + 0.2 + 0.2 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 = 3.9.</p>

  <p class="indent">More precisely, let <em>r</em><sub><em>n</em></sub>(<em>x</em>) be the number <em>x</em> rounded to <em>n</em> decimal places; we define <span class="middle"><img src="../Images/ch01/e160_02.jpg"></span>. Then we wish to find</p>

  <div class="image"><img src="../Images/ch01/e160_03.jpg"></div>

  <p class="exercisesp">we know that <em>S</em><sub>1</sub> = 3.9, and the problem is to write a complete <code>MIX</code> program that calculates and prints <em>S</em><sub><em>n</em></sub> for <em>n</em> = 2, 3, 4, and 5.</p>

  <p class="exercises1N"><a id="page_161"></a><em>Note:</em> There is a much faster way to do this than the simple procedure of adding <em>r</em><sub><em>n</em></sub>(1/<em>m</em>), one number at a time, until <em>r</em><sub><em>n</em></sub>(1/<em>m</em>) becomes zero. For example, we have <em>r</em><sub>5</sub>(1/<em>m</em>) = 0.00001 for all values of <em>m</em> from 66667 to 200000; it’s wise to avoid calculating 1/m all 133334 times! An algorithm along the following lines should rather be used:</p>

  <p class="indentab">A. Start with <em>m</em><sub><em>h</em></sub> = 1, <em>S</em> = 1.</p>

  <p class="indentab">B. Set <em>m</em><sub><em>e</em></sub> = <em>m</em><sub><em>h</em></sub> + 1 and calculate <em>r</em><sub><em>n</em></sub> (1<em>/m</em><sub><em>e</em></sub>) = <em>r</em>.</p>

  <p class="indentab">C. Find <em>m</em><sub><em>h</em></sub>, the largest <em>m</em> for which <em>r</em><sub><em>n</em></sub> (1<em>/m</em>) = <em>r</em>.</p>

  <p class="indentab">D. Add (<em>m</em><sub><em>h</em></sub> − <em>m</em><sub><em>e</em></sub> + 1)<em>r</em> to <em>S</em> and return to Step B.</p>

  <p class="exercises1"><strong><a href="../Text/app01a.html#ch01ex_2_13_17a" id="ch01ex_2_13_17">17</a>.</strong> [<em>HM30</em>] Using the notation of the preceding exercise, prove or disprove the formula</p>

  <p class="center">lim<sub><em>n</em>→∞</sub> (<em>S</em><sub><em>n</em>+1</sub> − <em>S<sub><em>n</em></sub></em>) = ln 10.</p>

  <p class="exercises1"><strong><a href="../Text/app01a.html#ch01ex_2_13_18a" id="ch01ex_2_13_18">18</a>.</strong> [<em>25</em>] The ascending sequence of all reduced fractions between 0 and 1 that have denominators ≤ <em>n</em> is called the “Farey series of order <em>n</em>.” For example, the Farey series of order 7 is</p>

  <div class="image"><img src="../Images/ch01/e161_01.jpg"></div>

  <p class="exercisesp">If we denote this series by <em>x</em><sub>0</sub>/<em>y</em><sub>0</sub>, <em>x</em><sub>1</sub>/<em>y</em><sub>1</sub>, <em>x</em><sub>2</sub>/<em>y</em><sub>2</sub>, ..., <a href="../Text/ch01b.html#ch01ex_2_13_19">exercise 19</a> proves that</p>

  <p class="center"><em>x</em><sub>0</sub> = 0,&nbsp;&nbsp;&nbsp;<em>y</em><sub>0</sub> = 1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>x</em><sub>1</sub> = 1,&nbsp;&nbsp;&nbsp;<em>y</em><sub>1</sub> = <em>n</em>;</p>

  <p class="center"><em>x</em><sub><em>k</em>+2</sub> = <span class="middle"><img src="../Images/ch01/en0470_01.jpg"></span>(<em>y</em><sub><em>k</em></sub> + <em>n</em>)/<em>y</em><sub><em>k</em>+1</sub><span class="middle"><img src="../Images/ch01/en0470_02.jpg"></span><em>x</em><sub><em>k</em>+1</sub> − <em>x</em><sub><em>k</em></sub>;</p>

  <p class="center"><em>y</em><sub><em>k</em>+2</sub> = <span class="middle"><img src="../Images/ch01/en0470_01.jpg"></span>(<em>y</em><sub><em>k</em></sub> + <em>n</em>)/<em>y</em><sub><em>k</em>+1</sub><span class="middle"><img src="../Images/ch01/en0470_02.jpg"></span><em>y</em><sub><em>k</em>+1</sub> − <em>y</em><sub><em>k</em></sub>.</p>

  <p class="exercisesp">Write a <code>MIX</code> subroutine that computes the Farey series of order <em>n</em>, by storing the values of <em>x</em><sub><em>k</em></sub> and <em>y</em><sub><em>k</em></sub> in locations <code>X</code> + <em>k</em>, <code>Y</code> + <em>k</em>, respectively. (The total number of terms in the series is approximately 3<em>n</em><sup>2</sup>/<em>π</em><sup>2</sup>, so you may assume that <em>n</em> is rather small.)</p>

  <p class="exercises1"><strong><a href="../Text/app01a.html#ch01ex_2_13_19a" id="ch01ex_2_13_19">19</a>.</strong> [<em>M30</em>] (a) Show that the numbers <em>x</em><sub><em>k</em></sub> and <em>y</em><sub><em>k</em></sub> defined by the recurrence in the preceding exercise satisfy the relation <em>x</em><sub><em>k</em>+1</sub> y<sub><em>k</em></sub>− <em>x</em><sub><em>k</em></sub><em>y</em><sub><em>k</em>+1</sub> = 1. (b) Show that the fractions <em>x</em><sub><em>k</em></sub>/<em>y</em><sub><em>k</em></sub> are indeed the Farey series of order <em>n</em>, using the fact proved in (a).</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/common-05.jpg"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01a.html#ch01ex_2_13_20a" id="ch01ex_2_13_20">20</a>.</strong> [<em>33</em>] Assume that <code>MIX</code>’s overflow toggle and X-register have been wired up to the traffic signals at the corner of Del Mar Boulevard and Berkeley Avenue, as follows:</p>

  <div class="image"><img src="../Images/ch01/e161_02.jpg"></div>

  <p class="exercisesp">Cars or pedestrians wishing to travel on Berkeley across the boulevard must trip a switch that causes the overflow toggle of <code>MIX</code> to go on. If this condition never occurs, the light for Del Mar should remain green.</p>

  <p class="indent">Cycle times are as follows:</p>

  <p class="uln-indent1">Del Mar traffic light is green ≥ 30 sec, amber 8 sec;</p>

  <p class="uln-indent1">Berkeley traffic light is green 20 sec, amber 5 sec.</p>

  <p class="exercisesp">When a traffic light is green or amber for one direction, the other direction has a red light. When the traffic light is green, the corresponding <code>WALK</code> light is on, except that</p>

  <p class="exercisesp"><a id="page_162"></a><code>DON’T WALK</code> flashes for 12 sec just before a green light turns to amber, as follows:</p>

  <div class="image"><img src="../Images/ch01/e162_01.jpg"></div>

  <p class="exercises1N">If the overflow is tripped while the Berkeley light is green, the car or pedestrian will pass on that cycle, but if it is tripped during the amber or red portions, another cycle will be necessary after the Del Mar traffic has passed.</p>

  <p class="exercises1N">Assume that one <code>MIX</code> time unit equals 10 <em>μ</em>sec. Write a complete <code>MIX</code> program that controls these lights by manipulating rX, according to the input given by the overflow toggle. The stated times are to be followed exactly unless it is impossible to do so. <em>Note:</em> The setting of rX changes precisely at the <em>completion</em> of a <code>LDX</code> or <code>INCX</code> instruction.</p>

  <p class="exercises1"><a id="ch01ex_2_13_21"></a><strong>21.</strong> [<em>28</em>] A <em>magic square of order n</em> is an arrangement of the numbers 1 through <em>n</em><sup>2</sup> in a square array in such a way that the sum of each row and column is <em>n</em>(<em>n</em><sup>2</sup> + 1)<em>/</em>2, and so is the sum of the two main diagonals. <a href="../Text/ch01b.html#ch01fig16">Figure 16</a> shows a magic square of order 7. The rule for generating it is easily seen: Start with 1 just below the middle square, then go down and to the right diagonally — when running off the edge imagine an entire plane tiled with squares — until reaching a filled square; then drop down two spaces from the most-recently-filled square and continue. This method works whenever <em>n</em> is odd.</p>

  <div class="image">
    <a id="ch01fig16"></a><img src="../Images/ch01/01fig16.jpg">

    <p class="fig-caption"><strong>Fig. 16.</strong> A magic square.</p>
  </div>

  <p class="exercises1N">Using memory allocated in a fashion like that of <a href="../Text/ch01b.html#ch01ex_2_13_10">exercise 10</a>, write a complete <code>MIX</code> program to generate the 23 × 23 magic square by the method above, and to print the result. [This algorithm is due to Ibn al-Haytham, who was born in Basra about 965 and died in Cairo about 1040. Many other magic square constructions make good programming exercises; see W. W. Rouse Ball, <em>Mathematical Recreations and Essays</em>, revised by H. S. M. Coxeter (New York: Macmillan, 1939), Chapter 7.]</p>

  <p class="exercises1"><strong><a href="../Text/app01a.html#ch01ex_2_13_22a" id="ch01ex_2_13_22">22</a>.</strong> [<em>31</em>] (<em>The Josephus problem</em>.) There are <em>n</em> men arranged in a circle. Beginning at a particular position, we count around the circle and brutally execute every <em>m</em>th man; the circle closes as men die. For example, the execution order when <em>n</em> = 8 and <em>m</em> = 4 is 54613872, as shown in <a href="../Text/ch01b.html#ch01fig17">Fig. 17</a>: The first man is fifth to go, the second man is fourth, etc. Write a complete <code>MIX</code> program that prints out the order of execution when <em>n</em> = 24, m = 11. Try to design a clever algorithm that works at high speed when n and m are large (it may save your life). <em>Reference:</em> W. Ahrens, <em>Mathematische Unterhaltungenund Spiele</em> <strong>2</strong> (Leipzig: Teubner, 1918), Chapter 15.</p>

  <div class="image">
    <a id="ch01fig17"></a><img src="../Images/ch01/01fig17.jpg">

    <p class="fig-caption"><strong>Fig. 17.</strong> Josephus’s problem, <em>n</em> = 8, <em>m</em> = 4.</p>
  </div>

  <p class="exercises1"><a id="page_163"></a><a id="ch01ex_2_13_23"></a><strong>23.</strong> [<em>37</em>] This is an exercise designed to give some experience in the many applications of computers for which the output is to be displayed graphically rather than in the usual tabular form. In this case, the object is to “draw” a crossword puzzle diagram.</p>

  <p class="exercises1N">You are given as input a matrix of zeros and ones. An entry of zero indicates a white square; a one indicates a black square. The output should be a diagram of the puzzle, with the appropriate squares numbered for words across and down.</p>

  <p class="exercises1N">For example, given the matrix</p>

  <div class="image"><img src="../Images/ch01/e163_01.jpg"></div>

  <p class="exercisesp">the corresponding puzzle diagram would be as shown in <a href="../Text/ch01b.html#ch01fig18">Fig. 18</a>. A square is numbered if it is a white square and either (a) the square below it is white and there is no white square immediately above, or (b) the square to its right is white and there is no white square immediately to its left. If black squares occur at the edges, they should be removed from the diagram. This is illustrated in <a href="../Text/ch01b.html#ch01fig18">Fig. 18</a>, where the black squares at the corners were dropped. A simple way to accomplish this is to artificially insert rows and columns of −1’s at the top, bottom, and sides of the given input matrix, then to change every +1 that is adjacent to a −1 into a −1 until no +1 remains next to any −1.</p>

  <div class="image">
    <a id="ch01fig18"></a><img src="../Images/ch01/01fig18.jpg">

    <p class="fig-caption"><strong>Fig. 18.</strong> Diagram corresponding to the matrix in <a href="../Text/ch01b.html#ch01ex_2_13_23">exercise 23</a>.</p>
  </div>

  <p class="exercises1N">The following method should be used to print the final diagram on a line printer: Each box of the puzzle should correspond to 5 columns and 3 rows of the output page, where the 15 positions are filled as follows:</p>

  <div class="image"><img src="../Images/ch01/e163_02.jpg"></div>

  <p class="exercises1N">“−1” squares, depending on whether there are −1’s to the right or below:</p>

  <div class="image"><img src="../Images/ch01/e163_03.jpg"></div>

  <p class="exercisesp">The diagram shown in <a href="../Text/ch01b.html#ch01fig18">Fig. 18</a> would then be printed as shown in <a href="../Text/ch01b.html#ch01fig19">Fig. 19</a>.</p>

  <div class="image">
    <a id="ch01fig19"></a><img src="../Images/ch01/01fig19.jpg">

    <p class="fig-caption"><strong>Fig. 19.</strong> Representation of <a href="../Text/ch01b.html#ch01fig18">Fig. 18</a> on a line printer.</p>
  </div>

  <p class="exercises1N">The width of a printer line — 120 characters — is enough to allow up to 23 columns in the crossword puzzle. The data supplied as input to your program will be a 23 × 23 matrix of zeros and ones, where each row is punched in columns 1–23 of an input card. For example, the card corresponding to the top row of the matrix above would be punched <code>‘10000111111111111111111’</code>. The diagram will not necessarily be symmetrical, and it might have long paths of black squares that are connected to the outside in strange ways.</p>

  <div class="heading">
    <h4 id="ch01lev2sec14"><a id="page_164"></a>1.3.3. Applications to Permutations</h4>

    <p class="noindent">In this section we shall give several more examples of <code>MIX</code> programs, and at the same time introduce some important properties of permutations. These investigations will also bring out some interesting aspects of computer programming in general.</p>
  </div>

  <p class="indent">Permutations were discussed earlier in <a href="../Text/ch01.html#ch01lev2sec5">Section 1.2.5</a>; we treated the permutation <em>c d f b e a</em> as an <em>arrangement</em> of the six objects <em>a</em>, <em>b</em>, <em>c</em>, <em>d</em>, <em>e</em>, <em>f</em> in a straight line. Another viewpoint is also possible: We may think of a permutation as a <em>rearrangement</em> or renaming of the objects. With this interpretation it is customary to use a two-line notation, for example,</p>

  <div class="equation"><a id="ch01eq-lev2sec14-1"></a><img src="../Images/ch01/164equ01.jpg"></div>

  <p class="noindent">to mean “<em>a</em> becomes <em>c</em>, <em>b</em> becomes <em>d</em>, <em>c</em> becomes <em>f</em>, <em>d</em> becomes <em>b</em>, <em>e</em> becomes <em>e</em>, <em>f</em> becomes <em>a</em>.” Considered as a rearrangement, this means that object <em>c</em> moves to the place formerly occupied by object <em>a</em>; considered as a renaming, it means that object <em>a</em> is renamed <em>c</em>. The two-line notation is unaffected by changes in the order of the columns; for example, the permutation (<a href="../Text/ch01b.html#ch01eq-lev2sec14-1">1</a>) could also be written</p>

  <div class="image"><img src="../Images/ch01/e164_01.jpg"></div>

  <p class="noindent">and in 718 other ways.</p>

  <p class="indent">A <em>cycle notation</em> is often used in connection with this interpretation. Permutation (<a href="../Text/ch01b.html#ch01eq-lev2sec14-1">1</a>) could be written</p>

  <div class="equation"><a id="ch01eq-lev2sec14-2"></a><img src="../Images/ch01/164equ02.jpg"></div>

  <p class="noindent">again meaning “<em>a</em> becomes <em>c</em>, <em>c</em> becomes <em>f</em>, <em>f</em> becomes <em>a</em>, <em>b</em> becomes <em>d</em>, <em>d</em> becomes <em>b</em>.” A cycle (<em>x</em><sub>1</sub><em>x</em><sub>2</sub> ... <em>x</em><sub><em>n</em></sub>) means “<em>x</em><sub>1</sub> becomes <em>x</em><sub>2</sub>, ..., <em>x</em><sub><em>n</em>−1</sub> becomes <em>x</em><sub><em>n</em></sub>, <em>x</em><sub><em>n</em></sub> becomes <em>x</em><sub>1</sub> .” Since <em>e</em> is fixed under the permutation, it does not appear in the cycle notation; that is, singleton cycles like “(<em>e</em>)” are conventionally not written. If a permutation fixes <em>all</em> elements, so that there are only singleton cycles present, it is called the <em>identity permutation</em>, and we denote it by “()”.</p>

  <p class="indent">The cycle notation is not unique. For example,</p>

  <div class="equation"><a id="ch01eq-lev2sec14-3"></a><img src="../Images/ch01/164equ03.jpg"></div>

  <p class="noindent">etc., are all equivalent to (<a href="../Text/ch01b.html#ch01eq-lev2sec14-2">2</a>). However, “(<em>a f c</em>) (<em>b d</em>)” is not the same, since it says that <em>a</em> goes to <em>f</em>.</p>

  <p class="indent">It is easy to see why the cycle notation is always possible. Starting with any element <em>x</em><sub>1</sub>, the permutation takes <em>x</em><sub>1</sub> into <em>x</em><sub>2</sub>, say, and <em>x</em><sub>2</sub> into <em>x</em><sub>3</sub>, etc., until finally (since there are only finitely many elements) we get to some element <em>x</em><sub><em>n</em></sub><sub>+1</sub> that has already appeared among <em>x</em><sub>1</sub>, ..., <em>x</em><sub><em>n</em></sub>. Now <em>x</em><sub><em>n</em>+1</sub> must equal <em>x</em><sub>1</sub>. For if it were equal to, say, <em>x</em><sub>3</sub>, we already know that <em>x</em><sub>2</sub> goes into <em>x</em><sub>3</sub>; but by assumption, <em>x</em><sub><em>n</em></sub> ≠ <em>x</em><sub>2</sub> goes to <em>x</em><sub><em>n</em>+1</sub>. So <em>x</em><sub><em>n</em>+1</sub> = <em>x</em><sub>1</sub>, and we have a cycle (<em>x</em><sub>1</sub><em>x</em><sub>2</sub> ... <em>x</em><sub><em>n</em></sub>) as part of our permutation, for some <em>n</em> ≥ 1. If this does not account for the entire permutation, we can find another element <em>y</em><sub>1</sub> and get another cycle (<em>y</em><sub>1</sub><em>y</em><sub>2</sub> ... <em>y</em><sub><em>m</em></sub>) <a id="page_165"></a>in the same way. None of the <em>y</em>’s can equal any of the <em>x</em>’s, since <em>x</em><sub><em>i</em></sub> = <em>y</em><sub><em>j</em></sub> implies that <em>x</em><sub><em>i</em>+1</sub> = <em>y</em><sub><em>j</em>+1</sub>, etc., and we would ultimately find <em>x</em><sub><em>k</em></sub> = <em>y</em><sub>1</sub> for some <em>k</em>, contradicting the choice of <em>y</em><sub>1</sub>. All cycles will eventually be found.</p>

  <p class="indent">One application of these concepts to programming comes up whenever some set of <em>n</em> objects is to be put into a different order. If we want to rearrange the objects without moving them elsewhere, we must essentially follow the cycle structure. For example, to do the rearrangement (<a href="../Text/ch01b.html#ch01eq-lev2sec14-1">1</a>), namely to set</p>

  <p class="center">(<em>a, b, c, d, e, f</em>) ← (<em>c, d, f, b, e, a</em>)<em>,</em></p>

  <p class="noindent">we would essentially follow the cycle structure (<a href="../Text/ch01b.html#ch01eq-lev2sec14-2">2</a>) and successively set</p>

  <p class="center"><em>t</em> ← <em>a</em>,&nbsp;&nbsp;&nbsp;<em>a</em> ← <em>c</em>,&nbsp;&nbsp;&nbsp;<em>c</em> ← <em>f</em>,&nbsp;&nbsp;&nbsp;<em>f</em> ← <em>t</em>;&nbsp;&nbsp;&nbsp;<em>t</em> ← <em>b</em>,&nbsp;&nbsp;&nbsp;<em>b</em> ← <em>d</em>,&nbsp;&nbsp;&nbsp;<em>d</em> ← <em>t</em>.</p>

  <p class="noindent">It is frequently useful to realize that any such transformation takes place in disjoint cycles.</p>

  <p class="noindent"><strong>Products of permutations.</strong> We can multiply two permutations together, with the understanding that multiplication means the application of one permutation after the other. For example, if permutation (<a href="../Text/ch01b.html#ch01eq-lev2sec14-1">1</a>) is followed by the permutation</p>

  <div class="image"><img src="../Images/ch01/e165_01.jpg"></div>

  <p class="noindent">we have <em>a</em> becomes <em>c</em>, which then becomes <em>c</em>; <em>b</em> becomes <em>d</em>, which becomes <em>a</em>; etc.:</p>

  <div class="equation"><a id="ch01eq-lev2sec14-4"></a><img src="../Images/ch01/165equ01.jpg"></div>

  <p class="indent">It should be clear that multiplication of permutations is not commutative; in other words, <em>π</em><sub>1</sub> × <em>π</em><sub>2</sub> is not necessarily equal to <em>π</em><sub>2</sub> × <em>π</em><sub>1</sub> when <em>π</em><sub>1</sub> and <em>π</em><sub>2</sub> are permutations. The reader may verify that the product in (<a href="../Text/ch01b.html#ch01eq-lev2sec14-4">4</a>) gives a different result if the two factors are interchanged (see <a href="../Text/ch01c.html#ch01ex_2_14_3">exercise 3</a>).</p>

  <p class="indent">Some people multiply permutations from right to left rather than the somewhat more natural left-to-right order shown in (<a href="../Text/ch01b.html#ch01eq-lev2sec14-4">4</a>). In fact, mathematicians are divided into two camps in this regard; should the result of applying transformation <em>T</em><sub>1</sub>, then <em>T</em><sub>2</sub>, be denoted by <em>T</em><sub>1</sub><em>T</em><sub>2</sub> or by <em>T</em><sub>2</sub><em>T</em><sub>1</sub>? Here we use <em>T</em><sub>1</sub><em>T</em><sub>2</sub>.</p>

  <p class="indent">Equation (<a href="../Text/ch01b.html#ch01eq-lev2sec14-4">4</a>) would be written as follows, using the cycle notation:</p>

  <div class="equation"><a id="ch01eq-lev2sec14-5"></a><img src="../Images/ch01/165equ02.jpg"></div>

  <p class="noindent">Note that the multiplication sign “×” is conventionally dropped; this does not conflict with the cycle notation since it is easy to see that the permutation (<em>a c f</em>) (<em>b d</em>) is really the product of the permutations (<em>a c f</em>) and (<em>b d</em>).</p>

  <p class="indent"><a id="page_166"></a>Multiplication of permutations can be done directly in terms of the cycle notation. For example, to compute the product of several permutations</p>

  <div class="equation"><a id="ch01eq-lev2sec14-6"></a><img src="../Images/ch01/166equ01.jpg"></div>

  <p class="noindent">we find (proceeding from left to right) that “<em>a</em> goes to <em>c</em>, then <em>c</em> goes to <em>d</em>, then <em>d</em> goes to <em>a</em>, then <em>a</em> goes to <em>d</em>, then <em>d</em> is unchanged”; so the net result is that <em>a</em> goes to <em>d</em> under (<a href="../Text/ch01b.html#ch01eq-lev2sec14-6">6</a>), and we write down “(<em>a d</em>” as the partial answer. Now we consider the effect on <em>d</em>: “<em>d</em> goes to <em>b</em> goes to <em>g</em>”; we have the partial result “(<em>a d g</em>”. Considering <em>g</em>, we find that “<em>g</em> goes to <em>a</em>, to <em>e</em>, to <em>f</em>, to <em>a</em>”, and so the first cycle is closed: “(<em>a d g</em>)”. Now we pick a new element that hasn’t appeared yet, say <em>c</em>; we find that <em>c</em> goes to <em>e</em>, and the reader may verify that ultimately the answer “(<em>a d g</em>)(<em>c e b</em>)” is obtained for (<a href="../Text/ch01b.html#ch01eq-lev2sec14-6">6</a>).</p>

  <p class="indent">Let us now try to do this process by computer. The following algorithm formalizes the method described in the preceding paragraph, in a way that is amenable to machine calculation.</p>

  <div class="image">
    <a id="ch01fig20"></a><img src="../Images/ch01/01fig20.jpg">

    <p class="fig-caption"><strong>Fig. 20.</strong> <a href="../Text/ch01b.html#ch01alg-lev2sec14-A">Algorithm A</a> for multiplying permutations.</p>
  </div>

  <p class="noindent"><a id="ch01alg-lev2sec14-A"></a><strong>Algorithm A</strong> (<em>Multiply permutations in cycle form</em>). This algorithm takes a product of cycles, such as (<a href="../Text/ch01b.html#ch01eq-lev2sec14-6">6</a>), and computes the resulting permutation in the form of a product of disjoint cycles. For simplicity, the removal of singleton cycles is not described here; that would be a fairly simple extension of the algorithm. As this algorithm is performed, we successively “tag” the elements of the input formula; that is, we mark somehow those symbols of the input formula that have been processed.</p>

  <p class="indenthanging"><strong>A1.</strong> [First pass.] Tag all left parentheses, and replace each right parenthesis by a tagged copy of the input symbol that follows its matching left parenthesis. (See the example in <a href="../Text/ch01b.html#ch01tab04">Table 1</a>.)</p>

  <p class="indenthanging"><strong>A2.</strong> [Open.] Searching from left to right, find the first untagged element of the input. (If all elements are tagged, the algorithm terminates.) Set <code>START</code> equal to it; output a left parenthesis; output the element; and tag it.</p>

  <p class="indenthanging"><strong>A3.</strong> [Set <code>CURRENT</code>.] Set <code>CURRENT</code> equal to the next element of the formula.</p>

  <p class="indenthanging"><strong>A4.</strong> [Scan formula.] Proceed to the right until either reaching the end of the formula, or finding an element equal to <code>CURRENT</code>; in the latter case, tag it and go back to step A3.</p>

  <div class="image4">
    <a id="page_167"></a><a id="ch01tab04"></a><img class="img1" src="../Images/ch01/167tab01.jpg">

    <p class="tab-caption"><strong>Table 1</strong> <a href="../Text/ch01b.html#ch01alg-lev2sec14-A">Algorithm A</a> Applied to (<a href="../Text/ch01b.html#ch01eq-lev2sec14-6">6</a>)</p>
  </div>

  <p class="indenthanging"><strong>A5.</strong> <code>[CURRENT = START?]</code> If <code>CURRENT ≠ START</code>, output <code>CURRENT</code> and go back to step A4 starting again at the left of the formula (thereby continuing the development of a cycle in the output).</p>

  <p class="indenthanging"><strong>A6.</strong> [Close.] (A complete cycle in the output has been found.) Output a right parenthesis, and go back to step A2. <span class="middle"><img src="../Images/ch01/box.jpg"></span></p>

  <p class="indent">For example, consider formula (<a href="../Text/ch01b.html#ch01eq-lev2sec14-6">6</a>); <a href="../Text/ch01b.html#ch01tab04">Table 1</a> shows successive stages in its processing. The first line of that table shows the formula after right parentheses have been replaced by the leading element of the corresponding cycle; succeeding lines show the progress that is made as more and more elements are tagged. A cursor shows the current point of interest in the formula. The output is “(<em>a d g</em>) (<em>c e b</em>) (<em>f</em>)”; notice that singleton cycles will appear in the output.</p>

  <p class="noindent"><strong>A</strong> <code>MIX</code> <strong>program</strong>. To implement this algorithm for <code>MIX</code>, the “tagging” can be done by using the sign of a word. Suppose our input is punched onto cards in the following format: An 80-column card is divided into 16 five-character fields. Each field is either (a) ‘<span class="ent">⊔</span><span class="ent">⊔</span><span class="ent">⊔</span><span class="ent">⊔</span>(’, representing the left parenthesis beginning a cycle; (b) ‘)<span class="ent">⊔</span><span class="ent">⊔</span><span class="ent">⊔</span><span class="ent">⊔</span>’, representing the right parenthesis ending a cycle; (c) ‘<span class="ent">⊔</span><span class="ent">⊔</span><span class="ent">⊔</span><span class="ent">⊔</span><span class="ent">⊔</span>’, all blanks, which may be inserted anywhere to fill space; or (d) anything else, representing an element to be permuted. The last card of the input is recognized by having columns 76–80 equal to ‘<span class="ent">⊔</span><span class="ent">⊔</span><span class="ent">⊔</span><span class="ent">⊔</span>=’. For example, (<a href="../Text/ch01b.html#ch01eq-lev2sec14-6">6</a>) might be punched <a id="page_168"></a>on two cards as follows:</p>

  <div class="image"><img src="../Images/ch01/168tab01.jpg"></div>

  <p class="noindent">The output of our program will consist of a verbatim copy of the input, followed by the answer in essentially the same format.</p>

  <p class="noindent"><a id="ch01b_pro_a"></a><strong>Program A</strong> (<em>Multiply permutations in cycle form</em>). This program implements <a href="../Text/ch01b.html#ch01alg-lev2sec14-A">Algorithm A</a>, and it also includes provision for input, output, and the removing of singleton cycles. But it doesn’t catch errors in the input.</p>

  <div class="image3"><img src="../Images/ch01/168pro01.jpg"></div>

  <div class="image3"><img src="../Images/ch01/168pro01a.jpg"></div>

  <div class="image3"><a id="page_169"></a><img src="../Images/ch01/168pro01b.jpg"></div>

  <p class="indent"><a id="page_170"></a>This program of approximately 75 instructions is quite a bit longer than the programs of the previous section, and indeed it is longer than most of the programs we will meet in this book. Its length is not formidable, however, since it divides into several small parts that are fairly independent. Lines 07–22 read in the input cards and print a copy of each card; lines 23–38 accomplish step A1 of the algorithm, the preconditioning of the input; lines 39–46 and 64–86 do the main business of <a href="../Text/ch01b.html#ch01alg-lev2sec14-A">Algorithm A</a>; and lines 48–57 output the answer.</p>

  <p class="indent">The reader will find it instructive to study as many of the <code>MIX</code> programs given in this book as possible. An ability to read and to understand computer programs that you haven’t written yourself is exceedingly important; yet such training has been sadly neglected in too many computer courses, and some horribly inefficient uses of computing machinery have arisen as a result.</p>

  <p class="noindent"><strong>Timing.</strong> The parts of <a href="../Text/ch01b.html#ch01b_pro_a">Program A</a> that are not concerned with input-output have been decorated with frequency counts, as we did for Program 1.3.2M. Thus, for example, line 30 is supposedly executed <em>B</em> times. For convenience we shall assume that no blank words appear in the input except at the extreme right end; under this assumption, line 71 is never executed and the jump in line 32 never occurs.</p>

  <p class="indent">By simple addition the total time to execute the program is</p>

  <div class="equation"><a id="ch01eq-lev2sec14-7"></a><img src="../Images/ch01/170equ01.jpg"></div>

  <p class="noindent">plus the time for input and output. In order to understand the meaning of formula (<a href="../Text/ch01b.html#ch01eq-lev2sec14-7">7</a>), we need to examine the fifteen unknowns <em>A</em>, <em>B</em>, <em>C</em>, <em>D</em>, <em>E</em>, <em>F</em>, <em>G</em>, <em>H</em>, <em>J</em>, <em>K</em>, <em>L</em>, <em>P</em>, <em>Q</em>, <em>R</em>, <em>S</em> and we must relate them to pertinent characteristics of the input. Let’s look at some general principles of attack for problems of this kind.</p>

  <p class="indent">First we can apply “Kirchhoff’s first law” of electrical circuit theory: The number of times an instruction is executed must equal the number of times we transfer to that instruction. This seemingly obvious rule often relates several quantities in a nonobvious way. Analyzing the flow of <a href="../Text/ch01b.html#ch01b_pro_a">Program A</a>, we get the following equations.</p>

  <div class="image"><img src="../Images/ch01/170tab01.jpg"></div>

  <p class="noindent">The equations given by Kirchhoff’s law will not all be independent; in the present case, for example, we see that the first and second equations are obviously equivalent. Furthermore, the last equation can be deduced from the others, <a id="page_171"></a>since the third, fourth, and fifth imply that <em>H</em> = <em>R</em>; hence the sixth says that <em>K</em> = <em>L</em> − <em>R</em>. At any rate we have already eliminated six of our fifteen unknowns:</p>

  <div class="equation"><a id="ch01eq-lev2sec14-8"></a><img src="../Images/ch01/171equ01.jpg"></div>

  <p class="noindent">Kirchhoff’s first law is an effective tool that is analyzed more closely in <a href="../Text/ch02b.html#ch02lev3sec1">Section 2.3.4.1</a>.</p>

  <p class="indent">The next step is to try to match up the variables with important characteristics of the data. We find from lines 24, 25, 30, and 36 that</p>

  <div class="equation"><a id="ch01eq-lev2sec14-9"></a><img src="../Images/ch01/171equ02.jpg"></div>

  <p class="noindent">where <em>X</em> is the number of input cards. From line 28,</p>

  <div class="equation"><a id="ch01eq-lev2sec14-10"></a><img src="../Images/ch01/171equ03.jpg"></div>

  <p class="noindent">Similarly, from line 34,</p>

  <div class="equation"><a id="ch01eq-lev2sec14-11"></a><img src="../Images/ch01/171equ04.jpg"></div>

  <p class="noindent">Now (<a href="../Text/ch01b.html#ch01eq-lev2sec14-10">10</a>) and (<a href="../Text/ch01b.html#ch01eq-lev2sec14-11">11</a>) give us a fact that could not be deduced by Kirchhoff’s law:</p>

  <div class="equation"><a id="ch01eq-lev2sec14-12"></a><img src="../Images/ch01/171equ05.jpg"></div>

  <p class="indent">From line 64,</p>

  <div class="equation"><a id="ch01eq-lev2sec14-13"></a><img src="../Images/ch01/171equ06.jpg"></div>

  <p class="noindent">Line 82 says <em>R</em> is equal to this same quantity; the fact that <em>H</em> = <em>R was</em> in this case deducible from Kirchhoff’s law, since it already appears in (<a href="../Text/ch01b.html#ch01eq-lev2sec14-8">8</a>).</p>

  <p class="indent">Using the fact that each nonblank word is ultimately tagged, and lines 29, 35, and 67, we find that</p>

  <div class="equation"><a id="ch01eq-lev2sec14-14"></a><img src="../Images/ch01/171equ07.jpg"></div>

  <p class="noindent">where <em>Y</em> is the number of nonblank words appearing in the input permutations. From the fact that every <em>distinct</em> element appearing in the input permutation is written into the output just once, either at line 65 or line 72, we have</p>

  <div class="equation"><a id="ch01eq-lev2sec14-15"></a><img src="../Images/ch01/171equ08.jpg"></div>

  <p class="noindent">(See Eqs. (<a href="../Text/ch01b.html#ch01eq-lev2sec14-8">8</a>).) A moment’s reflection makes this clear from line 80 as well. Finally, we see from line 85 that</p>

  <div class="equation"><a id="ch01eq-lev2sec14-16"></a><img src="../Images/ch01/171equ09.jpg"></div>

  <p class="indent">Clearly the quantities <em>B, C, H, J, P</em>, and <em>S</em> that we have now interpreted are essentially independent parameters that may be expected to enter into the timing of <a href="../Text/ch01b.html#ch01b_pro_a">Program A</a>.</p>

  <p class="indent">The results we have obtained so far leave us with only the unknowns <em>G</em> and <em>L</em> to be analyzed. For these we must use a little more ingenuity. The scans of the input that start at lines 41 and 74 always terminate either at line 47 (the last time) or at line 80. During each one of these <em>P</em> + 1 loops, the instruction <a id="page_172"></a>‘<code>INC3 1</code>’ is performed <em>B</em> + <em>C</em> times; this takes place only at lines 44, 68, and 77, so we get the nontrivial relation</p>

  <div class="equation"><a id="ch01eq-lev2sec14-17"></a><img src="../Images/ch01/172equ01.jpg"></div>

  <p class="noindent">connecting our unknowns <em>G</em> and <em>L</em>. Fortunately, the running time (<a href="../Text/ch01b.html#ch01eq-lev2sec14-7">7</a>) is a function of <em>G</em>+<em>L</em> (it involves · · · + 3<em>F</em>+4<em>G</em>+· · ·+3<em>K</em>+4<em>L</em>+· · · = · · ·+7<em>G</em>+7<em>L</em>+ · · ·), so we need not try to analyze the individual quantities <em>G</em> and <em>L</em> any further.</p>

  <p class="indent">Summing up all these results, we find that the total time exclusive of input-output comes to</p>

  <div class="equation"><a id="ch01eq-lev2sec14-18"></a><img src="../Images/ch01/172equ02.jpg"></div>

  <p class="noindent">in this formula, new names for the data characteristics have been used as follows:</p>

  <div class="equation"><a id="ch01eq-lev2sec14-19"></a><img src="../Images/ch01/172equ03.jpg"></div>

  <p class="noindent">In this way we have found that analysis of a program like <a href="../Text/ch01b.html#ch01b_pro_a">Program A</a> is in many respects like solving an amusing puzzle.</p>

  <p class="indent">We will show below that, if the output permutation is assumed to be random, the quantities <em>U</em> and <em>υ</em> will be <em>H</em><sub><em>N</em></sub> and 1, respectively, on the average.</p>

  <p class="noindent"><strong>Another approach.</strong> <a href="../Text/ch01b.html#ch01alg-lev2sec14-A">Algorithm A</a> multiplies permutations together much as people ordinarily do the same job. Quite often we find that problems to be solved by computer are very similar to problems that have confronted humans for many years; therefore time-honored methods of solution, which have evolved for use by mortals such as we, are also appropriate procedures for computer algorithms.</p>

  <p class="indent">Just as often, however, we encounter new methods that turn out to be superior for computers, although they are quite unsuitable for human use. The central reason is that a computer “thinks” differently; it has a different kind of memory for facts. An instance of this difference may be seen in our permutation-multiplication problem: Using the algorithm below, a computer can do the multiplication in one sweep over the formula, remembering the entire current state of the permutation as its cycles are being multiplied. The human-oriented <a href="../Text/ch01b.html#ch01alg-lev2sec14-A">Algorithm A</a> scans the formula many times, once for each element of the output, but the new algorithm handles everything in one scan. This is a feat that could not be done reliably by <em>Homo sapiens</em>.</p>

  <p class="indent">What is this computer-oriented method for permutation multiplication? <a href="../Text/ch01b.html#ch01tab05">Table 2</a> illustrates the basic idea. The column below each character of the cycle form in that table says what permutation is represented by the partial cycles <em>to the right</em>. For example, the fragmentary formula “<em>... d e</em>)(<em>b g f a e</em>)” represents</p>

  <div class="image">
    <a id="page_173"></a><a id="ch01tab05"></a><img src="../Images/ch01/173tab01.jpg">

    <p class="tab-caption"><strong>Table 2</strong> Multiplying Permutations in One Pass</p>
  </div>

  <p class="noindent">the permutation</p>

  <div class="image"><img src="../Images/ch01/e173_01.jpg"></div>

  <p class="noindent">which appears under the rightmost <em>d</em> of the table, except that the unknown destination of <em>e</em> is represented there by ‘)’ not ‘?’.</p>

  <p class="indent">Inspection of <a href="../Text/ch01b.html#ch01tab05">Table 2</a> shows that it can be created systematically, if we start with the identity permutation on the right and work backward from right to left. The column below letter <em>x</em> differs from the column to its right (which records the previous status) only in row <em>x</em>; and the new value in row <em>x</em> is the one that disappeared in the preceding change. More precisely, we have the following algorithm:</p>

  <p class="noindent"><a id="ch01alg-lev2sec14-B"></a><strong>Algorithm B</strong> (<em>Multiply permutations in cycle form</em>). This algorithm accomplishes essentially the same result as <a href="../Text/ch01b.html#ch01alg-lev2sec14-A">Algorithm A</a>. Assume that the elements permuted are named <em>x</em><sub>1</sub>, <em>x</em><sub>2</sub>, ..., <em>x</em><sub><em>n</em></sub>. We use an auxiliary table <em>T</em> [1], <em>T</em> [2], ..., <em>T</em> [n]; upon termination of this algorithm, <em>x</em><sub><em>i</em></sub> goes to <em>x</em><sub><em>j</em></sub> under the input permutation if and only if <em>T</em>[<em>i</em>] = <em>j</em>.</p>

  <p class="indenthanging"><strong>B1.</strong> [Initialize.] Set <em>T</em>[<em>k</em>] ← <em>k</em> for 1 ≤ <em>k</em> ≤ <em>n</em>. Also, prepare to scan the input from right to left.</p>

  <p class="indenthanging"><strong>B2.</strong> [Next element.] Examine the next element of the input (right to left). If the input has been exhausted, the algorithm terminates. If the element is a “)”, set <em>Z</em> ← 0 and repeat step B2; if it is a “(”, go to B4. Otherwise the element is <em>x</em><sub><em>i</em></sub> for some <em>i</em>; go on to B3.</p>

  <p class="indenthanging"><strong>B3.</strong> [Change <em>T</em> [<em>i</em>].] Exchange <em>Z</em> ↔ <em>T</em> [<em>i</em>]. If this makes <em>T</em> [<em>i</em>] = 0, set <em>j</em> ← <em>i</em>. Return to step B2.</p>

  <p class="indenthanging"><strong>B4.</strong> [Change <em>T</em> [<em>j</em>].] Set <em>T</em> [<em>j</em>] ← <em>Z</em>. (At this point, <em>j</em> is the row that shows a “)” entry in the notation of <a href="../Text/ch01b.html#ch01tab05">Table 2</a>, corresponding to the right parenthesis that matches the left parenthesis just scanned.) Return to step B2. <span class="middle"><img src="../Images/ch01/common-01.jpg"></span></p>

  <p class="indent">Of course, after this algorithm has been performed, we still must output the contents of table <em>T</em> in cycle form; this is easily done by a “tagging” method, as we shall see below.</p>

  <div class="image">
    <a id="page_174"></a><a id="ch01fig21"></a><img src="../Images/ch01/01fig21.jpg">

    <p class="fig-caption"><strong>Fig. 21.</strong> <a href="../Text/ch01b.html#ch01alg-lev2sec14-B">Algorithm B</a> for multiplying permutations.</p>
  </div>

  <p class="indent">Let us now write a <code>MIX</code> program based on the new algorithm. We wish to use the same ground rules as those in <a href="../Text/ch01b.html#ch01b_pro_a">Program A</a>, with input and output in the same format as before. A slight problem presents itself; namely, how can we implement <a href="../Text/ch01b.html#ch01alg-lev2sec14-B">Algorithm B</a> without knowing in advance what the elements <em>x</em><sub>1</sub>,<em>x</em><sub>2</sub>, ..., <em>x</em><sub><em>n</em></sub> are? We don’t know <em>n</em>, and we don’t know whether the element named <em>b</em> is to be <em>x</em><sub>1</sub>, or <em>x</em><sub>2</sub>, etc. A simple way to solve this problem is to maintain a table of the element names that have been encountered so far, and to search for the current name each time (see lines 35–44 in the program below).</p>

  <p class="noindent"><a id="ch01b_pro_b"></a><strong>Program B</strong> (<em>Same effect as <a href="../Text/ch01b.html#ch01b_pro_b">Program A</a></em>). rX ≡ <em>Z</em>; rI4 ≡ <em>i</em>; rI1 ≡ <em>j</em>; rI3 = <em>n</em>, the number of distinct names seen.</p>

  <div class="image3"><img src="../Images/ch01/174pro01.jpg"></div>

  <div class="image3"><img src="../Images/ch01/174pro01a.jpg"></div>

  <p class="noindent"><a id="page_175"></a>Lines 54–68, which construct the cycle notation from the <em>T</em> table and the table of names, make a rather pretty little algorithm that merits some study. The quantities <em>A</em>, <em>B</em>, ..., <em>R</em>, <em>S</em>, <em>T</em>, <em>W</em>, <em>Z</em> that enter into the timing of this program are, of course, different from the quantities of the same name in the analysis of <a href="../Text/ch01b.html#ch01b_pro_a">Program A</a>. The reader will find it an interesting exercise to analyze these times (see <a href="../Text/ch01c.html#ch01ex_2_14_10">exercise 10</a>).</p>

  <p class="indent">Experience shows that the main portion of the execution time of <a href="../Text/ch01b.html#ch01b_pro_b">Program B</a> will be spent in searching the names table — this is quantity <em>F</em> in the timing. Much better algorithms for searching and building dictionaries of names are available; they are called <em>symbol table algorithms</em>, and they are of great importance in computer applications. Chapter 6 contains a thorough discussion of efficient symbol table algorithms.</p>

  <p class="noindent"><strong>Inverses.</strong> The inverse <em>π</em><sup>−</sup> of a permutation <em>π</em> is the rearrangement that undoes the effect of <em>π</em>; if <em>i</em> goes to <em>j</em> under <em>π</em>, then <em>j</em> goes to <em>i</em> under <em>π</em><sup>−</sup>. Thus the product <em>ππ</em><sup>−</sup> equals the identity permutation, and so does the product <em>π</em><sup>−</sup><em>π</em>. <a id="page_176"></a>People often denote the inverse by <em>π</em><sup>−1</sup> instead of <em>π</em><sup>−</sup>, but the superscript 1 is redundant (for the same reason that <em>x</em><sup>1</sup> = <em>x</em>).</p>

  <p class="indent">Every permutation has an inverse. For example, the inverse of</p>

  <div class="image"><img src="../Images/ch01/e176_01.jpg"></div>

  <p class="noindent">We will now consider some simple algorithms for computing the inverse of a permutation.</p>

  <p class="indent">In the rest of this section, let us assume that we are dealing with permutations of the numbers {1<em>,</em> 2<em>, ..., n</em>}. If <em>X</em>[1]<em>X</em>[2] <em>... X</em>[<em>n</em>] is such a permutation, there is a simple method to compute its inverse: Set <em>Y</em>[<em>X</em>[<em>k</em>]] ← <em>k</em> for 1 ≤ <em>k</em> ≤ <em>n</em>. Then <em>Y</em>[1] <em>Y</em>[2] <em>... Y</em>[<em>n</em>] is the desired inverse. This method uses 2<em>n</em> memory cells, namely <em>n</em> for <em>X</em> and <em>n</em> for <em>Y</em>.</p>

  <p class="indent">Just for fun, however, let’s suppose that <em>n</em> is very large and suppose also that we wish to compute the inverse of <em>X</em>[1] <em>X</em>[2] <em>... X</em>[<em>n</em>] without using much additional memory space. We want to compute the inverse “in place,” so that after our algorithm is finished the array <em>X</em>[1] <em>X</em>[2] <em>... X</em>[<em>n</em>] will be the inverse of the original permutation. Merely setting <em>X</em>[<em>X</em>[<em>k</em>]] ← <em>k</em> for 1 ≤ k ≤ n will certainly fail, but by considering the cycle structure we can derive the following simple algorithm:</p>

  <p class="noindent"><a id="ch01alg-lev2sec14-I"></a><strong>Algorithm I</strong> (<em>Inverse in place</em>). Replace <em>X</em>[1]<em>X</em>[2] <em>... X</em>[<em>n</em>], a permutation of {1<em>,</em> 2<em>, ..., n</em>}, by its inverse. This algorithm is due to Bing-Chao Huang [<em>Inf. Proc. Letters</em> <strong>12</strong> (1981), 237–238].</p>

  <p class="indenthanging"><strong>I1.</strong> [Initialize.] Set <em>m</em> ← <em>n</em>, <em>j</em> ← −1.</p>

  <p class="indenthanging"><strong>I2.</strong> [Next element.] Set <em>i</em> ← <em>X</em>[<em>m</em>]. If <em>i</em> &lt; 0, go to step I5 (the element has already been processed).</p>

  <p class="indenthanging"><strong>I3.</strong> [Invert one.] (At this point <em>j</em> &lt; 0 and <em>i</em> = <em>X</em>[<em>m</em>]. If <em>m</em> is not the largest element of its cycle, the original permutation had <em>X</em> [−<em>j</em>] = <em>m</em>.) Set <em>X</em>[<em>m</em>] ← <em>j</em>, <em>j</em> ← −<em>m</em>, <em>m</em> ← <em>i</em>, <em>i</em> ← <em>X</em>[<em>m</em>].</p>

  <p class="indenthanging"><strong>I4.</strong> [End of cycle?] If <em>i</em> &gt; 0, go back to I3 (the cycle has not ended); otherwise set <em>i</em> ← <em>j</em>. (In the latter case, the original permutation had <em>X</em> [−<em>j</em>] = <em>m</em>, and <em>m</em> is largest in its cycle.)</p>

  <p class="indenthanging"><strong>I5.</strong> [Store final value.] Set <em>X</em>[<em>m</em>] ← −<em>i</em>. (Originally <em>X</em> [−<em>i</em>] was equal to <em>m</em>.)</p>

  <p class="indenthanging"><strong>I6.</strong> [Loop on <em>m</em>.] Decrease <em>m</em> by 1. If <em>m</em> &gt; 0, go back to I2; otherwise the algorithm terminates. <span class="middle"><img src="../Images/ch01/common-01.jpg"></span></p>

  <p class="noindent">See <a href="../Text/ch01b.html#ch01tab06">Table 3</a> for an example of this algorithm. The method is based on inversion of successive cycles of the permutation, tagging the inverted elements by making them negative, afterwards restoring the correct sign.</p>

  <p class="indent"><a href="../Text/ch01b.html#ch01alg-lev2sec14-I">Algorithm I</a> resembles parts of <a href="../Text/ch01b.html#ch01alg-lev2sec14-A">Algorithm A</a>, and it very strongly resembles the cycle-finding algorithm in <a href="../Text/ch01b.html#ch01b_pro_b">Program B</a> (lines 54–68). Thus it is typical of a number of algorithms involving rearrangements. When preparing a <code>MIX</code> implementation, we find that it is most convenient to keep the value of –<em>i</em> in a register instead of <em>i</em> itself:</p>

  <div class="image">
    <a id="page_177"></a><a id="ch01tab06"></a><img src="../Images/ch01/177tab01.jpg">

    <p class="tab-caption"><strong>Table 3</strong> Computing the Inverse of 6 2 1 5 4 3 by <a href="../Text/ch01b.html#ch01alg-lev2sec14-I">Algorithm I</a></p>
  </div>

  <p class="noindent"><a id="ch01b_pro_i"></a><strong>Program I</strong> (<em>Inverse in place</em>). rI1 ≡ <em>m</em>; rI2 ≡ −<em>i</em>; rI3 ≡ <em>j</em>; and <em>n</em> = <code>N</code>, a symbol to be defined when this program is assembled as part of a larger routine.</p>

  <div class="image3"><img src="../Images/ch01/177pro01.jpg"></div>

  <p class="indent">The timing for this program is easily worked out in the manner shown earlier; every element <em>X</em>[<em>m</em>] is set first to a negative value in step I3 and later to a positive value in step I5. The total time comes to (14<em>N</em> + <em>C</em> + 2)<em>u</em>, where <em>N</em> is the size of the array and <em>C</em> is the total number of cycles. The behavior of <em>C</em> in a random permutation is analyzed below.</p>

  <p class="indent">There is almost always more than one algorithm to do any given task, so we would expect that there may be another way to invert a permutation. The following ingenious algorithm is due to J. Boothroyd:</p>

  <p class="noindent"><a id="ch01alg-lev2sec14-J"></a><strong>Algorithm J</strong> (<em>Inverse in place</em>). This algorithm has the same effect as <a href="../Text/ch01b.html#ch01alg-lev2sec14-I">Algorithm I</a> but uses a different method.</p>

  <p class="indenthanging"><strong>J1.</strong> [Negate all.] Set <em>X</em>[<em>k</em>] ← −<em>X</em> [<em>k</em>], for 1 ≤ <em>k</em> ≤ <em>n</em>. Also set <em>m</em> ← <em>n</em>.</p>

  <p class="indenthanging"><strong>J2.</strong> [Initialize <em>j</em>.] Set <em>j</em> ← <em>m</em>.</p>

  <p class="indenthanging"><strong>J3.</strong> [Find negative entry.] Set <em>i</em> ← <em>X</em>[<em>j</em>]. If <em>i</em> &gt; 0, set <em>j</em> ← <em>i</em> and repeat this step.</p>

  <p class="indenthanging"><strong>J4.</strong> [Invert.] Set <em>X</em>[<em>j</em>] ← <em>X</em> [−<em>i</em>], <em>X</em> [−<em>i</em>] ← <em>m</em>.</p>

  <p class="indenthanging"><strong>J5.</strong> [Loop on <em>m</em>.] Decrease <em>m</em> by 1; if <em>m</em> &gt; 0, go back to J2. Otherwise the algorithm terminates. <span class="middle"><img src="../Images/ch01/box.jpg"></span></p>

  <div class="image">
    <a id="page_178"></a><a id="ch01tab07"></a><img src="../Images/ch01/178tab01.jpg">

    <p class="tab-caption"><strong>Table 4</strong> Computing the Inverse of 6 2 1 5 4 3 by <a href="../Text/ch01b.html#ch01alg-lev2sec14-J">Algorithm J</a></p>
  </div>

  <p class="indent">See <a href="../Text/ch01b.html#ch01tab07">Table 4</a> for an example of Boothroyd’s algorithm. Again the method is essentially based on the cycle structure, but this time it is less obvious that the algorithm really works! Verification is left to the reader (see <a href="../Text/ch01c.html#ch01ex_2_14_13">exercise 13</a>).</p>

  <p class="noindent"><a id="ch01b_pro_j"></a><strong>Program J</strong> (<em>Analogous to <a href="../Text/ch01b.html#ch01b_pro_i">Program I</a></em>). rI1 ≡ <em>m</em>; rI2 ≡ <em>j</em>; rI3 ≡ −<em>i</em>.</p>

  <div class="image3"><img src="../Images/ch01/178pro01.jpg"></div>

  <p class="noindent">To decide how fast this program runs, we need to know the quantity <em>A</em>; this quantity is so interesting and instructive, it has been left as an exercise (see <a href="../Text/ch01c.html#ch01ex_2_14_14">exercise 14</a>).</p>

  <p class="indent">Although <a href="../Text/ch01b.html#ch01alg-lev2sec14-J">Algorithm J</a> is deucedly clever, analysis shows that <a href="../Text/ch01b.html#ch01alg-lev2sec14-I">Algorithm I</a> is definitely superior. In fact, the average running time of <a href="../Text/ch01b.html#ch01alg-lev2sec14-J">Algorithm J</a> turns out to be essentially proportional to <em>n</em> ln <em>n</em>, while that of <a href="../Text/ch01b.html#ch01alg-lev2sec14-I">Algorithm I</a> is essentially proportional to <em>n</em>. Maybe some day someone will find a use for <a href="../Text/ch01b.html#ch01alg-lev2sec14-J">Algorithm J</a> (or some related modification); it is a bit too pretty to be forgotten altogether.</p>

  <p class="noindent"><strong>An unusual correspondence.</strong> We have already remarked that the cycle notation for a permutation is not unique; the six-element permutation (1 6 3)(4 5) may be written (5 4)(3 1 6), etc. It will be useful to consider a <em>canonical form</em> for the cyclic notation; the canonical form <em>is</em> unique. To get the canonical form, proceed as follows:</p>

  <p class="indenthangingA">a) Write all singleton cycles explicitly.</p>

  <p class="indenthangingA"><a id="page_179"></a>b) Within each cycle, put the smallest number first.</p>

  <p class="indenthangingA">c) Order the cycles in <em>decreasing</em> order of the first number in the cycle.</p>

  <p class="noindent">For example, starting with (3 1 6)(5 4) we would get</p>

  <div class="equation"><a id="ch01eq-lev2sec14-20"></a><img src="../Images/ch01/179equ01.jpg"></div>

  <p class="indent">The important property of this canonical form is that the parentheses may be dropped and uniquely reconstructed again. Thus there is only one way to insert parentheses in “4 5 2 1 6 3” to get a canonical cycle form: One must insert a left parenthesis just before each <em>left-to-right minimum</em> (namely, just before each element that is preceded by no smaller elements).</p>

  <p class="indent">This insertion and removal of parentheses gives us an unusual one-to-one correspondence between the set of all permutations expressed in cycle form and the set of all permutations expressed in linear form. For example, the permutation 6 2 1 5 4 3 in canonical cycle form is (4 5) (2) (1 6 3); remove parentheses to get 4 5 2 1 6 3, which in cycle form is (2 5 6 3) (1 4); remove parentheses to get 2 5 6 3 1 4, which in cycle form is (3 6 4) (1 2 5); etc.</p>

  <p class="indent">This correspondence has numerous applications to the study of permutations of different types. For example, let us ask “How many cycles does a permutation of <em>n</em> elements have, on the average?” To answer this question we consider the set of all <em>n</em>! permutations expressed in canonical form, and drop the parentheses; we are left with the set of all <em>n</em>! permutations in some order. Our original question is therefore equivalent to, “How many left-to-right minima does a permutation of <em>n</em> elements have, on the average?” We have already answered the latter question in <a href="../Text/ch01a.html#ch01lev2sec10">Section 1.2.10</a>; this was the quantity (<em>A</em> + 1) in the analysis of <a href="../Text/ch01a.html#ch01alg-lev2sec10-M">Algorithm 1.2.10M</a>, for which we found the statistics</p>

  <div class="equation"><a id="ch01eq-lev2sec14-21"></a><img src="../Images/ch01/179equ02.jpg"></div>

  <p class="noindent">(Actually, we discussed the average number of right-to-left maxima, but that’s clearly the same as the number of left-to-right minima.) Furthermore, we proved in essence that a permutation of <em>n</em> objects has <em>k</em> left-to-right minima with probability <span class="middle"><img src="../Images/ch01/e179_01.jpg"></span>; therefore <em>a permutation of n objects has k cycles with probability</em> <span class="middle"><img src="../Images/ch01/e179_02.jpg"></span>.</p>

  <p class="indent">We can also ask about the average distance <em>between</em> left-to-right minima, which becomes equivalent to the average length of a cycle. By (<a href="../Text/ch01b.html#ch01eq-lev2sec14-21">21</a>), the <em>total</em> number of cycles among all the <em>n</em>! permutations is <em>n</em>! <em>H</em><sub><em>n</em></sub>, since it is <em>n</em>! times the <em>average</em> number of cycles. If we pick one of these cycles at random, what is its average length?</p>

  <p class="indent">Imagine all <em>n</em>! permutations of {1<em>,</em> 2<em>, ..., n</em>} written down in cycle notation; how many three-cycles are present? To answer this question, let us consider how many times a particular three-cycle (<em>x y z</em>) appears: It clearly appears in exactly (<em>n</em> − 3)! of the permutations, since this is the number of ways the remaining n − 3 elements may be permuted. Now the number of different possible three-cycles (<em>x y z</em>) is <em>n</em>(<em>n</em> − 1)(<em>n</em> − 2)<em>/</em>3, since there are <em>n</em> choices for <em>x</em>, (<em>n</em> − 1) for <em>y</em>, (<em>n</em> − 2) for <em>z</em>, and among these <em>n</em>(<em>n</em> − 1)(<em>n</em> − 2) choices each different three-cycle <a id="page_180"></a>has appeared in three forms (<em>x y z</em>), (<em>y z x</em>), (<em>z x y</em>). Therefore the total number of three-cycles among all n! permutations is <em>n</em>(<em>n</em> − 1)(<em>n</em> − 2)/3 times (<em>n</em> − 3)!, namely <em>n</em>!/3. Similarly, the total number of <em>m</em>-cycles is <em>n</em>!/m, for 1 ≤ <em>m</em> ≤ <em>n</em>. (This provides another simple proof of the fact that the total number of cycles is <em>n</em>! <em>H</em><sub><em>n</em></sub>; hence the average number of cycles in a random permutation is <em>H</em><sub><em>n</em></sub>, as we already knew.) <a href="../Text/ch01c.html#ch01ex_2_14_17">Exercise 17</a> shows that the average length of a randomly chosen cycle is <em>n/H<sub><em>n</em></sub></em>, if we consider the <em>n</em>! <em>H</em><sub><em>n</em></sub><em>cycles</em> to be equally probable; but if we choose an <em>element</em> at random in a random permutation, the average length of the cycle containing that element is somewhat greater than <em>n/H</em><sub><em>n</em></sub>.</p>

  <p class="indent">To complete our analyses of <a href="../Text/ch01b.html#ch01alg-lev2sec14-A">Algorithms A</a> and <a href="../Text/ch01b.html#ch01alg-lev2sec14-B">B</a>, we would like to know the average number of <em>singleton cycles</em> in a random permutation. This is an interesting problem. Suppose we write down the <em>n</em>! permutations, listing first those with no singleton cycles, then those with just one, etc.; for example, if <em>n</em> = 4,</p>

  <div class="image"><img src="../Images/ch01/e180_01.jpg"></div>

  <p class="noindent">(Singleton cycles, which are the elements that remain fixed by a permutation, have been specially marked in this list.) Permutations with no fixed elements are called <em>derangements</em>; the number of derangements is the number of ways to put <em>n</em> letters into <em>n</em> envelopes, getting them all wrong.</p>

  <p class="indent">Let <em>P</em><sub>nk</sub> be the number of permutations of <em>n</em> objects having exactly <em>k</em> fixed elements, so that for example,</p>

  <p class="center"><em>P</em><sub>40</sub> = 9,&nbsp;&nbsp;&nbsp;<em>P</em><sub>41</sub> = 8,&nbsp;&nbsp;&nbsp;<em>P</em><sub>42</sub> = 6,&nbsp;&nbsp;&nbsp;<em>P</em><sub>43</sub> = 0,&nbsp;&nbsp;&nbsp;<em>P</em><sub>44</sub> = 1.</p>

  <p class="noindent">An examination of the list above reveals the principal relationship between these numbers: We can get all permutations with <em>k</em> fixed elements by first choosing the <em>k</em> that are to be fixed (this can be done in <span class="middle"><img src="../Images/ch01/e180_02.jpg"></span> ways) and then permuting the remaining <em>n</em> − <em>k</em> elements in all <em>P</em><sub>(<em>n</em>−<em>k</em>)0</sub> ways that leave no further elements fixed. Hence</p>

  <div class="equation"><a id="ch01eq-lev2sec14-22"></a><img src="../Images/ch01/180equ01.jpg"></div>

  <p class="noindent">We also have the rule that “the whole is the sum of its parts”:</p>

  <div class="equation"><a id="ch01eq-lev2sec14-23"></a><img src="../Images/ch01/180equ02.jpg"></div>

  <p class="noindent">Combining Eqs. (<a href="../Text/ch01b.html#ch01eq-lev2sec14-22">22</a>) and (<a href="../Text/ch01b.html#ch01eq-lev2sec14-23">23</a>) and rewriting the result slightly, we find that</p>

  <div class="equation"><a id="ch01eq-lev2sec14-24"></a><img src="../Images/ch01/180equ03.jpg"></div>

  <p class="noindent">an equation that must be true for all positive integers <em>n</em>. This equation has already confronted us before — it appears in <a href="../Text/ch01.html#ch01lev2sec5">Section 1.2.5</a> in connection with <a id="page_181"></a>Stirling’s attempt to generalize the factorial function — and we found a simple derivation of its coefficients in <a href="../Text/ch01a.html#ch01lev2sec6">Section 1.2.6</a> (<a href="../Text/ch01a.html#ch01exam05">Example 5</a>). We conclude that</p>

  <div class="equation"><a id="ch01eq-lev2sec14-25"></a><img src="../Images/ch01/181equ01.jpg"></div>

  <p class="indent">Now let <em>p</em><sub><em>nk</em></sub> be the probability that a permutation of <em>n</em> objects has exactly <em>k</em> singleton cycles. Since <em>p</em><sub><em>nk</em></sub> = <em>P</em><sub><em>nk</em></sub>/<em>n</em>!, we have from Eqs. (<a href="../Text/ch01b.html#ch01eq-lev2sec14-22">22</a>) and (<a href="../Text/ch01b.html#ch01eq-lev2sec14-25">25</a>)</p>

  <div class="equation"><a id="ch01eq-lev2sec14-26"></a><img src="../Images/ch01/181equ02.jpg"></div>

  <p class="noindent">The generating function <em>G</em><sub><em>n</em></sub> (<em>z</em>) = <em>p</em><sub><em>n</em>0</sub> + <em>p</em><sub><em>n</em>1</sub><em>z</em> + <em>p</em><sub><em>n</em>2</sub><em>z</em><sup>2</sup> + · · · is therefore</p>

  <div class="equation"><a id="ch01eq-lev2sec14-27"></a><img src="../Images/ch01/181equ03.jpg"></div>

  <p class="noindent">From this formula it follows that <em>G</em>′<sub><em>n</em></sub> (<em>z</em>) = <em>G</em><sub>n−1</sub> (<em>z</em>), and with the methods of <a href="../Text/ch01a.html#ch01lev2sec10">Section 1.2.10</a> we obtain the following statistics on the number of singleton cycles:</p>

  <div class="equation"><a id="ch01eq-lev2sec14-28"></a><img src="../Images/ch01/181equ04.jpg"></div>

  <p class="indent">A somewhat more direct way to count the number of permutations having no singleton cycles follows from the <em>principle of inclusion and exclusion</em>, which is an important method for many enumeration problems. The general principle of inclusion and exclusion may be formulated as follows: We are given <em>N</em> elements, and <em>M</em> subsets, <em>S</em><sub>1</sub>,<em>S</em><sub>2</sub>, ..., <em>S</em><sub><em>M</em></sub>, of these elements; and our goal is to count how many of the elements lie in none of the subsets. Let |<em>S</em>| denote the number of elements in a set <em>S</em>; then the desired number of objects in none of the sets <em>S</em><sub><em>j</em></sub> is</p>

  <div class="equation"><a id="ch01eq-lev2sec14-29"></a><img src="../Images/ch01/181equ05.jpg"></div>

  <p class="noindent">(Thus we first subtract the number of elements in <em>S</em><sub>1</sub>, ..., <em>S</em><sub><em>M</em></sub> from the total number, <em>N</em>; but this underestimates the desired total. So we add back the number of elements that are common to pairs of sets, <em>S</em><sub><em>j</em></sub> ∩ <em>S</em><sub><em>k</em></sub>, for each pair <em>S</em><sub><em>j</em></sub> and <em>S</em><sub><em>k</em></sub>; this, however, gives an overestimate. So we subtract the elements common to triples of sets, etc.) There are several ways to prove this formula, and the reader is invited to discover one of them. (See <a href="../Text/ch01c.html#ch01ex_2_14_25">exercise 25</a>.)</p>

  <p class="indent">To count the number of permutations on <em>n</em> elements having no singleton cycles, we consider the <em>N</em> = <em>n</em>! permutations and let <em>S</em><sub><em>j</em></sub> be the set of permutations in which element j forms a singleton cycle. If 1 ≤ <em>j</em><sub>1</sub> &lt; <em>j</em><sub>2</sub> &lt; · · · &lt; <em>j</em><sub><em>k</em></sub> ≤ <em>n</em>, the number of elements in <em>S</em><sub><em>j</em>1</sub> ∩ <em>S</em><sub><em>j</em>2</sub> ∩ · · · ∩ <em>S</em><sub><em>jk</em></sub> is the number of permutations in which <em>j</em><sub>1</sub>, ..., <em>j</em><sub><em>k</em></sub> are singleton cycles, and this is clearly (<em>n</em> − <em>k</em>)!. Thus formula (<a href="../Text/ch01b.html#ch01eq-lev2sec14-29">29</a>) becomes</p>

  <div class="image"><img src="../Images/ch01/e181_06.jpg"></div>

  <p class="noindent">in agreement with (<a href="../Text/ch01b.html#ch01eq-lev2sec14-25">25</a>).</p>

  <p class="indent"><a id="page_182"></a>The principle of inclusion and exclusion is due to A. de Moivre [see his <em>Doctrine of Chances</em> (London: 1718), 61–63; 3rd ed. (1756, reprinted by Chelsea, 1957), 110–112], but its significance was not generally appreciated until it was popularized and developed further by I. Todhunter in his <em>Algebra</em> (second edition, 1860), §762, and by W. A. Whitworth in the well-known book <em>Choice and Chance</em> (Cambridge: 1867).</p>

  <p class="indent">Combinatorial properties of permutations are explored further in Section 5.1.</p>
</body>
</html>