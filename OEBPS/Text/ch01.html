<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      extensions: ["tex2jax.js"],
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        inlineMath: [["$","$"]],
        displayMath: [["$$","$$"]],
        processEscapes: true
      },
      "HTML-CSS": { availableFonts: ["TeX"] }
    });
  </script>
  <script src="MathJax-2.4-latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

  <title></title>
  <link href="../Styles/caps.css" rel="stylesheet" type="text/css">
</head>

<body>
  <div style="display:none">$\newcommand{\md}[2][\!\!]{#1\;({\rm modulo}\;#2)}$<!-- #1 optional arg, #2 mandatory arg, [\!\!] optional arg. If not second arg is given, optional arg will be used (canceling the space produced by the first "\;")--></div>

  <h2 id="ch01"><a id="page_xx"></a>Chapter One. Basic Concepts</h2>

  <div class="image"><img src="../Images/ch01/xx-fig01.png"></div>

  <p class="blockquote"><a id="page_1"></a><span class="roman_italic">Many persons who are not conversant with mathematical studies imagine that because the business of [Babbage’s Analytical Engine] is to give its results in numerical notation, the nature of its processes must consequently be arithmetical and numerical, rather than algebraical and analytical. This is an error. The engine can arrange and combine its numerical quantities exactly as if they were letters or any other general symbols; and in fact it might bring out its results in algebraical notation, were provisions made accordingly.</span></p>

  <p class="attribution">— AUGUSTA ADA, Countess of Lovelace (1843)</p>

  <p class="blockquote"><span class="roman_italic">Practice yourself, for heaven’s sake, in little things;
  and thence proceed to greater</span>.</p>

  <p class="attribution">— EPICTETUS (<span class="roman_italic">Discourses</span> IV.i)</p>

  <div class="heading">
    <h3 id="ch01lev1sec1">1.1. Algorithms</h3>

    <p>The notion of an <em>algorithm</em> is basic to all of computer programming, so we should begin with a careful analysis of this concept.</p>
  </div>

  <p class="indent">The word “algorithm” itself is quite interesting; at first glance it may look as though someone intended to write “logarithm” but jumbled up the first four letters. The word did not appear in <em>Webster’s New World Dictionary</em> as late as 1957; we find only the older form “algorism” with its ancient meaning, the process of doing arithmetic using Arabic numerals. During the Middle Ages, abacists computed on the abacus and algorists computed by algorism. By the time of the Renaissance, the origin of this word was in doubt, and early linguists attempted to guess at its derivation by making combinations like <em>algiros</em> [painful]+<em>arithmos</em> [number]; others said no, the word comes from “King Algor of Castile.” Finally, historians of mathematics found the true origin of the word algorism: It comes from the name of a famous Persian textbook author, Abū ‘Abd Allāh Muh. ammad ibn Mūsā al-Khwārizmī (c. 825) — literally, “Father of Abdullah, Mohammed, son of Moses, native of Khwārizm.” The Aral Sea in Central Asia was once known as Lake Khwārizm, and the Khwārizm region is located in the Amu River basin just south of that sea. Al-Khwārizmī wrote the celebrated Arabic text <em>Kitāb al-jabr wa’l-muqābala</em> (“Rules of restoring and equating”); another word, “algebra,” stems from the title of that book, which was a systematic study of the solution of linear and quadratic equations. [For notes on al-Khwārizmī’s life and work, see H. Zemanek, <em>Lecture Notes in Computer Science</em> <strong>122</strong> (1981), 1–81.]</p>

  <p class="indent"><a id="page_2"></a>Gradually the form and meaning of <em>algorism</em> became corrupted; as explained by the <em>Oxford English Dictionary</em>, the word “passed through many pseudo-etymological perversions, including a recent <em>algorithm</em>, in which it is learnedly confused” with the Greek root of the word <em>arithmetic</em>. This change from “algorism” to “algorithm” is not hard to understand in view of the fact that people had forgotten the original derivation of the word. An early German mathematical dictionary, <em>Vollständiges mathematisches Lexicon</em> (Leipzig: 1747), gave the following definition for the word <em>Algorithmus</em>: “Under this designation are combined the notions of the four types of arithmetic calculations, namely addition, multiplication, subtraction, and division.” The Latin phrase <em>algorithmus infinitesimalis</em> was at that time used to denote “ways of calculation with infinitely small quantities, as invented by Leibniz.”</p>

  <p class="indent">By 1950, the word algorithm was most frequently associated with Euclid’s algorithm, a process for finding the greatest common divisor of two numbers that appears in Euclid’s <em>Elements</em> (Book 7, Propositions 1 and 2). It will be instructive to exhibit Euclid’s algorithm here:</p>

  <p><a id="ch01alg-lev1sec1-E"></a><strong>Algorithm E</strong> (<em>Euclid’s algorithm</em>). Given two positive integers <em>m</em> and <em>n</em>, find their <em>greatest common divisor</em>, that is, the largest positive integer that evenly divides both <em>m</em> and <em>n</em>.</p>

  <p class="indenthanging"><strong>E1.</strong> [Find remainder.] Divide <em>m</em> by <em>n</em> and let <em>r</em> be the remainder. (We will have 0 ≤ <em>r</em> &lt; <em>n</em>.)</p>

  <p class="indenthanging"><strong>E2.</strong> [Is it zero?] If <em>r</em> = 0, the algorithm terminates; <em>n</em> is the answer.</p>

  <p class="indenthanging"><strong>E3.</strong> [Reduce.] Set $m←n$, $n←r$, and go back to step E1. <span class="middle"><img src="../Images/ch01/common-01.png"></span></p>

  <p class="indent">Of course, Euclid did not present his algorithm in just this manner. The format above illustrates the style in which all of the algorithms throughout this book will be presented.</p>

  <p class="indent">Each algorithm we consider has been given an identifying letter (E in the preceding example), and the steps of the algorithm are identified by this letter followed by a number (E1, E2, E3). The chapters are divided into numbered sections; within a section the algorithms are designated by letter only, but when algorithms are referred to in other sections, the appropriate section number is attached. For example, we are now in <a href="../Text/ch01.html#ch01lev1sec1">Section 1.1</a>; within this section Euclid’s algorithm is called <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a>, while in later sections it is referred to as <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm 1.1E</a>.</p>

  <p class="indent">Each step of an algorithm, such as step E1 above, begins with a phrase in brackets that sums up as briefly as possible the principal content of that step. This phrase also usually appears in an accompanying <em>flow chart</em>, such as <a href="../Text/ch01.html#ch01fig01">Fig. 1</a>, so that the reader will be able to picture the algorithm more readily.</p>

  <div class="image">
    <a id="ch01fig01"></a><img src="../Images/ch01/01fig01.png">

    <p class="fig-caption"><strong>Fig. 1.</strong> Flow chart for <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a>.</p>
  </div>

  <p class="indent">After the summarizing phrase comes a description in words and symbols of some <em>action</em> to be performed or some decision to be made. Parenthesized <em>comments</em>, like the second sentence in step E1, may also appear. Comments are included as explanatory information about that step, often indicating certain invariant characteristics of the variables or the current goals. They do not specify <a id="page_3"></a>actions that belong to the algorithm, but are meant only for the reader’s benefit as possible aids to comprehension.</p>

  <p class="indent">The arrow “←” in step E3 is the all-important <em>replacement</em> operation, sometimes called <em>assignment</em> or <em>substitution</em>: “$m←n$” means that the value of variable <em>m</em> is to be replaced by the current value of variable <em>n</em>. When <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a> begins, the values of <em>m</em> and <em>n</em> are the originally given numbers; but when it ends, those variables will have, in general, different values. An arrow is used to distinguish the replacement operation from the equality relation: We will not say, “Set <em>m</em> = <em>n</em>,” but we will perhaps ask, “Does <em>m</em> = <em>n</em>?” The “=” sign denotes a condition that can be tested, the “←” sign denotes an action that can be performed. The operation of <em>increasing <em>n</em> by one</em> is denoted by “$n←n+1$” (read “<em>n</em> is replaced by <em>n</em> + 1” or “<em>n</em> gets <em>n</em> + 1”). In general, “variable ← formula” means that the formula is to be computed using the present values of any variables appearing within it; then the result should replace the previous value of the variable at the left of the arrow. Persons untrained in computer work sometimes have a tendency to say “<em>n</em> becomes <em>n</em> + 1” and to write “$n→n+1$” for the operation of increasing <em>n</em> by one; this symbolism can only lead to confusion because of its conflict with standard conventions, and it should be avoided.</p>

  <p class="indent">Notice that the order of actions in step E3 is important: “Set $m←n$, $n←r$” is quite different from “Set $n←r$, $m←n$,” since the latter would imply that the previous value of <em>n</em> is lost before it can be used to set <em>m</em>. Thus the latter sequence is equivalent to “Set $n←r$, $m←r$.” When several variables are all to be set equal to the same quantity, we can use multiple arrows; for example, “$n←r$, $m←r$” may be written “$n←m←r$.” To interchange the values of two variables, we can write “Exchange $m↔n$”; this action could also be specified by using a new variable <em>t</em> and writing “Set $t←m$, $m←n$, $n←t$.”</p>

  <p class="indent">An algorithm starts at the lowest-numbered step, usually step 1, and it performs subsequent steps in sequential order unless otherwise specified. In step E3, the imperative “go back to step E1” specifies the computational order in an obvious fashion. In step E2, the action is prefaced by the condition “If <em>r</em> = 0”; so if <em>r</em> ≠ 0, the rest of that sentence does not apply and no action is specified. We might have added the redundant sentence, “If <em>r</em> ≠ 0, go on to step E3.”</p>

  <p class="indent">The heavy vertical line “<span class="middle"><img src="../Images/ch01/common-01.png"></span>” appearing at the end of step E3 is used to indicate the end of an algorithm and the resumption of text.</p>

  <p class="indent">We have now discussed virtually all the notational conventions used in the algorithms of this book, except for a notation used to denote “subscripted” or <a id="page_4"></a>“indexed” items that are elements of an ordered array. Suppose we have <em>n</em> quantities, $v_{1},v_{2},...,v_{n}$; instead of writing $v_{j}$ for the <em>j</em> th element, the notation $v[j]$ is often used. Similarly, $a[i,j]$ is sometimes used in preference to a doubly subscripted notation like $a_{ij}$. Sometimes multiple-letter names are used for variables, usually set in capital letters; thus <code>TEMP</code> might be the name of a variable used for temporarily holding a computed value, <code>PRIME[K]</code> might denote the <code>K</code>th prime number, and so on.</p>

  <p class="indent">So much for the <em>form</em> of algorithms; now let us <em>perform</em> one. It should be mentioned immediately that the reader should <em>not</em> expect to read an algorithm as if it were part of a novel; such an attempt would make it pretty difficult to understand what is going on. An algorithm must be seen to be believed, and the best way to learn what an algorithm is all about is to try it. The reader should always take pencil and paper and work through an example of each algorithm immediately upon encountering it in the text. Usually the outline of a worked example will be given, or else the reader can easily conjure one up. This is a simple and painless way to gain an understanding of a given algorithm, and all other approaches are generally unsuccessful.</p>

  <p class="indent">Let us therefore work out an example of <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a>. Suppose that we are given <em>m</em> = 119 and <em>n</em> = 544; we are ready to begin, at step E1. (The reader should now follow the algorithm as we give a play-by-play account.) Dividing <em>m</em> by <em>n</em> in this case is quite simple, almost too simple, since the quotient is zero and the remainder is 119. Thus, $r←119$. We proceed to step E2, and since <em>r</em> ≠ 0 no action occurs. In step E3 we set $m←544$, $n←119$. It is clear that if <em>m</em> &lt; <em>n</em> originally, the quotient in step E1 will always be zero and the algorithm will always proceed to interchange <em>m</em> and <em>n</em> in this rather cumbersome fashion. We could insert a new step at the beginning:</p>

  <p><strong>E0.</strong> [Ensure <em>m</em> ≥ <em>n</em>.] If <em>m</em> &lt; <em>n</em>, exchange <em>m</em> ↔ <em>n</em>.</p>

  <p>This would make no essential change in the algorithm, except to increase its length slightly, and to decrease its running time in about one half of all cases.</p>

  <p class="indent">Back at step E1, we find that $544/119=4+68/119$, so $r←68$. Again E2 is inapplicable, and at E3 we set $m←119$, $n←68$. The next round sets $r←51$, and ultimately $m←68$, $n←51$. Next $r←17$, and $m←51$, $n←17$. Finally, when 51 is divided by 17, we set $r←0$, so at step E2 the algorithm terminates. The greatest common divisor of 119 and 544 is 17.</p>

  <p class="indent">So this is an algorithm. The modern meaning for algorithm is quite similar to that of <em>recipe, process, method, technique, procedure, routine, rigmarole,</em> except that the word “algorithm” connotes something just a little different. Besides merely being a finite set of rules that gives a sequence of operations for solving a specific type of problem, an algorithm has five important features:</p>

  <p class="number">1) <em>Finiteness.</em> An algorithm must always terminate after a finite number of steps. <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a> satisfies this condition, because after step E1 the value of <em>r</em> is <em>less</em> than <em>n</em>; so if <em>r</em> ≠ 0, the value of <em>n</em> decreases</em> the next time step E1 is encountered. A decreasing sequence of positive integers must eventually terminate, so step E1 is executed only a finite number of times for any given original <a id="page_5"></a>value of <em>n</em>. Note, however, that the number of steps can become arbitrarily large; certain huge choices of <em>m</em> and <em>n</em> will cause step E1 to be executed more than a million times.</p>

  <p class="indent">(A procedure that has all of the characteristics of an algorithm except that it possibly lacks finiteness may be called a <em>computational method</em>. Euclid originally presented not only an algorithm for the greatest common divisor of numbers, but also a very similar geometrical construction for the “greatest common measure” of the lengths of two line segments; this is a computational method that does not terminate if the given lengths are incommensurable. Another example of a nonterminating computational method is a <em>reactive process</em>, which continually interacts with its environment.)</p>

  <p class="number">2) <em>Definiteness.</em> Each step of an algorithm must be precisely defined; the actions to be carried out must be rigorously and unambiguously specified for each case. The algorithms of this book will hopefully meet this criterion, but they are specified in the English language, so there is a possibility that the reader might not understand exactly what the author intended. To get around this difficulty, formally defined <em>programming languages</em> or <em>computer languages</em> are designed for specifying algorithms, in which every statement has a very definite meaning. Many of the algorithms of this book will be given both in English and in a computer language. An expression of a computational method in a computer language is called a <em>program</em>.</p>

  <p class="indent">In <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a>, the criterion of definiteness as applied to step E1 means that the reader is supposed to understand exactly what it means to divide <em>m</em> by <em>n</em> and what the remainder is. In actual fact, there is no universal agreement about what this means if <em>m</em> and <em>n</em> are not positive integers; what is the remainder of −8 divided by −π? What is the remainder of $59/13$ divided by zero? Therefore the criterion of definiteness means we must make sure that the values of <em>m</em> and <em>n</em> are always positive integers whenever step E1 is to be executed. This is initially true, by hypothesis; and after step E1, <em>r</em> is a nonnegative integer that must be nonzero if we get to step E3. So <em>m</em> and <em>n</em> are indeed positive integers as required.</p>

  <p class="number">3) <em>Input.</em> An algorithm has zero or more <em>inputs</em>: quantities that are given to it initially before the algorithm begins, or dynamically as the algorithm runs. These inputs are taken from specified sets of objects. In <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a>, for example, there are two inputs, namely <em>m</em> and <em>n</em>, both taken from the set of <em>positive integers</em>.</p>

  <p class="number">4) <em>Output.</em> An algorithm has one or more <em>outputs</em>: quantities that have a specified relation to the inputs. <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a> has one output, namely <em>n</em> in step E2, the greatest common divisor of the two inputs.</p>

  <p class="indent">(We can easily <em>prove</em> that this number is indeed the greatest common divisor, as follows. After step E1, we have</p>

  <p class="center">$m=qn+r$,</p>

  <p>for some integer <em>q</em>. If <em>r</em> = 0, then <em>m</em> is a multiple of <em>n</em>, and clearly in such a case <em>n</em> is the greatest common divisor of <em>m</em> and <em>n</em>. If <em>r</em> ≠ 0, note that any number that divides both <em>m</em> and <em>n</em> must divide $m-qn=r$, and any number that divides <a id="page_6"></a>both <em>n</em> and <em>r</em> must divide $qn+r=m$; so the set of common divisors of <em>m</em> and <em>n</em> is the same as the set of common divisors of <em>n</em> and <em>r</em>. In particular, the <em>greatest</em> common divisor of <em>m</em> and <em>n</em> is the same as the greatest common divisor of <em>n</em> and <em>r</em>. Therefore step E3 does not change the answer to the original problem.)</p>

  <p class="number">5) <em>Effectiveness.</em> An algorithm is also generally expected to be <em>effective</em>, in the sense that its operations must all be sufficiently basic that they can in principle be done exactly and in a finite length of time by someone using pencil and paper. <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a> uses only the operations of dividing one positive integer by another, testing if an integer is zero, and setting the value of one variable equal to the value of another. These operations are effective, because integers can be represented on paper in a finite manner, and because there is at least one method (the “division algorithm”) for dividing one by another. But the same operations would <em>not</em> be effective if the values involved were arbitrary real numbers specified by an infinite decimal expansion, nor if the values were the lengths of physical line segments (which cannot be specified exactly). Another example of a noneffective step is, “If 4 is the largest integer <em>n</em> for which there is a solution to the equation $w^{n}+x^{n}+y^{n}=z^{n}$ in positive integers <em>w</em>, <em>x</em>, <em>y</em>, and <em>z</em>, then go to step E4.” Such a statement would not be an effective operation until someone successfully constructs an algorithm to determine whether 4 is or is not the largest integer with the stated property.</p>

  <p class="indent">Let us try to compare the concept of an algorithm with that of a cookbook recipe. A recipe presumably has the qualities of finiteness (although it is said that a watched pot never boils), input (eggs, flour, etc.), and output (TV dinner, etc.), but it notoriously lacks definiteness. There are frequent cases in which a cook’s instructions are indefinite: “Add a dash of salt.” A “dash” is defined to be “less than ⅛ teaspoon,” and salt is perhaps well enough defined; but where should the salt be added — on top? on the side? Instructions like “toss lightly until mixture is crumbly” or “warm cognac in small saucepan” are quite adequate as explanations to a trained chef, but an algorithm must be specified to such a degree that even a computer can follow the directions. Nevertheless, a computer programmer can learn much by studying a good recipe book. (The author has in fact barely resisted the temptation to name the present volume “The Programmer’s Cookbook.” Perhaps someday he will attempt a book called “Algorithms for the Kitchen.”)</p>

  <p class="indent">We should remark that the finiteness restriction is not really strong enough for practical use. A useful algorithm should require not only a finite number of steps, but a <em>very</em> finite number, a reasonable number. For example, there is an algorithm that determines whether or not the game of chess can always be won by White if no mistakes are made (see <a href="../Text/ch02.html#ch02ex_2_3_28">exercise 2.2.3–28</a>). That algorithm can solve a problem of intense interest to thousands of people, yet it is a safe bet that we will never in our lifetimes know the answer; the algorithm requires fantastically large amounts of time for its execution, even though it is finite. See also Chapter 8 for a discussion of some finite numbers that are so large as to actually be beyond comprehension.</p>

  <p class="indent"><a id="page_7"></a>In practice we not only want algorithms, we want algorithms that are <em>good</em> in some loosely defined aesthetic sense. One criterion of goodness is the length of time taken to perform the algorithm; this can be expressed in terms of the number of times each step is executed. Other criteria are the adaptability of the algorithm to different kinds of computers, its simplicity and elegance, etc.</p>

  <p class="indent">We often are faced with several algorithms for the same problem, and we must decide which is best. This leads us to the extremely interesting and all-important field of <em>algorithmic analysis</em>: Given an algorithm, we want to determine its performance characteristics.</p>

  <p class="indent">For example, let’s consider Euclid’s algorithm from this point of view. Suppose we ask the question, “Assuming that the value of <em>n</em> is known but <em>m</em> is allowed to range over all positive integers, what is the <em>average</em> number of times, $T_{n}$, that step E1 of <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a> will be performed?” In the first place, we need to check that this question does have a meaningful answer, since we are trying to take an average over infinitely many choices for <em>m</em>. But it is evident that after the first execution of step E1 only the remainder of <em>m</em> after division by <em>n</em> is relevant. So all we must do to find $T_{n}$ is to try the algorithm for $m=1,m=2,...,m=n$, count the total number of times step E1 has been executed, and divide by <em>n</em>.</p>

  <p class="indent">Now the important question is to determine the <em>nature</em> of $T_{n}$; is it approximately equal to ${\frac{1}{3}}n$, or $\sqrt{n}$, for instance? As a matter of fact, the answer to this question is an extremely difficult and fascinating mathematical problem, not yet completely resolved, which is examined in more detail in Section 4.5.3. For large values of <em>n</em> it is possible to prove that $T_{n}$ is approximately $(12(\ln 2)/π^{2})\ln n$, that is, proportional to the <em>natural logarithm</em> of <em>n</em>, with a constant of proportionality that might not have been guessed offhand! For further details about Euclid’s algorithm, and other ways to calculate the greatest common divisor, see Section 4.5.2.</p>

  <p class="indent"><em>Analysis of algorithms</em> is the name the author likes to use to describe investigations such as this. The general idea is to take a particular algorithm and to determine its quantitative behavior; occasionally we also study whether or not an algorithm is optimal in some sense. The <em>theory of algorithms</em> is another subject entirely, dealing primarily with the existence or nonexistence of effective algorithms to compute particular quantities.</p>

  <p class="indent">So far our discussion of algorithms has been rather imprecise, and a mathematically oriented reader is justified in thinking that the preceding commentary makes a very shaky foundation on which to erect any theory about algorithms. We therefore close this section with a brief indication of one method by which the concept of algorithm can be firmly grounded in terms of mathematical set theory. Let us formally define a <em>computational method</em> to be a quadruple (<em>Q, I, Ω, f</em>), in which <em>Q</em> is a set containing subsets <em>I</em> and <em>Ω</em>, and <em>f</em> is a function from <em>Q</em> into itself. Furthermore <em>f</em> should leave Ω pointwise fixed; that is, $f(q)$ should equal <em>q</em> for all elements <em>q</em> of Ω. The four quantities <em>Q</em>, <em>I</em>, Ω, <em>f</em> are intended to represent respectively the states of the computation, the input, the output, and the computational rule. Each input <em>x</em> in the set <em>I</em> defines a <em>computational <a id="page_8"></a>sequence</em>, $x_{0},x_{1},x_{2},...$, as follows:</p>

  <div class="equation" id="ch01eq-lev1sec1-1"><img src="../Images/ch01/008equ01.png"></div>

  <p>The computational sequence is said to <em>terminate in k steps</em> if <em>k</em> is the smallest integer for which $x_{k}$ is in Ω, and in this case it is said to produce the output $x_{k}$ from <em>x</em>. (Notice that if $x_{k}$ is in Ω, so is $x_{k+1}$, because $x_{k+1}=x_{k}$ in such a case.) Some computational sequences may never terminate; an <em>algorithm</em> is a computational method that terminates in finitely many steps for all <em>x</em> in <em>I</em>.</p>

  <p class="indent"><a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a> may, for example, be formalized in these terms as follows: Let <em>Q</em> be the set of all singletons $(n)$, all ordered pairs $(m,n)$, and all ordered quadruples $(m,n,r,1)$, $(m,n,r,2)$, and $(m,n,p,3)$, where <em>m</em>, <em>n</em>, and <em>p</em> are positive integers and <em>r</em> is a nonnegative integer. Let <em>I</em> be the subset of all pairs $(m,n)$ and let Ω be the subset of all singletons $(n)$. Let <em>f</em> be defined as follows:</p>

  <div class="equation" id="ch01eq-lev1sec1-2"><img src="../Images/ch01/008equ02.png"></div>

  <p>The correspondence between this notation and <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a> is evident.</p>

  <p class="indent">This formulation of the concept of an algorithm does not include the restriction of effectiveness mentioned earlier. For example, <em>Q</em> might denote infinite sequences that are not computable by pencil and paper methods, or <em>f</em> might involve operations that mere mortals cannot always perform. If we wish to restrict the notion of algorithm so that only elementary operations are involved, we can place restrictions on <em>Q</em>, <em>I</em>, Ω, and <em>f</em>, for example as follows: Let <em>A</em> be a finite set of letters, and let $A^{*}$ be the set of all strings on <em>A</em> (the set of all ordered sequences $x_{1}x_{2}...x_{n}$, where <em>n</em> ≥ 0 and $x_{j}$ is in <em>A</em> for 1 ≤ <em>j</em> ≤ <em>n</em>). The idea is to encode the states of the computation so that they are represented by strings of $A^{*}$. Now let <em>N</em> be a nonnegative integer and let <em>Q</em> be the set of all $(σ,j)$, where σ is in $A^{*}$ and <em>j</em> is an integer, 0 ≤ <em>j</em> ≤ <em>N</em>; let <em>I</em> be the subset of <em>Q</em> with <em>j</em> = 0 and let Ω be the subset with <em>j</em> = <em>N</em>. If θ and σ are strings in $A^{*}$, we say that θ occurs in σ if σ has the form $αθω$ for strings <em>α</em> and ω. To complete our definition, let <em>f</em> be a function of the following type, defined by the strings $θ_{j}$, $φ_{j}$ and the integers $a_{j}$, $b_{j}$ for 0 ≤ <em>j</em> &lt; <em>N</em>:</p>

  <div class="equation" id="ch01eq-lev1sec1-3"><img src="../Images/ch01/008equ03.jpg"></div>

  <p class="indent">Every step of such a computational method is clearly effective, and experience shows that pattern-matching rules of this kind are also powerful enough to do anything we can do by hand. There are many other essentially equivalent ways to formulate the concept of an effective computational method (for example, using Turing machines). The formulation above is virtually the same as that <a id="page_9"></a>given by A. A. Markov in his book <em>The Theory of Algorithms</em> [<em>Trudy Mat. Inst. Akad. Nauk</em> <strong>42</strong> (1954), 1–376], later revised and enlarged by N. M. Nagorny (Moscow: Nauka, 1984; English edition, Dordrecht: Kluwer, 1988).</p>

  <p class="ex-title">Exercises</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_1_1_1a" id="ch01ex_1_1_1">1</a>.</strong> [<em>10</em>] The text showed how to interchange the values of variables <em>m</em> and <em>n</em>, using the replacement notation, by setting $t←m$, $m←n$, $n←t$. Show how the values of <em>four</em> variables $(a,b,c,d)$ can be rearranged to $(b,c,d,a)$ by a sequence of replacements. In other words, the new value of <em>a</em> is to be the original value of <em>b</em>, etc. Try to use the minimum number of replacements.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_1_1_2a" id="ch01ex_1_1_2">2</a>.</strong> [<em>15</em>] Prove that <em>m</em> is always greater than <em>n</em> at the beginning of step E1, except possibly the first time this step occurs.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_1_1_3a" id="ch01ex_1_1_3">3</a>.</strong> [<em>20</em>] Change <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a> (for the sake of efficiency) so that all trivial replacement operations such as “$m←n$” are avoided. Write this new algorithm in the style of <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a>, and call it <a href="../Text/ch02a.html#ch02alg-lev2sec9-F">Algorithm F</a>.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_1_1_4a" id="ch01ex_1_1_4">4</a>.</strong> [<em>16</em>] What is the greatest common divisor of 2166 and 6099?</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_1_1_5a" id="ch01ex_1_1_5">5</a>.</strong> [<em>12</em>] Show that the “<a href="../Text/pref02.html#pref02">Procedure for Reading This Set of Books</a>” that appears after the preface actually fails to be a genuine algorithm on at least three of our five counts! Also mention some differences in format between it and <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a>.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_1_1_6a" id="ch01ex_1_1_6">6</a>.</strong> [<em>20</em>] What is $T_{5}$, the average number of times step E1 is performed when <em>n</em> = 5?</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_1_1_7a" id="ch01ex_1_1_7">7</a>.</strong> [<em>M21</em>] Suppose that <em>m</em> is known and <em>n</em> is allowed to range over all positive integers; let $U_{m}$ be the average number of times that step E1 is executed in <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a>. Show that $U_{m}$ is well defined. Is $U_{m}$ in any way related to $T_{m}$?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_1_1_8a" id="ch01ex_1_1_8">8</a>.</strong> [<em>M25</em>] Give an “effective” formal algorithm for computing the greatest common divisor of positive integers <em>m</em> and <em>n</em>, by specifying $θ_{j}$, $φ_{j}$, $a_{j}$, $b_{j}$ as in Eqs. (<a href="../Text/ch01.html#ch01eq-lev1sec1-3">3</a>). Let the input be represented by the string $a^{m}b^{n}$, that is, <em>m a</em>’s followed by <em>n b</em>’s. Try to make your solution as simple as possible. [<em>Hint:</em> Use <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a>, but instead of division in step E1, set $r←|m-n|$, $n←\min(m,n)$.]</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_1_1_9a" id="ch01ex_1_1_9">9</a>.</strong> [<em>M30</em>] Suppose that $C_{1}=(Q_{1},I_{1},Ω_{1},f_{1})$ and $C_{2}=(Q_{2},I_{2},Ω_{2},f_{2})$ are computational methods. For example, $C_{1}$ might stand for <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a> as in Eqs. (<a href="../Text/ch01.html#ch01eq-lev1sec1-2">2</a>), except that <em>m</em> and <em>n</em> are restricted in magnitude, and $C_{2}$ might stand for a computer program implementation of <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm E</a>. (Thus $Q_{2}$ might be the set of all states of the machine, i.e., all possible configurations of its memory and registers; $f_{2}$ might be the definition of single machine actions; and $I_{2}$ might be the set of initial states, each including the program that determines the greatest common divisor as well as the particular values of <em>m</em> and <em>n</em>.)</p>

  <p class="exercises1N">Formulate a set-theoretic definition for the concept “$C_{2}$ is a representation of $C_{1}$” or “$C_{2}$ simulates $C_{1}$.” This is to mean intuitively that any computation sequence of $C_{1}$ is mimicked by $C_{2}$, except that $C_{2}$ might take more steps in which to do the computation and it might retain more information in its states. (We thereby obtain a rigorous interpretation of the statement, “Program <em>X</em> is an implementation of Algorithm <em>Y</em>.”)</p>

  <div class="heading">
    <h3 id="ch01lev1sec2"><a id="page_10"></a>1.2. Mathematical Preliminaries</h3>

    <p>In this section we shall investigate the mathematical notations that occur throughout <em>The Art of Computer Programming</em>, and we’ll derive several basic formulas that will be used repeatedly. Even a reader not concerned with the more complex mathematical derivations should at least become familiar with the <em>meanings</em> of the various formulas, so as to be able to use the results of the derivations.</p>
  </div>

  <p class="indent">Mathematical notation is used for two main purposes in this book: to describe portions of an algorithm, and to analyze the performance characteristics of an algorithm. The notation used in descriptions of algorithms is quite simple, as explained in the previous section. When analyzing the performance of algorithms, we need to use other more specialized notations.</p>

  <p class="indent">Most of the algorithms we will discuss are accompanied by mathematical calculations that determine the speed at which the algorithm may be expected to run. These calculations draw on nearly every branch of mathematics, and a separate book would be necessary to develop all of the mathematical concepts that are used in one place or another. However, the majority of the calculations can be carried out with a knowledge of college algebra, and the reader with a knowledge of elementary calculus will be able to understand nearly all of the mathematics that appears. Sometimes we will need to use deeper results of complex variable theory, group theory, number theory, probability theory, etc.; in such cases the topic will be explained in an elementary manner, if possible, or a reference to other sources of information will be given.</p>

  <p class="indent">The mathematical techniques involved in the analysis of algorithms usually have a distinctive flavor. For example, we will quite often find ourselves working with finite summations of rational numbers, or with the solutions to recurrence relations. Such topics are traditionally given only a light treatment in mathematics courses, and so the following subsections are designed not only to give a thorough drilling in the use of the notations to be defined but also to illustrate in depth the types of calculations and techniques that will be most useful to us.</p>

  <p><em>Important note:</em> Although the following subsections provide a rather extensive training in the mathematical skills needed in connection with the study of computer algorithms, most readers will not see at first any very strong connections between this material and computer programming (except in <a href="../Text/ch01.html#ch01lev2sec1">Section 1.2.1</a>). The reader may choose to read the following subsections carefully, with implicit faith in the author’s assertion that the topics treated here are indeed very relevant; but it is probably preferable, for motivation, to <em>skim over this section lightly at first, and</em> (after seeing numerous applications of the techniques in future chapters) <em>return to it later for more intensive study</em>. If too much time is spent studying this material when first reading the book, a person might never get on to the computer programming topics! However, each reader should at least become familiar with the general contents of these subsections, and should try to solve a few of the exercises, even on first reading. <a href="../Text/ch01a.html#ch01lev2sec10">Section 1.2.10</a> should receive particular attention, since it is the point of departure for most of the theoretical material <a id="page_11"></a>developed later. <a href="../Text/ch01b.html#ch01lev1sec3">Section 1.3</a>, which follows <a href="../Text/ch01.html#ch01lev1sec2">1.2</a>, abruptly leaves the realm of “pure mathematics” and enters into “pure computer programming.”</p>

  <p class="indent">An expansion and more leisurely presentation of much of the following material can be found in the book <em>Concrete Mathematics</em> by Graham, Knuth, and Patashnik, second edition (Reading, Mass.: Addison–Wesley, 1994). That book will be called simply <em>CMath</em> when we need to refer to it later.</p>

  <div class="heading">
    <h4 id="ch01lev2sec1">1.2.1. Mathematical Induction</h4>

    <p>Let $P(n)$ be some statement about the integer <em>n</em>; for example, $P(n)$ might be “<em>n</em> times $(n+3)$ is an even number,” or “if <em>n</em> ≥ 10, then $2^{n}\gt n^{3}$.” Suppose we want <em>to prove that $P(n)$ is true for all positive integers n</em>. An important way to do this is:</p>
  </div>

  <p class="indenthangingA">a) Give a proof that $P(1)$ is true.</p>

  <p class="indenthangingA">b) Give a proof that “if all of $P(1),P(2),...,P(n)$ are true, then $P(n+1)$ is also true”; this proof should be valid for any positive integer <em>n</em>.</p>

  <p class="indent">As an example, consider the following series of equations, which many people have discovered independently since ancient times:</p>

  <div class="equation" id="ch01eq-lev2sec1-1"><img src="../Images/ch01/011equ01.png"></div>

  <p>We can formulate the general property as follows:</p>

  <div class="equation" id="ch01eq-lev2sec1-2"><img src="../Images/ch01/011equ02.png"></div>

  <p>Let us, for the moment, call this equation $P(n)$; we wish to prove that $P(n)$ is true for all positive <em>n</em>. Following the procedure outlined above, we have:</p>

  <p class="indenthangingA">a) “$P(1)$ is true, since $1=1^{2}$.”</p>

  <p class="indenthangingA">b) “If all of $P(1),...,P(n)$ are true, then, in particular, $P(n)$ is true, so Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec1-2">2</a>) holds; adding 2<em>n</em> + 1 to both sides we obtain</p>

  <p class="center">$1+3+···+(2n-1)+(2n+1)=n^{2}+2n+1=(n+1)^{2}$,</p>

  <p class="indent">which proves that $P(n+1)$ is also true.”</p>

  <p class="indent">We can regard this method as an <em>algorithmic proof procedure.</em> In fact, the following algorithm produces a proof of $P(n)$ for any positive integer <em>n</em>, assuming that steps (a) and (b) above have been worked out:</p>

  <p><a id="ch01alg-lev2sec1-I"></a><strong>Algorithm I</strong> (<em>Construct a proof</em>). Given a positive integer <em>n</em>, this algorithm will output a proof that $P(n)$ is true.</p>

  <p class="indenthanging"><strong>I1.</strong> [Prove $P(1)$.] Set $k←1$, and, according to (a), output a proof of $P(1)$.</p>

  <p class="indenthanging"><a id="page_12"></a><strong>I2.</strong> [<em>k</em> = <em>n</em>?] If <em>k</em> = <em>n</em>, terminate the algorithm; the required proof has been output.</p>

  <p class="indenthanging"><strong>I3.</strong> [Prove $P(k+1)$.] According to (b), output a proof that “If all of $P(1),...,P(k)$ are true, then $P(k+1)$ is true.” Also output “We have already proved $P(1),...,P(k)$; hence $P(k+1)$ is true.”</p>

  <p class="indenthanging"><strong>I4.</strong> [Increase <em>k</em>.] Increase <em>k</em> by 1 and go to step I2. <span class="middle"><img src="../Images/ch01/common-01.png"></span></p>

  <div class="image">
    <a id="ch01fig02"></a><img src="../Images/ch01/01fig02.png">

    <p class="fig-caption"><strong>Fig. 2.</strong> <a href="../Text/ch01.html#ch01alg-lev2sec1-I">Algorithm I</a>: Mathematical induction.</p>
  </div>

  <p class="indent">Since this algorithm clearly presents a proof of $P(n)$, for any given <em>n</em>, the proof technique consisting of steps (a) and (b) is logically valid. It is called <em>proof by mathematical induction</em>.</p>

  <p class="indent">The concept of mathematical induction should be distinguished from what is usually called inductive reasoning in science. A scientist takes specific observations and creates, by “induction,” a general theory or hypothesis that accounts for these facts; for example, we might observe the five relations in (<a href="../Text/ch01.html#ch01eq-lev2sec1-1">1</a>), above, and formulate (<a href="../Text/ch01.html#ch01eq-lev2sec1-2">2</a>). In this sense, induction is no more than our best guess about the situation; mathematicians would call it an empirical result or a conjecture.</p>

  <p class="indent">Another example will be helpful. Let $p(n)$ denote the number of <em>partitions</em> of <em>n</em>, that is, the number of different ways to write <em>n</em> as a sum of positive integers, disregarding order. Since 5 can be partitioned in exactly seven ways,</p>

  <p class="center">1 + 1 + 1 + 1 + 1 = 2 + 1 + 1 + 1 = 2 + 2 + 1 = 3 + 1 + 1 = 3 + 2 = 4 + 1 = 5,</p>

  <p>we have $p(5)=7$. In fact, it is easy to establish the first few values,</p>

  <p class="center">$p(1)=1$,&nbsp;&nbsp;&nbsp;$p(2)=2$,&nbsp;&nbsp;&nbsp;$p(3)=3$,&nbsp;&nbsp;&nbsp;$p(4)=5$,&nbsp;&nbsp;&nbsp;$p(5)=7$.</p>

  <p>At this point we might tentatively formulate, by induction, the hypothesis that the sequence $p(2),p(3),...$ runs through the <em>prime numbers</em>. To test this hypothesis, we proceed to calculate $p(6)$ and behold! $p(6)=11$, confirming our conjecture.</p>

  <p class="indent">[Unfortunately, $p(7)$ turns out to be 15, spoiling everything, and we must try again. The numbers $p(n)$ are known to be quite complicated, although S. Ramanujan succeeded in guessing and proving many remarkable things about them. For further information, see G. H. Hardy, <em>Ramanujan</em> (London: Cambridge University Press, 1940), Chapters 6 and 8. See also Section 7.2.1.4.]</p>

  <p class="indent">Mathematical induction is quite different from induction in the sense just explained. It is not just guesswork, but a conclusive proof of a statement; indeed, it is a proof of infinitely many statements, one for each <em>n</em>. It has been called “induction” only because one must first decide somehow <em>what</em> is to be proved, <a id="page_13"></a><em>before</em> one can apply the technique of mathematical induction. Henceforth in this book we shall use the word induction only when we wish to imply proof by mathematical induction.</p>

  <p class="indent">There is a geometrical way to prove Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec1-2">2</a>). <a href="../Text/ch01.html#ch01fig03">Figure 3</a> shows, for <em>n</em> = 6, $n^{2}$ cells broken into groups of $1+3+···+(2n-1)$ cells. However, in the final analysis, this picture can be regarded as a “proof” only if we show that the construction can be carried out for all <em>n</em>, and such a demonstration is essentially the same as a proof by induction.</p>

  <div class="image">
    <a id="ch01fig03"></a><img src="../Images/ch01/01fig03.png">

    <p class="fig-caption"><strong>Fig. 3.</strong> The sum of odd numbers is a square.</p>
  </div>

  <p class="indent">Our proof of Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec1-2">2</a>) used only a special case of (b); we merely showed that the truth of $P(n)$ implies the truth of $P(n+1)$. This is an important simple case that arises frequently, but our next example illustrates the power of the method a little more. We define the <em>Fibonacci sequence</em> $F_{0},F_{1},F_{2},...$ by the rule that $F_{0}=0$, $F_{1}=1$, and every further term is the sum of the preceding two. Thus the sequence begins 0, 1, 1, 2, 3, 5, 8, 13, ...; we will investigate it in detail in <a href="../Text/ch01a.html#ch01lev2sec8">Section 1.2.8</a>. We will now prove that if <em>φ</em> is the number $(1+\sqrt{5})/2$ we have</p>

  <div class="equation" id="ch01eq-lev2sec1-3"><img src="../Images/ch01/013equ01.png"></div>

  <p>for all positive integers <em>n</em>. Call this formula $P(n)$.</p>

  <p class="indent">If <em>n</em> = 1, then $F_{1}=1=φ^{0}=φ^{1-1}$, so step (a) has been done. For step (b) we notice first that $P(2)$ is also true, since $F_{2}=1\lt 1.6\lt φ^{1}=φ^{2-1}$. Now, if all of $P(1),P(2),...,P(n)$ are true and <em>n</em> &gt; 1, we know in particular that $P(n-1)$ and $P(n)$ are true; so $F_{n-1}≤φ^{n-2}$ and $F_{n}≤φ^{n-1}$. Adding these inequalities, we get</p>

  <div class="equation" id="ch01eq-lev2sec1-4"><img src="../Images/ch01/013equ02.png"></div>

  <p>The important property of the number <em>φ</em>, indeed the reason we chose this number for this problem in the first place, is that</p>

  <div class="equation" id="ch01eq-lev2sec1-5"><img src="../Images/ch01/013equ03.png"></div>

  <p>Plugging (<a href="../Text/ch01.html#ch01eq-lev2sec1-5">5</a>) into (<a href="../Text/ch01.html#ch01eq-lev2sec1-4">4</a>) gives $F_{n+1}≤φ^{n}$, which is $P(n+1)$. So step (b) has been done, and (<a href="../Text/ch01.html#ch01eq-lev2sec1-3">3</a>) has been proved by mathematical induction. Notice that we approached step (b) in two different ways here: We proved $P(n+1)$ <em>directly</em> when <em>n</em> = 1, and we used an inductive method when <em>n</em> &gt; 1. This was necessary, since when <em>n</em> = 1 our reference to $P(n-1)=P(0)$ would not have been legitimate.</p>

  <p class="indent">Mathematical induction can also be used to prove things about <em>algorithms</em>. Consider the following generalization of Euclid’s algorithm.</p>

  <p><a id="ch01alg-lev2sec1-E"></a><strong>Algorithm E</strong> (<em>Extended Euclid’s algorithm</em>). Given two positive integers <em>m</em> and <em>n</em>, we compute their greatest common divisor <em>d</em>, and we also compute two not-necessarily-positive integers <em>a</em> and <em>b</em> such that $am+bn=d$.</p>

  <p class="indenthanging"><strong>E1.</strong> [Initialize.] Set $a'←b←1$, $a←b'←0$, $c←m$, $d←n$.</p>

  <p class="indenthanging"><a id="page_14"></a><strong>E2.</strong> [Divide.] Let <em>q</em> and <em>r</em> be the quotient and remainder, respectively, of <em>c</em> divided by <em>d</em>. (We have $c=qd+r$ and 0 ≤ <em>r</em> &lt; <em>d</em>.)</p>

  <p class="indenthanging"><strong>E3.</strong> [Remainder zero?] If <em>r</em> = 0, the algorithm terminates; we have in this case $am+bn=d$ as desired.</p>

  <p class="indenthanging"><strong>E4.</strong> [Recycle.] Set $c←d$, $d←r$, $t←a'$, $a'←a$, $a←t-qa$, $t←b'$, $b'←b$, $b←t-qb$, and go back to E2. <span class="middle"><img src="../Images/ch01/common-01.png"></span></p>

  <p class="indent">If we suppress the variables <em>a</em>, <em>b</em>, <em>a</em>′, and <em>b</em>′ from this algorithm and use <em>m</em> and <em>n</em> for the auxiliary variables <em>c</em> and <em>d</em>, we have our old algorithm, <a href="../Text/ch01.html#ch01alg-lev1sec1-E">1.1E</a>. The new version does a little more, by determining the coefficients <em>a</em> and <em>b</em>. Suppose that <em>m</em> = 1769 and <em>n</em> = 551; we have successively (after step E2):</p>

  <div class="image"><img src="../Images/ch01/e014_01.png"></div>

  <p>The answer is correct: $5×1769-16×551=8845-8816=29$, the greatest common divisor of 1769 and 551.</p>

  <p class="indent">The problem is to <em>prove</em> that this algorithm works properly, for all <em>m</em> and <em>n</em>. We can try to apply the method of mathematical induction by letting $P(n)$ be the statement “<a href="../Text/ch01.html#ch01alg-lev2sec1-E">Algorithm E</a> works for <em>n</em> and all integers <em>m</em>.” However, that approach doesn’t work out so easily, and we need to prove some extra facts. After a little study, we find that something must be proved about <em>a</em>, <em>b</em>, <em>a</em>′, and <em>b</em>′, and the appropriate fact is that the equalities</p>

  <div class="equation" id="ch01eq-lev2sec1-6"><img src="../Images/ch01/014equ01.png"></div>

  <p>always hold whenever step E2 is executed. We may prove these equalities directly by observing that they are certainly true the first time we get to E2, and that step E4 does not change their validity. (See <a href="../Text/ch01.html#ch01ex_2_1_6">exercise 6</a>.)</p>

  <p class="indent">Now we are ready to show that <a href="../Text/ch01.html#ch01alg-lev2sec1-E">Algorithm E</a> is valid, by induction on <em>n</em>: If <em>m</em> is a multiple of <em>n</em>, the algorithm obviously works properly, since we are done immediately at E3 the first time. This case always occurs when <em>n</em> = 1. The only case remaining is when <em>n</em> &gt; 1 and <em>m</em> is not a multiple of <em>n</em>. In such a case, the algorithm proceeds to set $c←n$, $d←r$ after the first execution, and since <em>r</em> &lt; <em>n</em>, <em>we may assume by induction</em> that the final value of <em>d</em> is the gcd of <em>n</em> and <em>r</em>. By the argument given in <a href="../Text/ch01.html#ch01lev1sec1">Section 1.1</a>, the pairs $\{m,n\}$ and $\{n,r\}$ have the same common divisors, and, in particular, they have the same greatest common divisor. Hence <em>d</em> is the gcd of <em>m</em> and <em>n</em>, and $am+bn=d$ by (<a href="../Text/ch01.html#ch01eq-lev2sec1-6">6</a>).</p>

  <p class="indent">The italicized phrase in the proof above illustrates the conventional language that is so often used in an inductive proof: When doing part (b) of the construction, rather than saying “We will now assume $P(1),P(2),...,P(n)$, and with this assumption we will prove $P(n+1)$,” we often say simply “We will now prove $P(n)$; <em>we may assume by induction</em> that $P(k)$ is true whenever 1 ≤ <em>k</em> &lt; <em>n</em>.”</p>

  <p class="indent"><a id="page_15"></a>If we examine this argument very closely and change our viewpoint slightly, we can envision a general method applicable to proving the validity of <em>any</em> algorithm. The idea is to take a flow chart for some algorithm and to label each of the arrows with an assertion about the current state of affairs at the time the computation traverses that arrow. See <a href="../Text/ch01.html#ch01fig04">Fig. 4</a>, where the assertions have been labeled <em>A1</em>, <em>A2</em>, ..., <em>A6</em>. (All of these assertions have the additional stipulation that the variables are integers; this stipulation has been omitted to save space.) <em>A1</em> gives the initial assumptions upon entry to the algorithm, and <em>A4</em> states what we hope to prove about the output values <em>a</em>, <em>b</em>, and <em>d</em>.</p>

  <div class="image4">
    <a id="ch01fig04"></a><img class="img1" src="../Images/ch01/01fig04.png">

    <p class="fig-caption"><strong>Fig. 4.</strong> Flow chart for <a href="../Text/ch01.html#ch01alg-lev2sec1-E">Algorithm E</a>, labeled with assertions that prove the validity of the algorithm.</p>
  </div>

  <p class="indent">The general method consists of proving, for each box in the flow chart, that</p>

  <div class="equation" id="ch01eq-lev2sec1-7"><img src="../Images/ch01/015equ01.png"></div>

  <p>Thus, for example, we must prove that either <em>A2</em> or <em>A6</em> before E2 implies <em>A3</em> after E2. (In this case <em>A2</em> is a stronger statement than <em>A6</em>; that is, <em>A2</em> implies <em>A6</em>. So we need only prove that <em>A6</em> before E2 implies <em>A3</em> after. Notice that the condition <em>d</em> &gt; 0 is necessary in <em>A6</em> just to prove that operation E2 even makes sense.) It is also necessary to show that <em>A3</em> and <em>r</em> = 0 implies <em>A4;</em> that <em>A3</em> and <em>r</em> ≠ 0 implies <em>A5</em>; etc. Each of the required proofs is very straightforward.</p>

  <p class="indent"><em>Once statement</em> (<a href="../Text/ch01.html#ch01eq-lev2sec1-7">7</a>) <em>has been proved for each box, it follows that all assertions are true during any execution of the algorithm.</em> For we can now use induction <a id="page_16"></a>on the number of steps of the computation, in the sense of the number of arrows traversed in the flow chart. While traversing the first arrow, the one leading from “Start”, the assertion <em>A1</em> is true since we always assume that our input values meet the specifications; so the assertion on the first arrow traversed is correct. If the assertion that labels the <em>n</em>th arrow is true, then by (<a href="../Text/ch01.html#ch01eq-lev2sec1-7">7</a>) the assertion that labels the (<em>n</em> + 1)st arrow is also true.</p>

  <p class="indent">Using this general method, the problem of proving that a given algorithm is valid evidently consists mostly of inventing the right assertions to put in the flow chart. Once this inductive leap has been made, it is pretty much routine to carry out the proofs that each assertion leading into a box logically implies each assertion leading out. In fact, it is pretty much routine to invent the assertions themselves, once a few of the difficult ones have been discovered; thus it is very simple in our example to write out essentially what <em>A2</em>, <em>A3</em>, and <em>A5</em> must be, if only <em>A1</em>, <em>A4</em>, and <em>A6</em> are given. In our example, assertion <em>A6</em> is the creative part of the proof; all the rest could, in principle, be supplied mechanically. Hence no attempt has been made to give detailed formal proofs of the algorithms that follow in this book, at the level of detail found in <a href="../Text/ch01.html#ch01fig04">Fig. 4</a>. It suffices to state the key inductive assertions. Those assertions either appear in the discussion following an algorithm or they are given as parenthetical remarks in the text of the algorithm itself.</p>

  <p class="indent">This approach to proving the correctness of algorithms has another aspect that is even more important: <em>It mirrors the way we understand an algorithm.</em> Recall that in <a href="../Text/ch01.html#ch01lev1sec1">Section 1.1</a> the reader was cautioned not to expect to read an algorithm like part of a novel; one or two trials of the algorithm on some sample data were recommended. This was done expressly because an example runthrough of the algorithm helps a person formulate the various assertions mentally. It is the contention of the author that we really understand why an algorithm is valid only when we reach the point that our minds have implicitly filled in all the assertions, as was done in <a href="../Text/ch01.html#ch01fig04">Fig. 4</a>. This point of view has important psychological consequences for the proper communication of algorithms from one person to another: It implies that the key assertions, those that cannot easily be derived by an automaton, should always be stated explicitly when an algorithm is being explained to someone else. When <a href="../Text/ch01.html#ch01alg-lev2sec1-E">Algorithm E</a> is being put forward, assertion <em>A6</em> should be mentioned too.</p>

  <p class="indent">An alert reader will have noticed a gaping hole in our last proof of <a href="../Text/ch01.html#ch01alg-lev2sec1-E">Algorithm E</a>, however. We never showed that the algorithm terminates; all we have proved is that <em>if</em> it terminates, it gives the right answer!</p>

  <p class="indent">(Notice, for example, that <a href="../Text/ch01.html#ch01alg-lev2sec1-E">Algorithm E</a> still makes sense if we allow its variables <em>m</em>, <em>n</em>, <em>c</em>, <em>d</em>, and <em>r</em> to assume values of the form <span class="middle"><img src="../Images/ch01/e016_01.png"></span>, where <em>u</em> and <em>v</em> are integers. The variables <em>q</em>, <em>a</em>, <em>b</em>, <em>a</em>′, <em>b</em>′ are to remain integer-valued. If we start the method with <span class="middle"><img src="../Images/ch01/e016_02.png"></span> and <span class="middle"><img src="../Images/ch01/e016_03.png"></span>, say, it will compute a “greatest common divisor” <span class="middle"><img src="../Images/ch01/e016_04.png"></span> with <em>a</em> = +2, <em>b</em> = −1. Even under this extension of the assumptions, the proofs of assertions <em>A1</em> through <em>A6</em> remain valid; therefore all assertions are true throughout any execution of the procedure. But if we start out with <em>m</em> = 1 and <span class="middle"><img src="../Images/ch01/e016_05.png"></span>, the computation never <a id="page_17"></a>terminates (see <a href="../Text/ch01.html#ch01ex_2_1_12">exercise 12</a>). Hence a proof of assertions <em>A1</em> through <em>A6</em> does <em>not</em> logically prove that the algorithm is finite.)</p>

  <p class="indent">Proofs of termination are usually handled separately. But <a href="../Text/ch01.html#ch01ex_2_1_13">exercise 13</a> shows that it <em>is</em> possible to extend the method above in many important cases so that a proof of termination is included as a by-product.</p>

  <p class="indent">We have now twice proved the validity of <a href="../Text/ch01.html#ch01alg-lev2sec1-E">Algorithm E</a>. To be strictly logical, we should also try to prove that the first algorithm in this section, <a href="../Text/ch01.html#ch01alg-lev2sec1-I">Algorithm I</a>, is valid; in fact, we have used <a href="../Text/ch01.html#ch01alg-lev2sec1-I">Algorithm I</a> to establish the correctness of any proof by induction. If we attempt to <em>prove</em> that <a href="../Text/ch01.html#ch01alg-lev2sec1-I">Algorithm I</a> works properly, however, we are confronted with a dilemma — we can’t really prove it without using induction again! The argument would be circular.</p>

  <p class="indent">In the last analysis, <em>every</em> property of the integers must be proved using induction somewhere along the line, because if we get down to basic concepts, the integers are essentially <em>defined</em> by induction. Therefore we may take as axiomatic the idea that any positive integer <em>n</em> either equals 1 or can be reached by starting with 1 and repetitively adding 1; this suffices to prove that <a href="../Text/ch01.html#ch01alg-lev2sec1-I">Algorithm I</a> is valid. [For a rigorous study of fundamental concepts about the integers, see the article “On Mathematical Induction” by Leon Henkin, <em>AMM</em> <strong>67</strong> (1960), 323–338.]</p>

  <p class="indent">The idea behind mathematical induction is thus intimately related to the concept of number. The first European to apply mathematical induction to rigorous proofs was the Italian scientist Francesco Maurolico, in 1575. Pierre de Fermat made further improvements, in the early 17th century; he called it the “method of infinite descent.” The notion also appears clearly in the later writings of Blaise Pascal (1653). The phrase “mathematical induction” apparently was coined by A. De Morgan in the early nineteenth century. [See <em>The Penny Cyclopædia</em> <strong>12</strong> (1838), 465–466; <em>AMM</em> <strong>24</strong> (1917), 199–207; <strong>25</strong> (1918), 197–201; <em>Arch. Hist. Exact Sci.</em> <strong>9</strong> (1972), 1–21.] Further discussion of mathematical induction can be found in G. Pólya’s book <em>Induction and Analogy in Mathematics</em> (Princeton, N.J.: Princeton University Press, 1954), Chapter 7.</p>

  <p class="indent">The formulation of algorithm-proving in terms of assertions and induction, as given above, is essentially due to R. W. Floyd. He pointed out that a semantic definition of each operation in a programming language can be formulated as a logical rule that tells exactly what assertions can be proved after the operation, based on what assertions are true beforehand [see “Assigning Meanings to Programs,” <em>Proc. Symp. Appl. Math.</em>, Amer. Math. Soc., <strong>19</strong> (1967), 19–32]. Similar ideas were voiced independently by Peter Naur, <em>BIT</em> <strong>6</strong> (1966), 310–316, who called the assertions “general snapshots.” An important refinement, the notion of “invariants,” was introduced by C. A. <em>R</em>. Hoare; see, for example, <em>CACM</em> <strong>14</strong> (1971), 39–45. Later authors found it advantageous to reverse Floyd’s direction, going from an assertion that should hold <em>after</em> an operation to the “weakest precondition” that must hold <em>before</em> the operation is done; such an approach makes it possible to discover new algorithms that are guaranteed to be correct, if we start from the specifications of the desired output and work backwards. [See E. W. Dijkstra, <em>CACM</em> <strong>18</strong> (1975), 453–457; <em>A Discipline of Programming</em>(Prentice–Hall, 1976).]</p>

  <p class="indent"><a id="page_18"></a>The concept of inductive assertions actually appeared in embryonic form in 1946, at the same time as flow charts were introduced by H. H. Goldstine and J. von Neumann. Their original flow charts included “assertion boxes” that are in close analogy with the assertions in <a href="../Text/ch01.html#ch01fig04">Fig. 4</a>. [See John von Neumann, <em>Collected Works</em> <strong>5</strong> (New York: Macmillan, 1963), 91–99. See also A. M. Turing’s early comments about verification in <em>Report of a Conference on High Speed Automatic Calculating Machines</em> (Cambridge Univ., 1949), 67–68 and figures; reprinted with commentary by F. L. Morris and C. B. Jones in <em>Annals of the History of Computing</em> <strong>6</strong> (1984), 139–143.]</p>

  <p class="blockquote"><span class="roman_italic">The understanding of the theory of a routine<br>
  may be greatly aided by providing, at the time of construction<br>
  one or two statements concerning the state of the machine<br>
  at well chosen points. ...<br>
  In the extreme form of the theoretical method<br>
  a watertight mathematical proof is provided for the assertions.<br>
  In the extreme form of the experimental method<br>
  the routine is tried out on the machine with a variety of initial<br>
  conditions and is pronounced fit if the assertions hold in each case.<br>
  Both methods have their weaknesses.</span></p>

  <p class="attribution">— A. M. TURING, Ferranti Mark I Programming Manual (1950)</p>

  <p class="ex-title">Exercises</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_1_1a" id="ch01ex_2_1_1">1</a>.</strong> [<em>05</em>] Explain how to modify the idea of proof by mathematical induction, in case we want to prove some statement $P(n)$ for all <em>nonnegative</em> integers — that is, for $n=0,1,2,...$ instead of for $n=1,2,3,...$.</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_1_2a" id="ch01ex_2_1_2">2</a>.</strong> [<em>15</em>] There must be something wrong with the following proof. What is it? “<strong>Theorem.</strong> Let <em>a</em> be any positive number. For all positive integers <em>n</em> we have $a^{n-1}=1$. <em>Proof.</em> If <em>n</em> = 1, $a^{n-1}=a^{1-1}=a^{0}=1$. And by induction, assuming that the theorem is true for $1,2,...,n,$ we have</p>

  <div class="image"><img src="../Images/ch01/e018_01.png"></div>

  <p class="exercisesp">so the theorem is true for <em>n</em> + 1 as well.”</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_1_3a" id="ch01ex_2_1_3">3</a>.</strong> [<em>18</em>] The following proof by induction seems correct, but for some reason the equation for <em>n</em> = 6 gives <span class="middle"><img src="../Images/ch01/e018_02.png"></span> on the left-hand side, and <span class="middle"><img src="../Images/ch01/e018_03.png"></span> on the right-hand side. Can you find a mistake? “<strong>Theorem.</strong></p>

  <div class="image"><img src="../Images/ch01/e018_04.png"></div>

  <p class="exercisesp"><em>Proof.</em> We use induction on <em>n</em>. For <em>n</em> = 1, clearly $3/2-1/n=1/(1×2)$; and, assuming that the theorem is true for <em>n</em>,</p>

  <div class="image"><img src="../Images/ch01/e018_05.png"></div>

  <p class="exercises"><strong>4.</strong> [<em>20</em>] Prove that, in addition to Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec1-3">3</a>), Fibonacci numbers satisfy $F_{n}≥ φ^{n-2}$ for all positive integers <em>n</em>.</p>

  <p class="exercises"><a id="page_19"></a><strong><a href="../Text/app01.html#ch01ex_2_1_5a" id="ch01ex_2_1_5">5</a>.</strong> [<em>21</em>] A <em>prime number</em> is an integer &gt; 1 that has no positive integer divisors other than 1 and itself. Using this definition and mathematical induction, prove that every integer &gt; 1 may be written as a product of one or more prime numbers. (A prime number is considered to be the “product” of a single prime, namely itself.)</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_1_6a" id="ch01ex_2_1_6">6</a>.</strong> [<em>20</em>] Prove that if Eqs. (<a href="../Text/ch01.html#ch01eq-lev2sec1-6">6</a>) hold just before step E4, they hold afterwards also.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_1_7a" id="ch01ex_2_1_7">7</a>.</strong> [<em>23</em>] Formulate and prove by induction a rule for the sums $1^{2}$, $2^{2}-1^{2}$, $3^{2}-2^{2}+1^{2}$, $4^{2}-3^{2}+2^{2}-1^{2}$, $5^{2}-4^{2}+3^{2}-2^{2}+1^{2}$, etc.</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_1_8a" id="ch01ex_2_1_8">8</a>.</strong> [<em>25</em>] (a) Prove the following theorem of Nicomachus (<small>A.D</small>. c. 100) by induction: $1^{3}=1$, $2^{3}=3+5$, $3^{3}=7+9+11$, $4^{3}=13+15+17+19$, etc. (b) Use this result to prove the remarkable formula $1^{3}+2^{3}+···+n^{3}=(1+2+···+n)^{2}$.</p>

  <p class="exercisesp">[<em>Note:</em> An attractive geometric interpretation of this formula, suggested by Warren Lushbaugh, is shown in <a href="../Text/ch01.html#ch01fig05">Fig. 5</a>; see <em>Math. Gazette</em> <strong>49</strong> (1965), 200. The idea is related to Nicomachus’s theorem and <a href="../Text/ch01.html#ch01fig03">Fig. 3</a>. Other “look-see” proofs can be found in books by Martin Gardner, <em>Knotted Doughnuts</em> (New York: Freeman, 1986), Chapter 16; J. H. Conway and R. K. Guy, <em>The Book of Numbers</em> (New York: Copernicus, 1996), <a href="../Text/ch02.html#ch02">Chapter 2</a>.]</p>

  <div class="image">
    <a id="ch01fig05"></a><img src="../Images/ch01/01fig05.png">

    <p class="fig-caption"><strong>Fig. 5.</strong> Geometric version of <a href="../Text/ch01.html#ch01ex_2_1_8">exercise 8</a>(b).</p>
  </div>

  <p class="exercises"><a id="ch01ex_2_1_09"></a><strong>9.</strong> [<em>20</em>] Prove by induction that if 0 &lt; <em>a</em> &lt; 1, then $(1-a)^{n}≥ 1-na$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_1_10a" id="ch01ex_2_1_10">10</a>.</strong> [<em>M22</em>] Prove by induction that if <em>n</em> ≥ 10, then $2^{n}\gt n^{3}$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_1_11a" id="ch01ex_2_1_11">11</a>.</strong> [<em>M30</em>] Find and prove a simple formula for the sum</p>

  <div class="image"><img src="../Images/ch01/e019_01.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_1_12a" id="ch01ex_2_1_12">12</a>.</strong> [<em>M25</em>] Show how <a href="../Text/ch01.html#ch01alg-lev2sec1-E">Algorithm E</a> can be generalized as stated in the text so that it will accept input values of the form $u+v\sqrt{2}$, where <em>u</em> and <em>v</em> are integers, and the computations can still be done in an elementary way (that is, without using the infinite decimal expansion of $\sqrt{2}$). Prove that the computation will not terminate, however, if <em>m</em> = 1 and $n=\sqrt{2}$.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_1_13a" id="ch01ex_2_1_13">13</a>.</strong> [<em>M23</em>] Extend <a href="../Text/ch01.html#ch01alg-lev2sec1-E">Algorithm E</a> by adding a new variable <em>T</em> and adding the operation “$T←T+1$” at the beginning of each step. (Thus, <em>T</em> is like a clock, counting the number of steps executed.) Assume that <em>T</em> is initially zero, so that assertion <em>A1</em> in <a href="../Text/ch01.html#ch01fig04">Fig. 4</a> becomes “<em>m</em> &gt; 0, <em>n</em> &gt; 0, <em>T</em> = 0.” The additional condition “<em>T</em> = 1” should similarly be appended to <em>A2</em>. Show how to append additional conditions to the assertions in such a way that any one of <em>A1</em>, <em>A2</em>, ..., <em>A6</em> implies <em>T</em> ≤ 3<em>n</em>, and such that the inductive proof can still be carried out. (Hence the computation must terminate in at most 3<em>n</em> steps.)</p>

  <p class="exercises1"><a id="page_20"></a><strong>14.</strong> [<em>50</em>] (R. W. Floyd.) Prepare a computer program that accepts, as input, programs in some programming language together with optional assertions, and that attempts to fill in the remaining assertions necessary to make a proof that the computer program is valid. (For example, strive to get a program that is able to prove the validity of <a href="../Text/ch01.html#ch01alg-lev2sec1-E">Algorithm E</a>, given only assertions <em>A1</em>, <em>A4</em>, and <em>A6</em>. See the papers by R. W. Floyd and J. C. King in the IFIP Congress proceedings, 1971, for further discussion.)</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_1_15a" id="ch01ex_2_1_15">15</a>.</strong> [<em>HM28</em>] (<em>Generalized induction.</em>) The text shows how to prove statements $P(n)$ that depend on a single integer <em>n</em>, but it does not describe how to prove statements $P(m,n)$ depending on two integers. In these circumstances a proof is often given by some sort of “double induction,” which frequently seems confusing. Actually, there is an important principle more general than simple induction that applies not only to this case but also to situations in which statements are to be proved about uncountable sets — for example, $P(x)$ for all real <em>x</em>. This general principle is called <em>well-ordering</em>.</p>

  <p class="indent">Let “≺” be a relation on a set <em>S</em>, satisfying the following properties:</p>

  <p class="indenti">i) Given <em>x</em>, <em>y</em>, and <em>z</em> in <em>S</em>, if $x≺y$ and $y≺z$, then $x≺z$.</p>

  <p class="indenti">ii) Given <em>x</em> and <em>y</em> in <em>S</em>, exactly one of the following three possibilities is true: $x≺y$, <em>x</em> = <em>y</em>, or $y≺x$.</p>

  <p class="indenti">iii) If <em>A</em> is any nonempty subset of <em>S</em>, there is an element <em>x</em> in <em>A</em> with $x≼y$ (that is, $x≺y$ or <em>x</em> = <em>y</em>) for all <em>y</em> in <em>A</em>.</p>

  <p class="exercisesp">This relation is said to be a well-ordering of <em>S</em>. For example, it is clear that the positive integers are well-ordered by the ordinary “less than” relation, &lt;.</p>

  <p class="indenta">a) Show that the set of <em>all</em> integers is not well-ordered by &lt;.</p>

  <p class="indenta">b) Define a well-ordering relation on the set of all integers.</p>

  <p class="indenta">c) Is the set of all nonnegative real numbers well-ordered by &lt;?</p>

  <p class="indenta">d) (<em>Lexicographic order</em>.) Let <em>S</em> be well-ordered by ≺, and for <em>n</em> &gt; 0 let $T_{n}$ be the set of all <em>n</em>-tuples $(x_{1},x_{2},...,x_{n})$ of elements $x_{j}$ in S. Define $(x_{1},x_{2},...,x_{n})≺(y_{1},y_{2},...,y_{n})$ if there is some <em>k</em>, 1 ≤ <em>k</em> ≤ <em>n</em>, such that $x_{j}=y_{j}$ for 1 ≤ <em>j</em> &lt; <em>k</em>, but $x_{k}≺y_{k}$ in S. Is ≺ a well-ordering of $T_{n}$?</p>

  <p class="indenta">e) Continuing part (d), let $T=\bigcup_{n ≥ 1}T_{n}$; define $(x_{1},x_{2},...,x_{m})≺(y_{1},y_{2},...,y_{n})$ if $x_{j}=y_{j}$ for 1 ≤ j &lt; <em>k</em> and $x_{k}≺y_{k}$, for some $k≤\min(m,n)$, or if <em>m</em> &lt; <em>n</em> and $x_{j}=y_{j}$ for 1 ≤ <em>j</em> ≤ <em>m</em>. Is ≺ a well-ordering of <em>T</em>?</p>

  <p class="indenta">f) Show that ≺ is a well-ordering of <em>S</em> if and only if it satisfies (i) and (ii) above and there is no infinite sequence $x_{1},x_{2},x_{3},...$ with $x_{j+1}≺x_{j}$ for all <em>j</em> ≥ 1.</p>

  <p class="indenta">g) Let <em>S</em> be well-ordered by ≺, and let $P(x)$ be a statement about the element <em>x</em> of <em>S</em>. Show that if $P(x)$ can be proved under the assumption that $P(y)$ is true for all $y≺x$, then $P(x)$ is true for all <em>x</em> in <em>S</em>.</p>

  <p class="exercisesp">[<em>Notes:</em> Part (g) is the generalization of simple induction that was promised; in the case <em>S</em> = positive integers, it is just the simple case of mathematical induction treated in the text. In that case we are asked to prove that $P(1)$ is true if $P(y)$ is true for all positive integers <em>y</em> &lt; 1; this is the same as saying we should prove $P(1)$, since $P(y)$ certainly is (vacuously) true for all such <em>y</em>. Consequently, one finds that in many situations $P(1)$ need not be proved using a special argument.</p>

  <p class="exercises1N">Part (d), in connection with part (g), gives us a powerful method of <em>n</em>-tuple induction for proving statements $P(m_{1},...,m_{n})$ about <em>n</em> positive integers $m_{1},...,m_{n}$.</p>

  <p class="exercises1N">Part (f) has further application to computer algorithms: If we can map each state <em>x</em> of a computation into an element $f(x)$ belonging to a well-ordered set <em>S</em>, in such a way that every step of the computation takes a state <em>x</em> into a state <em>y</em> with $f(y)≺f(x)$, then <a id="page_21"></a>the algorithm must terminate. This principle generalizes the argument about strictly decreasing values of <em>n</em>, by which we proved the termination of <a href="../Text/ch01.html#ch01alg-lev1sec1-E">Algorithm 1.1E</a>.]</p>

  <div class="heading">
    <h4 id="ch01lev2sec2">1.2.2. Numbers, Powers, and Logarithms</h4>

    <p>Let us now begin our study of numerical mathematics by taking a good look at the numbers we are dealing with. The <em>integers</em> are the whole numbers</p>
  </div>

  <p class="center">$...,-3,-2,-1,0,1,2,3,...$</p>

  <p>(negative, zero, or positive). A <em>rational number</em> is the ratio (quotient) of two integers, $p/q$, where <em>q</em> is positive. A <em>real number</em> is a quantity <em>x</em> that has a <em>decimal expansion</em></p>

  <div class="equation" id="ch01eq-lev2sec2-1"><img src="../Images/ch01/021equ01.png"></div>

  <p>where <em>n</em> is an integer, each $d_{i}$ is a digit between 0 and 9, and the sequence of digits doesn’t end with infinitely many 9s. The representation (<a href="../Text/ch01.html#ch01eq-lev2sec2-1">1</a>) means that</p>

  <div class="equation" id="ch01eq-lev2sec2-2"><img src="../Images/ch01/021equ02.png"></div>

  <p>for all positive integers <em>k</em>. Examples of real numbers that are not rational are</p>

  <p class="indent">$π=3.14159265358979...$, the ratio of circumference to diameter in a circle;</p>

  <p class="indent">$φ=1.61803398874989...$, the <em>golden ratio</em> $(1+\sqrt{5})/2$ (see <a href="../Text/ch01a.html#ch01lev2sec8">Section 1.2.8</a>).</p>

  <p>A table of important constants, to forty decimal places of accuracy, appears in <a href="../Text/app02.html#app02">Appendix A</a>. We need not discuss the familiar properties of addition, subtraction, multiplication, division, and comparison of real numbers.</p>

  <p class="indent">Difficult problems about integers are often solved by working with real numbers, and difficult problems about real numbers are often solved by working with a still more general class of values called complex numbers. A <em>complex number</em> is a quantity <em>z</em> of the form $z=x+iy$, where <em>x</em> and <em>y</em> are real and <em>i</em> is a special quantity that satisfies the equation $i^{2}=-1$. We call <em>x</em> and <em>y</em> the <em>real part</em> and <em>imaginary part</em> of z, and we define the absolute value of <em>z</em> to be</p>

  <div class="equation" id="ch01eq-lev2sec2-3"><img src="../Images/ch01/021equ03.png"></div>

  <p>The <em>complex conjugate</em> of <em>z</em> is $\overline{z}=x-iy$, and we have $z\overline{z}=x^{2}+y^{2}=|z|^{2}$. The theory of complex numbers is in many ways simpler and more beautiful than the theory of real numbers, but it is usually considered to be an advanced topic. Therefore we shall concentrate on real numbers in this book, except when real numbers turn out to be unnecessarily complicated.</p>

  <p class="indent">If <em>u</em> and <em>v</em> are real numbers with <em>u</em> ≤ <em>v</em>, the <em>closed interval</em> $[u..v]$ is the set of real numbers <em>x</em> such that <em>u</em> ≤ <em>x</em> ≤ <em>v</em>. The <em>open interval</em> $(u..v)$ is, similarly, the set of <em>x</em> such that <em>u</em> &lt; <em>x</em> &lt; <em>v</em>. And <em>half-open intervals</em> $[u..v)$ or $(u..v]$ are defined in an analogous way. We also allow <em>u</em> to be $-∞$ or <em>v</em> to be ∞ at an open endpoint, meaning that there is no lower or upper bound; thus $(-∞..∞)$ stands for the set of all real numbers, and $[0..∞)$ denotes the nonnegative reals.</p>

  <p class="indent"><a id="page_22"></a>Throughout this section, let the letter <em>b</em> stand for a positive real number. If <em>n</em> is an integer, then $b^{n}$ is defined by the familiar rules</p>

  <div class="equation" id="ch01eq-lev2sec2-4"><img src="../Images/ch01/022equ01.png"></div>

  <p>It is easy to prove by induction that the <em>laws of exponents</em> are valid:</p>

  <div class="equation" id="ch01eq-lev2sec2-5"><img src="../Images/ch01/022equ02.png"></div>

  <p>whenever <em>x</em> and <em>y</em> are integers.</p>

  <p class="indent">If <em>u</em> is a positive real number and if <em>m</em> is a positive integer, there is always a unique positive real number <em>v</em> such that $v^{m}=u$; it is called the <em>mth root</em> of <em>u</em>, and denoted <span class="middle"><img src="../Images/ch01/e022_01.png"></span>.</p>

  <p class="indent">We now define $b^{r}$ for rational numbers $r=p/q$ as follows:</p>

  <div class="equation" id="ch01eq-lev2sec2-6"><img src="../Images/ch01/022equ03.png"></div>

  <p>This definition, due to Oresme (c. 1360), is a good one, since $b^{ap/aq}=b^{p/q}$, and since the laws of exponents are still correct even when <em>x</em> and <em>y</em> are arbitrary rational numbers (see <a href="../Text/ch01.html#ch01ex_2_2_9">exercise 9</a>).</p>

  <p class="indent">Finally, we define $b^{x}$ for all real values of <em>x</em>. Suppose first that <em>b</em> &gt; 1; if <em>x</em> is given by Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec2-1">1</a>), we want</p>

  <div class="equation" id="ch01eq-lev2sec2-7"><img src="../Images/ch01/022equ04.png"></div>

  <p>This <em>defines</em> $b^{x}$ as a unique positive real number, since the difference between the right and left extremes in Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec2-7">7</a>) is $b^{n+d_{1}/10+···+d_{k}/10^{k}}(b^{1/10^{k}}–1)$; by <a href="../Text/ch01.html#ch01ex_2_2_13">exercise 13</a> below, this difference is less than $b^{n+1}(b-1)/10^{k}$, and if we take <em>k</em> large enough, we can therefore get any desired accuracy for $b^{x}$.</p>

  <p class="indent">For example, we find that</p>

  <div class="equation" id="ch01eq-lev2sec2-8"><img src="../Images/ch01/022equ05.png"></div>

  <p>therefore if <em>b</em> = 10 and $x=0.30102999...$, we know the value of $b^{x}$ with an accuracy of better than one part in 10 million (although we still don’t even know whether the decimal expansion of $b^{x}$ is $1.999...$ or $2.000...$).</p>

  <p class="indent">When <em>b</em> &lt; 1, we define $b^{x}=(1/b)^{-x}$; and when <em>b</em> = 1, $b^{x}=1$. With these definitions, it can be proved that the laws of exponents (<a href="../Text/ch01.html#ch01eq-lev2sec2-5">5</a>) hold for any <em>real</em> values of <em>x</em> and <em>y</em>. These ideas for defining $b^{x}$ were first formulated by John Wallis (1655) and Isaac Newton (1669).</p>

  <p class="indent">Now we come to an important question. Suppose that a positive real number <em>y</em> is given; can we find a real number <em>x</em> such that $y=b^{x}$? The answer is “yes” (provided that <em>b</em> ≠ 1), for we simply use Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec2-7">7</a>) <em>in reverse</em> to determine <em>n</em> and $d_{1},d_{2},...$ when $b^{x}=y$ is given. The resulting number <em>x</em> is called the <em>logarithm</em> of <em>y</em> <em>to the base</em> <em>b</em>, and we write this as $x=\log_{b}y$. By this definition we have</p>

  <div class="equation" id="ch01eq-lev2sec2-9"><img src="../Images/ch01/022equ06.png"></div>

  <p>As an example, Eqs. (<a href="../Text/ch01.html#ch01eq-lev2sec2-8">8</a>) show that</p>

  <div class="equation" id="ch01eq-lev2sec2-10"><img src="../Images/ch01/022equ07.png"></div>

  <p><a id="page_23"></a>From the laws of exponents it follows that</p>

  <div class="equation" id="ch01eq-lev2sec2-11"><img src="../Images/ch01/023equ01.png"></div>

  <p>and</p>

  <div class="equation" id="ch01eq-lev2sec2-12"><img src="../Images/ch01/023equ02.png"></div>

  <p class="indent">Equation (<a href="../Text/ch01.html#ch01eq-lev2sec2-10">10</a>) illustrates the so-called <em>common logarithms</em>, which we get when the base is 10. One might expect that in computer work <em>binary logarithms</em> (to the base 2) would be more useful, since most computers do binary arithmetic. Actually, we will see that binary logarithms are indeed very useful, but not only for that reason; the reason is primarily that a computer algorithm often makes two-way branches. Binary logarithms arise so frequently, it is wise to have a shorter notation for them. Therefore we shall write</p>

  <div class="equation" id="ch01eq-lev2sec2-13"><img src="../Images/ch01/023equ03.png"></div>

  <p>following a suggestion of Edward M. Reingold.</p>

  <p class="indent">The question now arises as to whether or not there is any relationship between $\lg x$ and $\log_{10}x$; fortunately there is,</p>

  <p class="center">$\log_{10}x=\log_{10}(2^{\lg x})=(\lg x)(\log_{10}2)$,</p>

  <p>by Eqs. (<a href="../Text/ch01.html#ch01eq-lev2sec2-9">9</a>) and (<a href="../Text/ch01.html#ch01eq-lev2sec2-12">12</a>). Hence $\lg x=\log_{10}x/\log_{10}2$, and in general we find that</p>

  <div class="equation" id="ch01eq-lev2sec2-14"><img src="../Images/ch01/023equ04.png"></div>

  <p>Equations (<a href="../Text/ch01.html#ch01eq-lev2sec2-11">11</a>), (<a href="../Text/ch01.html#ch01eq-lev2sec2-12">12</a>), and (<a href="../Text/ch01.html#ch01eq-lev2sec2-14">14</a>) are the fundamental rules for manipulating logarithms.</p>

  <p class="indent">It turns out that neither base 10 nor base 2 is really the most convenient base to work with in most cases. There is a real number, denoted by $e=2.718281828459045...$, for which the logarithms have simpler properties. Logarithms to the base <em>e</em> are conventionally called <em>natural logarithms</em>, and we write</p>

  <div class="equation" id="ch01eq-lev2sec2-15"><img src="../Images/ch01/023equ05.png"></div>

  <p>This rather arbitrary definition (in fact, we haven’t really defined <em>e</em>) probably doesn’t strike the reader as being a very “natural” logarithm; yet we’ll find that ln <em>x</em> seems more and more natural, the more we work with it. John Napier actually discovered natural logarithms (with slight modifications, and without connecting them with powers) before the year 1590, many years before any other kind of logarithm was known. The following two examples, proved in every calculus text, shed some light on why Napier’s logarithms deserve to be called “natural”: (a) In <a href="../Text/ch01.html#ch01fig06">Fig. 6</a> the area of the shaded portion is ln <em>x</em>. (b) If a bank pays compound interest at rate <em>r</em>, compounded semiannually, the annual return on each dollar is $(1+r/2)^{2}$ dollars; if it is compounded quarterly, you get $(1+r/4)^{4}$ dollars; and if it is compounded daily you probably get $(1+r/365)^{365}$ dollars. Now if the interest were compounded <em>continuously</em>, you would get exactly $e^{r}$ dollars for every dollar (ignoring roundoff error). In this age of computers, many bankers have now actually reached the limiting formula.</p>

  <div class="image">
    <a id="ch01fig06"></a><img src="../Images/ch01/01fig06.png">

    <p class="fig-caption"><strong>Fig. 6.</strong> Natural logarithm.</p>
  </div>

  <p class="indent"><a id="page_24"></a>The interesting history of the concepts of logarithm and exponential has been told in a series of articles by F. Cajori, <em>AMM</em> <strong>20</strong> (1913), 5–14, 35–47, 75–84, 107–117, 148–151, 173–182, 205–210.</p>

  <p class="indent">We conclude this section by considering how to <em>compute</em> logarithms. One method is suggested immediately by Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec2-7">7</a>): If we let $b^{x}=y$ and raise all parts of that equation to the $10^{k}\rm\unicode{45}th$ power, we find that</p>

  <div class="equation" id="ch01eq-lev2sec2-16"><img src="../Images/ch01/024equ01.png"></div>

  <p>for some integer <em>m</em>. All we have to do to get the logarithm of <em>y</em> is to raise <em>y</em> to this huge power and find which powers $(m,m+1)$ of <em>b</em> the result lies between; then $m/10^{k}$ is the answer to <em>k</em> decimal places.</p>

  <p class="indent">A slight modification of this apparently impractical method leads to a simple and reasonable procedure. We will show how to calculate $log_{10}x$ and to express the answer in the <em>binary</em> system, as</p>

  <div class="equation" id="ch01eq-lev2sec2-17"><img src="../Images/ch01/024equ02.png"></div>

  <p>First we shift the decimal point of <em>x</em> to the left or to the right so that we have $1≤x/10^{n}\lt 10$; this determines the integer part, <em>n</em>. To obtain $b_{1},b_{2},...$, we now set $x_{0}=x/10^{n}$ and, for <em>k</em> ≥ 1,</p>

  <div class="equation" id="ch01eq-lev2sec2-18"><img src="../Images/ch01/024equ03.png"></div>

  <p>The validity of this procedure follows from the fact that</p>

  <div class="equation" id="ch01eq-lev2sec2-19"><img src="../Images/ch01/024equ04.png"></div>

  <p>for $k=0,1,2,...$, as is easily proved by induction.</p>

  <p class="indent">In practice, of course, we must work with only finite accuracy, so we cannot set <span class="middle"><img src="../Images/ch01/e024_01.png"></span> exactly. Instead, we set <span class="middle"><img src="../Images/ch01/e024_02.png"></span> <em>rounded</em> or <em>truncated</em> to a certain number of decimal places. For example, here is the evaluation of $\log_{10}2$ rounded to four significant figures:</p>

  <div class="image"><img src="../Images/ch01/e024_05.png"></div>

  <p>Computational error has caused errors to propagate; the true rounded value of $x_{10}$ is 1.798. This will eventually cause $b_{19}$ to be computed incorrectly, and <a id="page_25"></a>we get the binary value $(0.0100110100010000011...)_{2}$, which corresponds to the decimal equivalent $0.301031...$ rather than the true value given in Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec2-10">10</a>).</p>

  <p class="indent">With any method such as this it is necessary to examine the amount of computational error due to the limitations imposed. <a href="../Text/ch01.html#ch01ex_2_2_27">Exercise 27</a> derives an upper bound for the error; working to four figures as above, we find that the error in the value of the logarithm is guaranteed to be less than 0.00044. Our answer above was more accurate than this primarily because $x_{0}$, $x_{1}$, $x_{2}$, and $x_{3}$ were obtained <em>exactly</em>.</p>

  <p class="indent">This method is simple and quite interesting, but it is probably not the best way to calculate logarithms on a computer. Another method is given in <a href="../Text/ch01.html#ch01ex_2_2_25">exercise 25</a>.</p>

  <p class="ex-title">Exercises</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_2_1a" id="ch01ex_2_2_1">1</a>.</strong> [<em>00</em>] What is the smallest positive rational number?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_2_2a" id="ch01ex_2_2_2">2</a>.</strong> [<em>00</em>] Is $1+0.239999999...$ a decimal expansion?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_2_3a" id="ch01ex_2_2_3">3</a>.</strong> [<em>02</em>] What is $(-3)^{-3}$?</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_2_4a" id="ch01ex_2_2_4">4</a>.</strong> [<em>05</em>] What is $(0.125)^{-2/3}$?</p>

  <p class="exercises"><strong>5.</strong> [<em>05</em>] We defined real numbers in terms of a decimal expansion. Discuss how we could have defined them in terms of a binary expansion instead, and give a definition to replace Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec2-2">2</a>).</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_2_6a" id="ch01ex_2_2_6">6</a>.</strong> [<em>10</em>] Let $x=m+0.d_{1}d_{2}...$ and $y=n+0.e_{1}e_{2}...$ be real numbers. Give a rule for determining whether <em>x</em> = <em>y</em>, <em>x</em> &lt; <em>y</em>, or <em>x</em> &gt; <em>y</em>, based on the decimal representation.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_2_7a" id="ch01ex_2_2_7">7</a>.</strong> [<em>M23</em>] Given that <em>x</em> and <em>y</em> are integers, prove the laws of exponents, starting from the definition given by Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec2-4">4</a>).</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_2_8a" id="ch01ex_2_2_8">8</a>.</strong> [<em>25</em>] Let <em>m</em> be a positive integer. <em>Prove</em> that every positive real number <em>u</em> has a unique positive <em>m</em>th root, by giving a method to construct successively the values $n,d_{1},d_{2},...$ in the decimal expansion of the root.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_2_9a" id="ch01ex_2_2_9">9</a>.</strong> [<em>M23</em>] Given that <em>x</em> and <em>y</em> are rational, prove the laws of exponents under the assumption that the laws hold when <em>x</em> and <em>y</em> are integers.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_2_10a" id="ch01ex_2_2_10">10</a>.</strong> [<em>18</em>] Prove that $\log_{10}2$ is not a rational number.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_2_11a" id="ch01ex_2_2_11">11</a>.</strong> [<em>10</em>] If <em>b</em> = 10 and $x ≈\log_{10}2$, to how many decimal places of accuracy will we need to know the value of <em>x</em> in order to determine the first three decimal places of the decimal expansion of $b^{x}$? [<em>Note:</em> You may use the result of <a href="../Text/ch01.html#ch01ex_2_2_10">exercise 10</a> in your discussion.]</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_2_12a" id="ch01ex_2_2_12">12</a>.</strong> [<em>02</em>] Explain why Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec2-10">10</a>) follows from Eqs. (<a href="../Text/ch01.html#ch01eq-lev2sec2-8">8</a>).</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_2_13a" id="ch01ex_2_2_13">13</a>.</strong> [<em>M23</em>] (a) Given that <em>x</em> is a positive real number and <em>n</em> is a positive integer, prove the inequality <span class="middle"><img src="../Images/ch01/e025_01.png"></span>. (b) Use this fact to justify the remarks following (<a href="../Text/ch01.html#ch01eq-lev2sec2-7">7</a>).</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_2_14a" id="ch01ex_2_2_14">14</a>.</strong> [<em>15</em>] Prove Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec2-12">12</a>).</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_2_15a" id="ch01ex_2_2_15">15</a>.</strong> [<em>10</em>] Prove or disprove:</p>

  <p class="center">$\log_{b}x/y=\log_{b}x-\log_{b}y$,&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;&nbsp;$x,y\gt 0$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_2_16a" id="ch01ex_2_2_16">16</a>.</strong> [<em>00</em>] How can $\log_{10}x$ be expressed in terms of $\ln x$ and $\ln 10$?</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_2_17a" id="ch01ex_2_2_17">17</a>.</strong> [<em>05</em>] What is $\lg 32$? $\log_{π}π$? $\ln e$? $\log_{b}1$? $\log_{b}(-1)$?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_2_18a" id="ch01ex_2_2_18">18</a>.</strong> [<em>10</em>] Prove or disprove: <span class="middle"><img src="../Images/ch01/e025_02.png"></span></p>

  <p class="exercises3"><a id="page_26"></a><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_2_19a" id="ch01ex_2_2_19">19</a>.</strong> [<em>20</em>] If <em>n</em> is an integer whose decimal representation is 14 digits long, will the value of <em>n</em> fit in a computer word with a capacity of 47 bits and a sign bit?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_2_20a" id="ch01ex_2_2_20">20</a>.</strong> [<em>10</em>] Is there any simple relation between $\log_{10}2$ and $\log_{2}10$?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_2_21a" id="ch01ex_2_2_21">21</a>.</strong> [<em>15</em>] (<em>Logs of logs</em>.) Express $\log_{b}\log_{b}x$ in terms of $\ln\ln x$, $\ln\ln b$, and $\ln b$.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_2_22a" id="ch01ex_2_2_22">22</a>.</strong> [<em>20</em>] (R. W. Hamming.) Prove that</p>

  <p class="center">$\lg x ≈\ln x+\log_{10}x$,</p>

  <p class="exercisesp">with less than 1% error! (Thus a table of natural logarithms and of common logarithms can be used to get approximate values of binary logarithms as well.)</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_2_23a" id="ch01ex_2_2_23">23</a>.</strong> [<em>M25</em>] Give a <em>geometric</em> proof that $\ln xy=\ln x+\ln y$, based on <a href="../Text/ch01.html#ch01fig06">Fig. 6</a>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_2_24a" id="ch01ex_2_2_24">24</a>.</strong> [<em>15</em>] Explain how the method used for calculating logarithms to the base 10 at the end of this section can be modified to produce logarithms to base 2.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_2_25a" id="ch01ex_2_2_25">25</a>.</strong> [<em>22</em>] Suppose that we have a binary computer and a number <em>x</em>, 1 ≤ <em>x</em> &lt; 2. Show that the following algorithm, which uses only shifting, addition, and subtraction operations proportional to the number of places of accuracy desired, may be used to calculate an approximation to $y=\log_{b}x$:</p>

  <p class="uln-indentC"><strong>L1.</strong> [Initialize.] Set $y←0$, $z←x$ shifted right 1, $k←1$.</p>

  <p class="uln-indentC"><strong>L2.</strong> [Test for end.] If <em>x</em> = 1, stop.</p>

  <p class="uln-indentC"><strong>L3.</strong> [Compare.] If $x-z\lt 1$, set $z←z$ shifted right 1, $k←k+1$, and repeat this step.</p>

  <p class="uln-indentC"><strong>L4.</strong> [Reduce values.] Set $x←x-z$, $z←x$ shifted right <em>k</em>, $y←y+\log_{b}(2^{k}/(2^{k}-1))$, and go to L2. <span class="middle"><img src="../Images/ch01/box.png"></span></p>

  <p class="exercisesp">[<em>Notes:</em> This method is very similar to the method used for division in computer hardware. The idea goes back in essence to Henry Briggs, who used it (in decimal rather than binary form) to compute logarithm tables, published in 1624. We need an auxiliary table of the constants $\log_{b}2$, $\log_{b}(4/3)$, $\log_{b}(8/7)$, etc., to as many values as the precision of the computer. The algorithm involves intentional computational errors, as numbers are shifted to the right, so that eventually <em>x</em> will be reduced to 1 and the algorithm will terminate. The purpose of this exercise is to explain why it will terminate and why it computes an approximation to $\log_{b}x$. ]</p>

  <p class="exercises1"><a id="ch01ex_2_2_26"></a><strong>26.</strong> [<em>M27</em>] Find a rigorous upper bound on the error made by the algorithm in the previous exercise, based on the precision used in the arithmetic operations.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_2_27a" id="ch01ex_2_2_27">27</a>.</strong> [<em>M25</em>] Consider the method for calculating $\log_{10}x$ discussed in the text. Let <span class="middle"><img src="../Images/ch01/e026_01.png"></span> denote the computed approximation to $x_{k}$, determined as follows: <img src="../Images/ch01/e026_02.png">; and in the determination of <span class="middle"><img src="../Images/ch01/e026_03.png"></span> by Eqs. (<a href="../Text/ch01.html#ch01eq-lev2sec2-18">18</a>), the quantity $y_{k}$ is used in place of $(x'_{k-1})^{2}$, where <span class="middle"><img src="../Images/ch01/e026_05.png"></span> and $1≤y_{k}\lt 100$. Here <em>δ</em> and $\epsilon$ are small constants that reflect the upper and lower errors due to rounding or truncation. If $\log' x$ denotes the result of the calculations, show that after <em>k</em> steps we have</p>

  <p class="center">$\log_{10}x+2\log_{10}(1-δ)-1/2^{k}\lt\log'x≤\log_{10}x+2\log_{10}(1+\epsilon)$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_2_28a" id="ch01ex_2_2_28">28</a>.</strong> [<em>M30</em>] (R. Feynman.) Develop a method for computing $b^{x}$ when 0 ≤ <em>x</em> &lt; 1, using only shifting, addition, and subtraction (similar to the algorithm in <a href="../Text/ch01.html#ch01ex_2_2_25">exercise 25</a>), and analyze its accuracy.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_2_29a" id="ch01ex_2_2_29">29</a>.</strong> [<em>HM20</em>] Let <em>x</em> be a real number greater than 1. (a) For what real number <em>b</em> &gt; 1 is $b\log_{b}x$ a minimum? (b) For what <em>integer</em> <em>b</em> &gt; 1 is it a minimum? (c) For what integer <em>b</em> &gt; 1 is $(b+1)\log_{b}x$ a minimum?</p>

  <p class="exercises1"><a id="page_27"></a><strong><a href="../Text/app01.html#ch01ex_2_2_30a" id="ch01ex_2_2_30">30</a>.</strong> [<em>12</em>] Simplify the expression $(\ln x)^{\ln x/\ln\ln x}$, assuming that <em>x</em> &gt; 1 and <em>x</em> ≠ <em>e</em>.</p>

  <div class="heading">
    <h4 id="ch01lev2sec3">1.2.3. Sums and Products</h4>

    <p>Let $a_{1},a_{2},...$ be any sequence of numbers. We are often interested in sums such as $a_{1}+a_{2}+···+a_{n}$, and this sum is more compactly written using either of the following equivalent notations:</p>
  </div>

  <div class="equation" id="ch01eq-lev2sec3-1"><img src="../Images/ch01/027equ01.png"></div>

  <p>If <em>n</em> is zero, the value of <span class="middle"><img src="../Images/ch01/e027_01.png"></span> is defined to be zero. Our convention of using “three dots” in sums such as $a_{1}+a_{2}+···+a_{n}$ therefore has some slightly peculiar, but sensible, behavior in borderline cases (see <a href="../Text/ch01.html#ch01ex_2_3_1">exercise 1</a>).</p>

  <p class="indent">In general, if $R(j)$ is any relation involving <em>j</em>, the symbol</p>

  <div class="equation" id="ch01eq-lev2sec3-2"><img src="../Images/ch01/027equ02.png"></div>

  <p>means the sum of all $a_{j}$ where <em>j</em> is an integer satisfying the condition $R(j)$. If no such integers exist, notation (<a href="../Text/ch01.html#ch01eq-lev2sec3-2">2</a>) denotes zero. The letter <em>j</em> in (<a href="../Text/ch01.html#ch01eq-lev2sec3-1">1</a>) and (<a href="../Text/ch01.html#ch01eq-lev2sec3-2">2</a>) is a <em>dummy index</em> or <em>index variable</em>, introduced just for the purposes of the notation. Symbols used as index variables are usually the letters <em>i</em>, <em>j</em>, <em>k</em>, <em>m</em>, <em>n</em>, <em>r</em>, <em>s</em>, <em>t</em> (occasionally with subscripts or accent marks). Large summation signs like those in (<a href="../Text/ch01.html#ch01eq-lev2sec3-1">1</a>) and (<a href="../Text/ch01.html#ch01eq-lev2sec3-2">2</a>) can also be rendered more compactly as <span class="middle"><img src="../Images/ch01/e027_02.png"></span> or $∑_{R(j)}^{a}j$. The use of a ∑ and index variables to indicate summation with definite limits was introduced by J. Fourier in 1820.</p>

  <p class="indent">Strictly speaking, the notation $∑_{1≤j≤n}a_{j}$ is ambiguous, since it does not clarify whether the summation is taken with respect to <em>j</em> or to <em>n</em>. In this particular case it would be rather silly to interpret it as a sum on values of <em>n</em> ≥ <em>j</em>; but meaningful examples can be constructed in which the index variable is not clearly specified, as in <span class="middle"><img src="../Images/ch01/e027_03.png"></span>. In such cases the context must make clear which variable is a dummy variable and which variable has a significance that extends beyond its appearance in the sum. A sum such as <span class="middle"><img src="../Images/ch01/e027_04.png"></span> would presumably be used only if either <em>j</em> or <em>k</em> (not both) has exterior significance.</p>

  <p class="indent">In most cases we will use notation (<a href="../Text/ch01.html#ch01eq-lev2sec3-2">2</a>) only when the sum is <em>finite</em> — that is, when only a finite number of values <em>j</em> satisfy $R(j)$ and have $a_{j}≠0$. If an infinite sum is required, for example</p>

  <div class="image"><img src="../Images/ch01/e027_05.png"></div>

  <p>with infinitely many nonzero terms, the techniques of calculus must be employed; the precise meaning of (<a href="../Text/ch01.html#ch01eq-lev2sec3-2">2</a>) is then</p>

  <div class="equation" id="ch01eq-lev2sec3-3"><img src="../Images/ch01/027equ03.png"></div>

  <p><a id="page_28"></a>provided that both limits exist. If either limit fails to exist, the infinite sum is <em>divergent;</em> it does not exist. Otherwise it is <em>convergent</em>.</p>

  <p class="indent">When two or more conditions are placed under the ∑ sign, as in (<a href="../Text/ch01.html#ch01eq-lev2sec3-3">3</a>), we mean that <em>all</em> conditions must hold.</p>

  <p class="indent">Four simple algebraic operations on sums are very important, and familiarity with them makes the solution of many problems possible. We shall now discuss these four operations.</p>

  <p class="indenthangingA">a) <em>The distributive law</em>, for products of sums:</p>

  <div class="equation" id="ch01eq-lev2sec3-4"><img src="../Images/ch01/028equ01.png"></div>

  <p>To understand this law, consider for example the special case</p>

  <div class="image"><img src="../Images/ch01/e028_02.png"></div>

  <p>It is customary to drop the parentheses on the right-hand side of (<a href="../Text/ch01.html#ch01eq-lev2sec3-4">4</a>); a double summation such as <span class="middle"><img src="../Images/ch01/e028_01.png"></span> is written simply $∑_{R(i)}∑_{S(i)}a_{ij}$.</p>

  <p class="indenthangingA">b) <em>Change of variable:</em></p>

  <div class="equation" id="ch01eq-lev2sec3-5"><img src="../Images/ch01/028equ03.png"></div>

  <p>This equation represents two kinds of transformations. In the first case we are simply changing the name of the index variable from <em>i</em> to <em>j</em>. The second case is more interesting: Here $p(j)$ is a function of <em>j</em> that represents a <em>permutation</em> of the relevant values; more precisely, for each integer <em>i</em> satisfying the relation $R(i)$, there must be exactly one integer <em>j</em> satisfying the relation $p(j)=i$. This condition is always satisfied in the important cases $p(j)=c+j$ and $p(j)=c-j$, where <em>c</em> is an integer not depending on <em>j</em>, and these are the cases used most frequently in applications. For example,</p>

  <div class="equation" id="ch01eq-lev2sec3-6"><img src="../Images/ch01/028equ04.png"></div>

  <p>The reader should study this example carefully.</p>

  <p class="indent">The replacement of <em>j</em> by $p(j)$ cannot be done for all <em>infinite</em> sums. The operation is always valid if $p(j)=c ± j$, as above, but in other cases some care must be used. [For example, see T. M. Apostol, <em>Mathematical Analysis</em> (Reading, Mass.: Addison–Wesley, 1957), Chapter 12. A sufficient condition to <a id="page_29"></a>guarantee the validity of (<a href="../Text/ch01.html#ch01eq-lev2sec3-5">5</a>) for any permutation of the integers, $p(j)$, is that $∑_{R(j)}|a_{j}|$ exists.]</p>

  <p class="indenthangingA">c) <em>Interchanging order of summation:</em></p>

  <div class="equation" id="ch01eq-lev2sec3-7"><img src="../Images/ch01/029equ01.png"></div>

  <p>Let us consider a very simple special case of this equation:</p>

  <div class="image"><img src="../Images/ch01/e029_01.png"></div>

  <p>By Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-7">7</a>), these two are equal; this says no more than</p>

  <div class="equation" id="ch01eq-lev2sec3-8"><img src="../Images/ch01/029equ02.png"></div>

  <p>where we let $b_{i}=a_{i1}$ and $c_{i}=a_{i2}$.</p>

  <p class="indent">The operation of interchanging the order of summation is extremely useful, since it often happens that we know a simple form for $∑_{R(i)}a_{ij}$, but not for $∑_{S(j)}a_{ij}$. We frequently need to interchange the summation order also in a more general situation, where the relation $S(j)$ depends on <em>i</em> as well as <em>j</em>. In such a case we can denote the relation by “$S(i,j)$.” The interchange of summation can always be carried out, in theory at least, as follows:</p>

  <div class="equation" id="ch01eq-lev2sec3-9"><img src="../Images/ch01/029equ03.png"></div>

  <p>where $S'(j)$ is the relation “there is an integer <em>i</em> such that both $R(i)$ and $S(i,j)$ are true”; and $R'(i,j)$ is the relation “both $R(i)$ and $S(i,j)$ are true.” For example, if the summation is <span class="middle"><img src="../Images/ch01/e029_02.png"></span>, then $S'(j)$ is the relation “there is an integer <em>i</em> such that 1 ≤ <em>i</em> ≤ <em>n</em> and 1 ≤ <em>j</em> ≤ <em>i</em>,” that is, 1 ≤ <em>j</em> ≤ <em>n</em>; and $R'(i,j)$ is the relation “1 ≤ <em>i</em> ≤ <em>n</em> and 1 ≤ <em>j</em> ≤ <em>i</em>,” that is, <em>j</em> ≤ <em>i</em> ≤ <em>n</em>. Thus,</p>

  <div class="equation" id="ch01eq-lev2sec3-10"><img src="../Images/ch01/029equ04.png"></div>

  <p>[<em>Note:</em> As in case (b), the operation of interchanging order of summation is <em>not always valid for infinite series.</em> If the series is <em>absolutely convergent</em> — that is, if $∑_{R(i)}∑_{S(j)}|a_{ij}|$ exists — it can be shown that Eqs. (<a href="../Text/ch01.html#ch01eq-lev2sec3-7">7</a>) and (<a href="../Text/ch01.html#ch01eq-lev2sec3-9">9</a>) are valid. Also if <em>either one</em> of $R(i)$ or $S(j)$ specifies a <em>finite</em> sum in Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-7">7</a>), and if each infinite sum that appears is convergent, then the interchange is justified. In particular, Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-8">8</a>) is always true for convergent infinite sums.]</p>

  <p class="indenthangingA"><a id="page_30"></a>d) <em>Manipulating the domain.</em> If $R(j)$ and $S(j)$ are arbitrary relations, we have</p>

  <div class="equation" id="ch01eq-lev2sec3-11"><img src="../Images/ch01/030equ01.png"></div>

  <p>For example,</p>

  <div class="equation" id="ch01eq-lev2sec3-12"><img src="../Images/ch01/030equ02.png"></div>

  <p>assuming that 1 ≤ <em>m</em> ≤ <em>n</em>. In this case “$R(j)$ and $S(j)$” is simply “<em>j</em> = <em>m</em>,” so we have reduced the second sum to simply “$a_{m}$.” In most applications of Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-11">11</a>), either $R(j)$ and $S(j)$ are simultaneously satisfied for only one or two values of <em>j</em>, or else it is impossible to have both $R(j)$ and $S(j)$ true for the same <em>j</em>. In the latter case, the second sum on the right-hand side of Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-11">11</a>) simply disappears.</p>

  <p class="indent">Now that we have seen the four basic rules for manipulating sums, let’s study some further illustrations of how to apply these techniques.</p>

  <p><strong>Example 1.</strong></p>

  <div class="image"><img src="../Images/ch01/e030_01.png"></div>

  <p>The last step merely consists of simplifying the relations below the ∑’s.</p>

  <p><a id="ch01exam-1-2"></a><strong>Example 2.</strong> Let</p>

  <div class="image"><img src="../Images/ch01/e030_02.png"></div>

  <p>interchanging the names <em>i</em> and <em>j</em> and recognizing that $a_{j}a_{i}=a_{i}a_{j}$. If we denote the latter sum by $S_{2}$, we have</p>

  <div class="image"><a id="page_31"></a><img src="../Images/ch01/e030_03.png"></div>

  <p>Thus we have derived the important identity</p>

  <div class="equation" id="ch01eq-lev2sec3-13"><img src="../Images/ch01/031equ01.png"></div>

  <p><strong>Example 3</strong> (<em>The sum of a geometric progression</em>). Assume that <em>x</em> ≠ 1 and that <em>n</em> ≥ 0. Then</p>

  <div class="image"><img src="../Images/ch01/e031_01.png"></div>

  <p>Comparing the first relation with the last, we have</p>

  <div class="image"><img src="../Images/ch01/e031_02.png"></div>

  <p>hence we obtain the basic formula</p>

  <div class="equation" id="ch01eq-lev2sec3-14"><img src="../Images/ch01/031equ02.png"></div>

  <p><strong>Example 4</strong> (<em>The sum of an arithmetic progression</em>). Assume that <em>n</em> ≥ 0. Then</p>

  <div class="image"><a id="page_32"></a><img src="../Images/ch01/e031_03.png"></div>

  <p>since the first sum simply adds together $(n+1)$ terms that do not depend on <em>j</em>. Now by equating the first and last expressions and dividing by 2, we obtain</p>

  <div class="equation" id="ch01eq-lev2sec3-15"><img src="../Images/ch01/032equ01.png"></div>

  <p>This is <em>n</em> + 1 times <span class="middle"><img src="../Images/ch01/e032_01.png"></span>, which can be understood as the number of terms times the average of the first and last terms.</p>

  <p class="indent">Notice that we have derived the important equations (<a href="../Text/ch01.html#ch01eq-lev2sec3-13">13</a>), (<a href="../Text/ch01.html#ch01eq-lev2sec3-14">14</a>), and (<a href="../Text/ch01.html#ch01eq-lev2sec3-15">15</a>) purely by using simple manipulations of sums. Most textbooks would simply <em>state</em> those formulas, and prove them by <em>induction</em>. Induction is, of course, a perfectly valid procedure; but it does not give any insight into how on earth a person would ever have dreamed the formula up in the first place, except by some lucky guess. In the analysis of algorithms we are confronted with hundreds of sums that do not conform to any apparent pattern; by manipulating those sums, as above, we can often get the answer without the need for ingenious guesses.</p>

  <p class="indent">Many manipulations of sums and other formulas become considerably simpler if we adopt the following <em>bracket notation</em>:</p>

  <div class="equation" id="ch01eq-lev2sec3-16"><img src="../Images/ch01/032equ02.png"></div>

  <p>Then we can write, for example,</p>

  <div class="equation" id="ch01eq-lev2sec3-17"><img src="../Images/ch01/032equ03.png"></div>

  <p>where the sum on the right is over <em>all</em> integers <em>j</em>, because the terms of that infinite sum are zero when $R(j)$ is false. (We assume that $a_{j}$ is defined for all <em>j</em>.)</p>

  <p class="indent">With bracket notation we can derive rule (b) from rules (a) and (c) in an interesting way:</p>

  <div class="equation" id="page_33"></a><a id="ch01eq-lev2sec3-18"><img src="../Images/ch01/032equ04.png"></div>

  <p>The remaining sum on <em>j</em> is equal to 1 when $R(i)$ is true, if we assume that <em>p</em> is a permutation of the relevant values as required in (<a href="../Text/ch01.html#ch01eq-lev2sec3-5">5</a>); hence we are left with <span class="middle"><img src="../Images/ch01/e033_01a.png"></span>, which is <span class="middle"><img src="../Images/ch01/e033_01b.png"></span>. This proves (<a href="../Text/ch01.html#ch01eq-lev2sec3-5">5</a>). If <em>p</em> is <em>not</em> such a permutation, (<a href="../Text/ch01.html#ch01eq-lev2sec3-18">18</a>) tells us the true value of <span class="middle"><img src="../Images/ch01/e033_01c.png"></span>.</p>

  <p class="indent">The most famous special case of bracket notation is the so-called <em>Kronecker delta</em> symbol,</p>

  <div class="equation" id="ch01eq-lev2sec3-19"><img src="../Images/ch01/033equ01.png"></div>

  <p>introduced by Leopold Kronecker in 1868. More general notations such as (<a href="../Text/ch01.html#ch01eq-lev2sec3-16">16</a>) were introduced by K. E. Iverson in 1962; therefore (<a href="../Text/ch01.html#ch01eq-lev2sec3-16">16</a>) is often called <em>Iverson’s convention</em>. [See D. E. Knuth, <em>AMM</em> <strong>99</strong> (1992), 403–422.]</p>

  <p class="indent">There is a notation for products, analogous to our notation for sums: The symbols</p>

  <div class="equation" id="ch01eq-lev2sec3-20"><img src="../Images/ch01/033equ02.png"></div>

  <p>stand for the product of all $a_{j}$ for which the integer <em>j</em> satisfies $R(j)$. If no such integer <em>j</em> exists, the product is defined to have the value 1 (<em>not</em> 0).</p>

  <p class="indent">Operations (b), (c), and (d) are valid for the ∏-notation as well as for the ∑-notation, with suitable simple modifications. The exercises at the end of this section give a number of examples of product notation in use.</p>

  <p class="indent">We conclude this section by mentioning another notation for multiple summation that is often convenient: A single ∑-sign may be used with one or more relations in <em>several</em> index variables, meaning that the sum is taken over all combinations of variables that meet the conditions. For example,</p>

  <div class="image"><img src="../Images/ch01/e033_01.png"></div>

  <p>This notation gives no preference to one index of summation over any other, so it allows us to derive (<a href="../Text/ch01.html#ch01eq-lev2sec3-10">10</a>) in a new way:</p>

  <div class="image"><img src="../Images/ch01/e033_02.png"></div>

  <p>using the fact that $[1≤i≤n][1≤j≤i]=[1≤j≤i≤n]=[1≤j≤n][j≤i≤n]$. The more general equation (<a href="../Text/ch01.html#ch01eq-lev2sec3-9">9</a>) follows in a similar way from the identity</p>

  <div class="equation" id="ch01eq-lev2sec3-21"><img src="../Images/ch01/033equ03.png"></div>

  <p class="indent"><a id="page_34"></a>A further example that demonstrates the usefulness of summation with several indices is</p>

  <div class="equation" id="ch01eq-lev2sec3-22"><img src="../Images/ch01/034equ01.png"></div>

  <p>where <em>a</em> is an <em>n</em>-tuply subscripted variable; for example, if <em>n</em> = 5 this notation stands for</p>

  <p class="center">$a_{11111}+a_{21110}+a_{22100}+a_{31100}+a_{32000}+a_{41000}+a_{50000}$.</p>

  <p>(See the remarks on partitions of a number in <a href="../Text/ch01.html#ch01lev2sec1">Section 1.2.1</a>.)</p>

  <p class="ex-title">Exercises — First Set</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_1a" id="ch01ex_2_3_1">1</a>.</strong> [<em>10</em>] The text says that $a_{1}+a_{2}+···+a_{0}=0$. What, then, is $a_{2}+···+a_{0}$?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_3_2a" id="ch01ex_2_3_2">2</a>.</strong> [<em>01</em>] What does the notation $∑_{1≤j≤n}a_{j}$ mean, if $n=3.14$?</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_3a" id="ch01ex_2_3_3">3</a>.</strong> [<em>13</em>] Without using the ∑-notation, write out the equivalent of</p>

  <div class="image"><img src="../Images/ch01/e034_01.png"></div>

  <p class="exercisesp">and also the equivalent of</p>

  <div class="image"><img src="../Images/ch01/e034_02.png"></div>

  <p class="exercisesp">Explain why the two results are different, in spite of rule (b).</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_3_4a" id="ch01ex_2_3_4">4</a>.</strong> [<em>10</em>] Without using the ∑-notation, write out the equivalent of each side of Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-10">10</a>) as a sum of sums for the case <em>n</em> = 3.</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_5a" id="ch01ex_2_3_5">5</a>.</strong> [<em>HM20</em>] Prove that rule (a) is valid for arbitrary infinite series, provided that the series converge.</p>

  <p class="exercises"><strong>6.</strong> [<em>HM20</em>] Prove that rule (d) is valid for an arbitrary infinite series, provided that any three of the four sums exist.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_3_7a" id="ch01ex_2_3_7">7</a>.</strong> [<em>HM23</em>] Given that c is an integer, show that <span class="middle"><img src="../Images/ch01/e034_01a.png"></span> even if both series are infinite.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_3_8a" id="ch01ex_2_3_8">8</a>.</strong> [<em>HM25</em>] Find an example of infinite series in which Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-7">7</a>) is false.</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_9a" id="ch01ex_2_3_9">9</a>.</strong> [<em>05</em>] Is the derivation of Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-14">14</a>) valid even if <em>n</em> = −1?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_10a" id="ch01ex_2_3_10">10</a>.</strong> [<em>05</em>] Is the derivation of Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-14">14</a>) valid even if <em>n</em> = −2?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_11a" id="ch01ex_2_3_11">11</a>.</strong> [<em>03</em>] What should the right-hand side of Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-14">14</a>) be if <em>x</em> = 1?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_12a" id="ch01ex_2_3_12">12</a>.</strong> [<em>10</em>] What is <span class="middle"><img src="../Images/ch01/e034_03.png"></span></p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_13a" id="ch01ex_2_3_13">13</a>.</strong> [<em>10</em>] Using Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-15">15</a>) and assuming that <em>m</em> ≤ <em>n</em>, evaluate <span class="middle"><img src="../Images/ch01/e034_04.png"></span>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_14a" id="ch01ex_2_3_14">14</a>.</strong> [<em>11</em>] Using the result of the previous exercise, evaluate <span class="middle"><img src="../Images/ch01/e034_05.png"></span> <em>jk</em>.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_15a" id="ch01ex_2_3_15">15</a>.</strong> [<em>M22</em>] Compute the sum $1×2+2×2^{2}+3×2^{3}+···+n×2^{n}$ for small values of <em>n</em>. Do you see the pattern developing in these numbers? If not, discover it by manipulations similar to those leading up to Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-14">14</a>).</p>

  <p class="exercises1"><a id="page_35"></a><strong><a href="../Text/app01.html#ch01ex_2_3_16a" id="ch01ex_2_3_16">16</a>.</strong> [<em>M22</em>] Prove that</p>

  <div class="image"><img src="../Images/ch01/e035_01.png"></div>

  <p class="exercisesp">if <em>x</em> ≠ 1, without using mathematical induction.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_17a" id="ch01ex_2_3_17">17</a>.</strong> [<em>M00</em>] Let <em>S</em> be a set of integers. What is <span class="middle"><img src="../Images/ch01/e035_01a.png"></span></p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_18a" id="ch01ex_2_3_18">18</a>.</strong> [<em>M20</em>] Show how to interchange the order of summation as in Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-9">9</a>) given that $R(i)$ is the relation “<em>n</em> is a multiple of <em>i</em>” and $S(i,j)$ is the relation “1 ≤ <em>j</em> &lt; <em>i</em>.”</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_19a" id="ch01ex_2_3_19">19</a>.</strong> [<em>20</em>] What is <span class="middle"><img src="../Images/ch01/e035_02.png"></span></p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_20a" id="ch01ex_2_3_20">20</a>.</strong> [<em>25</em>] Dr. I. J. Matrix has observed a remarkable sequence of formulas: 9 × 1 + 2 = 11, 9 × 12 + 3 = 111, 9 × 123 + 4 = 1111, 9 × 1234 + 5 = 11111.</p>

  <p class="indenthangingA">a) Write the good doctor’s great discovery in terms of the ∑-notation.</p>

  <p class="indenthangingA">b) Your answer to part (a) undoubtedly involves the number 10 as base of the decimal system; generalize this formula so that you get a formula that will perhaps work in any base <em>b</em>.</p>

  <p class="indenthangingA">c) Prove your formula from part (b) by using formulas derived in the text or in <a href="../Text/ch01.html#ch01ex_2_3_16">exercise 16</a> above.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_21a" id="ch01ex_2_3_21">21</a>.</strong> [<em>M25</em>] Derive rule (d) from (<a href="../Text/ch01.html#ch01eq-lev2sec3-8">8</a>) and (<a href="../Text/ch01.html#ch01eq-lev2sec3-17">17</a>).</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_22a" id="ch01ex_2_3_22">22</a>.</strong> [<em>20</em>] State the appropriate analogs of Eqs. (<a href="../Text/ch01.html#ch01eq-lev2sec3-5">5</a>), (<a href="../Text/ch01.html#ch01eq-lev2sec3-7">7</a>), (<a href="../Text/ch01.html#ch01eq-lev2sec3-8">8</a>), and (<a href="../Text/ch01.html#ch01eq-lev2sec3-11">11</a>) for <em>products</em> instead of sums.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_23a" id="ch01ex_2_3_23">23</a>.</strong> [<em>10</em>] Explain why it is a good idea to define $∑_{R(j)}a_{j}$ and $∏_{R(j)}a_{j}$ as zero and one, respectively, when no integers satisfy $R(j)$.</p>

  <p class="exercises1"><strong>24.</strong> [<em>20</em>] Suppose that $R(j)$ is true for only finitely many <em>j</em>. By induction on the number of integers satisfying $R(j)$, prove that <span class="middle"><img src="../Images/ch01/e035_02a.png"></span>, assuming that all $a_{j}\gt0$.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_25a" id="ch01ex_2_3_25">25</a>.</strong> [<em>15</em>] Consider the following derivation; is anything amiss?</p>

  <div class="image"><img src="../Images/ch01/e035_03.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_26a" id="ch01ex_2_3_26">26</a>.</strong> [<em>25</em>] Show that <span class="middle"><img src="../Images/ch01/e035_04.png"></span> may be expressed in terms of <span class="middle"><img src="../Images/ch01/e035_05.png"></span> by manipulating the ∏-notation as stated in <a href="../Text/ch01.html#ch01ex_2_3_22">exercise 22</a>.</p>

  <p class="exercises1"><strong>27.</strong> [<em>M20</em>] Generalize the result of exercise <a href="../Text/ch01.html#ch01lev2sec1">1.2.1</a>–<a href="../Text/ch01.html#ch01ex_2_2_9">9</a> by proving that</p>

  <div class="image"><img src="../Images/ch01/e035_06.png"></div>

  <p class="exercisesp">assuming that $0 \lt a_{j}\lt 1$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_28a" id="ch01ex_2_3_28">28</a>.</strong> [<em>M22</em>] Find a simple formula for <span class="middle"><img src="../Images/ch01/e035_07.png"></span>.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_29a" id="ch01ex_2_3_29">29</a>.</strong> [<em>M30</em>] (a) Express <span class="middle"><img src="../Images/ch01/e035_08.png"></span> in terms of the multiple-sum notation explained at the end of the section. (b) Express the same sum in terms of <span class="middle"><img src="../Images/ch01/e035_09.png"></span>, <span class="middle"><img src="../Images/ch01/e035_10.png"></span>, and <span class="middle"><img src="../Images/ch01/e035_11.png"></span> [see Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec3-13">13</a>)].</p>

  <p class="exercises3"><a id="page_36"></a><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_30a" id="ch01ex_2_3_30">30</a>.</strong> [<em>M23</em>] (J. Binet, 1812.) Without using induction, prove the identity</p>

  <div class="image"><img src="../Images/ch01/e036_01.png"></div>

  <p class="exercisesp">[An important special case arises when $w_{1},...,w_{n}$, $z_{1},...,z_{n}$ are arbitrary complex numbers and we set $a_{j}=w_{j}$, <span class="middle"><img src="../Images/ch01/e036_02.png"></span>, <span class="middle"><img src="../Images/ch01/e036_03.png"></span>, $y_{j}=z_{j}$:</p>

  <div class="image"><img src="../Images/ch01/e036_04.png"></div>

  <p class="exercisesp">The terms <span class="middle"><img src="../Images/ch01/e036_05.png"></span> are nonnegative, so the famous <em>Cauchy–Schwarz inequality</em></p>

  <div class="image"><img src="../Images/ch01/e036_06.png"></div>

  <p class="exercisesp">is a consequence of Binet’s formula.]</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_31a" id="ch01ex_2_3_31">31</a>.</strong> [<em>M20</em>] Use Binet’s formula to express the sum <span class="middle"><img src="../Images/ch01/e036_06a.png"></span> in terms of <span class="middle"><img src="../Images/ch01/e036_07.png"></span>, <span class="middle"><img src="../Images/ch01/e036_08.png"></span>, and <span class="middle"><img src="../Images/ch01/e036_09.png"></span>.</p>

  <p class="exercises1"><strong>32.</strong> [<em>M20</em>] Prove that</p>

  <div class="image"><img src="../Images/ch01/e036_10.png"></div>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_33a" id="ch01ex_2_3_33">33</a>.</strong> [<em>M30</em>] One evening Dr. Matrix discovered some formulas that might even be classed as more remarkable than those of <a href="../Text/ch01.html#ch01ex_2_3_20">exercise 20</a>:</p>

  <div class="image"><img src="../Images/ch01/e036_11.png"></div>

  <p class="exercisesp">Prove that these formulas are a special case of a general law; let $x_{1},x_{2},...,x_{n}$ be distinct numbers, and show that</p>

  <div class="image"><img src="../Images/ch01/e036_12.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_34a" id="ch01ex_2_3_34">34</a>.</strong> [<em>M25</em>] Prove that</p>

  <div class="image"><a id="page_37"></a><img src="../Images/ch01/e036_13.png"></div>

  <p class="exercisesp">provided that 1 ≤ <em>m</em> ≤ <em>n</em> and <em>x</em> is arbitrary. For example, if <em>n</em> = 4 and <em>m</em> = 2, then</p>

  <div class="image"><img src="../Images/ch01/e037_01.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_35a" id="ch01ex_2_3_35">35</a>.</strong> [<em>HM20</em>] The notation $\sup_{R(j)}a_{j}$ is used to denote the least upper bound of the elements $a_{j}$, in a manner exactly analogous to the ∑- and ∏-notations. (When $R(j)$ is satisfied for only finitely many <em>j</em>, the notation $\max_{R(j)}a_{j}$ is often used to denote the same quantity.) Show how rules (a), (b), (c), and (d) can be adapted for manipulation of <em>this</em> notation. In particular discuss the following analog of rule (a):</p>

  <div class="image"><img src="../Images/ch01/e037_01a.png"></div>

  <p class="exercisesp">and give a suitable definition for the notation when $R(j)$ is satisfied for <em>no</em> <em>j</em>.</p>

  <p class="ex-title">Exercises — Second Set</p>

  <p><em>Determinants and matrices</em>. The following interesting problems are for the reader who has experienced at least an introduction to determinants and elementary matrix theory. A determinant may be evaluated by astutely combining the operations of: (a) factoring a quantity out of a row or column; (b) adding a multiple of one row (or column) to another row (or column); (c) expanding by cofactors. The simplest and most often used version of operation (c) is to simply delete the entire first row and column, provided that the element in the upper left corner is +1 and the remaining elements in either the entire first row or the entire first column are zero; then evaluate the resulting smaller determinant. In general, the cofactor of an element $a_{ij}$ in an $n×n$ determinant is $(-1)^{i+j}$ times the $(n-1)×(n-1)$ determinant obtained by deleting the row and column in which $a_{ij}$ appeared. The value of a determinant is equal to $∑ a_{ij}·cofactor(a_{ij})$ summed with either <em>i</em> or <em>j</em> held constant and with the other subscript varying from 1 to <em>n</em>.</p>

  <p class="indent">If $(b_{ij})$ is the <em>inverse</em> of matrix $(a_{ij})$, then $b_{ij}$ equals the cofactor of $a_{ji}$ (<em>not</em> $a_{ij}$), divided by the determinant of the whole matrix.</p>

  <p class="indent">The following types of matrices are of special importance:</p>

  <div class="image"><img src="../Images/ch01/e037_02.png"></div>

  <p class="exercises1"><a id="page_38"></a><strong><a href="../Text/app01.html#ch01ex_2_3_36a" id="ch01ex_2_3_36">36</a>.</strong> [<em>M23</em>] Show that the determinant of the combinatorial matrix is $x^{n−1}(x+ny)$.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_37a" id="ch01ex_2_3_37">37</a>.</strong> [<em>M24</em>] Show that the determinant of Vandermonde’s matrix is</p>

  <div class="image"><img src="../Images/ch01/e038_01.png"></div>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_38a" id="ch01ex_2_3_38">38</a>.</strong> [<em>M25</em>] Show that the determinant of Cauchy’s matrix is</p>

  <div class="image"><img src="../Images/ch01/e038_02.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_39a" id="ch01ex_2_3_39">39</a>.</strong> [<em>M23</em>] Show that the inverse of a combinatorial matrix is a combinatorial matrix with the entries $b_{ij}=(-y+δ_{ij}(x+ny))/x(x+ny)$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_40a" id="ch01ex_2_3_40">40</a>.</strong> [<em>M24</em>] Show that the inverse of Vandermonde’s matrix is given by</p>

  <div class="image"><img src="../Images/ch01/e038_03.png"></div>

  <p class="exercisesp">Don’t be dismayed by the complicated sum in the numerator — it is just the coefficient of $x^{j-1}$ in the polynomial $(x_{1}-x)...(x_{n}-x)/(x_{i}-x)$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_41a" id="ch01ex_2_3_41">41</a>.</strong> [<em>M26</em>] Show that the inverse of Cauchy’s matrix is given by</p>

  <div class="image"><img src="../Images/ch01/e038_04.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_42a" id="ch01ex_2_3_42">42</a>.</strong> [<em>M18</em>] What is the sum of all $n^{2}$ elements in the inverse of the combinatorial matrix?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_43a" id="ch01ex_2_3_43">43</a>.</strong> [<em>M24</em>] What is the sum of all $n^{2}$ elements in the inverse of Vandermonde’s matrix? [<em>Hint:</em> Use <a href="../Text/ch01.html#ch01ex_2_3_33">exercise 33</a>.]</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_44a" id="ch01ex_2_3_44">44</a>.</strong> [<em>M26</em>] What is the sum of all $n^{2}$ elements in the inverse of Cauchy’s matrix?</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_45a" id="ch01ex_2_3_45">45</a>.</strong> [<em>M25</em>] A <em>Hilbert matrix</em>, sometimes called an $n×n$ segment of <em>the</em> (infinite) Hilbert matrix, is a matrix for which $a_{ij}=1/(i+j-1)$. Show that this is a special case of Cauchy’s matrix, find its inverse, show that each element of the inverse is an integer, and show that the sum of all elements of the inverse is $n^{2}$. [<em>Note:</em> Hilbert matrices have often been used to test various matrix manipulation algorithms, because they are numerically unstable, and they have known inverses. However, it is a mistake to compare the <em>known</em> inverse, given in this exercise, to the <em>computed</em> inverse of a Hilbert matrix, since the matrix to be inverted must be expressed in rounded numbers beforehand; the inverse of an approximate Hilbert matrix will be somewhat different from the inverse of an exact one, due to the instability present. Since the elements of the inverse are integers, and since the inverse matrix is just as unstable as the original, the inverse can be specified exactly, and one could try to invert the inverse. The integers that appear in the inverse are, however, quite large.] The solution to this problem requires an elementary knowledge of factorials and binomial coefficients, which are discussed in <a href="../Text/ch01.html#ch01lev2sec5">Sections 1.2.5</a> and <a href="../Text/ch01a.html#ch01lev2sec6">1.2.6</a>.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_3_46a" id="ch01ex_2_3_46">46</a>.</strong> [<em>M30</em>] Let <em>A</em> be an $m×n$ matrix, and let <em>B</em> be an $n×m$ matrix. Given that $1≤j_{1},j_{2},...,j_{m}≤n$, let $A_{j_{1}j_{2}...j_{m}}$ denote the $m×m$ matrix consisting of columns <a id="page_39"></a>$j_{1},...,j_{m}$ of <em>A</em>, and let $B_{j_{1}j_{2}...j_{m}}$ denote the $m×m$ matrix consisting of rows $j_{1},...,j_{m}$ of <em>B</em>. Prove the <em>Binet–Cauchy identity</em></p>

  <div class="image"><img src="../Images/ch01/e039_01.png"></div>

  <p class="exercisesp">(Note the special cases: (i) <em>m</em> = <em>n</em>, (ii) <em>m</em> = 1, (iii) $B=A^{T}$, (iv) <em>m</em> &gt; <em>n</em>, (v) <em>m</em> = 2.)</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_3_47a" id="ch01ex_2_3_47">47</a>.</strong> [<em>M27</em>] (C. Krattenthaler.) Prove that</p>

  <div class="image"><img src="../Images/ch01/e039_02.png"></div>

  <p class="exercisesp">and generalize this equation to an identity for an $n×n$ determinant in $3n-2$ variables $x_{1},...,x_{n}$, $p_{1},...,p_{n−1}$, $q_{2},...,q_{n}$. Compare your formula to the result of <a href="../Text/ch01.html#ch01ex_2_3_38">exercise 38</a>.</p>

  <div class="heading">
    <h4 id="ch01lev2sec4">1.2.4. Integer Functions and Elementary Number Theory</h4>

    <p>If <em>x</em> is any real number, we write</p>
  </div>

  <p class="uln-indent">$\lfloor{x}\rfloor=$ the greatest integer less than or equal to <em>x</em> (the <em>floor</em> of <em>x</em>);</p>

  <p class="uln-indent">$\lceil{x}\rceil=$ the least integer greater than or equal to <em>x</em> (the <em>ceiling</em> of <em>x</em>).</p>

  <p>The notation [<em>x</em>] was often used before 1970 for one or the other of these functions, usually the former; but the notations above, introduced by K. E. Iverson in the 1960s, are more useful, because $\lfloor{x}\rfloor$ and $\lceil{x}\rceil$ occur about equally often in practice. The function $\lfloor{x}\rfloor$ is sometimes called the <em>entier</em> function, from the French word for “integer.”.</p>

  <p class="indent">The following formulas and examples are easily verified:</p>

  <div class="image"><img src="../Images/ch01/e039_03.png"></div>

  <p>Exercises at the end of this section list other important formulas involving the floor and ceiling operations.</p>

  <p class="indent">If <em>x</em> and <em>y</em> are any real numbers, we define the following binary operation:</p>

  <div class="equation" id="ch01eq-lev2sec4-1"><img src="../Images/ch01/039equ01.png"></div>

  <p>From this definition we can see that, when <em>y</em> ≠ 0,</p>

  <div class="equation" id="ch01eq-lev2sec4-2"><img src="../Images/ch01/039equ02.png"></div>

  <p>Consequently</p>

  <p class="indenthangingA">a) if <em>y</em> &gt; 0, then $0≤x\bmod y\lt y$;</p>

  <p class="indenthangingA">b) if <em>y</em> &lt; 0, then $0≥x\bmod y\gt y$;</p>

  <p class="indenthangingA"><a id="page_40"></a>c) the quantity $x-(x\bmod y)$ is an integral multiple of <em>y</em>.</p>

  <p>We call $x\bmod y$ the <em>remainder</em> when <em>x</em> is divided by <em>y</em>; similarly, we call $\lfloor{x/y}\rfloor$ the <em>quotient</em>.</p>

  <p class="indent">When <em>x</em> and <em>y</em> are integers, “mod” is therefore a familiar operation:</p>

  <div class="equation" id="ch01eq-lev2sec4-3"><img src="../Images/ch01/040equ01.png"></div>

  <p>We have <em>x</em> mod <em>y</em> = 0 if and only if <em>x</em> is a multiple of <em>y</em>, that is, if and only if <em>x</em> is divisible by <em>y</em>. The notation $y\minus x$, read “<em>y</em> divides <em>x</em>,” means that <em>y</em> is a positive integer and $x\bmod y=0$.</p>

  <p class="indent">The “mod” operation is useful also when <em>x</em> and <em>y</em> take arbitrary real values. For example, with trigonometric functions we can write</p>

  <p class="center">$\tan x=\tan(x\bmod π)$.</p>

  <p class="indent">The quantity $x\bmod 1$ is the <em>fractional part</em> of <em>x</em>; we have, by Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec4-1">1</a>),</p>

  <div class="equation" id="ch01eq-lev2sec4-4"><img src="../Images/ch01/040equ02.png"></div>

  <p class="indent">Writers on number theory often use the abbreviation “mod” in a different but closely related sense. We will use the following form to express the numbertheoretical concept of <em>congruence</em>: The statement</p>

  <div class="equation" id="ch01eq-lev2sec4-5"><img src="../Images/ch01/040equ03.png"></div>

  <p>means that $x\bmod z=y\bmod z$; it is the same as saying that $x-y$ is an integral multiple of <em>z</em>. Expression (<a href="../Text/ch01.html#ch01eq-lev2sec4-5">5</a>) is read, “<em>x</em> is congruent to <em>y</em> modulo <em>z</em>.”</p>

  <p class="indent">Let’s turn now to the basic elementary properties of congruences that will be used in the number-theoretical arguments of this book. All variables in the following formulas are assumed to be integers. Two integers <em>x</em> and <em>y</em> are said to be <em>relatively prime</em> if they have no common factor, that is, if their greatest common divisor is 1; in such a case we write $x⊥y$. The concept of relatively prime integers is a familiar one, since it is customary to say that a fraction is in “lowest terms” when the numerator is relatively prime to the denominator.</p>

  <p><a id="law_a"></a><strong>Law A.</strong> If $a≡b$ and $x≡y$, then $a ± x≡b ± y$ and $ax≡\md[by]{m}$.</p>

  <p><a id="law_b"></a><strong>Law B.</strong> If $ax≡by$ and $a≡b$, and if $a⊥m$, then $x≡\md[y]{m}$.</p>

  <p><a id="law_c"></a><strong>Law C.</strong> $a≡\md[b]{m}$ if and only if $an≡\md[bn]{mn}$, when <em>n</em> ≠ 0.</p>

  <p><a id="law_d"></a><strong>Law D.</strong> If $r⊥s$, then $a≡\md[b]{rs}$ if and only if $a≡\md[b]{r}$ and $a≡\md[b]{s}$.</p>

  <p class="indent"><a href="../Text/ch01.html#law_a">Law A</a> states that we can do addition, subtraction, and multiplication modulo <em>m</em> just as we do ordinary addition, subtraction, and multiplication. <a href="../Text/ch01.html#law_b">Law B</a> considers the operation of division and shows that, when the divisor is relatively prime to the modulus, we can also divide out common factors. <a href="../Text/ch01.html#law_c">Laws C</a> and <a href="../Text/ch01.html#law_d">D</a> consider what happens when the modulus is changed. These laws are proved in the exercises below.</p>

  <p class="indent">The following important theorem is a consequence of Laws A and B.</p>

  <p><a id="page_41"></a><a id="ch01the01_F"></a><strong>Theorem F</strong> <em>(Fermat’s theorem</em>, 1640). <em>If p is a prime number, then $a^{p}≡\md[a]{p}$ for all integers a.</em></p>

  <p><em>Proof</em>. If <em>a</em> is a multiple of <em>p</em>, obviously $a^{p}≡0≡\md[a]{p}$. So we need only consider the case $a\bmod p≠0$. Since <em>p</em> is a prime number, this means that $a⊥p$. Consider the numbers</p>

  <div class="equation" id="ch01eq-lev2sec4-6"><img src="../Images/ch01/041equ01.png"></div>

  <p>These <em>p</em> numbers are all <em>distinct</em>, for if $ax\bmod p=ay\bmod p$, then by definition (<a href="../Text/ch01.html#ch01eq-lev2sec4-5">5</a>) $ax≡\md[ay]{p}$; hence by <a href="../Text/ch01.html#law_b">Law B</a>, $x≡\md[y]{p}$.</p>

  <p class="indent">Since (<a href="../Text/ch01.html#ch01eq-lev2sec4-6">6</a>) gives <em>p</em> distinct numbers, all nonnegative and less than <em>p</em>, we see that the first number is zero and the rest are the integers $1,2,...,p-1$ in some order. Therefore by <a href="../Text/ch01.html#law_a">Law A</a>,</p>

  <div class="equation" id="ch01eq-lev2sec4-7"><img src="../Images/ch01/041equ02.png"></div>

  <p>Multiplying each side of this congruence by <em>a</em>, we obtain</p>

  <div class="equation" id="ch01eq-lev2sec4-8"><img src="../Images/ch01/041equ03.png"></div>

  <p>and this proves the theorem, since each of the factors 1, 2<em>, ..., p</em> − 1 is relatively prime to <em>p</em> and can be canceled by <a href="../Text/ch01.html#law_b">Law B</a>. <span class="middle"><img src="../Images/ch01/box.png"></span></p>

  <p class="ex-title">Exercises</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_4_1a" id="ch01ex_2_4_1">1</a>.</strong> [<em>00</em>] What are $\lfloor{1.1}\rfloor$, $\lfloor{−1.1}\rfloor$, $\lceil{−1.1}\rceil$, $\lfloor{0.99999}\rfloor$, and $\lfloor{\lg 35}\rfloor$?</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_4_2a" id="ch01ex_2_4_2">2</a>.</strong> [<em>01</em>] What is $\lceil{\lfloor{x}\rfloor}\rceil$?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_4_3a" id="ch01ex_2_4_3">3</a>.</strong> [<em>M10</em>] Let <em>n</em> be an integer, and let <em>x</em> be a real number. Prove that</p>

  <p class="indenthangingA">a) $\lfloor{x}\rfloor\lt n$ if and only if <em>x</em> &lt; n;

  <p class="indenthangingA">b) $n≤\lfloor{x}\rfloor$ if and only if <em>n</em> ≤ <em>x</em>;</p>

  <p class="indenthangingA">c) $\lceil{x}\rceil≤n$ if and only if <em>x</em> ≤ n;

  <p class="indenthangingA">d) $n\lt\lceil{x}\rceil$ if and only if <em>n</em> &lt; <em>x</em>;</p>

  <p class="indenthangingA">e) $\lfloor{x}\rfloor=n$ if and only if $x-1\lt n≤x$, and if and only if $n≤x\lt n+1$;</p>

  <p class="indenthangingA">f) $\lceil{x}\rceil=n$ if and only if $x≤n\lt x+1$, and if and only if $n-1\lt x≤n$.</p>

  <p class="exercisesp">[<em>These formulas are the most important tools for proving facts about $\lfloor{x}\rfloor$ and $\lceil{x}\rceil$</em>.]</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_4_4a" id="ch01ex_2_4_4">4</a>.</strong> [<em>M10</em>] Using the previous exercise, prove that $\lfloor{−x}\rfloor=-\lceil{x}\rceil$.</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_4_5a" id="ch01ex_2_4_5">5</a>.</strong> [<em>16</em>] Given that <em>x</em> is a positive real number, state a simple formula that expresses <em>x</em> <em>rounded to the nearest integer</em>. The desired rounding rule is to produce $\lfloor{x}\rfloor$ when $x\bmod <span class="middle"><img src="../Images/ch01/e041_01.png"></span>$, and to produce $\lceil{x}\rceil$ when $x\bmod <span class="middle"><img src="../Images/ch01/e041_02.png"></span>$. Your answer should be a single formula that covers both cases. Discuss the rounding that would be obtained by your formula when <em>x</em> is negative.</p>

  <p class="exercises2"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_4_6a" id="ch01ex_2_4_6">6</a>.</strong> [<em>20</em>] Which of the following equations are true for all positive real numbers <em>x</em>?</p>

  <div class="image"><img src="../Images/ch01/e041_03.png"></div>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_4_7a" id="ch01ex_2_4_7">7</a>.</strong> [<em>M15</em>] Show that $\lfloor{x}\rfloor+\lfloor{y}\rfloor≤\lfloor{x+y}\rfloor$ and that equality holds if and only if $x\bmod 1 + y\bmod 1 \lt 1$. Does a similar formula hold for ceilings?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_4_8a" id="ch01ex_2_4_8">8</a>.</strong> [<em>00</em>] What are $100\bmod 3$, $100\bmod 7$, $-100\bmod 7$, $-100\bmod 0$?</p>

  <p class="exercises"><strong><a href="../Text/app01.html#ch01ex_2_4_9a" id="ch01ex_2_4_9">9</a>.</strong> [<em>05</em>] What are $5\bmod -3$, $18\bmod -3$, $-2\bmod -3$?</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_4_10a" id="ch01ex_2_4_10">10</a>.</strong> [<em>10</em>] What are $1.1\bmod 1$, $0.11\bmod .1$, $0.11\bmod -.1$?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_11a" id="ch01ex_2_4_11">11</a>.</strong> [<em>00</em>] What does “$x≡\md[y]{0}$” mean by our conventions?</p>

  <p class="exercises1"><a id="page_42"></a><strong><a href="../Text/app01.html#ch01ex_2_4_12a" id="ch01ex_2_4_12">12</a>.</strong> [<em>00</em>] What integers are relatively prime to 1?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_13a" id="ch01ex_2_4_13">13</a>.</strong> [<em>M00</em>] By convention, we say that the greatest common divisor of 0 and <em>n</em> is $|n|$. What integers are relatively prime to 0?</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_4_14a" id="ch01ex_2_4_14">14</a>.</strong> [<em>12</em>] If $x\bmod 3=2$ and $x\bmod 5=3$, what is $x\bmod 15$?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_15a" id="ch01ex_2_4_15">15</a>.</strong> [<em>10</em>] Prove that $z(x\bmod y)=(zx)\bmod (zy)$. [<a href="../Text/ch01.html#law_c">Law C</a> is an immediate consequence of this distributive law.]</p>

  <p class="exercises1"><strong>16.</strong> [<em>M10</em>] Assume that <em>y</em> &gt; 0. Show that if $(x-z)/y$ is an integer and if 0 ≤ <em>z</em> &lt; <em>y</em>, then $z=x\bmod y$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_17a" id="ch01ex_2_4_17">17</a>.</strong> [<em>M15</em>] Prove <a href="../Text/ch01.html#law_a">Law A</a> directly from the definition of congruence, and also prove half of <a href="../Text/ch01.html#law_d">Law D</a>: If $a≡\md[b]{rs}$, then $a≡\md[b]{r}$ and $a≡\md[b]{s}$. (Here <em>r</em> and <em>s</em> are arbitrary integers.)</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_18a" id="ch01ex_2_4_18">18</a>.</strong> [<em>M15</em>] Using <a href="../Text/ch01.html#law_b">Law B</a>, prove the other half of <a href="../Text/ch01.html#law_d">Law D</a>: If $a≡\md[b]{r}$ and $a≡\md[b]{s}$, then $a≡\md[b]{rs}$, provided that $r⊥s$.</p>

  <p class="exercises3"><a id="ch01ex_2_4_19"></a><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong>19.</strong> [<em>M10</em>] (<em>Law of inverses</em>.) If $n⊥m$, there is an integer <em>n</em>′ such that $nn'≡\md[ 1]{m}$. Prove this, using the extension of Euclid’s algorithm (<a href="../Text/ch01.html#ch01alg-lev2sec1-E">Algorithm 1.2.1E</a>).</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_20a" id="ch01ex_2_4_20">20</a>.</strong> [<em>M15</em>] Use the law of inverses and <a href="../Text/ch01.html#law_a">Law A</a> to prove <a href="../Text/ch01.html#law_b">Law B</a>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_21a" id="ch01ex_2_4_21">21</a>.</strong> [<em>M22</em>] (<em>Fundamental theorem of arithmetic</em>.) Use <a href="../Text/ch01.html#law_b">Law B</a> and exercise <a href="../Text/ch01.html#ch01lev2sec1">1.2.1</a>–<a href="../Text/ch01.html#ch01ex_2_1_5">5</a> to prove that every integer <em>n</em> &gt; 1 has a <em>unique</em> representation as a product of primes (except for the order of the factors). In other words, show that there is exactly one way to write $n=p_{1}p_{2}...p_{k}$, where each $p_{j}$ is prime and $p_{1}≤p_{2}≤···≤p_{k}$.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_4_22a" id="ch01ex_2_4_22">22</a>.</strong> [<em>M10</em>] Give an example to show that <a href="../Text/ch01.html#law_b">Law B</a> is not always true if <em>a</em> is not relatively prime to <em>m</em>.</p>

  <p class="exercises1"><strong>23.</strong> [<em>M10</em>] Give an example to show that <a href="../Text/ch01.html#law_d">Law D</a> is not always true if <em>r</em> is not relatively prime to <em>s</em>.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_4_24a" id="ch01ex_2_4_24">24</a>.</strong> [<em>M20</em>] To what extent can Laws A, B, C, and D be generalized to apply to arbitrary real numbers instead of integers?</p>

  <p class="exercises1"><strong>25.</strong> [<em>M02</em>] Show that, according to <a href="../Text/ch01.html#ch01the01_F">Theorem F</a>, $a^{p-1}\bmod p=$ [<em>a</em> is not a multiple of <em>p</em>], whenever <em>p</em> is a prime number.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_26a" id="ch01ex_2_4_26">26</a>.</strong> [<em>M15</em>] Let <em>p</em> be an odd prime number, let <em>a</em> be any integer, and let $b=a^{(p-1)/2}$. Show that $b\bmod p$ is either 0 or 1 or $p-1$. [<em>Hint:</em> Consider $(b+1)(b-1)$.]</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_27a" id="ch01ex_2_4_27">27</a>.</strong> [<em>M15</em>] Given that <em>n</em> is a positive integer, let $φ(n)$ be the number of values among $\{0,1,...,n-1\}$ that are relatively prime to <em>n</em>. Thus $φ(1)=1$, $φ(2)=1$, $φ(3)=2$, $φ(4)=2$, etc. Show that $φ(p)=p-1$ if <em>p</em> is a prime number; and evaluate $φ(p^{e})$, when <em>e</em> is a positive integer.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_4_28a" id="ch01ex_2_4_28">28</a>.</strong> [<em>M25</em>] Show that the method used to prove <a href="../Text/ch01.html#ch01the01_F">Theorem F</a> can be used to prove the following extension, called <em>Euler’s theorem</em>: $a^{φ(m)}≡\md[1]{m}$, for <em>any</em> positive integer <em>m</em>, when $a⊥m$. (In particular, the number <em>n</em>′ in <a href="../Text/ch01.html#ch01ex_2_2_19">exercise 19</a> may be taken to be $n^{φ(m)-1}\bmod m$.)</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_29a" id="ch01ex_2_4_29">29</a>.</strong> [<em>M22</em>] A function $f(n)$ of positive integers <em>n</em> is called <em>multiplicative</em> if $f(rs)=f(r)f(s)$ whenever $r⊥s$. Show that each of the following functions is multiplicative: (a) $f(n)=n^{c}$, where <em>c</em> is any constant; (b) $f(n)=$ [<em>n</em> is not divisible by $k^{2}$ for any integer <em>k</em> &gt; 1]; (c) $f(n)=c^{k}$, where <em>k</em> is the number of distinct primes that divide <em>n</em>; (d) the product of any two multiplicative functions.</p>

  <p class="exercises1"><a id="page_43"></a><strong><a href="../Text/app01.html#ch01ex_2_4_30a" id="ch01ex_2_4_30">30</a>.</strong> [<em>M30</em>] Prove that the function $φ(n)$ of <a href="../Text/ch01.html#ch01ex_2_4_27">exercise 27</a> is multiplicative. Using this fact, evaluate <em>φ</em>(1000000), and give a method for evaluating $φ(n)$ in a simple way once <em>n</em> has been factored into primes.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_31a" id="ch01ex_2_4_31">31</a>.</strong> [<em>M22</em>] Prove that if <em>f</em> (<em>n</em>) is multiplicative, so is $g(n)=∑_{d\setminus n}f(d)$.</p>

  <p class="exercises1"><strong>32.</strong> [<em>M18</em>] Prove the double-summation identity</p>

  <div class="image"><img src="../Images/ch01/e043_01.png"></div>

  <p class="exercisesp">for any function $f(x,y)$.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_33a" id="ch01ex_2_4_33">33</a>.</strong> [<em>M18</em>] Given that <em>m</em> and <em>n</em> are integers, evaluate (a) <span class="middle"><img src="../Images/ch01/e043_02.png"></span>; (b) <span class="middle"><img src="../Images/ch01/e043_03.png"></span>. (The special case <em>m</em> = 0 is worth noting.)</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_4_34a" id="ch01ex_2_4_34">34</a>.</strong> [<em>M21</em>] What conditions on the real number <em>b</em> &gt; 1 are necessary and sufficient to guarantee that $\lfloor{log_{b}x}\rfloor=\lfloor{log_{b}\lfloor{x}\rfloor}\rfloor$ for all real <em>x</em> ≥ 1?</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_4_35a" id="ch01ex_2_4_35">35</a>.</strong> [<em>M20</em>] Given that <em>m</em> and <em>n</em> are integers and <em>n</em> &gt; 0, prove that</p>

  <p class="center">$\lfloor{(x+m)/n}\rfloor=\lfloor{(\lfloor{x}\rfloor+m)/n}\rfloor$</p>

  <p class="exercisesp">for all real <em>x</em>. (When <em>m</em> = 0, we have an important special case.) Does an analogous result hold for the ceiling function?</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_36a" id="ch01ex_2_4_36">36</a>.</strong> [<em>M23</em>] Prove that <span class="middle"><img src="../Images/ch01/e043_04.png"></span>; also evaluate <span class="middle"><img src="../Images/ch01/e043_05.png"></span>.</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_4_37a" id="ch01ex_2_4_37">37</a>.</strong> [<em>M30</em>] Let <em>m</em> and <em>n</em> be integers, <em>n</em> &gt; 0. Show that</p>

  <div class="image"><img src="../Images/ch01/e043_06.png"></div>

  <p class="exercisesp">where <em>d</em> is the greatest common divisor of <em>m</em> and <em>n</em>, and <em>x</em> is any real number.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_38a" id="ch01ex_2_4_38">38</a>.</strong> [<em>M26</em>] (E. Busche, 1909.) Prove that, for all real <em>x</em> and <em>y</em> with <em>y</em> &gt; 0,</p>

  <div class="image"><img src="../Images/ch01/e043_07.png"></div>

  <p class="exercisesp">In particular, when <em>y</em> is a positive integer <em>n</em>, we have the important formula</p>

  <div class="image"><img src="../Images/ch01/e043_08.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_39a" id="ch01ex_2_4_39">39</a>.</strong> [<em>HM35</em>] A function <em>f</em> for which <span class="middle"><img src="../Images/ch01/e043_09.png"></span>, whenever <em>n</em> is a positive integer, is called a <em>replicative function</em>. The previous exercise establishes the fact that $\lfloor{x}\rfloor$ is replicative. Show that the following functions are replicative:</p>

  <p class="indenthangingA">a) <span class="middle"><img src="../Images/ch01/e043_10.png"></span>;</p>

  <p class="indenthangingA">b) $f(x)=$ [<em>x</em> is an integer];</p>

  <p class="indenthangingA">c) $f(x)=$ [<em>x</em> is a positive integer];</p>

  <p class="indenthangingA">d) $f(x)=$ [there exists a rational number <em>r</em> and an integer <em>m</em> such that $x=rπ+m$];</p>

  <p class="indenthangingA">e) three other functions like the one in (d), with <em>r</em> and/or <em>m</em> restricted to positive values;</p>

  <p class="indenthangingA">f) $f(x)=\log|2\sin πx|$, if the value $f(x)=-∞$ is allowed;</p>

  <p class="indenthangingA">g) the sum of any two replicative functions;</p>

  <p class="indenthangingA">h) a constant multiple of a replicative function;</p>

  <p class="indenthangingA">i) the function $g(x)=f(x-\lfloor{x}\rfloor)$, where $f(x)$ is replicative.</p>

  <p class="exercises1"><a id="page_44"></a><strong><a href="../Text/app01.html#ch01ex_2_4_40a" id="ch01ex_2_4_40">40</a>.</strong> [<em>HM46</em>] Study the class of replicative functions; determine all replicative functions of a special type. For example, is the function in (a) of <a href="../Text/ch01.html#ch01ex_2_4_39">exercise 39</a> the only continuous replicative function? It may be interesting to study also the more general class of functions for which</p>

  <div class="image"><img src="../Images/ch01/e044_01.png"></div>

  <p class="exercisesp">Here $a_{n}$ and $b_{n}$ are numbers that depend on <em>n</em> but not on <em>x</em>. Derivatives and (if $b_{n}=0$) integrals of these functions are of the same type. If we require that $b_{n}=0$, we have, for example, the Bernoulli polynomials, the trigonometric functions $\cot πx$ and $\csc^{2}πx$, as well as Hurwitz’s generalized zeta function <span class="middle"><img src="../Images/ch01/e044_01a.png"></span> for fixed <em>s</em>. With $b_{n}≠0$ we have still other well-known functions, such as the psi function.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_41a" id="ch01ex_2_4_41">41</a>.</strong> [<em>M23</em>] Let $a_{1},a_{2},a_{3},...$ be the sequence 1, 2, 2, 3, 3, 3, 4, 4, 4, 4, ...; find an expression for $a_{n}$ in terms of <em>n</em>, using the floor and/or ceiling function.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_42a" id="ch01ex_2_4_42">42</a>.</strong> [<em>M24</em>] (a) Prove that</p>

  <div class="image"><img src="../Images/ch01/e044_02.png"></div>

  <p class="exercisesp">(b) The preceding formula is useful for evaluating certain sums involving the floor function. Prove that, if <em>b</em> is an integer ≥ 2,</p>

  <div class="image"><img src="../Images/ch01/e044_03.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_43a" id="ch01ex_2_4_43">43</a>.</strong> [<em>M23</em>] Evaluate <span class="middle"><img src="../Images/ch01/e044_04.png"></span>.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_44a" id="ch01ex_2_4_44">44</a>.</strong> [<em>M24</em>] Show that <span class="middle"><img src="../Images/ch01/e044_04a.png"></span>, if <em>b</em> and <em>n</em> are integers, <em>n</em> ≥ 0, and <em>b</em> ≥ 2. What is the value of this sum when <em>n</em> &lt; 0?</p>

  <p class="exercises3"><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_4_45a" id="ch01ex_2_4_45">45</a>.</strong> [<em>M28</em>] The result of <a href="../Text/ch01.html#ch01ex_2_4_37">exercise 37</a> is somewhat surprising, since it implies that</p>

  <div class="image"><img src="../Images/ch01/e044_05.png"></div>

  <p class="exercisesp">when <em>m</em> and <em>n</em> are positive integers and <em>x</em> is arbitrary. This “reciprocity relationship” is one of many similar formulas (see Section 3.3.3). Show that in general we have</p>

  <div class="image"><img src="../Images/ch01/e044_06.png"></div>

  <p class="exercisesp">for any function <em>f</em> and all integers <em>m</em>, <em>n</em> &gt; 0. In particular, prove that</p>

  <div class="image"><img src="../Images/ch01/e044_07.png"></div>

  <p class="exercisesp">[<em>Hint:</em> Consider the change of variable $r=\lfloor{mj/n}\rfloor$. Binomial coefficients <span class="middle"><img src="../Images/ch01/e044_08.png"></span> are discussed in <a href="../Text/ch01a.html#ch01lev2sec6">Section 1.2.6</a>.]</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_46a" id="ch01ex_2_4_46">46</a>.</strong> [<em>M29</em>] (<em>General reciprocity law.</em>) Extend the formula of <a href="../Text/ch01.html#ch01ex_2_4_45">exercise 45</a> to obtain an expression for <span class="middle"><img src="../Images/ch01/e044_09.png"></span>, where <em>α</em> is <em>any</em> positive real number.</p>

  <p class="exercises3"><a id="page_45"></a><span class="middle"><img src="../Images/ch01/arrow.png"></span>&nbsp;&nbsp;&nbsp;<strong><a href="../Text/app01.html#ch01ex_2_4_47a" id="ch01ex_2_4_47">47</a>.</strong> [<em>M31</em>] When <em>p</em> is an odd prime number, the <em>Legendre symbol</em> <span class="middle"><img src="../Images/ch01/e045_01.png"></span> is defined to be +1, 0, or −1, depending on whether $q^{(p-1)/2}\bmod p$ is 1, 0, or <em>p</em> − 1. (<a href="../Text/ch01.html#ch01ex_2_4_26">Exercise 26</a> proves that these are the only possible values.)</p>

  <p class="indenthangingA">a) Given that <em>q</em> is not a multiple of <em>p</em>, show that the numbers</p>

  <p class="center">$(-1)^{\lfloor{2kq/p}\rfloor}(2kq\bmod p)$,&nbsp;&nbsp;&nbsp;&nbsp;$0\lt k\lt p/2$,</p>

  <p class="indenthangingNP">are congruent in some order to the numbers $2,4,...,p-\md[1]{p}$. Hence <span class="middle"><img src="../Images/ch01/e045_03.png"></span> where <span class="middle"><img src="../Images/ch01/e045_03a.png"></span>.</p>

  <p class="indenthangingA">b) Use the result of (a) to calculate <span class="middle"><img src="../Images/ch01/e045_04.png"></span>.</p>

  <p class="indenthangingA">c) Given that <em>q</em> is odd, show that <span class="middle"><img src="../Images/ch01/e045_04a.png"></span> unless <em>q</em> is a multiple of <em>p</em>. [<em>Hint:</em> Consider the quantity $\lfloor{(p-1-2k)q/p}\rfloor$.]</p>

  <p class="indenthangingA">d) Use the general reciprocity formula of <a href="../Text/ch01.html#ch01ex_2_4_46">exercise 46</a> to obtain the <em>law of quadratic reciprocity</em>, <span class="middle"><img src="../Images/ch01/e045_05.png"></span>, given that <em>p</em> and <em>q</em> are distinct odd primes.</p>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_48a" id="ch01ex_2_4_48">48</a>.</strong> [<em>M26</em>] Prove or disprove the following identities, for integers <em>m</em> and <em>n</em>:</p>

  <div class="image"><img src="../Images/ch01/e045_06.png"></div>

  <p class="exercises1"><strong><a href="../Text/app01.html#ch01ex_2_4_49a" id="ch01ex_2_4_49">49</a>.</strong> [<em>M30</em>] Suppose the integer-valued function $f(x)$ satisfies the two simple laws (i) $f(x+1)=f(x)+1$; (ii) $f(x)=f(f(nx)/n)$ for all positive integers <em>n</em>. Prove that either $f(x)=\lfloor{x}\rfloor$ for all rational <em>x</em>, or $f(x)=\lceil{x}\rceil$ for all rational <em>x</em>.</p>

  <div class="heading">
    <h4 id="ch01lev2sec5">1.2.5. Permutations and Factorials</h4>

    <p>A <em>permutation of <em>n</em> objects</em> is an arrangement of <em>n</em> distinct objects in a row. There are six permutations of three objects $\{a,b,c\}$:</p>
  </div>

  <div class="equation" id="ch01eq-lev2sec5-1"><img src="../Images/ch01/045equ01.png"></div>

  <p class="indent">The properties of permutations are of great importance in the analysis of algorithms, and we will deduce many interesting facts about them later in this book.<a href="../Text/ch01.html#ch01afn01" id="ch01afn01a">*</a> Our first task is simply to <em>count</em> them: How many permutations of <em>n</em> objects are possible? There are <em>n</em> ways to choose the leftmost object, and once this choice has been made there are $n-1$ ways to select a different object to place next to it; this gives us $n(n-1)$ choices for the first two positions. Similarly, we find that there are $n-2$ choices for the third object distinct from the first two, and a total of $n(n-1)(n-2)$ possible ways to choose the first three objects. In general, if $p_{nk}$ denotes the number of ways to choose <em>k</em> objects out of <em>n</em> and to arrange them in a row, we see that</p>

  <div class="equation" id="ch01eq-lev2sec5-2"><img src="../Images/ch01/045equ02.png"></div>

  <p>The total number of permutations is therefore $p_{nn}=n(n-1)...(1)$.</p>

  <p class="footnote"><a href="../Text/ch01.html#ch01afn01a" id="ch01afn01">*</a> In fact, permutations are so important, Vaughan Pratt has suggested calling them “perms.” As soon as Pratt’s convention is established, textbooks of computer science will be somewhat shorter (and perhaps less expensive).</p>

  <p class="indent">The process of <em>constructing</em> all permutations of <em>n</em> objects in an inductive manner, assuming that all permutations of <em>n</em> − 1 objects have been constructed, is very important in our applications. Let us rewrite (<a href="../Text/ch01.html#ch01eq-lev2sec5-1">1</a>) using the numbers $\{1,2,3\}$ instead of the letters $\{a,b,c\}$; the permutations are then</p>

  <div class="equation" id="page_46"></a><a id="ch01eq-lev2sec5-3"><img src="../Images/ch01/046equ01.png"></div>

  <p>Consider how to get from this array to the permutations of $\{1,2,3,4\}$. There are two principal ways to go from <em>n</em> − 1 objects to <em>n</em> objects.</p>

  <p><strong>Method 1.</strong> For each permutation $a_{1}a_{2}...a_{n-1}$ of $\{1,2,...,n-1\}$, form <em>n</em> others by inserting the number <em>n</em> in all possible places, obtaining</p>

  <p class="center">$n a_{1}a_{2}...a_{n-1}$,&nbsp;&nbsp;&nbsp;&nbsp;$a_{1}n a_{2}...a+{n-1}$,&nbsp;&nbsp;&nbsp;&nbsp;$...,$&nbsp;&nbsp;&nbsp;&nbsp;$a_{1}a_{2}...n a_{n-1}$,&nbsp;&nbsp;&nbsp;&nbsp;$a_{1}a_{2}...a_{n-1}n$.</p>

  <p>For example, from the permutation 2 3 1 in (<a href="../Text/ch01.html#ch01eq-lev2sec5-3">3</a>), we get 4 2 3 1, 2 4 3 1, 2 3 4 1, 2 3 1 4. It is clear that all permutations of <em>n</em> objects are obtained in this manner and that no permutation is obtained more than once.</p>

  <p><strong>Method 2.</strong> For each permutation $a_{1}a_{2}...a_{n-1}$ of $\{1,2,...,n-1\}$, form <em>n</em> others as follows: First construct the array</p>

  <div class="image"><img src="../Images/ch01/e046_01.png"></div>

  <p>Then rename the elements of each permutation using the numbers $\{1,2,...,n\}$, <em>preserving order</em>. For example, from the permutation 2 3 1 in (<a href="../Text/ch01.html#ch01eq-lev2sec5-3">3</a>) we get</p>

  <div class="image"><img src="../Images/ch01/e046_02.png"></div>

  <p>and, renaming, we get</p>

  <p class="center">3 4 2 1,&nbsp;&nbsp;&nbsp;&nbsp;3 4 1 2,&nbsp;&nbsp;&nbsp;&nbsp;2 4 1 3,&nbsp;&nbsp;&nbsp;&nbsp;2 3 1 4.</p>

  <p class="indent">Another way to describe this process is to take the permutation $a_{1}a_{2}...a_{n-1}$ and a number <em>k</em>, 1 ≤ <em>k</em> ≤ <em>n</em>; add one to each $a_{j}$ whose value is ≥ <em>k</em>, thus obtaining a permutation $b_{1}b_{2}...b_{n-1}$ of the elements $\{1,...,k-1,k+1,...,n\}$; then $b_{1}b_{2}...b_{n-1}k$ is a permutation of $\{1,...,n\}$.</p>

  <p class="indent">Again it is clear that we obtain each permutation of <em>n</em> elements exactly once by this construction. Putting <em>k</em> at the left instead of the right, or putting <em>k</em> in any other fixed position, would obviously work just as well.</p>

  <p class="indent">If $p_{n}$ is the number of permutations of <em>n</em> objects, both of these methods show that $p_{n}=np_{n-1}$; this offers us two further proofs that $p_{n}=n(n-1)...(1)$, as we already established in Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-2">2</a>).</p>

  <p class="indent">The important quantity $p_{n}$ is called <em>n factorial</em> and it is written</p>

  <div class="equation" id="ch01eq-lev2sec5-4"><img src="../Images/ch01/046equ02.png"></div>

  <p>Our convention for vacuous products (<a href="../Text/ch01.html#ch01lev2sec3">Section 1.2.3</a>) gives us the value</p>

  <div class="equation" id="ch01eq-lev2sec5-5"><img src="../Images/ch01/046equ03.png"></div>

  <p>and with this convention the basic identity</p>

  <div class="equation" id="ch01eq-lev2sec5-6"><img src="../Images/ch01/046equ04.png"></div>

  <p>is valid for all positive integers <em>n</em>.</p>

  <p class="indent"><a id="page_47"></a>Factorials come up sufficiently often in computer work that the reader is advised to memorize the values of the first few:</p>

  <p class="center">$0!=1$,&nbsp;&nbsp;&nbsp;$1!=1$,&nbsp;&nbsp;&nbsp;$2!=2$,&nbsp;&nbsp;&nbsp;$3!=6$,&nbsp;&nbsp;$4!=24$,&nbsp;&nbsp;&nbsp;$5!=120$.</p>

  <p>The factorials increase very rapidly; for example, $1000!$ is an integer with over 2500 decimal digits.</p>

  <p class="indent">It is helpful to keep the value $10!=3,628,800$ in mind; one should remember that 10! is about <span class="middle"><img src="../Images/ch01/e047_01a.png"></span>. In a sense, this number represents an approximate dividing line between things that are practical to compute and things that are not. If an algorithm requires the testing of more than 10! cases, it may consume too much computer time to be practical. On the other hand, if we decide to test $10!$ cases and each case requires, say, one millisecond of computer time, then the entire run will take about an hour. These comments are very vague, of course, but they can be useful to give an intuitive idea of what is computationally feasible.</p>

  <p class="indent">It is only natural to wonder what relation <em>n</em>! bears to other quantities in mathematics. Is there any way to tell how large 1000! is, without laboriously carrying out the multiplications implied in Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-4">4</a>)? The answer was found by James Stirling in his famous work <em>Methodus Differentialis</em> (1730), page 137; we have</p>

  <div class="equation" id="ch01eq-lev2sec5-7"><img src="../Images/ch01/047equ01.png"></div>

  <p class="indent">The “≈” sign that appears here denotes “approximately equal,” and “<em>e</em>” is the base of natural logarithms introduced in <a href="../Text/ch01.html#ch01lev2sec2">Section 1.2.2</a>. We will prove Stirling’s approximation (<a href="../Text/ch01.html#ch01eq-lev2sec5-7">7</a>) in <a href="../Text/ch01b.html#ch01lev3sec2">Section 1.2.11.2</a>. <a href="../Text/ch01a.html#ch01ex_2_5_24">Exercise 24</a> gives a simple proof of a less precise result.</p>

  <p class="indent">As an example of the use of this formula, we may compute</p>

  <div class="image"><img src="../Images/ch01/e047_01.png"></div>

  <p>In this case the error is about 1%; we will see later that the relative error is approximately $1/(12n)$.</p>

  <p class="indent">In addition to the approximate value given by Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-7">7</a>), we can also rather easily obtain the exact value of <em>n</em>! factored into primes. In fact, the prime <em>p</em> is a divisor of $n!$ with the multiplicity</p>

  <div class="equation" id="ch01eq-lev2sec5-8"><img src="../Images/ch01/047equ02.png"></div>

  <p>For example, if <em>n</em> = 1000 and <em>p</em> = 3, we have</p>

  <div class="image"><img src="../Images/ch01/e047_02.png"></div>

  <p>so $1000!$ is divisible by $3^{498}$ but not by $3^{499}$. Although formula (<a href="../Text/ch01.html#ch01eq-lev2sec5-8">8</a>) is written as an infinite sum, it is really finite for any particular values of <em>n</em> and <em>p</em>, because all of <a id="page_48"></a>the terms are eventually zero. It follows from <a href="../Text/ch01.html#ch01lev2sec4">exercise 1.2.4</a>–<a href="../Text/ch01.html#ch01ex_2_4_35">35</a> that $\lfloor{n/p^{k+1}}\rfloor=\lfloor{\lfloor{n/p^{k}}\rfloor/p}\rfloor$; this fact facilitates the calculation in Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-8">8</a>), since we can just divide the value of the previous term by <em>p</em> and discard the remainder.</p>

  <p class="indent">Equation (<a href="../Text/ch01.html#ch01eq-lev2sec5-8">8</a>) follows from the fact that $\lfloor{n/p^{k}}\rfloor$ is the number of integers among $\{1,2,...,n\}$ that are multiples of $p^{k}$. If we study the integers in the product (<a href="../Text/ch01.html#ch01eq-lev2sec5-4">4</a>), any integer that is divisible by $p^{j}$ but not by $p^{j+1}$ is counted exactly <em>j</em> times: once in $\lfloor{n/p}\rfloor$, once in $\lfloor{n/p^{2}}\rfloor,...,$ once in $\lfloor{n/p^{j}}\rfloor$. This accounts for all occurrences of <em>p</em> as a factor of $n!$. [See A. M. Legendre, <em>Essai sur la Théorie des Nombres</em>, second edition (Paris: 1808), page 8.]</p>

  <p class="indent">Another natural question arises: Now that we have defined <em>n</em>! for non-negative integers <em>n</em>, perhaps the factorial function is meaningful also for rational values of <em>n</em>, and even for real values. What is <span class="middle"><img src="../Images/ch01/e048_01a.png"></span>, for example? Let us illustrate this point by introducing the “termial” function</p>

  <div class="equation" id="ch01eq-lev2sec5-9"><img src="../Images/ch01/048equ01.png"></div>

  <p>which is analogous to the factorial function except that we are adding instead of multiplying. We already know the sum of this arithmetic progression from Eq. <a href="../Text/ch01.html#ch01lev2sec3">1.2.3</a>–(<a href="../Text/ch01.html#ch01eq-lev2sec3-15">15</a>):</p>

  <div class="equation" id="ch01eq-lev2sec5-10"><img src="../Images/ch01/048equ02.png"></div>

  <p>This suggests a good way to generalize the “termial” function to arbitrary <em>n</em>, by using (<a href="../Text/ch01.html#ch01eq-lev2sec5-10">10</a>) instead of (<a href="../Text/ch01.html#ch01eq-lev2sec5-9">9</a>). We have <span class="middle"><img src="../Images/ch01/e048_01.png"></span>.</p>

  <p class="indent">Stirling himself made several attempts to generalize <em>n</em>! to noninteger <em>n</em>. He extended the approximation (<a href="../Text/ch01.html#ch01eq-lev2sec5-7">7</a>) into an infinite sum, but unfortunately the sum did not converge for any value of <em>n</em>; his method gave extremely good approximations, but it couldn’t be extended to give an <em>exact</em> value. [For a discussion of this somewhat unusual situation, see K. Knopp, <em>Theory and Application of Infinite Series,</em> 2nd ed. (Glasgow: Blackie, 1951), 518–520, 527, 534.]</p>

  <p class="indent">Stirling tried again, by noticing that</p>

  <div class="equation" id="ch01eq-lev2sec5-11"><img src="../Images/ch01/048equ03.png"></div>

  <p>(We will prove this formula in the next section.) The apparently infinite sum in Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-11">11</a>) is in reality finite for any nonnegative integer <em>n</em>; however, it does not provide the desired generalization of <em>n</em>!, since the infinite sum does not exist <em>except</em> when <em>n</em> is a nonnegative integer. (See <a href="../Text/ch01a.html#ch01ex_2_5_16">exercise 16</a>.)</p>

  <p class="indent">Still undaunted, Stirling found a sequence $a_{1},a_{2},...$ such that</p>

  <div class="equation" id="ch01eq-lev2sec5-12"><img src="../Images/ch01/048equ04.png"></div>

  <p>He was unable to <em>prove</em> that this sum defined <em>n</em>! for all fractional values of <em>n</em>, although he was able to deduce the value of <span class="middle"><img src="../Images/ch01/e048_02.png"></span>.</p>

  <p class="indent"><a id="page_49"></a>At about the same time, Leonhard Euler considered the same problem, and he was the first to find the appropriate generalization:</p>

  <div class="equation" id="ch01eq-lev2sec5-13"><img src="../Images/ch01/049equ01.png"></div>

  <p>Euler communicated this idea in a letter to Christian Goldbach on October 13, 1729. His formula defines <em>n</em>! for any value of <em>n</em> except negative integers (when the denominator becomes zero); in such cases <em>n</em>! is taken to be infinite. <a href="../Text/ch01a.html#ch01ex_2_5_8">Exercises 8</a> and <a href="../Text/ch01a.html#ch01ex_2_5_22">22</a> explain why Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-13">13</a>) is a reasonable definition.</p>

  <p class="indent">Nearly two centuries later, in 1900, C. Hermite proved that Stirling’s idea (<a href="../Text/ch01.html#ch01eq-lev2sec5-12">12</a>) actually does define <em>n</em>! successfully for nonintegers <em>n</em>, and that in fact Euler’s and Stirling’s generalizations are identical.</p>

  <p class="indent">Many notations were used for factorials in the early days. Euler actually wrote [<em>n</em>], Gauss wrote <em>Π n</em>, and the symbols <span class="middle"><img src="../Images/ch01/n-1.png"></span> and <span class="middle"><img src="../Images/ch01/n-2.png"></span> were popular in England and Italy. The notation <em>n</em>!, which is universally used today when <em>n</em> is an integer, was introduced by a comparatively little known mathematician, Christian Kramp, in an algebra text [<em>Élémens d’Arithmétique Universelle</em> (Cologne: 1808), page 219].</p>

  <p class="indent">When <em>n</em> is <em>not</em> an integer, however, the notation <em>n</em>! is less common; instead we customarily employ a notation due to A. M. Legendre:</p>

  <div class="equation" id="ch01eq-lev2sec5-14"><img src="../Images/ch01/049equ02.png"></div>

  <p>This function $Γ(x)$ is called the <em>gamma function</em>, and by Eq. (<a href="../Text/ch01.html#ch01eq-lev2sec5-13">13</a>) we have the definition</p>

  <div class="equation" id="ch01eq-lev2sec5-15"><img src="../Images/ch01/049equ03.png"></div>

  <p>A graph of $Γ(x)$ is shown in <a href="../Text/ch01.html#ch01fig07">Fig. 7</a>.</p>

  <div class="image4">
    <a id="ch01fig07"></a><img class="img1" src="../Images/ch01/01fig07.png">

    <p class="fig-caption"><strong>Fig. 7.</strong> The function <em>Γ</em> (<em>x</em>) = (<em>x</em> - 1)!. The local minimum at <em>X</em> has the coordinates (1.46163 21449 68362 34126 26595, 0.88560 31944 10888 70027 88159).</p>
  </div>

  <p class="indent">Equations (<a href="../Text/ch01.html#ch01eq-lev2sec5-13">13</a>) and (<a href="../Text/ch01.html#ch01eq-lev2sec5-15">15</a>) define factorials and the gamma function for complex values as well as real values; but we generally use the letter <em>z</em>, instead of <em>n</em> or <em>x</em>, when thinking of a variable that has both real and imaginary parts. The factorial and gamma functions are related not only by the rule $z!=Γ(z+1)$ but also by</p>

  <div class="equation" id="ch01eq-lev2sec5-16"><img src="../Images/ch01/049equ04.png"></div>

  <p>which holds whenever <em>z</em> is not an integer. (See <a href="../Text/ch01a.html#ch01ex_2_5_23">exercise 23</a>.)</p>

  <p class="indent">Although $Γ(z)$ is infinite when <em>z</em> is zero or a negative integer, the function $1/Γ(z)$ is well defined for all complex <em>z</em>. (See exercise <a href="../Text/ch01a.html#ch01lev2sec7">1.2.7</a>–<a href="../Text/ch01a.html#ch01ex_2_7_2">2</a>.) Advanced applications of the gamma function often make use of an important contour integral formula due to Hermann Hankel:</p>

  <div class="equation" id="ch01eq-lev2sec5-17"><img src="../Images/ch01/049equ05.png"></div>

  <p>the path of complex integration starts at −∞, then circles the origin in a counterclockwise direction and returns to −∞. [<em>Zeitschrift für Math. und Physik</em> 9 (1864), 1–21.]</p>

  <p class="indent"><a id="page_50"></a>Many formulas of discrete mathematics involve factorial-like products known as <em>factorial powers.</em> The quantities <span class="middle"><img src="../Images/ch01/e050_01.png"></span> and <span class="middle"><img src="../Images/ch01/e050_02.png"></span> (read, “<em>x</em> to the <em>k</em> falling” and “<em>x</em> to the <em>k</em> rising”) are defined as follows, when <em>k</em> is a positive integer:</p>

  <div class="equation" id="ch01eq-lev2sec5-18"><img src="../Images/ch01/050equ01.png"></div>

  <div class="equation" id="ch01eq-lev2sec5-19"><img src="../Images/ch01/050equ02.png"></div>

  <p>Thus, for example, the number $p_{nk}$ of (<a href="../Text/ch01.html#ch01eq-lev2sec5-2">2</a>) is just <span class="middle"><img src="../Images/ch01/e050_03.png"></span>. Notice that we have</p>

  <div class="equation" id="ch01eq-lev2sec5-20"><img src="../Images/ch01/050equ03.png"></div>

  <p>The general formulas</p>

  <div class="equation" id="ch01eq-lev2sec5-21"><img src="../Images/ch01/050equ04.png"></div>

  <p>can be used to define factorial powers for other values of <em>k.</em> [The notations <span class="middle"><img src="../Images/ch01/e050_01.png"></span> and <span class="middle"><img src="../Images/ch01/e050_02.png"></span> are due respectively to A. Capelli, <em>Giornale di Mat. di Battaglini</em> <strong>31</strong> (1893), 291–313, and L. Toscano, <em>Comment. Accademia della Scienze</em> <strong>3</strong> (1939), 721–757.]</p>

  <p class="indent">The interesting history of factorials from the time of Stirling to the present day is traced in an article by P. J. Davis, “Leonhard Euler’s integral: A historical profile of the gamma function,” <em>AMM</em> <strong>66</strong> (1959), 849–869. See also J. Dutka, <em>Archive for History of Exact Sciences</em> <strong>31</strong> (1984), 15–34.</p>
</body>
</html>